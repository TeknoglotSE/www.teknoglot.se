{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"source/favicon.png","path":"favicon.png","modified":1,"renderable":0},{"_id":"themes/tg-hueman/source/favicon.ico","path":"favicon.ico","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/js/insight.js","path":"js/insight.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/images/logo-header.png","path":"css/images/logo-header.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/images/logo-header.psd","path":"css/images/logo-header.psd","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/images/opacity-10.png","path":"css/images/opacity-10.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/images/s-left.png","path":"css/images/s-left.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/images/thumb-default-small.png","path":"css/images/thumb-default-small.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/css/images/thumb-default.png","path":"css/images/thumb-default.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/blank.gif","path":"vendor/fancybox/blank.gif","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_loading.gif","path":"vendor/fancybox/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_loading@2x.gif","path":"vendor/fancybox/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_overlay.png","path":"vendor/fancybox/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_sprite.png","path":"vendor/fancybox/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_sprite@2x.png","path":"vendor/fancybox/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/jquery.fancybox.css","path":"vendor/fancybox/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/jquery.fancybox.js","path":"vendor/fancybox/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/jquery.fancybox.pack.js","path":"vendor/fancybox/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/jquery.scrollLoading.js","path":"vendor/scrollLoading/jquery.scrollLoading.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/main.js","path":"vendor/scrollLoading/main.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/style.css","path":"vendor/scrollLoading/style.css","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/source-code-pro/styles.css","path":"vendor/source-code-pro/styles.css","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/styles.css","path":"vendor/titillium-web/styles.css","modified":1,"renderable":1},{"_id":"source/wp-content/uploads/2009/04/avatar-150x150.jpg","path":"wp-content/uploads/2009/04/avatar-150x150.jpg","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2009/04/avatar.jpg","path":"wp-content/uploads/2009/04/avatar.jpg","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2009/07/4d89ae6b339483137aa42a1935c11bdb.jpeg","path":"wp-content/uploads/2009/07/4d89ae6b339483137aa42a1935c11bdb.jpeg","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2009/06/screenshot1245833173-150x26.png","path":"wp-content/uploads/2009/06/screenshot1245833173-150x26.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2009/06/screenshot1245833173-300x10.png","path":"wp-content/uploads/2009/06/screenshot1245833173-300x10.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2009/06/screenshot1245833173.png","path":"wp-content/uploads/2009/06/screenshot1245833173.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/ChangeGW.zip","path":"wp-content/uploads/2010/03/ChangeGW.zip","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/image-150x150.png","path":"wp-content/uploads/2010/03/image-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/image-300x140.png","path":"wp-content/uploads/2010/03/image-300x140.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/image.png","path":"wp-content/uploads/2010/03/image.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/image_thumb-150x150.png","path":"wp-content/uploads/2010/03/image_thumb-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/image_thumb-300x140.png","path":"wp-content/uploads/2010/03/image_thumb-300x140.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/03/image_thumb.png","path":"wp-content/uploads/2010/03/image_thumb.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/04/DistributeAgents.zip","path":"wp-content/uploads/2010/04/DistributeAgents.zip","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/04/DistributeAgents1.zip","path":"wp-content/uploads/2010/04/DistributeAgents1.zip","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/09/snmp_error_wireshark-150x138.png","path":"wp-content/uploads/2010/09/snmp_error_wireshark-150x138.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/09/snmp_error_wireshark-300x66.png","path":"wp-content/uploads/2010/09/snmp_error_wireshark-300x66.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/09/snmp_error_wireshark.png","path":"wp-content/uploads/2010/09/snmp_error_wireshark.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCPrgb-150x80.png","path":"wp-content/uploads/2010/10/MCPrgb-150x80.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCPrgb.png","path":"wp-content/uploads/2010/10/MCPrgb.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCSArgb-150x80.png","path":"wp-content/uploads/2010/10/MCSArgb-150x80.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCSArgb.png","path":"wp-content/uploads/2010/10/MCSArgb.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCSDrgb-150x80.png","path":"wp-content/uploads/2010/10/MCSDrgb-150x80.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCSDrgb.png","path":"wp-content/uploads/2010/10/MCSDrgb.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCTSrgb_537-150x80.png","path":"wp-content/uploads/2010/10/MCTSrgb_537-150x80.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCTSrgb_537-300x51.png","path":"wp-content/uploads/2010/10/MCTSrgb_537-300x51.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2010/10/MCTSrgb_537.png","path":"wp-content/uploads/2010/10/MCTSrgb_537.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/02/teknoglot_favicon.png","path":"wp-content/uploads/2011/02/teknoglot_favicon.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/02/teknoglot_title_banner.png","path":"wp-content/uploads/2011/02/teknoglot_title_banner.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/02/teknoglot_title_banner_leftie.png","path":"wp-content/uploads/2011/02/teknoglot_title_banner_leftie.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/04/k-services-icon.png","path":"wp-content/uploads/2011/04/k-services-icon.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/05/SCOM_Connectivity_Map-150x150.png","path":"wp-content/uploads/2011/05/SCOM_Connectivity_Map-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png","path":"wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2011/07/DisableACSForwarders.zip","path":"wp-content/uploads/2011/07/DisableACSForwarders.zip","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-150x150.png","path":"wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-300x259.png","path":"wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-300x259.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png","path":"wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL1-150x120.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL1-150x120.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL1.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL1.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL2-150x150.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL2-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL2-300x279.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL2-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL2.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL2.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL3-150x150.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL3-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL3-300x279.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL3-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL3.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL3.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL4-150x150.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL4-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL4-300x233.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL4-300x233.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL4.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL4.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL5-150x150.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL5-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL5-300x279.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL5-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL5.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL5.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL6-150x150.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL6-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL6-300x279.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL6-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL6.png","path":"wp-content/uploads/2012/05/051812_1007_SettingupNL6.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance1-150x120.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance1-150x120.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance1.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance10-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance10-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance10-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance10-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance10.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance11-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance11-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance11-300x105.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance11-300x105.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance11.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance2-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance2-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance2-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance2-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance2.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance3-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance3-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance3-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance3-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance3.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance4-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance4-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance4-300x233.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance4-300x233.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance4.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance5-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance5-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance5-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance5-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance5.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance6-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance6-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance6-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance6-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance6.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance7-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance7-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance7-300x218.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance7-300x218.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance7.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance8-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance8-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance8-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance8-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance8.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance9-150x150.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance9-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance9-300x279.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance9-300x279.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png","path":"wp-content/uploads/2012/05/051812_1216_Loadbalance9.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-150x60.png","path":"wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-150x60.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-300x45.png","path":"wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-300x45.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1.png","path":"wp-content/uploads/2012/06/teknoglot_title_banner_leftie1.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2013/04/cream_dust.png","path":"wp-content/uploads/2013/04/cream_dust.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2013/04/cream_dust1.png","path":"wp-content/uploads/2013/04/cream_dust1.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2013/11/teknoglot_title_banner_leftie1.png","path":"wp-content/uploads/2013/11/teknoglot_title_banner_leftie1.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/08/cream_dust1.png","path":"wp-content/uploads/2014/08/cream_dust1.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/08/dark_stripes.png","path":"wp-content/uploads/2014/08/dark_stripes.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/08/fabric_plaid-150x150.png","path":"wp-content/uploads/2014/08/fabric_plaid-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/08/fabric_plaid.png","path":"wp-content/uploads/2014/08/fabric_plaid.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152402_0001-150x103.png","path":"wp-content/uploads/2014/09/152402_0001-150x103.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152402_0001.png","path":"wp-content/uploads/2014/09/152402_0001.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152428_0002-150x150.png","path":"wp-content/uploads/2014/09/152428_0002-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152428_0002-300x228.png","path":"wp-content/uploads/2014/09/152428_0002-300x228.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152428_0002.png","path":"wp-content/uploads/2014/09/152428_0002.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152447_0003-150x150.png","path":"wp-content/uploads/2014/09/152447_0003-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152447_0003-300x228.png","path":"wp-content/uploads/2014/09/152447_0003-300x228.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152447_0003.png","path":"wp-content/uploads/2014/09/152447_0003.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152506_0004-150x150.png","path":"wp-content/uploads/2014/09/152506_0004-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152506_0004-300x228.png","path":"wp-content/uploads/2014/09/152506_0004-300x228.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152506_0004.png","path":"wp-content/uploads/2014/09/152506_0004.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152525_0005-150x150.png","path":"wp-content/uploads/2014/09/152525_0005-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152525_0005-300x228.png","path":"wp-content/uploads/2014/09/152525_0005-300x228.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152525_0005.png","path":"wp-content/uploads/2014/09/152525_0005.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152612_0006-150x150.png","path":"wp-content/uploads/2014/09/152612_0006-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152612_0006-300x228.png","path":"wp-content/uploads/2014/09/152612_0006-300x228.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152612_0006.png","path":"wp-content/uploads/2014/09/152612_0006.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152646_0007-150x150.png","path":"wp-content/uploads/2014/09/152646_0007-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152646_0007-300x228.png","path":"wp-content/uploads/2014/09/152646_0007-300x228.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152646_0007.png","path":"wp-content/uploads/2014/09/152646_0007.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152750_0008-150x150.png","path":"wp-content/uploads/2014/09/152750_0008-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152750_0008-300x212.png","path":"wp-content/uploads/2014/09/152750_0008-300x212.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/152750_0008.png","path":"wp-content/uploads/2014/09/152750_0008.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/153833_0010-150x150.png","path":"wp-content/uploads/2014/09/153833_0010-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/153833_0010-300x240.png","path":"wp-content/uploads/2014/09/153833_0010-300x240.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/153833_0010.png","path":"wp-content/uploads/2014/09/153833_0010.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/154444_0011-150x93.png","path":"wp-content/uploads/2014/09/154444_0011-150x93.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/154444_0011-300x68.png","path":"wp-content/uploads/2014/09/154444_0011-300x68.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/154444_0011.png","path":"wp-content/uploads/2014/09/154444_0011.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/154502_0012-150x150.png","path":"wp-content/uploads/2014/09/154502_0012-150x150.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/154502_0012-300x117.png","path":"wp-content/uploads/2014/09/154502_0012-300x117.png","modified":1,"renderable":0},{"_id":"source/wp-content/uploads/2014/09/154502_0012.png","path":"wp-content/uploads/2014/09/154502_0012.png","modified":1,"renderable":0},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/fancybox_buttons.png","path":"vendor/fancybox/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-buttons.css","path":"vendor/fancybox/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-buttons.js","path":"vendor/fancybox/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-media.js","path":"vendor/fancybox/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-thumbs.css","path":"vendor/fancybox/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-thumbs.js","path":"vendor/fancybox/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/font-awesome/css/font-awesome.min.css","path":"vendor/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.woff2","path":"vendor/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/images/preloader.gif","path":"vendor/scrollLoading/images/preloader.gif","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/images/preloader@2x.gif","path":"vendor/scrollLoading/images/preloader@2x.gif","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","path":"vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","path":"vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcSo_WB_cotcEMUw1LsIE8mM.woff2","path":"vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcSo_WB_cotcEMUw1LsIE8mM.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcZSnX671uNZIV63UdXh3Mg0.woff2","path":"vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcZSnX671uNZIV63UdXh3Mg0.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr4-67659ICLY8bMrYhtePPA.woff2","path":"vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr4-67659ICLY8bMrYhtePPA.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr46gJz9aNFrmnwBdd69aqzY.woff2","path":"vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr46gJz9aNFrmnwBdd69aqzY.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr9INifKjd1RJ3NxxEi9Cy2w.woff2","path":"vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr9INifKjd1RJ3NxxEi9Cy2w.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr_SNRT0fZ5CX-AqRkMYgJJo.woff2","path":"vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr_SNRT0fZ5CX-AqRkMYgJJo.woff2","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/webfont/1.6.16/webfont.load.js","path":"vendor/webfont/1.6.16/webfont.load.js","modified":1,"renderable":1},{"_id":"source/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png","path":"wp-content/uploads/2011/05/SCOM_Connectivity_Map.png","modified":1,"renderable":0},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/FontAwesome.otf","path":"vendor/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.eot","path":"vendor/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.woff","path":"vendor/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/jquery/2.0.3/jquery.min.js","path":"vendor/jquery/2.0.3/jquery.min.js","modified":1,"renderable":1},{"_id":"source/wp-content/uploads/2011/04/teknoglot.wordpress.2011-04-27.xml_.txt","path":"wp-content/uploads/2011/04/teknoglot.wordpress.2011-04-27.xml_.txt","modified":1,"renderable":0},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.ttf","path":"vendor/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.svg","path":"vendor/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"8d702b1e7580d4c696530d7d560a32f819a22249","modified":1464818930035},{"_id":"source/favicon.png","hash":"d567eba1530f23fc4049b3aba328a68c242e091e","modified":1464817361000},{"_id":"themes/tg-hueman/.gitignore","hash":"cd089ae45ce870c45e434019e8f1ed4f066cd425","modified":1463520662000},{"_id":"themes/tg-hueman/LICENSE","hash":"f0c7cd0dcb6f00b98393878068ff3e6bf5f321f1","modified":1463520662000},{"_id":"themes/tg-hueman/README.md","hash":"5fd90f06b48adb35e2fe318f67f13a6439a5fa39","modified":1463520662000},{"_id":"themes/tg-hueman/_config.yml","hash":"5bf4e989eacce8d012e5ceb46f2f3cde4646fcd4","modified":1467752408764},{"_id":"themes/tg-hueman/package.json","hash":"d5a6c72b576e169e568adb1f8616f43d6c1dd3a6","modified":1463520662000},{"_id":"source/About/index.md","hash":"7738c8af391edb1898fe3ee3d4f5537a2def4272","modified":1463524004000},{"_id":"source/_posts/20160705-Resize-all-images-in-a-Word-document-with-vbs-macro.md","hash":"13bf9568d3dd7c1ecfb208c36f56abb1fc929cd9","modified":1467751868652},{"_id":"source/_posts/Event-Id-4001-–-“Cannot-Add-Type”-in-SQL-MP-6-6-4-0-for-OpsMgr2012.md","hash":"542960e5a75ed8b653b819ecf66e0f60a51039bc","modified":1464127177927},{"_id":"source/_posts/PoSH-Grid-Dashboard-for-RDSH.md","hash":"b03f9f17bd9d9d73dc2481ac284d7c55aad84d01","modified":1467748697942},{"_id":"source/_posts/bulk-disable-acs-forwarders-with-wildcards.md","hash":"1c3beb3e8cd658bd0105e90d11e42f6c05533d58","modified":1464127540686},{"_id":"source/_posts/cannot-delete-files-with-long-paths.md","hash":"867800e530df01ea64803e024b1f2e100538b843","modified":1464127473779},{"_id":"source/_posts/change-gateway-powershell-script.md","hash":"572392a19953c29ec13db8bc030bc81326d98c72","modified":1464127412015},{"_id":"source/_posts/clearing-disabled-discovery.md","hash":"cfbed70b3fcc8860cdf01f504cc5f171fadb8430","modified":1464127319117},{"_id":"source/_posts/cloudflare-dynamic-dns-mikrotik.md","hash":"4d8458f0b57f70e9e6a58d7e96dcf877016fb4ea","modified":1464127308874},{"_id":"source/_posts/esent-error-when-modifying-opsmgr-agent.md","hash":"2fca81f69413ad5b8f9b30e2aa3bd4640202c4d2","modified":1464127267490},{"_id":"source/_posts/health-rollup-not-working-in-exchange-management-pack.md","hash":"77440f4e45ff237261ff3c112d10d9fc6ccca713","modified":1464126917248},{"_id":"source/_posts/im-moving-finally.md","hash":"48507cdf48e595fda96c98f7f9f72b58f486911c","modified":1464126906929},{"_id":"source/_posts/in-transit-again.md","hash":"c22e42bb119f463ae894941eb496e602ace009dc","modified":1464823008000},{"_id":"source/_posts/install-linuxis21-rhes5.md","hash":"e008514b5b333ec87880e3e39060ba5d125a1a05","modified":1464126890115},{"_id":"source/_posts/installing-sql-reporting-services-2005-on-windows-2008-x64.md","hash":"feb9d9ce3f2d400db72aa35fd5d511a9484f7efa","modified":1464126726529},{"_id":"source/_posts/intel-drivers-causes-old-school-freezes-on-windows-vista.md","hash":"d716835a09c55d359ac6567aa6f1c00dd8d0cbcf","modified":1464126715339},{"_id":"source/_posts/introduction-to-tg-winautosvc-v1.md","hash":"c6ae9d8b359278df537393a9988a9cc01610f2f3","modified":1464126700087},{"_id":"source/_posts/lets-split.md","hash":"4922f3f0183ab0167b6d83bfa2fbd899bcdadfc3","modified":1463649069000},{"_id":"source/_posts/linux-discovery-not-enough-entropy.md","hash":"a71ea862ba5876be1e3f0a2854c708b987dafc5c","modified":1464126633353},{"_id":"source/_posts/load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb.md","hash":"5ff61bee0c235c01dcf815edaca89812c44cf22c","modified":1464126326461},{"_id":"source/_posts/menu-problems.md","hash":"3b55f841a41c4882646a49c40bb7d36d7bb82886","modified":1464126092453},{"_id":"source/_posts/microsoft-adds-support-for-suse-11-in-opsmgr-r2.md","hash":"771061b688e989022bb8985f28e5a0c014a7efb7","modified":1464126071212},{"_id":"source/_posts/move-complete-welcome-to-teknoglot-se.md","hash":"b9a5a87101c68f48262ef7cf42ffa9d1529b6b22","modified":1463649069000},{"_id":"source/_posts/msmq-3-mp-for-opsmgr-v6065870-released.md","hash":"3ad2a9ec8034bc77e2c5dca6256f70e0ef091c35","modified":1464125882584},{"_id":"source/_posts/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally.md","hash":"934244785294c8cc4fef6dbaa8da99542e511d49","modified":1464125848780},{"_id":"source/_posts/msmq-mp-subscriptoutofrange.md","hash":"21373bdc170a7f01fbfe92a67a1e1811b6c9e393","modified":1464125802232},{"_id":"source/_posts/my-impression-of-ext4-wth.md","hash":"c3cd3e974a545ea486932299e182dcfdfd56cc82","modified":1463649069000},{"_id":"source/_posts/networkadaptercheck-fails-on-win2k.md","hash":"28064bbbae16299bcef5f018742ca6aca6d93ce2","modified":1464125684009},{"_id":"source/_posts/nvidia-problems-in-ubuntu-810.md","hash":"cdfcfc7ca309e5d7a059518e263b66168a628a2f","modified":1464125464466},{"_id":"source/_posts/opsmgr-2007-connectivity-map.md","hash":"c5d41edd8971d07b5808a20cc9f64da4aa4f38f2","modified":1464125453254},{"_id":"source/_posts/opsmgr-2007-r2-documentation.md","hash":"4137f99dfb98c3e62ee931ebc191289b36296d66","modified":1464125438928},{"_id":"source/_posts/opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell.md","hash":"1cbd4b904cf51a6da38045f26fced9d9fd3979d8","modified":1464125423119},{"_id":"source/_posts/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell.md","hash":"69d08f014cbe2114c0d36523fa4b02bf99a85ea2","modified":1464125413989},{"_id":"source/_posts/opsmgr-2012-agent-gateway-failover-the-basics.md","hash":"3ad7d2902a9f8c3a6ec02db66162e01e29b7fa17","modified":1464125405315},{"_id":"source/_posts/opsmgr-2012-r2-ur4-field-notes.md","hash":"84f9bfe9216b29344a75318bf986fd5eecf54595","modified":1464125390237},{"_id":"source/_posts/opsmgr2012r2ur3-field-notes.md","hash":"519e1c404826d53dd01c0b0b66a0cf4221101226","modified":1464125376201},{"_id":"source/_posts/parameter-replacement-in-alertname.md","hash":"4d8cf1bcd4fd00cbaaa521bbc1100512edac97d6","modified":1464125358143},{"_id":"source/_posts/quest-software-acquires-exc-and-vizioncore.md","hash":"c95679f9d697e23d5670a2bf16d935822be43cbb","modified":1464125085359},{"_id":"source/_posts/quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring.md","hash":"4b3d8d40d024a2b3eaeb7f189705e1db7ffec24c","modified":1464124957292},{"_id":"source/_posts/quick-hack-send-sms-through-powershell-powershell.md","hash":"ee1b0e9fec8e88615e978cae2ea9ece2b4b7ec4c","modified":1464124826798},{"_id":"source/_posts/rant-the-concept-of-booth-babes.md","hash":"6cb4260e424b9a6dc7c7302ebbcb9844202e6766","modified":1464124575167},{"_id":"source/_posts/regain-sysadmin-access-to-sql2005-or-sql2008.md","hash":"fbfba98f4c544795b5679d19832f840c40a5b059","modified":1467729769336},{"_id":"source/_posts/replacechange-a-gateway-server.md","hash":"4393088cd8ada5a387edaad93744bfd92f7d278c","modified":1464124040061},{"_id":"source/_posts/server-problems-fixed-hopefully.md","hash":"c1f875e87b355db9ae1710090878678657cecca0","modified":1463649069000},{"_id":"source/_posts/silly-hibernation-doo-doo-on-winxp.md","hash":"24cff9b40a3abf8db14693ad254641d8b5c70545","modified":1463654526000},{"_id":"source/_posts/sluggish-performance-on-teknoglot.md","hash":"ae91080f28a3c99a688f12488fca9a8ae4acc2de","modified":1464123775038},{"_id":"source/_posts/snmp-get-errors-in-eventlog.md","hash":"971600d4e92f455f4f2cd1b12aebe1c3ec75a082","modified":1464123734400},{"_id":"source/_posts/sql-managementpack-survey-make-your-voice-heard.md","hash":"d571304768c4544f53cd255864b5270eafd30b17","modified":1463654550000},{"_id":"source/_posts/squaredup-installation.md","hash":"1ac4b2f66d6ef159391d08071c75b5ce899aa62d","modified":1464123373235},{"_id":"source/_posts/tcp-port-check-use-with-caution.md","hash":"05fad9e94272c60b48c9afa0de0c0cbcb71480c9","modified":1464123132982},{"_id":"source/_posts/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64.md","hash":"b964388626498d655f7e4ec282fd6d1260392621","modified":1464123051201},{"_id":"source/_posts/updated-msmq-management-pack.md","hash":"c8e26515884c467bb7e483181a9b3fe9e45e05e5","modified":1464122920153},{"_id":"source/_posts/updated-operations-manager-2007-r2-management-pack.md","hash":"bb2e0769c21676af1533cb50666c2b36d799dee8","modified":1464122523573},{"_id":"source/_posts/virtual-openvpn-server-at-home.md","hash":"c75b20303de8a559dbc336513995dea464234290","modified":1463649069000},{"_id":"source/_posts/w3socket-in-vbscript.md","hash":"501f87bd364b4671078605c437203d48f1597d75","modified":1464120179883},{"_id":"source/_posts/whynotusesqlexpress-itsforfree.md","hash":"da97f177adaa03157348024a0f861fabdd7de38b","modified":1464122408948},{"_id":"source/_posts/windows-server-2008-nlb-m-for-opsmgr-released.md","hash":"e47b33e9e0ae79d78659bc0b200fd3fdde4a12c1","modified":1464121597040},{"_id":"themes/tg-hueman/languages/ca.yml","hash":"d88625a06b434db3b0ed37b0d5f64ee31e91c077","modified":1463520662000},{"_id":"themes/tg-hueman/languages/en.yml","hash":"04e18ca6700ccee5dc713e1cd9165a3760016b8e","modified":1463520662000},{"_id":"themes/tg-hueman/languages/es.yml","hash":"92bbf2ebd70a08d5011e5c8c31597f2dd1ea9901","modified":1463520662000},{"_id":"themes/tg-hueman/languages/fr.yml","hash":"ed73fdd6adc49631eec1a163397e5adbaa91cd9e","modified":1463520662000},{"_id":"themes/tg-hueman/languages/id.yml","hash":"dfd5d4ddf4797385093a8a569b71b18aa902e0c2","modified":1463520662000},{"_id":"themes/tg-hueman/languages/pt-BR.yml","hash":"4caa8df5aba98b23672bbe7d70674f5f67744b95","modified":1463520662000},{"_id":"themes/tg-hueman/languages/ru.yml","hash":"fb81066411e37a2472797d4d40a7c409d768d34a","modified":1463520662000},{"_id":"themes/tg-hueman/languages/zh-CN.yml","hash":"48e4ba9beebfe4d6c7550deaa0ba30953f8ac778","modified":1463520662000},{"_id":"themes/tg-hueman/layout/archive.ejs","hash":"8785477232088e09a75da88a0cdcb32fedf4f81f","modified":1463520662000},{"_id":"themes/tg-hueman/layout/category.ejs","hash":"de99b00563d7c7b00cc7fd4e74e77c171891fbdc","modified":1463520662000},{"_id":"themes/tg-hueman/layout/index.ejs","hash":"8785477232088e09a75da88a0cdcb32fedf4f81f","modified":1463520662000},{"_id":"themes/tg-hueman/layout/layout.ejs","hash":"4376f9a13a19551ec72aa41b824c635f0a847c55","modified":1463520662000},{"_id":"themes/tg-hueman/layout/page.ejs","hash":"5afddd6a45fa72beacec8d760487dfe8a667e622","modified":1463520662000},{"_id":"themes/tg-hueman/layout/post.ejs","hash":"5afddd6a45fa72beacec8d760487dfe8a667e622","modified":1463520662000},{"_id":"themes/tg-hueman/layout/tag.ejs","hash":"8785477232088e09a75da88a0cdcb32fedf4f81f","modified":1463520662000},{"_id":"themes/tg-hueman/scripts/excerpt.js","hash":"61118ffd53158c6620010f6362752745f8372469","modified":1463520662000},{"_id":"themes/tg-hueman/scripts/fancybox.js","hash":"c5ccce47ecfa93925c54516f6af85d690f8f6476","modified":1463520662000},{"_id":"themes/tg-hueman/scripts/meta.js","hash":"2e5ac0cb9c90c072ca4b33e88f1892e954935ab7","modified":1463520662000},{"_id":"themes/tg-hueman/scripts/thumbnail.js","hash":"57ffb4a061516ffa52b0df5513bf1a8eaf4df48e","modified":1463520662000},{"_id":"themes/tg-hueman/source/favicon.ico","hash":"e8189e51434d7f4926a843581e6767d5695a3295","modified":1463523153000},{"_id":"themes/tg-hueman/layout/comment/counter.ejs","hash":"9a60f5c68301e61a8658cf13c55093112c92619a","modified":1463520662000},{"_id":"themes/tg-hueman/layout/comment/disqus.ejs","hash":"84988da295ab8c509e24299c2c857d707cf78f77","modified":1463520662000},{"_id":"themes/tg-hueman/layout/comment/duoshuo.ejs","hash":"adc024b7205e934e64c98a5b912c41117a4425bd","modified":1463520662000},{"_id":"themes/tg-hueman/layout/comment/index.ejs","hash":"c36e6b376647ae715d417cb928c2082ef56766a9","modified":1463520662000},{"_id":"themes/tg-hueman/layout/comment/scripts.ejs","hash":"8767c30714baf8011bb191b8a1c652ea114a53f2","modified":1463520662000},{"_id":"themes/tg-hueman/layout/comment/youyan.ejs","hash":"b4c49b97b757d01ba0c4e16f9862a2ec05f37b1f","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/archive.ejs","hash":"424647122986c501165b36a512cb48c392142f51","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/article.ejs","hash":"553542538c932a42e16ba2f2c46f72d714c09c12","modified":1464816330006},{"_id":"themes/tg-hueman/layout/common/content-title.ejs","hash":"1e787b40398f6da1db9505c39bbe6fa70e096cdc","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/footer.ejs","hash":"24aba6265bd769880e2f107614085802039c5550","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/head.ejs","hash":"ad5281f3342a5c0573d4717548ce2aad455a8556","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/header.ejs","hash":"a27f027fc60d49ca84381a08c7102aa7d3118ec4","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/scripts.ejs","hash":"271ad89a94bbced9f3f7377c145d86b62df0fee9","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/sidebar.ejs","hash":"5e0f2ed90009883c99fbb71f4baabbc55f220150","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/summary.ejs","hash":"a722ec4cbffa45259f5addc093b1bbf8ff25a3c3","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/thumbnail.ejs","hash":"bf9c51ba8ba86fa4cb8e5e10665f6eeaf5f93f01","modified":1463520662000},{"_id":"themes/tg-hueman/layout/plugin/baidu-analytics.ejs","hash":"dc075c744e866c3cea8460439953fa2a073d6475","modified":1463520662000},{"_id":"themes/tg-hueman/layout/plugin/google-analytics.ejs","hash":"760a8f9ee9b81f6eb27a5f2c8c5159b220a88a74","modified":1463520662000},{"_id":"themes/tg-hueman/layout/plugin/scripts.ejs","hash":"6d4bcb971713b2abd1feaf166f61f46761220a77","modified":1463520662000},{"_id":"themes/tg-hueman/layout/search/baidu.ejs","hash":"46515988503a8b8dd07d0cf3ccabf519b4fad2d1","modified":1463520662000},{"_id":"themes/tg-hueman/layout/search/index.ejs","hash":"1b232e45234638a08cdc34d33cd7378636649822","modified":1463520662000},{"_id":"themes/tg-hueman/layout/search/insight.ejs","hash":"21ec59e4534ac2417d6b215b6cfe3825245ad340","modified":1463520662000},{"_id":"themes/tg-hueman/layout/search/swiftype.ejs","hash":"cce9c44180d9490f45b30b8f052ac82675a9d66a","modified":1463520662000},{"_id":"themes/tg-hueman/layout/share/addtoany.ejs","hash":"b79f714da69c121729a136df0c94c09a85966d44","modified":1463520662000},{"_id":"themes/tg-hueman/layout/share/bdshare.ejs","hash":"d2a0826700c51d9edaf21fa6cbb047b5127cec8a","modified":1463520662000},{"_id":"themes/tg-hueman/layout/share/default.ejs","hash":"9a12d26f8d01557f69ca403a4b6f96fab7b45bd7","modified":1463520662000},{"_id":"themes/tg-hueman/layout/share/index.ejs","hash":"a0d5e32c68e1e6d3f2f954420bbb48675736b895","modified":1463520662000},{"_id":"themes/tg-hueman/layout/share/jiathis.ejs","hash":"442abbc0fe5cab4171179257d172150f2a789638","modified":1463520662000},{"_id":"themes/tg-hueman/layout/widget/archive.ejs","hash":"4bf2c1433166017450a3e7d265570b34d59195eb","modified":1463520662000},{"_id":"themes/tg-hueman/layout/widget/category.ejs","hash":"4f39c49773590a8c854aab6c09623afb1de865b5","modified":1463520662000},{"_id":"themes/tg-hueman/layout/widget/links.ejs","hash":"a979a257a0e8720de8c052233840c1ddde95ea37","modified":1463520662000},{"_id":"themes/tg-hueman/layout/widget/recent_posts.ejs","hash":"dd092bbf28104482210b4c4a734e551f7536f525","modified":1463520662000},{"_id":"themes/tg-hueman/layout/widget/tag.ejs","hash":"49c61ba1e57a76ab03053ef1b885ddeaa121c7ce","modified":1463520662000},{"_id":"themes/tg-hueman/layout/widget/tagcloud.ejs","hash":"744f0a0a9249745c7afd8abb0faba2cdb5b6811c","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_extend.styl","hash":"01cbce2eb56d9b576eba7e99b66a9476c2431d0f","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_responsive.styl","hash":"0e41183083909fa8d0b9cd6d7ebc5bcacded1b8f","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_retina.styl","hash":"8a001d540b3c404164f103720dc4299f76ab49f8","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_variables.styl","hash":"77b5a5ace79f3d7b34eae1c359d581f32b721d74","modified":1467752047058},{"_id":"themes/tg-hueman/source/css/style.styl","hash":"f0a024956f148dc6c6aeec305e2891c9fc0d48b0","modified":1463520662000},{"_id":"themes/tg-hueman/source/js/insight.js","hash":"154c023c13d913984e9f70e22affea1ee8abe444","modified":1463520662000},{"_id":"themes/tg-hueman/source/js/main.js","hash":"b0dbc3a3f4e83be5842713b1afdf3a3953854bc0","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/post/category.ejs","hash":"88ea9b606f4eaa2dc8019bc57a737b8b695f04f3","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/post/date.ejs","hash":"7136b61431f6170bdb714b1b146a5ea80ebea18c","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/post/nav.ejs","hash":"f7a755a93abed84337f2519eae788f20a88c4bf3","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/post/tag.ejs","hash":"ed8b5b262bbb7eb838c6295b588cbcdd4112f850","modified":1463520662000},{"_id":"themes/tg-hueman/layout/common/post/title.ejs","hash":"e164edee924be00641013f0fd4e53f55b51f90a8","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/agate.styl","hash":"c01db6c4e7648b217048a8deefeee189688a9290","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/androidstudio.styl","hash":"b0923fe15d0b5eb24d3c6236cb2fc30ee14a4c56","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/arduino-light.styl","hash":"591962bfc758a521b4cb907750c19a1a2423b4d5","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/arta.styl","hash":"3bc322455f657aa29f455f91009034af08cdc65c","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/ascetic.styl","hash":"ca087a3c70998c7ac6b0b42d5cf7a653b8707591","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-cave-dark.styl","hash":"a6b1960d8a3b39d035e06ce92af4f00a259b5c56","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-cave-light.styl","hash":"f47de0b9d66617728f68096ed48371dd6bb9e67a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-dune-dark.styl","hash":"68021a92fd7d6895426d0cc7f0929aa95633d742","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-dune-light.styl","hash":"657fe215931fd06e21b56374df699a94890f7ab4","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-estuary-dark.styl","hash":"6c051f034c229c49ffc9a2ec96c032441b0c6586","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-estuary-light.styl","hash":"2b416a0567a53aa0fa8898b196ddd44315c1a5f3","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-forest-dark.styl","hash":"15559324ee3a5f9bf6724ec9606f6f2e16cdc24d","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-forest-light.styl","hash":"8d7c7242974aa2454fa792c5d7a47c5f9632355a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-heath-dark.styl","hash":"bf62cafe316eb874f1f43679957dc3add4fbea34","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-heath-light.styl","hash":"c1db353e8613607580d40b12ddc162d029560576","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-lakeside-dark.styl","hash":"64ab6ab93a092a890d3d0fdeb23e4b6a2d0f2887","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-lakeside-light.styl","hash":"8659eaae6a0c2e00b4b9199803e50adf4ff0128d","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-plateau-dark.styl","hash":"8a6c187afcd60152306c003e1a5903e57d9428dd","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-plateau-light.styl","hash":"96181544eeadc5b0749229f11607e7c01f81e078","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-savanna-dark.styl","hash":"5261a100e84cf34f4752c24dfaddfa05c7be96f7","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-savanna-light.styl","hash":"8a5207a0c30262a0bf5e1a41411a306f7a89a7e7","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-seaside-dark.styl","hash":"434b7f0bdd5f91bf79d5b4ca46820db4a8e10166","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-seaside-light.styl","hash":"08e2df313c272d5c70c93e713639663c168180d0","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-sulphurpool-dark.styl","hash":"fa0cccd0f0dc015218cf8c1bba0b53c8c9383135","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/atelier-sulphurpool-light.styl","hash":"add3d88c9d12567dcfae7a8e49984d119fc72227","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/brown-paper.styl","hash":"d14846542a26b75fd26df5b5df6c5493733f73f6","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/codepen-embed.styl","hash":"7432ce9edb047b6382d28c82054a7e2a77e476c3","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/color-brewer.styl","hash":"9c4905eab730d0b389e6972e907057577f7e25f1","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/dark.styl","hash":"df4c1dc05567ad0812d0cd3133cb2a2a5fd23c04","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/darkula.styl","hash":"3c943561a885092286ec8db14e9177036bf8d21f","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/docco.styl","hash":"7bd3389ce16d20488ab336d557056cc703c921c7","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/far.styl","hash":"5989aea14ccd0153d17ee19b3e125dae06c75f3c","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/foundation.styl","hash":"28c59a31467c33bd51cbf3b6085782c2a724ff6c","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/github-gist.styl","hash":"71f4b0fca91a587e6eba15a5306dca963bb8f441","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/github.styl","hash":"a84eb710b302006120c3e7f8ca18f9e6fbc231c3","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/googlecode.styl","hash":"7f5082ae008925a23eb713f160773fe647eb3ff7","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/grayscale.styl","hash":"c83804abe39faebd80f8f4ff64fbd7137674cb1c","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/highlightjs.styl","hash":"fd796a58c5d4590cda67c998187933788d45f30a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/hopscotch.styl","hash":"7ec8d75a9c9d58f65868ea64289873302d3fad5e","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/hybrid.styl","hash":"d3ee1bcefc94f5f87a2b76a689f4c31594501d07","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/idea.styl","hash":"e284c1760e8da0848f56cd5601d867ceeb0192d7","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/index.styl","hash":"57298fa8ae862ac69f2e368957e2e63bb22bf3b8","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/ir-black.styl","hash":"c59db73998af32ce8419a5d2d335bcc9cfbaae45","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/kimbie.dark.styl","hash":"3b998c640eeb2c6192fee24bc78b4137de475dd7","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/kimbie.light.styl","hash":"e901738455ec9a1bddde7b62bbd8595de6033e1e","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/magula.styl","hash":"ab179306c12a1cf2949482beaca328e379ef034a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/mono-blue.styl","hash":"14fb8678739b77f35771b6d63101ddbf1e7a9fbc","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/monokai-sublime.styl","hash":"32955f699687b5fc2e4072804cb90925912d3c7c","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/monokai.styl","hash":"8489fc71bedefa8f271808126296fce6381f9e04","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/obsidian.styl","hash":"8145db8ec349548f09d91d7a05c00c83ff84d146","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/paraiso-dark.styl","hash":"50f1cee8a5b3b165b4184ead0a99dc564b62ef4f","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/paraiso-light.styl","hash":"e428e8202b01e83b0f018a96058d806e7f4c76bf","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/pojoaque.jpg","hash":"c5fe6533b88b21f8d90d3d03954c6b29baa67791","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/pojoaque.styl","hash":"d9f4b35c9f6115029600a8a023b559013e2b4e75","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/railscasts.styl","hash":"1ff800d9b6de464fafe591682cc48bf983202758","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/rainbow.styl","hash":"516c7080d64b12730357358dee2adc42c43c4516","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/school-book.styl","hash":"186c37e9c39e65aa291cce3317e35904693598d1","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/solarized-dark.styl","hash":"577458d1f6c02bc42e312066bf7dd7e427cab057","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/solarized-light.styl","hash":"bb04944fc06c12ecd7b56ad933dbedde60c2259a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/sunburst.styl","hash":"482bbb2bc461b22e9d6ce55f0f84767e1cfae99a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/tomorrow-night-blue.styl","hash":"eeafa86697c857c4e9a84ad48c0d56a7154997a3","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/tomorrow-night-bright.styl","hash":"f3cd5ed391d40265e36fcd9f7daced52773fb886","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/tomorrow-night-eighties.styl","hash":"1cd947f3d414fa5c1435caea509f27c99f6dc5b3","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/tomorrow-night.styl","hash":"b2a175caa23631f764b2f6fe2bac9739f5f5e078","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/tomorrow.styl","hash":"502335f0fac07ed74ca78207bcf3ef8dd2252cf6","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/vs.styl","hash":"14fbb0c43af440a290280b26968c8a5c0786b27f","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/xcode.styl","hash":"5fa8999c7f807c1aae29c7a1cdf681678576fb69","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_highlight/zenburn.styl","hash":"6908313d2666d31fc9d8658fd7e8dda3de2bb596","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/archive.styl","hash":"46aa36ef93ee77bfa97adad6ab2530a1057a1596","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/article.styl","hash":"037b9287c2fe39c29dd5adf082ad63bb214aa626","modified":1465856449361},{"_id":"themes/tg-hueman/source/css/_partial/assets.styl","hash":"c42627622550f02395087c53a1a193f162fded65","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/comment.styl","hash":"850f1f84987159da6fa2efdfa95cc82d0a2e59cd","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/footer.styl","hash":"6d3f31f50a7e87c92c2675dbf0c6c2e112dc5608","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/header.styl","hash":"64e4b94f1e88d795c8866d261856680ca6faee2a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/insight.styl","hash":"b29d88a9411f06974aa67381a3f3f39fb3b69feb","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/nav.styl","hash":"b2941a6a171d2bfb3000be71664c04cc2a2c5964","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/_partial/sidebar.styl","hash":"ae76e2b7bc637b0632b12b31193313d53be1643a","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/images/logo-header.png","hash":"fb0a0e52aa354840644b830fad20e8d4de3b8c79","modified":1463648028000},{"_id":"themes/tg-hueman/source/css/images/logo-header.psd","hash":"a0f925509b1b9d7d41617db5b5643938fade685f","modified":1463648015000},{"_id":"themes/tg-hueman/source/css/images/opacity-10.png","hash":"bbc979866c5b50e8adb348419154b28b1ff44d78","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/images/s-left.png","hash":"c8cac4f4e3492606fab93196364bd0f87d93bb98","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/images/thumb-default-small.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1463520662000},{"_id":"themes/tg-hueman/source/css/images/thumb-default.png","hash":"2d0ba175d958d342494241c616a74d37f48059fb","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/jquery.fancybox.css","hash":"2e54d51d21e68ebc4bb870f6e57d3bfb660d4f9c","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/jquery.fancybox.js","hash":"a68039c027be5585d347407d71737c065ecf7cc1","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/jquery.fancybox.pack.js","hash":"028cf1ddf6532edb2199ad9378de53aff9a3be43","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/jquery.scrollLoading.js","hash":"d0729cb06dd7eefd789e7b6b01fb9b4b691741fb","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/main.js","hash":"2c5656a7da36f79b046af1d01ef9d9af62137990","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/style.css","hash":"d51dc010ce8cb7f30ab1274e7c7b4bf20d91e9a3","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/source-code-pro/styles.css","hash":"6335d719343cca455152ad71a1aaed9868339236","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/styles.css","hash":"5780e94a2a38ffa02322edaa780cb58c3199efa7","modified":1463520662000},{"_id":"source/wp-content/uploads/2009/04/avatar-150x150.jpg","hash":"ab418a26a66479fcca11beb912c65a75790aa445","modified":1381920836000},{"_id":"source/wp-content/uploads/2009/04/avatar.jpg","hash":"a61204a931fcbc0b07b40f814d4a0829a36d2f36","modified":1381920836000},{"_id":"source/wp-content/uploads/2009/07/4d89ae6b339483137aa42a1935c11bdb.jpeg","hash":"fb3cf710b690205b6ab9eaf47fd2fa9b0252ef42","modified":1381920836000},{"_id":"source/wp-content/uploads/2009/06/screenshot1245833173-150x26.png","hash":"065fd3b268402b9371911fbf5495226142387077","modified":1381920836000},{"_id":"source/wp-content/uploads/2009/06/screenshot1245833173-300x10.png","hash":"ebb90a19e541bc6d09975a162230eb5771a6c594","modified":1381920836000},{"_id":"source/wp-content/uploads/2009/06/screenshot1245833173.png","hash":"705c83d1382a30744c7e4158801bce5121960c58","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/ChangeGW.zip","hash":"77662af386ae596fa9b4b7936b704e5668a7f3ae","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/image-150x150.png","hash":"2e6c17154ca9a14723c8d0dfee12e0d8507b73ae","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/image-300x140.png","hash":"30da021b8a1bf3dd8056c9b35d37376e2b92ceec","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/image.png","hash":"3010027641396efd61b963dd00bfcaaf2387c9ee","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/image_thumb-150x150.png","hash":"2e6c17154ca9a14723c8d0dfee12e0d8507b73ae","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/image_thumb-300x140.png","hash":"30da021b8a1bf3dd8056c9b35d37376e2b92ceec","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/03/image_thumb.png","hash":"3010027641396efd61b963dd00bfcaaf2387c9ee","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/04/DistributeAgents.zip","hash":"57339af729d1331291096c1c219ca804e65075a1","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/04/DistributeAgents1.zip","hash":"b0e2b9f5c3b632f6f73089f2653ade4025bf3991","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/09/snmp_error_wireshark-150x138.png","hash":"52a24d8608154e74f69a3933096f633bdb3fd8d7","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/09/snmp_error_wireshark-300x66.png","hash":"c5f9913fee529668f310e9e024da6f1d6455a553","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/09/snmp_error_wireshark.png","hash":"45a50df4966b411310239693d829717ba670b1e9","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCPrgb-150x80.png","hash":"0a32beb2928b2da91f19f8fa739ffc3cb28968a5","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCPrgb.png","hash":"e5c38373e7319050cd1d5d9179bcbe334269349e","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCSArgb-150x80.png","hash":"3b39a5363894d20cce5f43195edcad8b91df9a89","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCSArgb.png","hash":"6f04e2c039b0674a45ed431ee6379769fe0cad03","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCSDrgb-150x80.png","hash":"d79a7111b7deedcde0495db049b4e79cdc310b7a","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCSDrgb.png","hash":"7d6229b71359191af9bbbe7aa1aee8590c6766f7","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCTSrgb_537-150x80.png","hash":"c63b1da3d58d5c539039959e4e08a5ff6ac0f316","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCTSrgb_537-300x51.png","hash":"7c7bd3c3aa7e2aaea41d40c006ce2f91ce96942f","modified":1381920836000},{"_id":"source/wp-content/uploads/2010/10/MCTSrgb_537.png","hash":"26f899cdd65c8026e040203e9ca25c1728f045de","modified":1381920836000},{"_id":"source/wp-content/uploads/2011/02/teknoglot_favicon.png","hash":"d567eba1530f23fc4049b3aba328a68c242e091e","modified":1381920836000},{"_id":"source/wp-content/uploads/2011/02/teknoglot_title_banner.png","hash":"b02bdf58ac9779329e2243fcaa3d9cba926c7d58","modified":1381920836000},{"_id":"source/wp-content/uploads/2011/02/teknoglot_title_banner_leftie.png","hash":"57535c304eca5b30da5ea35a1178e127080242a1","modified":1381920836000},{"_id":"source/wp-content/uploads/2011/04/k-services-icon.png","hash":"1317f4e371f0e9897440a505db615e83d96915ad","modified":1382010089000},{"_id":"source/wp-content/uploads/2011/05/SCOM_Connectivity_Map-150x150.png","hash":"9a1e808a4dccf7a9c5c7b47389be55f9a083da5e","modified":1382010085000},{"_id":"source/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png","hash":"5d7fa86ea627400debddce922b4ce26816b9dcc7","modified":1382010087000},{"_id":"source/wp-content/uploads/2011/07/DisableACSForwarders.zip","hash":"6619dcce4966f8963ad9a12598ae917bde4af259","modified":1381920836000},{"_id":"source/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-150x150.png","hash":"7a8f2ae8a0f18b1ff34739c7845bbd5562aa022a","modified":1382010078000},{"_id":"source/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-300x259.png","hash":"9ec514b761f5d354192508bc6f8d783dcbb5fec6","modified":1382010081000},{"_id":"source/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png","hash":"c01188e6dcc616fb355ac994491730169516ec96","modified":1382010076000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL1-150x120.png","hash":"26fa08e5fdbd9b44795f6b17064c0a5c2402916a","modified":1382010075000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL1.png","hash":"c44cfca9895f654aa4d8adf9ba1b9b6a59d31554","modified":1382010073000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL2-150x150.png","hash":"3dd8efae865adc8abbdbd95466fbac2852eea5b5","modified":1382010069000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL2-300x279.png","hash":"e989cd62a1971ed3af779ac7bfd4468b30e2d98c","modified":1382010072000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL2.png","hash":"28831aad7e9d5b03ead8bee8bd1c999503643f3d","modified":1382010067000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL3-150x150.png","hash":"60c4aef2941591378376db1c19ee5d98590754e4","modified":1382010063000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL3-300x279.png","hash":"d125bd9fed61266a890c25bef6d278376f22609f","modified":1382010065000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL3.png","hash":"32462a6c9a7c5eb229e2d14159165ba808b21c2c","modified":1382010062000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL4-150x150.png","hash":"197c45bd0769eef0ee60b1d09b2a9233dc663dfb","modified":1382010057000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL4-300x233.png","hash":"c5372495a1e92e72c0020e165c8f9e0b6f7f4839","modified":1382010060000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL4.png","hash":"10f81add425dae47090b8dfb5a66b7a7f95d39b2","modified":1382010056000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL5-150x150.png","hash":"b49536eacf1fec9011790ec5db5f3cd47f44c9f7","modified":1382010050000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL5-300x279.png","hash":"6aac1cba6e67e3b4a9fea18cd898d16b6ce6a168","modified":1382010053000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL5.png","hash":"8fe1e5175803723e3849ab53f7afdfca383d7d72","modified":1382010048000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL6-150x150.png","hash":"31c67b4c33f3b4fb1a91c30bd4da821ac4efb048","modified":1382010042000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL6-300x279.png","hash":"2758c42401f72ff304f22be1ddca55fb5ba5a2c3","modified":1382010044000},{"_id":"source/wp-content/uploads/2012/05/051812_1007_SettingupNL6.png","hash":"eda5bc1681bd7ac6147ebaa39e08bb888672a2c3","modified":1382010040000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance1-150x120.png","hash":"26fa08e5fdbd9b44795f6b17064c0a5c2402916a","modified":1382010038000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png","hash":"c44cfca9895f654aa4d8adf9ba1b9b6a59d31554","modified":1382010036000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance10-150x150.png","hash":"e8462231a2e411272ecd49b797d029d24b464e17","modified":1382009846000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance10-300x279.png","hash":"50790bc8a3fcbe37cd9511995124861bfbe95e8c","modified":1382009855000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png","hash":"ecdf590b1c673afce037215b7b7d4355190335b6","modified":1382009838000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance11-150x150.png","hash":"b80e33e9c32ad5d653352f3b5798780752372d1f","modified":1382009825000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance11-300x105.png","hash":"f081b796abcba19bcc0760eaf593dadef92e3471","modified":1382009831000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png","hash":"5e19610706ebb5ae92476506b25e3f8baec37e15","modified":1382009818000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance2-150x150.png","hash":"3dd8efae865adc8abbdbd95466fbac2852eea5b5","modified":1382010027000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance2-300x279.png","hash":"e989cd62a1971ed3af779ac7bfd4468b30e2d98c","modified":1382010034000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png","hash":"28831aad7e9d5b03ead8bee8bd1c999503643f3d","modified":1382010021000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance3-150x150.png","hash":"60c4aef2941591378376db1c19ee5d98590754e4","modified":1382010009000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance3-300x279.png","hash":"d125bd9fed61266a890c25bef6d278376f22609f","modified":1382010016000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png","hash":"32462a6c9a7c5eb229e2d14159165ba808b21c2c","modified":1382010002000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance4-150x150.png","hash":"197c45bd0769eef0ee60b1d09b2a9233dc663dfb","modified":1382009985000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance4-300x233.png","hash":"c5372495a1e92e72c0020e165c8f9e0b6f7f4839","modified":1382009994000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png","hash":"10f81add425dae47090b8dfb5a66b7a7f95d39b2","modified":1382009974000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance5-150x150.png","hash":"b49536eacf1fec9011790ec5db5f3cd47f44c9f7","modified":1382009958000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance5-300x279.png","hash":"6aac1cba6e67e3b4a9fea18cd898d16b6ce6a168","modified":1382009966000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png","hash":"8fe1e5175803723e3849ab53f7afdfca383d7d72","modified":1382009950000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance6-150x150.png","hash":"31c67b4c33f3b4fb1a91c30bd4da821ac4efb048","modified":1382009934000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance6-300x279.png","hash":"2758c42401f72ff304f22be1ddca55fb5ba5a2c3","modified":1382009942000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png","hash":"eda5bc1681bd7ac6147ebaa39e08bb888672a2c3","modified":1382009929000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance7-150x150.png","hash":"3f07ed2d5f16e5cb069a090bd1c6dc388c275f69","modified":1382009915000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance7-300x218.png","hash":"4a07255d2d02ce165dd008ad45a233d1c48ce5e6","modified":1382009922000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png","hash":"61aa360d374bc3d173bedc81b78465bab13ef5ca","modified":1382009910000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance8-150x150.png","hash":"1a3ee19e6d92088a582f5342aff3a8a52af10071","modified":1382009894000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance8-300x279.png","hash":"79f52ec24d446353734c8ebeefe2c1de33383bdb","modified":1382009902000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png","hash":"97c6a08fd9272ac9896a506da294da2f07c34c38","modified":1382009886000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance9-150x150.png","hash":"bf88cba944b18c39958f2e195f4bbf9b0e9cccf0","modified":1382009873000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance9-300x279.png","hash":"b80769c27d6ba9d6a8dfe7a888fadcf1f43b2329","modified":1382009880000},{"_id":"source/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png","hash":"063edda481a34f0a22dbaf691ec2831b329dbe6d","modified":1382009865000},{"_id":"source/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-150x60.png","hash":"841620f35e9c24387e8a23ce5da36448b3b2b16b","modified":1382009802000},{"_id":"source/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-300x45.png","hash":"453042b5480b647f46b1cd27d90881547734b9d8","modified":1382009810000},{"_id":"source/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1.png","hash":"178369aab28af9bcb1914125d3c94f28e5f221a1","modified":1382009794000},{"_id":"source/wp-content/uploads/2013/04/cream_dust.png","hash":"eef38c387db75e461f07f1c3578942d8907e4f5a","modified":1381920836000},{"_id":"source/wp-content/uploads/2013/04/cream_dust1.png","hash":"eef38c387db75e461f07f1c3578942d8907e4f5a","modified":1381920836000},{"_id":"source/wp-content/uploads/2013/11/teknoglot_title_banner_leftie1.png","hash":"178369aab28af9bcb1914125d3c94f28e5f221a1","modified":1385554378000},{"_id":"source/wp-content/uploads/2014/08/cream_dust1.png","hash":"eef38c387db75e461f07f1c3578942d8907e4f5a","modified":1408972977000},{"_id":"source/wp-content/uploads/2014/08/dark_stripes.png","hash":"eefadc75ba3ffe1faee6a8c6d49c2e244f620d2f","modified":1408973387000},{"_id":"source/wp-content/uploads/2014/08/fabric_plaid-150x150.png","hash":"c7fc644da9e0d05abbd38ffd44259f35b68d7c88","modified":1408973206000},{"_id":"source/wp-content/uploads/2014/08/fabric_plaid.png","hash":"3c7062c930e73e3656b74f7d9cab1e8ca3091036","modified":1408973205000},{"_id":"source/wp-content/uploads/2014/09/152402_0001-150x103.png","hash":"d8d06811de843253eb4a312db272ab71cb6ee90d","modified":1410273231000},{"_id":"source/wp-content/uploads/2014/09/152402_0001.png","hash":"2f087310febd5f5c30c0c9e3e495d4054b4b66bd","modified":1410273230000},{"_id":"source/wp-content/uploads/2014/09/152428_0002-150x150.png","hash":"1e43a4e398acbca69a547ea0e4a6367ef0b8844f","modified":1410273234000},{"_id":"source/wp-content/uploads/2014/09/152428_0002-300x228.png","hash":"9d422658d2fd1550af9794316e4943840a995a9b","modified":1410273236000},{"_id":"source/wp-content/uploads/2014/09/152428_0002.png","hash":"be962612aef6c4ec9f4af90ba55df5d844025ff2","modified":1410273234000},{"_id":"source/wp-content/uploads/2014/09/152447_0003-150x150.png","hash":"f55988a162b0a32b7a863323fbb78ddcde15e905","modified":1410273240000},{"_id":"source/wp-content/uploads/2014/09/152447_0003-300x228.png","hash":"c8ecc8477c83b1a4339c6bab72169f79405cc0f9","modified":1410273242000},{"_id":"source/wp-content/uploads/2014/09/152447_0003.png","hash":"d8e1bc7fe1d1d9580fdbc56ab18715c2ffbc94b7","modified":1410273239000},{"_id":"source/wp-content/uploads/2014/09/152506_0004-150x150.png","hash":"eac0b3842777f583dcbfd001e265887a8bdfe156","modified":1410273244000},{"_id":"source/wp-content/uploads/2014/09/152506_0004-300x228.png","hash":"42f9f9e772fe0730c4f68fa32c9f0cbfa48e86d8","modified":1410273246000},{"_id":"source/wp-content/uploads/2014/09/152506_0004.png","hash":"19e9bfc26154b00bc22c0850fe7e32b9ec72177a","modified":1410273243000},{"_id":"source/wp-content/uploads/2014/09/152525_0005-150x150.png","hash":"c7c0831aaa15da89df193bc492749ad4af7fdf54","modified":1410273249000},{"_id":"source/wp-content/uploads/2014/09/152525_0005-300x228.png","hash":"b46893419e9cba0ab58b26c0e717ac9e905ed2fa","modified":1410273250000},{"_id":"source/wp-content/uploads/2014/09/152525_0005.png","hash":"3d534372764934f246d11ac91129d18b1f9b57c6","modified":1410273248000},{"_id":"source/wp-content/uploads/2014/09/152612_0006-150x150.png","hash":"32b9546cfa28213dc6440f6b795e2270a83a0485","modified":1410273254000},{"_id":"source/wp-content/uploads/2014/09/152612_0006-300x228.png","hash":"2325d133b009a1556c09aee539a6fffb82ded49c","modified":1410273255000},{"_id":"source/wp-content/uploads/2014/09/152612_0006.png","hash":"46c1dc72ae67c58328803c6794d7030e0141719c","modified":1410273253000},{"_id":"source/wp-content/uploads/2014/09/152646_0007-150x150.png","hash":"75491944460d84e29bf0ceabffebac5d27beca8d","modified":1410273259000},{"_id":"source/wp-content/uploads/2014/09/152646_0007-300x228.png","hash":"f7e8b8e9c26005d3e1cf9ddbf7f79913e00ba7ce","modified":1410273260000},{"_id":"source/wp-content/uploads/2014/09/152646_0007.png","hash":"d80ddd84a7df0379d11b4dc07b14fe50b36d6811","modified":1410273258000},{"_id":"source/wp-content/uploads/2014/09/152750_0008-150x150.png","hash":"44ff7ce4e54315dfbb402dd289d88f05fb3836d6","modified":1410273264000},{"_id":"source/wp-content/uploads/2014/09/152750_0008-300x212.png","hash":"a41c0bf04a82bce5848df8d8402a81e42577d28e","modified":1410273265000},{"_id":"source/wp-content/uploads/2014/09/152750_0008.png","hash":"f9931c55258c07463bcd662cc9f89c30da64568e","modified":1410273263000},{"_id":"source/wp-content/uploads/2014/09/153833_0010-150x150.png","hash":"d8dd461fc6087308c954d7e3d30fcf97e65cfb9e","modified":1410273269000},{"_id":"source/wp-content/uploads/2014/09/153833_0010-300x240.png","hash":"5d4629738d7a2f25d505437518fd538367cca386","modified":1410273270000},{"_id":"source/wp-content/uploads/2014/09/153833_0010.png","hash":"aea6bb135b2acd20266299b01963a168de1baad3","modified":1410273268000},{"_id":"source/wp-content/uploads/2014/09/154444_0011-150x93.png","hash":"c46eddc315aa854296164409a9f941b6a6c18c98","modified":1410273273000},{"_id":"source/wp-content/uploads/2014/09/154444_0011-300x68.png","hash":"4b62beff0ed0753f969ce0f356aeb3fe52a3bc4b","modified":1410273273000},{"_id":"source/wp-content/uploads/2014/09/154444_0011.png","hash":"a7fabc70b68d8ca0ea6c8a94e33b8dba481b935e","modified":1410273272000},{"_id":"source/wp-content/uploads/2014/09/154502_0012-150x150.png","hash":"2cb02d3aa88b01ddf3a163ca44d1c9e9a8b4dcac","modified":1410273276000},{"_id":"source/wp-content/uploads/2014/09/154502_0012-300x117.png","hash":"8e13ba026408b8dd34bc207a32b42d6b4738fd2c","modified":1410273278000},{"_id":"source/wp-content/uploads/2014/09/154502_0012.png","hash":"6b28d6cf94ae3387a3a2da3047bf9d3c0314204d","modified":1410273276000},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-buttons.css","hash":"6394c48092085788a8c0ef72670b0652006231a1","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-buttons.js","hash":"4c9c395d705d22af7da06870d18f434e2a2eeaf9","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-media.js","hash":"e14c32cc6823b81b2f758512f13ed8eb9ef2b454","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"b88b589f5f1aa1b3d87cc7eef34c281ff749b1ae","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"83cdfea43632b613771691a11f56f99d85fb6dbd","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/css/font-awesome.min.css","hash":"4c2c5f5f6cc86d775a44b944661e038b7be98149","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.woff2","hash":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/images/preloader.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/scrollLoading/images/preloader@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcSo_WB_cotcEMUw1LsIE8mM.woff2","hash":"6d17eac7fcc2866f10d1f2725a08ab749a6e978d","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcZSnX671uNZIV63UdXh3Mg0.woff2","hash":"78029561e4c2ec565ea11c3f5bbd052b018af8a6","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr4-67659ICLY8bMrYhtePPA.woff2","hash":"4e5557954ec161edc03b6f971ddefee6179c1305","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr46gJz9aNFrmnwBdd69aqzY.woff2","hash":"1454a4753468b607c23deac9f5438cd0ed5cb35d","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr9INifKjd1RJ3NxxEi9Cy2w.woff2","hash":"1758c64c8acec4497735ccb5336b1a518d24024c","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr_SNRT0fZ5CX-AqRkMYgJJo.woff2","hash":"e2e2993940fc54ed41f26e39257fdbd824c05e81","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/webfont/1.6.16/webfont.load.js","hash":"3fcca46a1030b74fd1d387b7fae196173a1beb7a","modified":1465884444247},{"_id":"source/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png","hash":"fbe7fcbcd63820eed1c590073974e8cb326d57c6","modified":1382010083000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/FontAwesome.otf","hash":"0112e96f327d413938d37c1693806f468ffdbace","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.eot","hash":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.woff","hash":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/jquery/2.0.3/jquery.min.js","hash":"745ab5d6e434cf8d321779da3c527b6d301e2b50","modified":1463520662000},{"_id":"source/wp-content/uploads/2011/04/teknoglot.wordpress.2011-04-27.xml_.txt","hash":"61dfee3122af6aca05c2681a8e2dd29c582f5451","modified":1381920836000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.ttf","hash":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1463520662000},{"_id":"themes/tg-hueman/source/vendor/font-awesome/fonts/fontawesome-webfont.svg","hash":"f346b8b3df147e4059e1a7d66c52c9a6e1cec3e8","modified":1463520662000},{"_id":"public/rss.xml","hash":"4a4e88b97ddf68dbf3cbcbc5823879adeb382deb","modified":1467752469607},{"_id":"public/post-sitemap.xml","hash":"3c811c4008fafc17854775126a3573e1507b8262","modified":1467752469609},{"_id":"public/page-sitemap.xml","hash":"352bd6bd2628a84360f205de650e957fef95abc2","modified":1467752469671},{"_id":"public/category-sitemap.xml","hash":"33c4b87b4982236612426f0f8b5a2ee904b8087a","modified":1467752479367},{"_id":"public/tag-sitemap.xml","hash":"ea8ed4689f8c512836f9335398509254d6cfce5b","modified":1467752479368},{"_id":"public/sitemap.xsl","hash":"1240a5e3a9ed1e1f6467ef64319cb09b6680f5f3","modified":1467752479438},{"_id":"public/sitemap.xml","hash":"5f3665c5ad75b0c849eb2bfbaec8b8ae6a254560","modified":1467752479438},{"_id":"public/content.json","hash":"d9d791f840e5d626e1ef600d8e6c58369f6dd446","modified":1467752479438},{"_id":"public/About/index.html","hash":"1384c7142003e182c70b525734a9166253e4f58e","modified":1467752479483},{"_id":"public/ms/opsmgr2012/PoSH-Grid-Dashboard-for-RDSH/index.html","hash":"5b40e64116acab5669fe526e9e642089533c5637","modified":1467752479483},{"_id":"public/tb/in-transit-again/index.html","hash":"01bb5846524165c5b92f22f7200225d9e77a809a","modified":1467752479762},{"_id":"public/ms/opsmgr2012/Event-Id-4001-–-“Cannot-Add-Type”-in-SQL-MP-6-6-4-0-for-OpsMgr2012/index.html","hash":"60a42a1ca6701c08f7e1ee5f415c20309b2ec63d","modified":1467752479762},{"_id":"public/ms/opsmgr2012/opsmgr-2012-r2-ur4-field-notes/index.html","hash":"9f6b120cf96946f73b8eab98b3e7f22a9643f1af","modified":1467752479762},{"_id":"public/ms/opsmgr2012/squaredup-installation/index.html","hash":"a1e1f0c335bc2750bbf7dc98a48cb2311e6d10c6","modified":1467752479765},{"_id":"public/ms/opsmgr2012/opsmgr2012r2ur3-field-notes/index.html","hash":"a1f502365515d02e3dcd47eb2ee39aeba800ff91","modified":1467752479765},{"_id":"public/mikrotik/cloudflare-dynamic-dns-mikrotik/index.html","hash":"ad4e081d1519bf658fe0389508f91a8c5f0fc702","modified":1467752479765},{"_id":"public/ms/opsmgr2007/quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring/index.html","hash":"6ead0b875ff90e5f7db10540882e5c60f1b59a4f","modified":1467752479765},{"_id":"public/ms/opsmgr2012/opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell/index.html","hash":"2513f84fdb3231b393bbaf44088847f8df428e3c","modified":1467752479766},{"_id":"public/ms/opsmgr2012/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/index.html","hash":"80d253b1981f0fb0c20f8130968bc0c128c91f8a","modified":1467752479766},{"_id":"public/tb/menu-problems/index.html","hash":"9d60ce648751cfbc4ce7835033a877312c7a983e","modified":1467752479766},{"_id":"public/ms/opsmgr2012/opsmgr-2012-agent-gateway-failover-the-basics/index.html","hash":"b004f60bf799b0727e6864b6b9f8c4741f518c13","modified":1467752479766},{"_id":"public/ms/opsmgr2012/load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb/index.html","hash":"2142ca60c9aeb328ee6f25b9178082e4871d1857","modified":1467752479766},{"_id":"public/code/posh/quick-hack-send-sms-through-powershell-powershell/index.html","hash":"549ad6a8d6f925cb4a1b169929d244f9047fd472","modified":1467752479766},{"_id":"public/tb/rant-the-concept-of-booth-babes/index.html","hash":"3c356f30c1385b14c3a3faa91d09cb7f38b9deb9","modified":1467752479766},{"_id":"public/ms/opsmgr2007/parameter-replacement-in-alertname/index.html","hash":"0eb1241a5ecc4f2840a11437a7bd2da4aac94588","modified":1467752479766},{"_id":"public/Linux/virtual-openvpn-server-at-home/index.html","hash":"32f1a9170567460f9a72eee270761a819e0a3b97","modified":1467752479766},{"_id":"public/ms/opsmgr2007/opsmgr-2007-r2-documentation/index.html","hash":"9c1e061c5bcee992f487eef5ed45949f7d6c186a","modified":1467752479766},{"_id":"public/ms/opsmgr2007/bulk-disable-acs-forwarders-with-wildcards/index.html","hash":"d7230cb0db968341c1f152e05b29a0b23f1fc6fa","modified":1467752479766},{"_id":"public/ms/opsmgr2007/opsmgr-2007-connectivity-map/index.html","hash":"03e6f49ee92ffe01b686fe54713af153d7b64c66","modified":1467752479767},{"_id":"public/ms/opsmgr2012/introduction-to-tg-winautosvc-v1/index.html","hash":"e49ffa1c7d521997f5e7b1374f7198bc28ce27ed","modified":1467752479767},{"_id":"public/tb/server-problems-fixed-hopefully/index.html","hash":"6c79c1b41329696a6ee3d5028eff3cbc213e9de3","modified":1467752479767},{"_id":"public/tb/sluggish-performance-on-teknoglot/index.html","hash":"bef069aab5dadf62c3bf3f12c05b490727437a7b","modified":1467752479768},{"_id":"public/tb/move-complete-welcome-to-teknoglot-se/index.html","hash":"477f39862831e558b5ba37d2e2ba8e86918d2671","modified":1467752479768},{"_id":"public/tb/im-moving-finally/index.html","hash":"ac53888344fbc475164f5e2481998581b957c299","modified":1467752479768},{"_id":"public/ms/opsmgr2007/snmp-get-errors-in-eventlog/index.html","hash":"4233d57fdbba5ed30fdae0c1075cc6cfff21f4a0","modified":1467752479768},{"_id":"public/Linux/rhes/install-linuxis21-rhes5/index.html","hash":"7f0e85d0396246ef1d2ca8b3531110ddc285c59e","modified":1467752479768},{"_id":"public/ms/opsmgr2007/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally/index.html","hash":"031717a154236f8739adf2a828bdcfaec311001c","modified":1467752479768},{"_id":"public/ms/opsmgr2007/change-gateway-powershell-script/index.html","hash":"5e00936331abd301f62cd0261baa7b1eddbed4b0","modified":1467752479768},{"_id":"public/ms/opsmgr2007/esent-error-when-modifying-opsmgr-agent/index.html","hash":"ad1cf0add711469ca5b01c653f35329a8845960f","modified":1467752479768},{"_id":"public/ms/opsmgr2007/updated-msmq-management-pack/index.html","hash":"1c582741852ea4d6e38dbfee7a72c7ea0cf65025","modified":1467752479768},{"_id":"public/Linux/sles/linux-discovery-not-enough-entropy/index.html","hash":"60b6974d245280e253cdba083a68d19bed36f999","modified":1467752479768},{"_id":"public/ms/sql/regain-sysadmin-access-to-sql2005-or-sql2008/index.html","hash":"7cdaa1bc0a638c7fecc01a9325dd622e00c561d9","modified":1467752479768},{"_id":"public/ms/opsmgr2007/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64/index.html","hash":"59b7409780e46e83b7874d02a04561d8e174d148","modified":1467752479768},{"_id":"public/ms/sql/installing-sql-reporting-services-2005-on-windows-2008-x64/index.html","hash":"dd6d0a8d18c2aa9b9955385213ed69472ec1c95b","modified":1467752479768},{"_id":"public/ms/windows/cannot-delete-files-with-long-paths/index.html","hash":"7125fc747bb7318d5f74c5c165285861f70d6d80","modified":1467752479768},{"_id":"public/ms/opsmgr2007/microsoft-adds-support-for-suse-11-in-opsmgr-r2/index.html","hash":"5d47f06cf8727640428c697b347a541951f5123c","modified":1467752479768},{"_id":"public/ms/opsmgr2007/health-rollup-not-working-in-exchange-management-pack/index.html","hash":"a6c60f335de4a42610ba537a75ad65af3918479b","modified":1467752479768},{"_id":"public/ms/opsmgr2007/updated-operations-manager-2007-r2-management-pack/index.html","hash":"4eb44fcdeb7e95954aff7d9e115bef3db909f54c","modified":1467752479768},{"_id":"public/ms/opsmgr2007/sql-managementpack-survey-make-your-voice-heard/index.html","hash":"87693326a3caca2fb834f1425f05f2e2cc957ce4","modified":1467752479768},{"_id":"public/ms/opsmgr2007/replacechange-a-gateway-server/index.html","hash":"58958ff306479f7c142d27ee16b97a56e9d28b24","modified":1467752479769},{"_id":"public/Linux/my-impression-of-ext4-wth/index.html","hash":"fffe43d0ddacbde16cc5eff28f00140da68057b8","modified":1467752479769},{"_id":"public/ms/opsmgr2007/tcp-port-check-use-with-caution/index.html","hash":"53d16ed2c0e19b6205f9c1dc7c46e0f2a9ca350d","modified":1467752479769},{"_id":"public/ms/sql/whynotusesqlexpress-itsforfree/index.html","hash":"fa4dc5d78afae9d030acc1e1b468890355305fd6","modified":1467752479769},{"_id":"public/ms/opsmgr2007/msmq-mp-subscriptoutofrange/index.html","hash":"7a3e48c964ab987af1c6ddac54ce4bd89f5b81b8","modified":1467752479769},{"_id":"public/ms/opsmgr2007/windows-server-2008-nlb-m-for-opsmgr-released/index.html","hash":"c8054e8f824e9517761b9266128c33408380175b","modified":1467752479769},{"_id":"public/ms/opsmgr2007/msmq-3-mp-for-opsmgr-v6065870-released/index.html","hash":"bc1ea3d2ad9e2bc024520169ca94e6207b2bc458","modified":1467752479769},{"_id":"public/ms/opsmgr2007/networkadaptercheck-fails-on-win2k/index.html","hash":"e4cf671cd4108edbcb5506cd538b83e04a22805a","modified":1467752479769},{"_id":"public/ms/opsmgr2007/clearing-disabled-discovery/index.html","hash":"a4f7dddd26e8b9e94c3834e09ece76bfc4037472","modified":1467752479769},{"_id":"public/tb/lets-split/index.html","hash":"b3da88eb457fe98b70f9116f5d224fa9b44275d5","modified":1467752479769},{"_id":"public/Linux/ubuntu/nvidia-problems-in-ubuntu-810/index.html","hash":"bb6d3d9635fc5ca6085c96562c6aa1246cfa6da0","modified":1467752479769},{"_id":"public/tb/quest-software-acquires-exc-and-vizioncore/index.html","hash":"a786aed78ac4eca54581e7e51864618429b6cc59","modified":1467752479769},{"_id":"public/ms/winvista/intel-drivers-causes-old-school-freezes-on-windows-vista/index.html","hash":"d8bd80d44daccb0c3442847cd648a717656527ad","modified":1467752479769},{"_id":"public/code/vbs/w3socket-in-vbscript/index.html","hash":"ee98dad4c3b696fee110b860926844c2992513d5","modified":1467752479770},{"_id":"public/ms/windows/winxp/silly-hibernation-doo-doo-on-winxp/index.html","hash":"70d31e2d7fdf55118917f73a7b7507daec5c2139","modified":1467752479770},{"_id":"public/topics/code/index.html","hash":"254bee199695e7746170f49a96c01b0bfe8b2a51","modified":1467752479770},{"_id":"public/topics/ms/index.html","hash":"cd4e7fe8516752332e2b396ba2e44c5706f311e1","modified":1467752479770},{"_id":"public/topics/ms/page/2/index.html","hash":"31545f40042f2cbc5510781d12221c47f956a831","modified":1467752479770},{"_id":"public/topics/ms/page/3/index.html","hash":"9f0182bdeba0cf23bfee695286fef6dfd7ddc4bc","modified":1467752479770},{"_id":"public/topics/ms/page/4/index.html","hash":"748d1ad477309cb01da974828764a1250bafaa8d","modified":1467752479770},{"_id":"public/topics/code/vbs/index.html","hash":"d7902cfa0950f098cd532e1bec3c0e30dcf7d541","modified":1467752479770},{"_id":"public/topics/ms/opsmgr2007/index.html","hash":"a716620180d59f88da5a05b62de790daf0a5e5ca","modified":1467752479770},{"_id":"public/topics/ms/opsmgr2007/page/2/index.html","hash":"ebb34f12e73fbd59d455eff973d4f257b83395b3","modified":1467752479770},{"_id":"public/topics/ms/opsmgr2007/page/3/index.html","hash":"d66d7194f5e44e96e25e3969923a0cec1021fd4f","modified":1467752479770},{"_id":"public/topics/ms/opsmgr2012/index.html","hash":"f01db802df803717df0cf9a0008a46f992f36621","modified":1467752479770},{"_id":"public/topics/mikrotik/index.html","hash":"737f92189585a478f20e55010152763b97979c1b","modified":1467752479770},{"_id":"public/topics/tb/index.html","hash":"cadf1500c782018c448aedfcfe081ae3be83de79","modified":1467752479771},{"_id":"public/topics/Linux/index.html","hash":"16cfd983639fb34f78866140210dde9847a9f01a","modified":1467752479771},{"_id":"public/topics/ms/sql/index.html","hash":"77def7517f0c691da82c840decc9389ca537c032","modified":1467752479771},{"_id":"public/topics/ms/windows/index.html","hash":"3bbed4a90aa294ed3baabc8af76d1c47153d4f59","modified":1467752479771},{"_id":"public/topics/ms/winvista/index.html","hash":"66c8e71283e5f48c5dce0d207e0fe59614de5808","modified":1467752479771},{"_id":"public/topics/Linux/rhes/index.html","hash":"2feb8f9f2afd4ef23054384430707e867682fc9b","modified":1467752479771},{"_id":"public/topics/code/posh/index.html","hash":"bac70e406032518cfc0da47053c43466883644a7","modified":1467752479771},{"_id":"public/topics/ms/windows/winxp/index.html","hash":"5cc68b7caf50ca8951e4a5a7aa35ef5dc7318015","modified":1467752479771},{"_id":"public/topics/Linux/sles/index.html","hash":"fb0188b2aa225cfbef1ad15c899787176ffdfadc","modified":1467752479771},{"_id":"public/topics/Linux/ubuntu/index.html","hash":"78341956dd73f20cb1137742995b171b15e90ce3","modified":1467752479771},{"_id":"public/archives/index.html","hash":"e39ebd1230ad913824671ab3077247081a179302","modified":1467752479771},{"_id":"public/archives/page/2/index.html","hash":"4cac06d1174e55d0a2e5764a89ba3b1b72d3a016","modified":1467752479772},{"_id":"public/archives/page/3/index.html","hash":"b5f37737c68c93b19b8f8730c718b5afcf141009","modified":1467752479772},{"_id":"public/archives/page/4/index.html","hash":"5b1e98780afe3fea0729e04fd389756b220941ff","modified":1467752479772},{"_id":"public/archives/page/5/index.html","hash":"d6d613413e7140b6255252a306652547387d722c","modified":1467752479772},{"_id":"public/archives/page/6/index.html","hash":"f3dea08bbb5e706859ba1d9042d7488340fdb07d","modified":1467752479772},{"_id":"public/archives/2006/index.html","hash":"015989210bfdb724e8ee5ac8a6ef124ffb9ed976","modified":1467752479772},{"_id":"public/archives/2006/12/index.html","hash":"3d307339860ecf844462d87c2b3970c4ac7961d7","modified":1467752479772},{"_id":"public/archives/2007/index.html","hash":"b932107077a83c67ba7ae8a0d9cb64a72b0b2261","modified":1467752479772},{"_id":"public/archives/2007/04/index.html","hash":"318232357122c5aa4209065e495b825901931cc8","modified":1467752479772},{"_id":"public/archives/2007/12/index.html","hash":"bfc43adbd0af3fd88f0ef7caf1c2932a7c53d407","modified":1467752479772},{"_id":"public/archives/2008/index.html","hash":"38f83243a4ce312fc16612e629570a2e2d822b7c","modified":1467752479772},{"_id":"public/archives/2008/01/index.html","hash":"5f86717e708393eae7b083e3b79358aa0c26a753","modified":1467752479772},{"_id":"public/archives/2008/11/index.html","hash":"5c26c3831415d3f2dd061364a9fb014e258a51e0","modified":1467752479773},{"_id":"public/archives/2009/index.html","hash":"79bc917c9e8faa4b65c0c0671869d90397a18077","modified":1467752479773},{"_id":"public/archives/2009/page/2/index.html","hash":"d59682354686b3b730234049b14ee7c71961b886","modified":1467752479773},{"_id":"public/archives/2009/04/index.html","hash":"d7bcf7c5c44a3d5d1c506e9f1dbf00ac150f04af","modified":1467752479773},{"_id":"public/archives/2009/06/index.html","hash":"1b1fcccf3dfae2feacd306082ce29a2c3adee83a","modified":1467752479773},{"_id":"public/archives/2009/08/index.html","hash":"60672180c9bb55a8123465b61b761a1b2e8f6fbd","modified":1467752479773},{"_id":"public/archives/2009/09/index.html","hash":"8828a25b30d8b7e35f7c66b936f54607176b3556","modified":1467752479773},{"_id":"public/archives/2009/10/index.html","hash":"68abfd6b0b6165d9b2466eab0617d3afd37ef2d9","modified":1467752479773},{"_id":"public/archives/2009/11/index.html","hash":"d6f1944540b88434d2ac7271e8ba2209a0286213","modified":1467752479773},{"_id":"public/archives/2009/12/index.html","hash":"7ea68f465150e336fbcd1c4c10da81288af99a6c","modified":1467752479773},{"_id":"public/archives/2010/index.html","hash":"842e2aa69907f31c88b911200ad85c4e5d58a278","modified":1467752479773},{"_id":"public/archives/2010/03/index.html","hash":"c402a5354092d474dcd0d0f32cc351abcf4bb30b","modified":1467752479773},{"_id":"public/archives/2010/04/index.html","hash":"9f05df93bae8644646fbc28d475c3414dccd8b54","modified":1467752479774},{"_id":"public/archives/2010/08/index.html","hash":"71644e530f359667f6473086a0cef3ff7bffaff2","modified":1467752479774},{"_id":"public/archives/2010/09/index.html","hash":"e880bdcec300d3e13b79d6327c9b0b51cef8de6f","modified":1467752479774},{"_id":"public/archives/2011/index.html","hash":"2d88a622f4eadba03239661f892fbbe96f3fb7c5","modified":1467752479774},{"_id":"public/archives/2011/02/index.html","hash":"822cab14e8e9ced8d3941119917c324a689f1f8b","modified":1467752479774},{"_id":"public/archives/2011/04/index.html","hash":"bf8b2b4ff3f0318dc21ea6ad9130d3c4d574bf36","modified":1467752479774},{"_id":"public/archives/2011/05/index.html","hash":"bfd7eeb37d7344c2b3f96f2210a3deabc10f0f36","modified":1467752479774},{"_id":"public/archives/2011/07/index.html","hash":"02a832d4f2ea7e74b6b567968259f556963ccfb7","modified":1467752479774},{"_id":"public/archives/2011/08/index.html","hash":"7defdfe0f11de963191036d3f0f7c285c7e72783","modified":1467752479774},{"_id":"public/archives/2011/09/index.html","hash":"bc3035f87480821c6e0c94bee3db3293f0ec00e5","modified":1467752479774},{"_id":"public/archives/2012/index.html","hash":"268d2a3bc533700c3933e1c985640ca113fb39dd","modified":1467752479774},{"_id":"public/archives/2012/04/index.html","hash":"e1f5a92ca65b7b97421a9f18c979500cb8a54e6f","modified":1467752479774},{"_id":"public/archives/2012/05/index.html","hash":"4684a116d0e39b896c6d56b230f4b2c79ca58fc2","modified":1467752479775},{"_id":"public/archives/2012/06/index.html","hash":"51f5c6005261cb32fa87f52ba9f5f71665647567","modified":1467752479775},{"_id":"public/archives/2013/index.html","hash":"160b9b63faf184eddc74fe756e906e3067ca3934","modified":1467752479775},{"_id":"public/archives/2013/02/index.html","hash":"ebf826187cc3df85339889075366d3019f7402dd","modified":1467752479775},{"_id":"public/archives/2014/index.html","hash":"cc491af466e79ec923a820881814278711d22d8f","modified":1467752479775},{"_id":"public/archives/2014/08/index.html","hash":"54bae1bcf95a9eb9039a2699f1cf01df7f77279b","modified":1467752479775},{"_id":"public/archives/2014/09/index.html","hash":"e20d6ee0854f6d4c77175489ddd1c64278cd4773","modified":1467752479775},{"_id":"public/archives/2014/10/index.html","hash":"c5672b07e33554b15046ff5991a75ecf2ad0ff8f","modified":1467752479775},{"_id":"public/archives/2016/index.html","hash":"f2a3d932a6301727d7c46499bea26f087704ab85","modified":1467752479775},{"_id":"public/archives/2016/02/index.html","hash":"1098a8f9b92d49affdf2b2050a5d3adae825403f","modified":1467752479775},{"_id":"public/archives/2016/06/index.html","hash":"7b42945a2c654d458fe47b66a643b7859a23e700","modified":1467752479775},{"_id":"public/index.html","hash":"f9469d7ff4340c1294701f8299106700ada17a20","modified":1467752479776},{"_id":"public/page/2/index.html","hash":"222506fbd67156ed16873c221dfabefe0475fe3d","modified":1467752479776},{"_id":"public/page/3/index.html","hash":"afbaacdfbe6878bcce00cf8fba81756395b1dd61","modified":1467752479777},{"_id":"public/page/4/index.html","hash":"7dbc024252cc371ab14412a511152af6234266cc","modified":1467752479777},{"_id":"public/page/5/index.html","hash":"dbb776c24c47e7fdc63c74004ac788bb454f745d","modified":1467752479777},{"_id":"public/page/6/index.html","hash":"8fa4df10f3816806889ececccd4e944e2012f937","modified":1467752479777},{"_id":"public/tag/Powershell/index.html","hash":"bbbc16c855f42e53328c7555781bb3b6277345e7","modified":1467752479777},{"_id":"public/tag/OpsMgr-2012-R2/index.html","hash":"5b79680e6719c1b35b0c217ef0f3fd3e6814e1f7","modified":1467752479777},{"_id":"public/tag/HowTo/index.html","hash":"ba7cb3404bba259fe9c5da57838952c0817e6ffd","modified":1467752479777},{"_id":"public/tag/ACS/index.html","hash":"82ec18effc64f97b8cb1921d9df062ae48a11276","modified":1467752479777},{"_id":"public/tag/OpsMgr/index.html","hash":"4915954faed069c1dc1c06beaf272ecffb1b5bca","modified":1467752479777},{"_id":"public/tag/OpsMgr/page/2/index.html","hash":"80ad67a7e058e16cffa29d427f57d85f0ab15474","modified":1467752479777},{"_id":"public/tag/OpsMgr/page/3/index.html","hash":"1b37d0aed50a5a6012a5ecc6809ca35d7ad14d18","modified":1467752479778},{"_id":"public/tag/PoSH/index.html","hash":"ccd5c4ed2c1eb0308728b3249c441b85abc9f5a0","modified":1467752479778},{"_id":"public/tag/Script/index.html","hash":"fd51ee43e8bb54849bf3a3058a2cb1ae882c975a","modified":1467752479778},{"_id":"public/tag/Errors/index.html","hash":"3f08cbc7675796dfde9b4227e5dcaefd091b61c8","modified":1467752479778},{"_id":"public/tag/KB/index.html","hash":"a477ee9ccd0112f8baeb98fb52c274ac1b3dbdbf","modified":1467752479778},{"_id":"public/tag/Windows/index.html","hash":"ee3c3ab359a478346d14ed4124acd63d3cb78862","modified":1467752479778},{"_id":"public/tag/Windows-2008/index.html","hash":"74831d4518ae273b3bc0139d07ed7d7d63638d9e","modified":1467752479778},{"_id":"public/tag/Windows-Vista/index.html","hash":"d3c1ca789500368f96f2ba66b51b7303b57ec228","modified":1467752479778},{"_id":"public/tag/Windows-XP/index.html","hash":"3dbbb5fc727e84185d5691a13f3465565394b079","modified":1467752479778},{"_id":"public/tag/How-To/index.html","hash":"f0f7fdb8cd7c71709b29741abd7c080dce15b063","modified":1467752479778},{"_id":"public/tag/DNS/index.html","hash":"7f754222bae1e4d20633cf8493f07bec5009e955","modified":1467752479778},{"_id":"public/tag/Invoke-RestMethod/index.html","hash":"aa08b400d8ce9064e01e22b67203ba1ec4d3f5fe","modified":1467752479778},{"_id":"public/tag/Mikrotik/index.html","hash":"6c18cae08b9c775f54b604c11e2f4a8025190035","modified":1467752479778},{"_id":"public/tag/RouterOS/index.html","hash":"806146375249737b649882014bef1a41c37f24da","modified":1467752479779},{"_id":"public/tag/Windows-Installer/index.html","hash":"dde3b7bfd65a769e2e5a610ffac98986b9c20d00","modified":1467752479779},{"_id":"public/tag/WMI/index.html","hash":"c8927a3a8f8fc38f0cc1cd3b16b90eaba4fb3195","modified":1467752479779},{"_id":"public/tag/Exchange/index.html","hash":"f280ce8cce8c17da51d6d21e99aef9fb5abd6085","modified":1467752479779},{"_id":"public/tag/Management-Pack/index.html","hash":"aea3e0c375adbeb553fe1e40a2a936cf5efcb52d","modified":1467752479779},{"_id":"public/tag/Management-Pack/page/2/index.html","hash":"2b6cbc4cedb907fe7bbcb08e4eb5773772b3dcc3","modified":1467752479779},{"_id":"public/tag/TechNet/index.html","hash":"24a316c82c0c6bbfb4eb2462a725cb38e9c3ddf4","modified":1467752479779},{"_id":"public/tag/Teknoglot/index.html","hash":"be94be4884d2533637c86bfe86e2e65f1d873b5a","modified":1467752479779},{"_id":"public/tag/Hexo/index.html","hash":"04c3be961548a306863397dec349487c04d00cfa","modified":1467752479779},{"_id":"public/tag/Wordpress/index.html","hash":"92a8e8e2ab77b9d6391017db9f6a7f2dd4d3a3a1","modified":1467752479779},{"_id":"public/tag/Hyper-V/index.html","hash":"ed25fae56cc053ddb75dc40efeea270afaa9cd40","modified":1467752479779},{"_id":"public/tag/Linux/index.html","hash":"0f8eb4bebe8904fea64062bbd029a9832dc0348d","modified":1467752479779},{"_id":"public/tag/RedHat/index.html","hash":"0d34f2cfbfcb5e7ebc5343e6ef94f55479fa843c","modified":1467752479780},{"_id":"public/tag/RHES5/index.html","hash":"47eeeadb97b5e83e8bc14a1723b4b98408148f54","modified":1467752479780},{"_id":"public/tag/IIS7/index.html","hash":"c065a3a5af2d44ada8b2b95bd7dcee2b7a0a42fb","modified":1467752479780},{"_id":"public/tag/Reporting-Services/index.html","hash":"ece947b0824b963ade4c4e8a26fdfbc281a7305c","modified":1467752479780},{"_id":"public/tag/x64/index.html","hash":"6473d4b912dc5fa85f0cb0257ff823b0eb984e51","modified":1467752479780},{"_id":"public/tag/OpsMgr-2007/index.html","hash":"9b933e7e5fe910bb7757b7cf5a55788bbd59a64f","modified":1467752479780},{"_id":"public/tag/Drivers/index.html","hash":"286334e2d69ab6c8a772e7f405071516586200ed","modified":1467752479780},{"_id":"public/tag/MP-Development/index.html","hash":"1772e7399f486d8370acf928753b73237ef4695e","modified":1467752479780},{"_id":"public/tag/TroubleShooting/index.html","hash":"6d4c4838ad9624e13064371f5ccf99a1d068f987","modified":1467752479780},{"_id":"public/tag/X-Plat/index.html","hash":"9d41db87db64f08e1df5eaeb965558945443317e","modified":1467752479780},{"_id":"public/tag/Highly-Available/index.html","hash":"9c2d0fd4785d9cc830f767a45cf4b60fab713dd1","modified":1467752479780},{"_id":"public/tag/NLB/index.html","hash":"2fff403df00079b83e4a00dab889449906aa9e75","modified":1467752479780},{"_id":"public/tag/Tutorial/index.html","hash":"f4ba0dbdd78d7d33ca7ff33ee8125832f3816b61","modified":1467752479781},{"_id":"public/tag/SUSE-11/index.html","hash":"158f0423872d909726e3ab6d7dd6ff6fbfbd7a3e","modified":1467752479781},{"_id":"public/tag/MSMQ/index.html","hash":"448a4c9f3b27b753a9d463a476f33ed68e5c0152","modified":1467752479781},{"_id":"public/tag/Fixed/index.html","hash":"d8f2d70e92a1975296c55d3aa0d11b912df05149","modified":1467752479781},{"_id":"public/tag/Quick-fix/index.html","hash":"26efebcb7ed7e62938276fd8eabe8a58033f7565","modified":1467752479781},{"_id":"public/tag/Rant/index.html","hash":"a218fc6de876240ad6d358eb5c51bab201806186","modified":1467752479781},{"_id":"public/tag/NVidia/index.html","hash":"8dc68053233ee03dfb3177418abc02fefd25037e","modified":1467752479781},{"_id":"public/tag/Quick-Reference/index.html","hash":"e774319afeead2c4f3627c08ee41c7c64f134549","modified":1467752479781},{"_id":"public/tag/Sillyness/index.html","hash":"327b9cb84bab894a45e063e12060a1fc0d5ed09e","modified":1467752479781},{"_id":"public/tag/Teach-a-Man-to-Fish/index.html","hash":"962ef931e6772440896713f9c3f0478df7eab919","modified":1467752479781},{"_id":"public/tag/Fail-over/index.html","hash":"75f86ada47085ad60dc53b5f1c57013fcdd78438","modified":1467752479781},{"_id":"public/tag/Scripts/index.html","hash":"5ef02ac4a5f068a14cf0bf1aadcbf3c59ebd2acf","modified":1467752479781},{"_id":"public/tag/Field-Notes/index.html","hash":"fd4bebfbd449e78d7cc958384ade8a20d4740a2a","modified":1467752479782},{"_id":"public/tag/Update-Rollup/index.html","hash":"615c0ea6c89841cb502ec6df575096caa7e9071b","modified":1467752479782},{"_id":"public/tag/Video/index.html","hash":"884f7bfffd6d07f1b7bd446054a533e6792640b5","modified":1467752479782},{"_id":"public/tag/GSM/index.html","hash":"f623b1b73b29ed3a557de05f74c112d6bea9bc5e","modified":1467752479782},{"_id":"public/tag/Quick-hack/index.html","hash":"b8dc7a8002ccc3d416a7ca054a1b6dd6ffb5411e","modified":1467752479782},{"_id":"public/tag/SMS/index.html","hash":"17d9ef73ef24c588f559d70b7d5712b59e62a309","modified":1467752479782},{"_id":"public/tag/Conference/index.html","hash":"e1c20571d292dbb018da61a072a60bd49d0fcd07","modified":1467752479782},{"_id":"public/tag/SQL-Server/index.html","hash":"62e552b69e2da95d76b5aaf4b1f6ce1043ae7d01","modified":1467752479782},{"_id":"public/tag/SQL-Server-2005/index.html","hash":"42d554ccca7399b1b0a952912afa67fd5337261d","modified":1467752479782},{"_id":"public/tag/SQL-Server-2008/index.html","hash":"ccb366d78a925c7dddf402020bf2be463a74b20b","modified":1467752479782},{"_id":"public/tag/SquaredUp/index.html","hash":"ed69fdb10a8ec3366d77887c0498872ba2c1780b","modified":1467752479782},{"_id":"public/tag/Unix/index.html","hash":"e1fea2eba6ee5d90a415624aabd302bea1bd920a","modified":1467752479783},{"_id":"public/tag/OpenVPN/index.html","hash":"d2b8d6d34be5d1d71947c3a1e5d277b24f0a4b12","modified":1467752479783},{"_id":"public/tag/Virtual-Appliance/index.html","hash":"1fa9cf5542fd1b0b97e30e97eafedf9a0f850e34","modified":1467752479783},{"_id":"public/tag/Checklist/index.html","hash":"66efb989b6c94aee65b46d4bfa96ca6c3c2fe50d","modified":1467752479783},{"_id":"public/tag/SQL-Express-2005/index.html","hash":"0a06b190f81d6cd16e84270103e6d2995178f935","modified":1467752479783},{"_id":"public/tag/SQL-Express-2008/index.html","hash":"9f7de7b7f876198d2c0936c64e9c380a0bfabebc","modified":1467752479783},{"_id":"public/code/vbs/Resize-all-images-in-a-Word-document-with-vbs-macro/index.html","hash":"0551d8423f191397884dfa40e92b7c3fd7bed221","modified":1467752479827},{"_id":"public/archives/2016/07/index.html","hash":"9ed271e0d7eeabedfd3cb1ebb78642de3204dbf2","modified":1467752479827},{"_id":"public/tag/VBScript/index.html","hash":"1253e95ed49ce9b0415d209a45b873e39250264e","modified":1467752479827},{"_id":"public/tag/Macro/index.html","hash":"312217157f5891ae3ffda47c9f36737114357c80","modified":1467752479828},{"_id":"public/tag/Word/index.html","hash":"4346863d1cef870451f6831057392b6fb12d7041","modified":1467752479828},{"_id":"public/tag/Office/index.html","hash":"c05242d6fa603b784a78d65361e6ee5bdf18e45e","modified":1467752479828},{"_id":"public/CNAME","hash":"8d702b1e7580d4c696530d7d560a32f819a22249","modified":1467752479852},{"_id":"public/favicon.png","hash":"d567eba1530f23fc4049b3aba328a68c242e091e","modified":1467752479852},{"_id":"public/favicon.ico","hash":"e8189e51434d7f4926a843581e6767d5695a3295","modified":1467752479852},{"_id":"public/css/images/logo-header.png","hash":"fb0a0e52aa354840644b830fad20e8d4de3b8c79","modified":1467752479853},{"_id":"public/css/images/opacity-10.png","hash":"bbc979866c5b50e8adb348419154b28b1ff44d78","modified":1467752479853},{"_id":"public/css/images/logo-header.psd","hash":"a0f925509b1b9d7d41617db5b5643938fade685f","modified":1467752479853},{"_id":"public/css/images/s-left.png","hash":"c8cac4f4e3492606fab93196364bd0f87d93bb98","modified":1467752479853},{"_id":"public/css/images/thumb-default-small.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1467752479853},{"_id":"public/css/images/thumb-default.png","hash":"2d0ba175d958d342494241c616a74d37f48059fb","modified":1467752479853},{"_id":"public/vendor/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1467752479853},{"_id":"public/vendor/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1467752479853},{"_id":"public/vendor/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1467752479853},{"_id":"public/vendor/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1467752479853},{"_id":"public/vendor/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1467752479853},{"_id":"public/vendor/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1467752479853},{"_id":"public/wp-content/uploads/2009/04/avatar-150x150.jpg","hash":"ab418a26a66479fcca11beb912c65a75790aa445","modified":1467752479854},{"_id":"public/wp-content/uploads/2009/04/avatar.jpg","hash":"a61204a931fcbc0b07b40f814d4a0829a36d2f36","modified":1467752479854},{"_id":"public/wp-content/uploads/2009/07/4d89ae6b339483137aa42a1935c11bdb.jpeg","hash":"fb3cf710b690205b6ab9eaf47fd2fa9b0252ef42","modified":1467752479854},{"_id":"public/wp-content/uploads/2009/06/screenshot1245833173-150x26.png","hash":"065fd3b268402b9371911fbf5495226142387077","modified":1467752479854},{"_id":"public/wp-content/uploads/2009/06/screenshot1245833173-300x10.png","hash":"ebb90a19e541bc6d09975a162230eb5771a6c594","modified":1467752479854},{"_id":"public/wp-content/uploads/2009/06/screenshot1245833173.png","hash":"705c83d1382a30744c7e4158801bce5121960c58","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/ChangeGW.zip","hash":"77662af386ae596fa9b4b7936b704e5668a7f3ae","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/image-150x150.png","hash":"2e6c17154ca9a14723c8d0dfee12e0d8507b73ae","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/image-300x140.png","hash":"30da021b8a1bf3dd8056c9b35d37376e2b92ceec","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/image.png","hash":"3010027641396efd61b963dd00bfcaaf2387c9ee","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/image_thumb-150x150.png","hash":"2e6c17154ca9a14723c8d0dfee12e0d8507b73ae","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/image_thumb.png","hash":"3010027641396efd61b963dd00bfcaaf2387c9ee","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/03/image_thumb-300x140.png","hash":"30da021b8a1bf3dd8056c9b35d37376e2b92ceec","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/04/DistributeAgents.zip","hash":"57339af729d1331291096c1c219ca804e65075a1","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/04/DistributeAgents1.zip","hash":"b0e2b9f5c3b632f6f73089f2653ade4025bf3991","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/09/snmp_error_wireshark-150x138.png","hash":"52a24d8608154e74f69a3933096f633bdb3fd8d7","modified":1467752479855},{"_id":"public/wp-content/uploads/2010/09/snmp_error_wireshark-300x66.png","hash":"c5f9913fee529668f310e9e024da6f1d6455a553","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/09/snmp_error_wireshark.png","hash":"45a50df4966b411310239693d829717ba670b1e9","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCPrgb-150x80.png","hash":"0a32beb2928b2da91f19f8fa739ffc3cb28968a5","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCPrgb.png","hash":"e5c38373e7319050cd1d5d9179bcbe334269349e","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCSArgb-150x80.png","hash":"3b39a5363894d20cce5f43195edcad8b91df9a89","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCSArgb.png","hash":"6f04e2c039b0674a45ed431ee6379769fe0cad03","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCSDrgb-150x80.png","hash":"d79a7111b7deedcde0495db049b4e79cdc310b7a","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCSDrgb.png","hash":"7d6229b71359191af9bbbe7aa1aee8590c6766f7","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCTSrgb_537-150x80.png","hash":"c63b1da3d58d5c539039959e4e08a5ff6ac0f316","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCTSrgb_537-300x51.png","hash":"7c7bd3c3aa7e2aaea41d40c006ce2f91ce96942f","modified":1467752479856},{"_id":"public/wp-content/uploads/2010/10/MCTSrgb_537.png","hash":"26f899cdd65c8026e040203e9ca25c1728f045de","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/02/teknoglot_favicon.png","hash":"d567eba1530f23fc4049b3aba328a68c242e091e","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/02/teknoglot_title_banner.png","hash":"b02bdf58ac9779329e2243fcaa3d9cba926c7d58","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/02/teknoglot_title_banner_leftie.png","hash":"57535c304eca5b30da5ea35a1178e127080242a1","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/04/k-services-icon.png","hash":"1317f4e371f0e9897440a505db615e83d96915ad","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/05/SCOM_Connectivity_Map-150x150.png","hash":"9a1e808a4dccf7a9c5c7b47389be55f9a083da5e","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png","hash":"5d7fa86ea627400debddce922b4ce26816b9dcc7","modified":1467752479857},{"_id":"public/wp-content/uploads/2011/07/DisableACSForwarders.zip","hash":"6619dcce4966f8963ad9a12598ae917bde4af259","modified":1467752479857},{"_id":"public/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-150x150.png","hash":"7a8f2ae8a0f18b1ff34739c7845bbd5562aa022a","modified":1467752479857},{"_id":"public/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog-300x259.png","hash":"9ec514b761f5d354192508bc6f8d783dcbb5fec6","modified":1467752479857},{"_id":"public/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png","hash":"c01188e6dcc616fb355ac994491730169516ec96","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL1-150x120.png","hash":"26fa08e5fdbd9b44795f6b17064c0a5c2402916a","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL1.png","hash":"c44cfca9895f654aa4d8adf9ba1b9b6a59d31554","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL2-150x150.png","hash":"3dd8efae865adc8abbdbd95466fbac2852eea5b5","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL2-300x279.png","hash":"e989cd62a1971ed3af779ac7bfd4468b30e2d98c","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL2.png","hash":"28831aad7e9d5b03ead8bee8bd1c999503643f3d","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL3-150x150.png","hash":"60c4aef2941591378376db1c19ee5d98590754e4","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL3-300x279.png","hash":"d125bd9fed61266a890c25bef6d278376f22609f","modified":1467752479858},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL3.png","hash":"32462a6c9a7c5eb229e2d14159165ba808b21c2c","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL4-150x150.png","hash":"197c45bd0769eef0ee60b1d09b2a9233dc663dfb","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL4-300x233.png","hash":"c5372495a1e92e72c0020e165c8f9e0b6f7f4839","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL4.png","hash":"10f81add425dae47090b8dfb5a66b7a7f95d39b2","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL5-150x150.png","hash":"b49536eacf1fec9011790ec5db5f3cd47f44c9f7","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL5-300x279.png","hash":"6aac1cba6e67e3b4a9fea18cd898d16b6ce6a168","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL5.png","hash":"8fe1e5175803723e3849ab53f7afdfca383d7d72","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL6-150x150.png","hash":"31c67b4c33f3b4fb1a91c30bd4da821ac4efb048","modified":1467752479859},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL6-300x279.png","hash":"2758c42401f72ff304f22be1ddca55fb5ba5a2c3","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1007_SettingupNL6.png","hash":"eda5bc1681bd7ac6147ebaa39e08bb888672a2c3","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance1-150x120.png","hash":"26fa08e5fdbd9b44795f6b17064c0a5c2402916a","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png","hash":"c44cfca9895f654aa4d8adf9ba1b9b6a59d31554","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance10-150x150.png","hash":"e8462231a2e411272ecd49b797d029d24b464e17","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance10-300x279.png","hash":"50790bc8a3fcbe37cd9511995124861bfbe95e8c","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png","hash":"ecdf590b1c673afce037215b7b7d4355190335b6","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance11-150x150.png","hash":"b80e33e9c32ad5d653352f3b5798780752372d1f","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance11-300x105.png","hash":"f081b796abcba19bcc0760eaf593dadef92e3471","modified":1467752479860},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png","hash":"5e19610706ebb5ae92476506b25e3f8baec37e15","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance2-150x150.png","hash":"3dd8efae865adc8abbdbd95466fbac2852eea5b5","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance2-300x279.png","hash":"e989cd62a1971ed3af779ac7bfd4468b30e2d98c","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png","hash":"28831aad7e9d5b03ead8bee8bd1c999503643f3d","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance3-150x150.png","hash":"60c4aef2941591378376db1c19ee5d98590754e4","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance3-300x279.png","hash":"d125bd9fed61266a890c25bef6d278376f22609f","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png","hash":"32462a6c9a7c5eb229e2d14159165ba808b21c2c","modified":1467752479861},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance4-150x150.png","hash":"197c45bd0769eef0ee60b1d09b2a9233dc663dfb","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance4-300x233.png","hash":"c5372495a1e92e72c0020e165c8f9e0b6f7f4839","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png","hash":"10f81add425dae47090b8dfb5a66b7a7f95d39b2","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance5-150x150.png","hash":"b49536eacf1fec9011790ec5db5f3cd47f44c9f7","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance5-300x279.png","hash":"6aac1cba6e67e3b4a9fea18cd898d16b6ce6a168","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png","hash":"8fe1e5175803723e3849ab53f7afdfca383d7d72","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance6-150x150.png","hash":"31c67b4c33f3b4fb1a91c30bd4da821ac4efb048","modified":1467752479862},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance6-300x279.png","hash":"2758c42401f72ff304f22be1ddca55fb5ba5a2c3","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png","hash":"eda5bc1681bd7ac6147ebaa39e08bb888672a2c3","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance7-150x150.png","hash":"3f07ed2d5f16e5cb069a090bd1c6dc388c275f69","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance7-300x218.png","hash":"4a07255d2d02ce165dd008ad45a233d1c48ce5e6","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png","hash":"61aa360d374bc3d173bedc81b78465bab13ef5ca","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance8-150x150.png","hash":"1a3ee19e6d92088a582f5342aff3a8a52af10071","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance8-300x279.png","hash":"79f52ec24d446353734c8ebeefe2c1de33383bdb","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png","hash":"97c6a08fd9272ac9896a506da294da2f07c34c38","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance9-150x150.png","hash":"bf88cba944b18c39958f2e195f4bbf9b0e9cccf0","modified":1467752479863},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance9-300x279.png","hash":"b80769c27d6ba9d6a8dfe7a888fadcf1f43b2329","modified":1467752479864},{"_id":"public/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png","hash":"063edda481a34f0a22dbaf691ec2831b329dbe6d","modified":1467752479864},{"_id":"public/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-150x60.png","hash":"841620f35e9c24387e8a23ce5da36448b3b2b16b","modified":1467752479864},{"_id":"public/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1-300x45.png","hash":"453042b5480b647f46b1cd27d90881547734b9d8","modified":1467752479864},{"_id":"public/wp-content/uploads/2012/06/teknoglot_title_banner_leftie1.png","hash":"178369aab28af9bcb1914125d3c94f28e5f221a1","modified":1467752479864},{"_id":"public/wp-content/uploads/2013/04/cream_dust.png","hash":"eef38c387db75e461f07f1c3578942d8907e4f5a","modified":1467752479864},{"_id":"public/wp-content/uploads/2013/04/cream_dust1.png","hash":"eef38c387db75e461f07f1c3578942d8907e4f5a","modified":1467752479864},{"_id":"public/wp-content/uploads/2013/11/teknoglot_title_banner_leftie1.png","hash":"178369aab28af9bcb1914125d3c94f28e5f221a1","modified":1467752479864},{"_id":"public/wp-content/uploads/2014/08/cream_dust1.png","hash":"eef38c387db75e461f07f1c3578942d8907e4f5a","modified":1467752479864},{"_id":"public/wp-content/uploads/2014/08/dark_stripes.png","hash":"eefadc75ba3ffe1faee6a8c6d49c2e244f620d2f","modified":1467752479864},{"_id":"public/wp-content/uploads/2014/08/fabric_plaid-150x150.png","hash":"c7fc644da9e0d05abbd38ffd44259f35b68d7c88","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/08/fabric_plaid.png","hash":"3c7062c930e73e3656b74f7d9cab1e8ca3091036","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152402_0001-150x103.png","hash":"d8d06811de843253eb4a312db272ab71cb6ee90d","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152402_0001.png","hash":"2f087310febd5f5c30c0c9e3e495d4054b4b66bd","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152428_0002-150x150.png","hash":"1e43a4e398acbca69a547ea0e4a6367ef0b8844f","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152428_0002-300x228.png","hash":"9d422658d2fd1550af9794316e4943840a995a9b","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152428_0002.png","hash":"be962612aef6c4ec9f4af90ba55df5d844025ff2","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152447_0003-150x150.png","hash":"f55988a162b0a32b7a863323fbb78ddcde15e905","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152447_0003-300x228.png","hash":"c8ecc8477c83b1a4339c6bab72169f79405cc0f9","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152447_0003.png","hash":"d8e1bc7fe1d1d9580fdbc56ab18715c2ffbc94b7","modified":1467752479865},{"_id":"public/wp-content/uploads/2014/09/152506_0004-150x150.png","hash":"eac0b3842777f583dcbfd001e265887a8bdfe156","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152506_0004-300x228.png","hash":"42f9f9e772fe0730c4f68fa32c9f0cbfa48e86d8","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152506_0004.png","hash":"19e9bfc26154b00bc22c0850fe7e32b9ec72177a","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152525_0005-150x150.png","hash":"c7c0831aaa15da89df193bc492749ad4af7fdf54","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152525_0005-300x228.png","hash":"b46893419e9cba0ab58b26c0e717ac9e905ed2fa","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152525_0005.png","hash":"3d534372764934f246d11ac91129d18b1f9b57c6","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152612_0006-150x150.png","hash":"32b9546cfa28213dc6440f6b795e2270a83a0485","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152612_0006-300x228.png","hash":"2325d133b009a1556c09aee539a6fffb82ded49c","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152612_0006.png","hash":"46c1dc72ae67c58328803c6794d7030e0141719c","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152646_0007-150x150.png","hash":"75491944460d84e29bf0ceabffebac5d27beca8d","modified":1467752479866},{"_id":"public/wp-content/uploads/2014/09/152646_0007-300x228.png","hash":"f7e8b8e9c26005d3e1cf9ddbf7f79913e00ba7ce","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/152646_0007.png","hash":"d80ddd84a7df0379d11b4dc07b14fe50b36d6811","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/152750_0008-150x150.png","hash":"44ff7ce4e54315dfbb402dd289d88f05fb3836d6","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/152750_0008-300x212.png","hash":"a41c0bf04a82bce5848df8d8402a81e42577d28e","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/152750_0008.png","hash":"f9931c55258c07463bcd662cc9f89c30da64568e","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/153833_0010-150x150.png","hash":"d8dd461fc6087308c954d7e3d30fcf97e65cfb9e","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/153833_0010-300x240.png","hash":"5d4629738d7a2f25d505437518fd538367cca386","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/153833_0010.png","hash":"aea6bb135b2acd20266299b01963a168de1baad3","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/154444_0011-150x93.png","hash":"c46eddc315aa854296164409a9f941b6a6c18c98","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/154444_0011-300x68.png","hash":"4b62beff0ed0753f969ce0f356aeb3fe52a3bc4b","modified":1467752479867},{"_id":"public/wp-content/uploads/2014/09/154444_0011.png","hash":"a7fabc70b68d8ca0ea6c8a94e33b8dba481b935e","modified":1467752479868},{"_id":"public/wp-content/uploads/2014/09/154502_0012-150x150.png","hash":"2cb02d3aa88b01ddf3a163ca44d1c9e9a8b4dcac","modified":1467752479868},{"_id":"public/wp-content/uploads/2014/09/154502_0012-300x117.png","hash":"8e13ba026408b8dd34bc207a32b42d6b4738fd2c","modified":1467752479868},{"_id":"public/wp-content/uploads/2014/09/154502_0012.png","hash":"6b28d6cf94ae3387a3a2da3047bf9d3c0314204d","modified":1467752479868},{"_id":"public/vendor/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1467752479868},{"_id":"public/vendor/font-awesome/fonts/fontawesome-webfont.woff2","hash":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1467752479868},{"_id":"public/vendor/scrollLoading/images/preloader.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1467752479868},{"_id":"public/vendor/scrollLoading/images/preloader@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1467752479868},{"_id":"public/vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1467752479868},{"_id":"public/vendor/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1467752479868},{"_id":"public/vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcSo_WB_cotcEMUw1LsIE8mM.woff2","hash":"6d17eac7fcc2866f10d1f2725a08ab749a6e978d","modified":1467752479868},{"_id":"public/vendor/titillium-web/fonts/7XUFZ5tgS-tD6QamInJTcZSnX671uNZIV63UdXh3Mg0.woff2","hash":"78029561e4c2ec565ea11c3f5bbd052b018af8a6","modified":1467752479868},{"_id":"public/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr4-67659ICLY8bMrYhtePPA.woff2","hash":"4e5557954ec161edc03b6f971ddefee6179c1305","modified":1467752479868},{"_id":"public/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr46gJz9aNFrmnwBdd69aqzY.woff2","hash":"1454a4753468b607c23deac9f5438cd0ed5cb35d","modified":1467752479869},{"_id":"public/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr9INifKjd1RJ3NxxEi9Cy2w.woff2","hash":"1758c64c8acec4497735ccb5336b1a518d24024c","modified":1467752479869},{"_id":"public/vendor/titillium-web/fonts/anMUvcNT0H1YN4FII8wpr_SNRT0fZ5CX-AqRkMYgJJo.woff2","hash":"e2e2993940fc54ed41f26e39257fdbd824c05e81","modified":1467752479869},{"_id":"public/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png","hash":"fbe7fcbcd63820eed1c590073974e8cb326d57c6","modified":1467752481575},{"_id":"public/vendor/font-awesome/fonts/FontAwesome.otf","hash":"0112e96f327d413938d37c1693806f468ffdbace","modified":1467752481576},{"_id":"public/vendor/font-awesome/fonts/fontawesome-webfont.eot","hash":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1467752481579},{"_id":"public/vendor/font-awesome/fonts/fontawesome-webfont.woff","hash":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1467752481579},{"_id":"public/js/insight.js","hash":"6ee84c42c2b230ff9e9bf605a444bd671d44f9e3","modified":1467752482699},{"_id":"public/js/main.js","hash":"5027fe5ba72a88d5f16a7feba312574ad50556b5","modified":1467752482699},{"_id":"public/vendor/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1467752482699},{"_id":"public/vendor/scrollLoading/jquery.scrollLoading.js","hash":"1a3eab1ab2c4644fe1ada921bd1bdb083268a751","modified":1467752482700},{"_id":"public/vendor/scrollLoading/main.js","hash":"d1e92247f199fa93c7b3672e6b2ad9ad74a0a529","modified":1467752482700},{"_id":"public/vendor/scrollLoading/style.css","hash":"4ee06b1478b786aed0817b629cf58f336e5eff62","modified":1467752482700},{"_id":"public/vendor/source-code-pro/styles.css","hash":"93c308012738728f906cd4c5cfdb34189e0c712b","modified":1467752482700},{"_id":"public/vendor/titillium-web/styles.css","hash":"d98f0c50aae4c922cd0b663fa820fd7dff2dd9b1","modified":1467752482700},{"_id":"public/vendor/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1467752482700},{"_id":"public/vendor/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1467752482700},{"_id":"public/vendor/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1467752482700},{"_id":"public/vendor/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1467752482700},{"_id":"public/vendor/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1467752482700},{"_id":"public/vendor/webfont/1.6.16/webfont.load.js","hash":"85f249aa2eb2d95207f81a2c4039019f315744e3","modified":1467752482701},{"_id":"public/css/style.css","hash":"97733620d6949792d67ce8e47f1ca635942f0c03","modified":1467752482701},{"_id":"public/vendor/fancybox/jquery.fancybox.js","hash":"c36aa96c08e0f0bc10a91e71f5f5aa1dbe4435c6","modified":1467752482701},{"_id":"public/vendor/fancybox/jquery.fancybox.pack.js","hash":"4bdce95d7ed1e6e3f0cdbb21972f6ed730db6ec9","modified":1467752482701},{"_id":"public/vendor/font-awesome/css/font-awesome.min.css","hash":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22","modified":1467752482701},{"_id":"public/vendor/jquery/2.0.3/jquery.min.js","hash":"a6eedf84389e1bc9f757bc2d19538f8c8d1cae9d","modified":1467752482701},{"_id":"public/wp-content/uploads/2011/04/teknoglot.wordpress.2011-04-27.xml_.txt","hash":"61dfee3122af6aca05c2681a8e2dd29c582f5451","modified":1467752482701},{"_id":"public/vendor/font-awesome/fonts/fontawesome-webfont.ttf","hash":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1467752482701},{"_id":"public/vendor/font-awesome/fonts/fontawesome-webfont.svg","hash":"f346b8b3df147e4059e1a7d66c52c9a6e1cec3e8","modified":1467752483186}],"Category":[{"name":"Code","_id":"ciq9xx7gc0004q4o23x8odlfy"},{"name":"Microsoft","_id":"ciq9xx7gk0009q4o2916yy1s2"},{"name":"VBS","parent":"ciq9xx7gc0004q4o23x8odlfy","_id":"ciq9xx7h2000kq4o2d9o5zcfj"},{"name":"OpsMgr 2007","parent":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7hf000xq4o2lani0wu0"},{"name":"OpsMgr 2012","parent":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7hk0012q4o2jbnjdy7y"},{"name":"Mikrotik","_id":"ciq9xx7hv001hq4o2zlvf83fi"},{"name":"Technobabble","_id":"ciq9xx7ja002fq4o2su9a74pw"},{"name":"Linux","_id":"ciq9xx7jk002rq4o2bwcfgujb"},{"name":"SQL Server","parent":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jo002yq4o27a9bmlj2"},{"name":"Windows","parent":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jx0036q4o20uctcy44"},{"name":"Windows Vista","parent":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7k4003eq4o2102x4tx2"},{"name":"RedHat ES","parent":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7l9004wq4o2ey9jc4nk"},{"name":"PoSH","parent":"ciq9xx7gc0004q4o23x8odlfy","_id":"ciq9xx7lb0050q4o2gx27a2tn"},{"name":"Windows XP","parent":"ciq9xx7jx0036q4o20uctcy44","_id":"ciq9xx7lc0055q4o288eb66l0"},{"name":"SLES","parent":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7lf005aq4o2mo86svjf"},{"name":"Ubuntu","parent":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7lh005gq4o2fj7kfxqz"}],"Data":[],"Page":[{"title":"About","date":"2016-05-17T22:20:57.000Z","_content":"# Who's stegenfeldt?\nA System Management consultant at [Atea Sverige AB](http://www.atea.se/), Swedish, focusing mainly on System Center Operations Manager, System Center Service Manager some Microsoft SQL Server and OP5.\nBesides doing consulting I am also an MCT and are holding both the official System Center Operations Manager courses at Cornerstone and Global Knowledge and holds customized classes at customer sites.\n\nThe content of this site consists of my own personal opinions (and occasionally the opinions of others) and does not officially represent my employer’s view in anyway. Included content is especially not intended to convey the views of Atea Sverige AB. Please visit [www.atea.com](www.atea.com) for official information. In addition, the thoughts and opinions of participants often change, and as a weblog, this is intended to provide a semi-permanent point in time snapshot. You should not consider out of date posts to reflect participants current thoughts and opinions.","source":"About/index.md","raw":"---\ntitle: About\ndate: 2016-05-18 00:20:57\n---\n# Who's stegenfeldt?\nA System Management consultant at [Atea Sverige AB](http://www.atea.se/), Swedish, focusing mainly on System Center Operations Manager, System Center Service Manager some Microsoft SQL Server and OP5.\nBesides doing consulting I am also an MCT and are holding both the official System Center Operations Manager courses at Cornerstone and Global Knowledge and holds customized classes at customer sites.\n\nThe content of this site consists of my own personal opinions (and occasionally the opinions of others) and does not officially represent my employer’s view in anyway. Included content is especially not intended to convey the views of Atea Sverige AB. Please visit [www.atea.com](www.atea.com) for official information. In addition, the thoughts and opinions of participants often change, and as a weblog, this is intended to provide a semi-permanent point in time snapshot. You should not consider out of date posts to reflect participants current thoughts and opinions.","updated":"2016-05-17T22:26:44.000Z","path":"About/index.html","comments":1,"layout":"page","_id":"ciq9xx7fv0000q4o2f8agdd74","content":"<h1 id=\"Who’s-stegenfeldt\"><a href=\"#Who’s-stegenfeldt\" class=\"headerlink\" title=\"Who’s stegenfeldt?\"></a>Who’s stegenfeldt?</h1><p>A System Management consultant at <a href=\"http://www.atea.se/\" target=\"_blank\" rel=\"external\">Atea Sverige AB</a>, Swedish, focusing mainly on System Center Operations Manager, System Center Service Manager some Microsoft SQL Server and OP5.<br>Besides doing consulting I am also an MCT and are holding both the official System Center Operations Manager courses at Cornerstone and Global Knowledge and holds customized classes at customer sites.</p>\n<p>The content of this site consists of my own personal opinions (and occasionally the opinions of others) and does not officially represent my employer’s view in anyway. Included content is especially not intended to convey the views of Atea Sverige AB. Please visit <a href=\"www.atea.com\">www.atea.com</a> for official information. In addition, the thoughts and opinions of participants often change, and as a weblog, this is intended to provide a semi-permanent point in time snapshot. You should not consider out of date posts to reflect participants current thoughts and opinions.</p>\n","excerpt":"","more":"<h1 id=\"Who’s-stegenfeldt\"><a href=\"#Who’s-stegenfeldt\" class=\"headerlink\" title=\"Who’s stegenfeldt?\"></a>Who’s stegenfeldt?</h1><p>A System Management consultant at <a href=\"http://www.atea.se/\">Atea Sverige AB</a>, Swedish, focusing mainly on System Center Operations Manager, System Center Service Manager some Microsoft SQL Server and OP5.<br>Besides doing consulting I am also an MCT and are holding both the official System Center Operations Manager courses at Cornerstone and Global Knowledge and holds customized classes at customer sites.</p>\n<p>The content of this site consists of my own personal opinions (and occasionally the opinions of others) and does not officially represent my employer’s view in anyway. Included content is especially not intended to convey the views of Atea Sverige AB. Please visit <a href=\"www.atea.com\">www.atea.com</a> for official information. In addition, the thoughts and opinions of participants often change, and as a weblog, this is intended to provide a semi-permanent point in time snapshot. You should not consider out of date posts to reflect participants current thoughts and opinions.</p>\n"}],"Post":[{"title":"Resize all images in a Word document with #vbs #macro","date":"2016-07-05T20:08:26.000Z","_content":"\n# TLDR\n\nQuick and dirty macro to resize all images in a word document to 145 mm. I am lazy like that.\n\nGet the gist of it [here][1].\n\n# The \"Why\"\n\nOk, so. I am a consultant, as you may know. And as a consultant, people pay me to do stuff and expect me to be efficient and deliver with high quality.\nPart of that entails writing documentation containing how I do stuff, where I do it and often why I do it.\nThis documentation is expected to be detailed enough to make sure my customers will be able to follow the steps and produce a copy of my work. Most of the time\nthese document are a big part of the disaster recovery processes and might have to be executed by the on-call staff with no previous knowledge of the product.\n\nThis means screenshots. Lots of screenshots.\nAnd while templates are nice and help me out a lot, the screenshots have to be from the actual installation and not some copy-pasta from a previous assignment.\nTo help me out, I use the excellent free program [Greenshot][2] to quickly generate screenshots into a WIP-folder (or directly into Word if that is appropriate) and that makes it possible to\ngrab snapshots of the process without having to pause all the time to `PrtScn-Alt+Tab-Ctrl+V-Crop-Ctrl+C-Alt+Tab-Ctrl+C`. I simply press `PrtScn` and go on with the installation.\n\nBeing a bit pedantic, doesn't help me out here though as I find myself selecting and resizing all the images in the Word document I have produced. This is a *very* time-consuming process and not the most exact one either.\nI want all images to be of scaled, if necessary, to an equal maximum width that fits comfortably withing the margins of the document template my company has prepared for me. \n\nSo I created a fairly simple macro to do it for me.\n\n# The \"How\"\n\nIf you are un-familiar with macros in Word, you will find them under the \"View\" tab.\nClicking on \"Macros\" will give you the option to execute the ones you have, or you can create your own using VBA (Visual Basic for Applications).\nTo create one, select where you want it saved (normal.dotx in my case, as I want it readily available) and enter a name for it.\nThis will bring up the Visual Basic for Applications IDE, where you can write your own fun stuff.\n\nThis little macro of mine is saved as a .bas file, which means I can import it into VBA by right-clicking the navigation and selecting \"Import file...\".\nBy doing that, and saving my changes, it is now available to me in any other word document, given that I saved it into the global template.\n\n# The Macro\n\nI've put it up on a [public gist][1] for anyone interested.\nIt is, currently, very specific for my templates but it's very easy to modify it to set images to a different size than 145 mm wide.\nGive it a little love, and we could add options for width as well, but I dont need that right now.\n\nAnd for those who don't want to travel all the way to Github, here's the script in it's current form.\n<script src=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0.js\"></script>\n\n\n\n[1]: https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0\n[2]: http://getgreenshot.org/","source":"_posts/20160705-Resize-all-images-in-a-Word-document-with-vbs-macro.md","raw":"---\ntitle: 'Resize all images in a Word document with #vbs #macro'\ndate: 2016-07-05 22:08:26\ntags:\n    - VBScript\n    - Macro\n    - Word\n    - Office\ncategories:\n    - Code\n    - VBS\n---\n\n# TLDR\n\nQuick and dirty macro to resize all images in a word document to 145 mm. I am lazy like that.\n\nGet the gist of it [here][1].\n\n# The \"Why\"\n\nOk, so. I am a consultant, as you may know. And as a consultant, people pay me to do stuff and expect me to be efficient and deliver with high quality.\nPart of that entails writing documentation containing how I do stuff, where I do it and often why I do it.\nThis documentation is expected to be detailed enough to make sure my customers will be able to follow the steps and produce a copy of my work. Most of the time\nthese document are a big part of the disaster recovery processes and might have to be executed by the on-call staff with no previous knowledge of the product.\n\nThis means screenshots. Lots of screenshots.\nAnd while templates are nice and help me out a lot, the screenshots have to be from the actual installation and not some copy-pasta from a previous assignment.\nTo help me out, I use the excellent free program [Greenshot][2] to quickly generate screenshots into a WIP-folder (or directly into Word if that is appropriate) and that makes it possible to\ngrab snapshots of the process without having to pause all the time to `PrtScn-Alt+Tab-Ctrl+V-Crop-Ctrl+C-Alt+Tab-Ctrl+C`. I simply press `PrtScn` and go on with the installation.\n\nBeing a bit pedantic, doesn't help me out here though as I find myself selecting and resizing all the images in the Word document I have produced. This is a *very* time-consuming process and not the most exact one either.\nI want all images to be of scaled, if necessary, to an equal maximum width that fits comfortably withing the margins of the document template my company has prepared for me. \n\nSo I created a fairly simple macro to do it for me.\n\n# The \"How\"\n\nIf you are un-familiar with macros in Word, you will find them under the \"View\" tab.\nClicking on \"Macros\" will give you the option to execute the ones you have, or you can create your own using VBA (Visual Basic for Applications).\nTo create one, select where you want it saved (normal.dotx in my case, as I want it readily available) and enter a name for it.\nThis will bring up the Visual Basic for Applications IDE, where you can write your own fun stuff.\n\nThis little macro of mine is saved as a .bas file, which means I can import it into VBA by right-clicking the navigation and selecting \"Import file...\".\nBy doing that, and saving my changes, it is now available to me in any other word document, given that I saved it into the global template.\n\n# The Macro\n\nI've put it up on a [public gist][1] for anyone interested.\nIt is, currently, very specific for my templates but it's very easy to modify it to set images to a different size than 145 mm wide.\nGive it a little love, and we could add options for width as well, but I dont need that right now.\n\nAnd for those who don't want to travel all the way to Github, here's the script in it's current form.\n<script src=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0.js\"></script>\n\n\n\n[1]: https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0\n[2]: http://getgreenshot.org/","slug":"Resize-all-images-in-a-Word-document-with-vbs-macro","published":1,"updated":"2016-07-05T20:51:08.652Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7fy0001q4o26drvw510","content":"<h1 id=\"TLDR\"><a href=\"#TLDR\" class=\"headerlink\" title=\"TLDR\"></a>TLDR</h1><p>Quick and dirty macro to resize all images in a word document to 145 mm. I am lazy like that.</p>\n<p>Get the gist of it <a href=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0\" target=\"_blank\" rel=\"external\">here</a>.</p>\n<h1 id=\"The-“Why”\"><a href=\"#The-“Why”\" class=\"headerlink\" title=\"The “Why”\"></a>The “Why”</h1><p>Ok, so. I am a consultant, as you may know. And as a consultant, people pay me to do stuff and expect me to be efficient and deliver with high quality.<br>Part of that entails writing documentation containing how I do stuff, where I do it and often why I do it.<br>This documentation is expected to be detailed enough to make sure my customers will be able to follow the steps and produce a copy of my work. Most of the time<br>these document are a big part of the disaster recovery processes and might have to be executed by the on-call staff with no previous knowledge of the product.</p>\n<p>This means screenshots. Lots of screenshots.<br>And while templates are nice and help me out a lot, the screenshots have to be from the actual installation and not some copy-pasta from a previous assignment.<br>To help me out, I use the excellent free program <a href=\"http://getgreenshot.org/\" target=\"_blank\" rel=\"external\">Greenshot</a> to quickly generate screenshots into a WIP-folder (or directly into Word if that is appropriate) and that makes it possible to<br>grab snapshots of the process without having to pause all the time to <code>PrtScn-Alt+Tab-Ctrl+V-Crop-Ctrl+C-Alt+Tab-Ctrl+C</code>. I simply press <code>PrtScn</code> and go on with the installation.</p>\n<p>Being a bit pedantic, doesn’t help me out here though as I find myself selecting and resizing all the images in the Word document I have produced. This is a <em>very</em> time-consuming process and not the most exact one either.<br>I want all images to be of scaled, if necessary, to an equal maximum width that fits comfortably withing the margins of the document template my company has prepared for me. </p>\n<p>So I created a fairly simple macro to do it for me.</p>\n<h1 id=\"The-“How”\"><a href=\"#The-“How”\" class=\"headerlink\" title=\"The “How”\"></a>The “How”</h1><p>If you are un-familiar with macros in Word, you will find them under the “View” tab.<br>Clicking on “Macros” will give you the option to execute the ones you have, or you can create your own using VBA (Visual Basic for Applications).<br>To create one, select where you want it saved (normal.dotx in my case, as I want it readily available) and enter a name for it.<br>This will bring up the Visual Basic for Applications IDE, where you can write your own fun stuff.</p>\n<p>This little macro of mine is saved as a .bas file, which means I can import it into VBA by right-clicking the navigation and selecting “Import file…”.<br>By doing that, and saving my changes, it is now available to me in any other word document, given that I saved it into the global template.</p>\n<h1 id=\"The-Macro\"><a href=\"#The-Macro\" class=\"headerlink\" title=\"The Macro\"></a>The Macro</h1><p>I’ve put it up on a <a href=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0\" target=\"_blank\" rel=\"external\">public gist</a> for anyone interested.<br>It is, currently, very specific for my templates but it’s very easy to modify it to set images to a different size than 145 mm wide.<br>Give it a little love, and we could add options for width as well, but I dont need that right now.</p>\n<p>And for those who don’t want to travel all the way to Github, here’s the script in it’s current form.</p>\n<script src=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0.js\"></script>\n\n\n\n","excerpt":"","more":"<h1 id=\"TLDR\"><a href=\"#TLDR\" class=\"headerlink\" title=\"TLDR\"></a>TLDR</h1><p>Quick and dirty macro to resize all images in a word document to 145 mm. I am lazy like that.</p>\n<p>Get the gist of it <a href=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0\">here</a>.</p>\n<h1 id=\"The-“Why”\"><a href=\"#The-“Why”\" class=\"headerlink\" title=\"The “Why”\"></a>The “Why”</h1><p>Ok, so. I am a consultant, as you may know. And as a consultant, people pay me to do stuff and expect me to be efficient and deliver with high quality.<br>Part of that entails writing documentation containing how I do stuff, where I do it and often why I do it.<br>This documentation is expected to be detailed enough to make sure my customers will be able to follow the steps and produce a copy of my work. Most of the time<br>these document are a big part of the disaster recovery processes and might have to be executed by the on-call staff with no previous knowledge of the product.</p>\n<p>This means screenshots. Lots of screenshots.<br>And while templates are nice and help me out a lot, the screenshots have to be from the actual installation and not some copy-pasta from a previous assignment.<br>To help me out, I use the excellent free program <a href=\"http://getgreenshot.org/\">Greenshot</a> to quickly generate screenshots into a WIP-folder (or directly into Word if that is appropriate) and that makes it possible to<br>grab snapshots of the process without having to pause all the time to <code>PrtScn-Alt+Tab-Ctrl+V-Crop-Ctrl+C-Alt+Tab-Ctrl+C</code>. I simply press <code>PrtScn</code> and go on with the installation.</p>\n<p>Being a bit pedantic, doesn’t help me out here though as I find myself selecting and resizing all the images in the Word document I have produced. This is a <em>very</em> time-consuming process and not the most exact one either.<br>I want all images to be of scaled, if necessary, to an equal maximum width that fits comfortably withing the margins of the document template my company has prepared for me. </p>\n<p>So I created a fairly simple macro to do it for me.</p>\n<h1 id=\"The-“How”\"><a href=\"#The-“How”\" class=\"headerlink\" title=\"The “How”\"></a>The “How”</h1><p>If you are un-familiar with macros in Word, you will find them under the “View” tab.<br>Clicking on “Macros” will give you the option to execute the ones you have, or you can create your own using VBA (Visual Basic for Applications).<br>To create one, select where you want it saved (normal.dotx in my case, as I want it readily available) and enter a name for it.<br>This will bring up the Visual Basic for Applications IDE, where you can write your own fun stuff.</p>\n<p>This little macro of mine is saved as a .bas file, which means I can import it into VBA by right-clicking the navigation and selecting “Import file…”.<br>By doing that, and saving my changes, it is now available to me in any other word document, given that I saved it into the global template.</p>\n<h1 id=\"The-Macro\"><a href=\"#The-Macro\" class=\"headerlink\" title=\"The Macro\"></a>The Macro</h1><p>I’ve put it up on a <a href=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0\">public gist</a> for anyone interested.<br>It is, currently, very specific for my templates but it’s very easy to modify it to set images to a different size than 145 mm wide.<br>Give it a little love, and we could add options for width as well, but I dont need that right now.</p>\n<p>And for those who don’t want to travel all the way to Github, here’s the script in it’s current form.</p>\n<script src=\"https://gist.github.com/stegenfeldt/5d81ab5c57a3d20397a6b04a75b882e0.js\"></script>\n\n\n\n"},{"title":"Event Id 4001 – “Cannot Add Type” in [#SQL] MP 6.6.4.0 for [#OpsMgr2012]","date":"2016-02-15T11:22:28.000Z","_content":"\nWas troubleshooting this little error message for a customer after deploying the SQL Server Management Pack version 6.6.4.0.\n\nThe event is the generic \"Health Service Script\" with id 4001.\n\n```text\nManagement Group: REDACTED. Script: Main Module: CPUUsagePercentDataSource.ps1 :\nComputer Name = \"REDACTED.redacted.com\" WMI = \"ComputerManagement11\" Service Name = \"MSSQLSERVER\" SQL Instance Name = \"MSSQLSERVER\"\nError occured during CPU Usage for SQL Instances data source executing.\nComputer: REDACTED\nReason: Cannot add type. Compilation errors occurred.\nPosition:256\nOffset:21\nDetailed error output: Cannot add type. Compilation errors occurred.\n--------\n(0) : No source files specified\n\n(1) : using System;\n\n--------\n(0) : Source file \"C:\\Windows\\TEMP\\njdqtgfb.0.cs\" could not be found\n\n(1) : using System;\n```\n\nThere are some known errors to the 6.6.4.0 version of the SQL management packs, and one of them does mention *\"Cannot add type. Compilation errors occured.\"*\nIn a [thread on the Technet Forums](https://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/92796ead-739d-4128-9afb-1e6f770099d6/#3004a2fc-88ad-4c74-936a-8ed3c8aa70fa) it was suggested that it has to do with rights, but focusing mainly on the SQL instance. What caught our eyes, however, was the fact that the script is using the `C:\\Windows\\TEMP` folder instead of its private one. And this seems to be because it is using a few .Net components that do some sort of JIT compilation.\nWe took a quick look using *procmon*, filtered on C:\\Windows\\TEMP\\ and yes indeed. The monitoring account used is trying to create and delete its temporary files in that very folder.\n\n# A wild work-around appears!\n\nThe work-around is simple, but cumbersome. Just make sure that the assigned RunAs account have read/write/delete rights on C:\\Windows\\TEMP.\nNow you just have to manage this on all your SQL-servers! (yaaaay)","source":"_posts/Event-Id-4001-–-“Cannot-Add-Type”-in-SQL-MP-6-6-4-0-for-OpsMgr2012.md","raw":"---\ntitle: 'Event Id 4001 – “Cannot Add Type” in [#SQL] MP 6.6.4.0 for [#OpsMgr2012]'\ndate: 2016-02-15 12:22:28\ntags:\ncategory:\n    - Microsoft\n    - OpsMgr 2012\n---\n\nWas troubleshooting this little error message for a customer after deploying the SQL Server Management Pack version 6.6.4.0.\n\nThe event is the generic \"Health Service Script\" with id 4001.\n\n```text\nManagement Group: REDACTED. Script: Main Module: CPUUsagePercentDataSource.ps1 :\nComputer Name = \"REDACTED.redacted.com\" WMI = \"ComputerManagement11\" Service Name = \"MSSQLSERVER\" SQL Instance Name = \"MSSQLSERVER\"\nError occured during CPU Usage for SQL Instances data source executing.\nComputer: REDACTED\nReason: Cannot add type. Compilation errors occurred.\nPosition:256\nOffset:21\nDetailed error output: Cannot add type. Compilation errors occurred.\n--------\n(0) : No source files specified\n\n(1) : using System;\n\n--------\n(0) : Source file \"C:\\Windows\\TEMP\\njdqtgfb.0.cs\" could not be found\n\n(1) : using System;\n```\n\nThere are some known errors to the 6.6.4.0 version of the SQL management packs, and one of them does mention *\"Cannot add type. Compilation errors occured.\"*\nIn a [thread on the Technet Forums](https://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/92796ead-739d-4128-9afb-1e6f770099d6/#3004a2fc-88ad-4c74-936a-8ed3c8aa70fa) it was suggested that it has to do with rights, but focusing mainly on the SQL instance. What caught our eyes, however, was the fact that the script is using the `C:\\Windows\\TEMP` folder instead of its private one. And this seems to be because it is using a few .Net components that do some sort of JIT compilation.\nWe took a quick look using *procmon*, filtered on C:\\Windows\\TEMP\\ and yes indeed. The monitoring account used is trying to create and delete its temporary files in that very folder.\n\n# A wild work-around appears!\n\nThe work-around is simple, but cumbersome. Just make sure that the assigned RunAs account have read/write/delete rights on C:\\Windows\\TEMP.\nNow you just have to manage this on all your SQL-servers! (yaaaay)","slug":"Event-Id-4001-–-“Cannot-Add-Type”-in-SQL-MP-6-6-4-0-for-OpsMgr2012","published":1,"updated":"2016-05-24T21:59:37.927Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7g50002q4o220i0g6c2","content":"<p>Was troubleshooting this little error message for a customer after deploying the SQL Server Management Pack version 6.6.4.0.</p>\n<p>The event is the generic “Health Service Script” with id 4001.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Management Group: REDACTED. Script: Main Module: CPUUsagePercentDataSource.ps1 :</span><br><span class=\"line\">Computer Name = &quot;REDACTED.redacted.com&quot; WMI = &quot;ComputerManagement11&quot; Service Name = &quot;MSSQLSERVER&quot; SQL Instance Name = &quot;MSSQLSERVER&quot;</span><br><span class=\"line\">Error occured during CPU Usage for SQL Instances data source executing.</span><br><span class=\"line\">Computer: REDACTED</span><br><span class=\"line\">Reason: Cannot add type. Compilation errors occurred.</span><br><span class=\"line\">Position:256</span><br><span class=\"line\">Offset:21</span><br><span class=\"line\">Detailed error output: Cannot add type. Compilation errors occurred.</span><br><span class=\"line\">--------</span><br><span class=\"line\">(0) : No source files specified</span><br><span class=\"line\"></span><br><span class=\"line\">(1) : using System;</span><br><span class=\"line\"></span><br><span class=\"line\">--------</span><br><span class=\"line\">(0) : Source file &quot;C:\\Windows\\TEMP\\njdqtgfb.0.cs&quot; could not be found</span><br><span class=\"line\"></span><br><span class=\"line\">(1) : using System;</span><br></pre></td></tr></table></figure>\n<p>There are some known errors to the 6.6.4.0 version of the SQL management packs, and one of them does mention <em>“Cannot add type. Compilation errors occured.”</em><br>In a <a href=\"https://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/92796ead-739d-4128-9afb-1e6f770099d6/#3004a2fc-88ad-4c74-936a-8ed3c8aa70fa\" target=\"_blank\" rel=\"external\">thread on the Technet Forums</a> it was suggested that it has to do with rights, but focusing mainly on the SQL instance. What caught our eyes, however, was the fact that the script is using the <code>C:\\Windows\\TEMP</code> folder instead of its private one. And this seems to be because it is using a few .Net components that do some sort of JIT compilation.<br>We took a quick look using <em>procmon</em>, filtered on C:\\Windows\\TEMP\\ and yes indeed. The monitoring account used is trying to create and delete its temporary files in that very folder.</p>\n<h1 id=\"A-wild-work-around-appears\"><a href=\"#A-wild-work-around-appears\" class=\"headerlink\" title=\"A wild work-around appears!\"></a>A wild work-around appears!</h1><p>The work-around is simple, but cumbersome. Just make sure that the assigned RunAs account have read/write/delete rights on C:\\Windows\\TEMP.<br>Now you just have to manage this on all your SQL-servers! (yaaaay)</p>\n","excerpt":"","more":"<p>Was troubleshooting this little error message for a customer after deploying the SQL Server Management Pack version 6.6.4.0.</p>\n<p>The event is the generic “Health Service Script” with id 4001.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Management Group: REDACTED. Script: Main Module: CPUUsagePercentDataSource.ps1 :</span><br><span class=\"line\">Computer Name = &quot;REDACTED.redacted.com&quot; WMI = &quot;ComputerManagement11&quot; Service Name = &quot;MSSQLSERVER&quot; SQL Instance Name = &quot;MSSQLSERVER&quot;</span><br><span class=\"line\">Error occured during CPU Usage for SQL Instances data source executing.</span><br><span class=\"line\">Computer: REDACTED</span><br><span class=\"line\">Reason: Cannot add type. Compilation errors occurred.</span><br><span class=\"line\">Position:256</span><br><span class=\"line\">Offset:21</span><br><span class=\"line\">Detailed error output: Cannot add type. Compilation errors occurred.</span><br><span class=\"line\">--------</span><br><span class=\"line\">(0) : No source files specified</span><br><span class=\"line\"></span><br><span class=\"line\">(1) : using System;</span><br><span class=\"line\"></span><br><span class=\"line\">--------</span><br><span class=\"line\">(0) : Source file &quot;C:\\Windows\\TEMP\\njdqtgfb.0.cs&quot; could not be found</span><br><span class=\"line\"></span><br><span class=\"line\">(1) : using System;</span><br></pre></td></tr></table></figure>\n<p>There are some known errors to the 6.6.4.0 version of the SQL management packs, and one of them does mention <em>“Cannot add type. Compilation errors occured.”</em><br>In a <a href=\"https://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/92796ead-739d-4128-9afb-1e6f770099d6/#3004a2fc-88ad-4c74-936a-8ed3c8aa70fa\">thread on the Technet Forums</a> it was suggested that it has to do with rights, but focusing mainly on the SQL instance. What caught our eyes, however, was the fact that the script is using the <code>C:\\Windows\\TEMP</code> folder instead of its private one. And this seems to be because it is using a few .Net components that do some sort of JIT compilation.<br>We took a quick look using <em>procmon</em>, filtered on C:\\Windows\\TEMP\\ and yes indeed. The monitoring account used is trying to create and delete its temporary files in that very folder.</p>\n<h1 id=\"A-wild-work-around-appears\"><a href=\"#A-wild-work-around-appears\" class=\"headerlink\" title=\"A wild work-around appears!\"></a>A wild work-around appears!</h1><p>The work-around is simple, but cumbersome. Just make sure that the assigned RunAs account have read/write/delete rights on C:\\Windows\\TEMP.<br>Now you just have to manage this on all your SQL-servers! (yaaaay)</p>\n"},{"title":"PoSH Grid Dashboard for RDSH [#opsmgr]","date":"2016-06-13T22:01:27.000Z","_content":"\n\n# TLDR\n\nCustomer wanted to see all RDS Host servers in a view with their current total session count.\n\nDecided to use a powershell grid dashboard, and share the script.\n\nHere's the gist of it: [SCOM_RDSH_TotalSession_PoSHWidget.ps1][1]\n\n# How To\n\nKeeping it fairly short this time.\n\nPre-requisites are:\n\n* System Center 2012 R2 with UR2 or later\n* Microsoft RDS Management Pack\n* Microsoft Windows Core OS Management Pack\n\n## Create a dashboard\n\n1. Rightclick and create a new view somewhere, make it a Dashboard View\n1. Enter Name and Description\n1. Select Grid type, and layout\n\n## Add a widget\n\n1. Click cog on grid view\n1. Select Powershell Grid Widget\n1. Set Name and Description\n1. Paste your [script](#The-Script) into the script box\n1. Save\n\n## The Script\n\n```powershell\n# Based on https://gallery.technet.microsoft.com/Retrieve-Performance-Data-c4595e2a#content\nfunction Add-Criteria()\n{\n    param($criteria,$clause)\n    if ($criteria -ne $null)\n        {$criteria += \" AND $clause\"}\n    else\n        {$criteria = $clause}\n    return($criteria)\n}\n\n$rdsClass = Get-SCOMClass -Name \"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost\"\n$rdsHosts = Get-SCOMMonitoringObject -Class $rdsClass | Sort-Object -Property '[Microsoft.Windows.Computer].PrincipalName'\n$rdsTotalSessionRule = Get-SCOMRule -Name \"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost.PerformanceCollection.TotalSessions\"\n$objectName = \"Terminal Services\"\n$counterName = \"Total Sessions\"\n$InstanceName = \"\"\n\n\n$i=0\nforeach ($rdsHost in $rdsHosts) {\n    # Build performance criteria\n    if ($rdsClass -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"MonitoringClassId = '{$($rdsClass.Id)}'\" }\n    if ($rdsHost -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"MonitoringObjectFullName = '$($rdsHost.FullName)'\" }\n    if ($objectName -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"ObjectName = '$objectName'\" }\n    if ($counterName -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"CounterName = '$counterName'\" }\n\n    #$criteria\n    # Get Performance reader object.\n    $perfReader = (Get-SCOMManagementGroup).GetMonitoringPerformanceDataReader($criteria)\n    while ($perfReader.Read()) {\n        $perfData = $perfReader.GetMonitoringPerformanceData()\n        $perfValueReader = $perfData.GetValueReader(((Get-Date).AddMinutes(-180)),(Get-Date))\n\n        $perfValues = @()\n        while ($perfValueReader.Read()) {\n            $perfValues += $perfValueReader.GetMonitoringPerformanceDataValue()\n        }\n        $perfValue = $perfValues | Sort-Object -Property TimeSampled | select -Last 1\n\n        $dataObject = $ScriptContext.CreateInstance(\"xsd://stegenfeldt/nullschema\")\n        $dataObject = $ScriptContext.CreateFromObject($rdsHost, \"Id=Id,Health=HealthState,Host=Path\", $null)\n        $dataObject[\"Time Sampled\"] = $perfValue.TimeSampled\n        $dataObject[\"Total Sessions\"] = $perfValue.SampleValue\n        $ScriptContext.ReturnCollection.Add($dataObject)\n    }\n    $criteria = $null\n    ++$i\n}\n```\n\n\n\n[1]: https://gist.github.com/stegenfeldt/112c6d3dd513f9659298d1321c98ebd1\n","source":"_posts/PoSH-Grid-Dashboard-for-RDSH.md","raw":"---\ntitle: PoSH Grid Dashboard for RDSH [#opsmgr]\ntags:\n  - Powershell\n  - OpsMgr 2012 R2\n  - HowTo\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2016-06-14 00:01:27\n---\n\n\n# TLDR\n\nCustomer wanted to see all RDS Host servers in a view with their current total session count.\n\nDecided to use a powershell grid dashboard, and share the script.\n\nHere's the gist of it: [SCOM_RDSH_TotalSession_PoSHWidget.ps1][1]\n\n# How To\n\nKeeping it fairly short this time.\n\nPre-requisites are:\n\n* System Center 2012 R2 with UR2 or later\n* Microsoft RDS Management Pack\n* Microsoft Windows Core OS Management Pack\n\n## Create a dashboard\n\n1. Rightclick and create a new view somewhere, make it a Dashboard View\n1. Enter Name and Description\n1. Select Grid type, and layout\n\n## Add a widget\n\n1. Click cog on grid view\n1. Select Powershell Grid Widget\n1. Set Name and Description\n1. Paste your [script](#The-Script) into the script box\n1. Save\n\n## The Script\n\n```powershell\n# Based on https://gallery.technet.microsoft.com/Retrieve-Performance-Data-c4595e2a#content\nfunction Add-Criteria()\n{\n    param($criteria,$clause)\n    if ($criteria -ne $null)\n        {$criteria += \" AND $clause\"}\n    else\n        {$criteria = $clause}\n    return($criteria)\n}\n\n$rdsClass = Get-SCOMClass -Name \"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost\"\n$rdsHosts = Get-SCOMMonitoringObject -Class $rdsClass | Sort-Object -Property '[Microsoft.Windows.Computer].PrincipalName'\n$rdsTotalSessionRule = Get-SCOMRule -Name \"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost.PerformanceCollection.TotalSessions\"\n$objectName = \"Terminal Services\"\n$counterName = \"Total Sessions\"\n$InstanceName = \"\"\n\n\n$i=0\nforeach ($rdsHost in $rdsHosts) {\n    # Build performance criteria\n    if ($rdsClass -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"MonitoringClassId = '{$($rdsClass.Id)}'\" }\n    if ($rdsHost -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"MonitoringObjectFullName = '$($rdsHost.FullName)'\" }\n    if ($objectName -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"ObjectName = '$objectName'\" }\n    if ($counterName -ne $null) { $criteria = Add-Criteria -criteria $criteria -clause \"CounterName = '$counterName'\" }\n\n    #$criteria\n    # Get Performance reader object.\n    $perfReader = (Get-SCOMManagementGroup).GetMonitoringPerformanceDataReader($criteria)\n    while ($perfReader.Read()) {\n        $perfData = $perfReader.GetMonitoringPerformanceData()\n        $perfValueReader = $perfData.GetValueReader(((Get-Date).AddMinutes(-180)),(Get-Date))\n\n        $perfValues = @()\n        while ($perfValueReader.Read()) {\n            $perfValues += $perfValueReader.GetMonitoringPerformanceDataValue()\n        }\n        $perfValue = $perfValues | Sort-Object -Property TimeSampled | select -Last 1\n\n        $dataObject = $ScriptContext.CreateInstance(\"xsd://stegenfeldt/nullschema\")\n        $dataObject = $ScriptContext.CreateFromObject($rdsHost, \"Id=Id,Health=HealthState,Host=Path\", $null)\n        $dataObject[\"Time Sampled\"] = $perfValue.TimeSampled\n        $dataObject[\"Total Sessions\"] = $perfValue.SampleValue\n        $ScriptContext.ReturnCollection.Add($dataObject)\n    }\n    $criteria = $null\n    ++$i\n}\n```\n\n\n\n[1]: https://gist.github.com/stegenfeldt/112c6d3dd513f9659298d1321c98ebd1\n","slug":"PoSH-Grid-Dashboard-for-RDSH","published":1,"updated":"2016-07-05T19:58:17.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gd0005q4o2i8k6ryww","content":"<h1 id=\"TLDR\"><a href=\"#TLDR\" class=\"headerlink\" title=\"TLDR\"></a>TLDR</h1><p>Customer wanted to see all RDS Host servers in a view with their current total session count.</p>\n<p>Decided to use a powershell grid dashboard, and share the script.</p>\n<p>Here’s the gist of it: <a href=\"https://gist.github.com/stegenfeldt/112c6d3dd513f9659298d1321c98ebd1\" target=\"_blank\" rel=\"external\">SCOM_RDSH_TotalSession_PoSHWidget.ps1</a></p>\n<h1 id=\"How-To\"><a href=\"#How-To\" class=\"headerlink\" title=\"How To\"></a>How To</h1><p>Keeping it fairly short this time.</p>\n<p>Pre-requisites are:</p>\n<ul>\n<li>System Center 2012 R2 with UR2 or later</li>\n<li>Microsoft RDS Management Pack</li>\n<li>Microsoft Windows Core OS Management Pack</li>\n</ul>\n<h2 id=\"Create-a-dashboard\"><a href=\"#Create-a-dashboard\" class=\"headerlink\" title=\"Create a dashboard\"></a>Create a dashboard</h2><ol>\n<li>Rightclick and create a new view somewhere, make it a Dashboard View</li>\n<li>Enter Name and Description</li>\n<li>Select Grid type, and layout</li>\n</ol>\n<h2 id=\"Add-a-widget\"><a href=\"#Add-a-widget\" class=\"headerlink\" title=\"Add a widget\"></a>Add a widget</h2><ol>\n<li>Click cog on grid view</li>\n<li>Select Powershell Grid Widget</li>\n<li>Set Name and Description</li>\n<li>Paste your <a href=\"#The-Script\">script</a> into the script box</li>\n<li>Save</li>\n</ol>\n<h2 id=\"The-Script\"><a href=\"#The-Script\" class=\"headerlink\" title=\"The Script\"></a>The Script</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Based on https://gallery.technet.microsoft.com/Retrieve-Performance-Data-c4595e2a#content</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> Add-Criteria()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">param</span>(<span class=\"variable\">$criteria</span>,<span class=\"variable\">$clause</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$criteria</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>)</span><br><span class=\"line\">        &#123;<span class=\"variable\">$criteria</span> += <span class=\"string\">\" AND <span class=\"variable\">$clause</span>\"</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;<span class=\"variable\">$criteria</span> = <span class=\"variable\">$clause</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>(<span class=\"variable\">$criteria</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$rdsClass</span> = Get-SCOMClass -Name <span class=\"string\">\"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost\"</span></span><br><span class=\"line\"><span class=\"variable\">$rdsHosts</span> = Get-SCOMMonitoringObject -Class <span class=\"variable\">$rdsClass</span> | <span class=\"built_in\">Sort-Object</span> -Property <span class=\"string\">'[Microsoft.Windows.Computer].PrincipalName'</span></span><br><span class=\"line\"><span class=\"variable\">$rdsTotalSessionRule</span> = Get-SCOMRule -Name <span class=\"string\">\"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost.PerformanceCollection.TotalSessions\"</span></span><br><span class=\"line\"><span class=\"variable\">$objectName</span> = <span class=\"string\">\"Terminal Services\"</span></span><br><span class=\"line\"><span class=\"variable\">$counterName</span> = <span class=\"string\">\"Total Sessions\"</span></span><br><span class=\"line\"><span class=\"variable\">$InstanceName</span> = <span class=\"string\">\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$i</span>=<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">foreach</span> (<span class=\"variable\">$rdsHost</span> <span class=\"keyword\">in</span> <span class=\"variable\">$rdsHosts</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\"># Build performance criteria</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$rdsClass</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"MonitoringClassId = '&#123;$(<span class=\"variable\">$rdsClass</span>.Id)&#125;'\"</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$rdsHost</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"MonitoringObjectFullName = '$(<span class=\"variable\">$rdsHost</span>.FullName)'\"</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$objectName</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"ObjectName = '<span class=\"variable\">$objectName</span>'\"</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$counterName</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"CounterName = '<span class=\"variable\">$counterName</span>'\"</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#$criteria</span></span><br><span class=\"line\">    <span class=\"comment\"># Get Performance reader object.</span></span><br><span class=\"line\">    <span class=\"variable\">$perfReader</span> = (Get-SCOMManagementGroup).GetMonitoringPerformanceDataReader(<span class=\"variable\">$criteria</span>)</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"variable\">$perfReader</span>.Read()) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$perfData</span> = <span class=\"variable\">$perfReader</span>.GetMonitoringPerformanceData()</span><br><span class=\"line\">        <span class=\"variable\">$perfValueReader</span> = <span class=\"variable\">$perfData</span>.GetValueReader(((<span class=\"built_in\">Get-Date</span>).AddMinutes(-<span class=\"number\">180</span>)),(<span class=\"built_in\">Get-Date</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$perfValues</span> = @()</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"variable\">$perfValueReader</span>.Read()) &#123;</span><br><span class=\"line\">            <span class=\"variable\">$perfValues</span> += <span class=\"variable\">$perfValueReader</span>.GetMonitoringPerformanceDataValue()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"variable\">$perfValue</span> = <span class=\"variable\">$perfValues</span> | <span class=\"built_in\">Sort-Object</span> -Property TimeSampled | select -Last <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span> = <span class=\"variable\">$ScriptContext</span>.CreateInstance(<span class=\"string\">\"xsd://stegenfeldt/nullschema\"</span>)</span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span> = <span class=\"variable\">$ScriptContext</span>.CreateFromObject(<span class=\"variable\">$rdsHost</span>, <span class=\"string\">\"Id=Id,Health=HealthState,Host=Path\"</span>, <span class=\"literal\">$null</span>)</span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span>[<span class=\"string\">\"Time Sampled\"</span>] = <span class=\"variable\">$perfValue</span>.TimeSampled</span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span>[<span class=\"string\">\"Total Sessions\"</span>] = <span class=\"variable\">$perfValue</span>.SampleValue</span><br><span class=\"line\">        <span class=\"variable\">$ScriptContext</span>.ReturnCollection.Add(<span class=\"variable\">$dataObject</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"variable\">$criteria</span> = <span class=\"literal\">$null</span></span><br><span class=\"line\">    ++<span class=\"variable\">$i</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","excerpt":"","more":"<h1 id=\"TLDR\"><a href=\"#TLDR\" class=\"headerlink\" title=\"TLDR\"></a>TLDR</h1><p>Customer wanted to see all RDS Host servers in a view with their current total session count.</p>\n<p>Decided to use a powershell grid dashboard, and share the script.</p>\n<p>Here’s the gist of it: <a href=\"https://gist.github.com/stegenfeldt/112c6d3dd513f9659298d1321c98ebd1\">SCOM_RDSH_TotalSession_PoSHWidget.ps1</a></p>\n<h1 id=\"How-To\"><a href=\"#How-To\" class=\"headerlink\" title=\"How To\"></a>How To</h1><p>Keeping it fairly short this time.</p>\n<p>Pre-requisites are:</p>\n<ul>\n<li>System Center 2012 R2 with UR2 or later</li>\n<li>Microsoft RDS Management Pack</li>\n<li>Microsoft Windows Core OS Management Pack</li>\n</ul>\n<h2 id=\"Create-a-dashboard\"><a href=\"#Create-a-dashboard\" class=\"headerlink\" title=\"Create a dashboard\"></a>Create a dashboard</h2><ol>\n<li>Rightclick and create a new view somewhere, make it a Dashboard View</li>\n<li>Enter Name and Description</li>\n<li>Select Grid type, and layout</li>\n</ol>\n<h2 id=\"Add-a-widget\"><a href=\"#Add-a-widget\" class=\"headerlink\" title=\"Add a widget\"></a>Add a widget</h2><ol>\n<li>Click cog on grid view</li>\n<li>Select Powershell Grid Widget</li>\n<li>Set Name and Description</li>\n<li>Paste your <a href=\"#The-Script\">script</a> into the script box</li>\n<li>Save</li>\n</ol>\n<h2 id=\"The-Script\"><a href=\"#The-Script\" class=\"headerlink\" title=\"The Script\"></a>The Script</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Based on https://gallery.technet.microsoft.com/Retrieve-Performance-Data-c4595e2a#content</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> Add-Criteria()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">param</span>(<span class=\"variable\">$criteria</span>,<span class=\"variable\">$clause</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$criteria</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>)</span><br><span class=\"line\">        &#123;<span class=\"variable\">$criteria</span> += <span class=\"string\">\" AND <span class=\"variable\">$clause</span>\"</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;<span class=\"variable\">$criteria</span> = <span class=\"variable\">$clause</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>(<span class=\"variable\">$criteria</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$rdsClass</span> = Get-SCOMClass -Name <span class=\"string\">\"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost\"</span></span><br><span class=\"line\"><span class=\"variable\">$rdsHosts</span> = Get-SCOMMonitoringObject -Class <span class=\"variable\">$rdsClass</span> | <span class=\"built_in\">Sort-Object</span> -Property <span class=\"string\">'[Microsoft.Windows.Computer].PrincipalName'</span></span><br><span class=\"line\"><span class=\"variable\">$rdsTotalSessionRule</span> = Get-SCOMRule -Name <span class=\"string\">\"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost.PerformanceCollection.TotalSessions\"</span></span><br><span class=\"line\"><span class=\"variable\">$objectName</span> = <span class=\"string\">\"Terminal Services\"</span></span><br><span class=\"line\"><span class=\"variable\">$counterName</span> = <span class=\"string\">\"Total Sessions\"</span></span><br><span class=\"line\"><span class=\"variable\">$InstanceName</span> = <span class=\"string\">\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$i</span>=<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">foreach</span> (<span class=\"variable\">$rdsHost</span> <span class=\"keyword\">in</span> <span class=\"variable\">$rdsHosts</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\"># Build performance criteria</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$rdsClass</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"MonitoringClassId = '&#123;$(<span class=\"variable\">$rdsClass</span>.Id)&#125;'\"</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$rdsHost</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"MonitoringObjectFullName = '$(<span class=\"variable\">$rdsHost</span>.FullName)'\"</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$objectName</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"ObjectName = '<span class=\"variable\">$objectName</span>'\"</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$counterName</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123; <span class=\"variable\">$criteria</span> = Add-Criteria -criteria <span class=\"variable\">$criteria</span> -clause <span class=\"string\">\"CounterName = '<span class=\"variable\">$counterName</span>'\"</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#$criteria</span></span><br><span class=\"line\">    <span class=\"comment\"># Get Performance reader object.</span></span><br><span class=\"line\">    <span class=\"variable\">$perfReader</span> = (Get-SCOMManagementGroup).GetMonitoringPerformanceDataReader(<span class=\"variable\">$criteria</span>)</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"variable\">$perfReader</span>.Read()) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$perfData</span> = <span class=\"variable\">$perfReader</span>.GetMonitoringPerformanceData()</span><br><span class=\"line\">        <span class=\"variable\">$perfValueReader</span> = <span class=\"variable\">$perfData</span>.GetValueReader(((<span class=\"built_in\">Get-Date</span>).AddMinutes(-<span class=\"number\">180</span>)),(<span class=\"built_in\">Get-Date</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$perfValues</span> = @()</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"variable\">$perfValueReader</span>.Read()) &#123;</span><br><span class=\"line\">            <span class=\"variable\">$perfValues</span> += <span class=\"variable\">$perfValueReader</span>.GetMonitoringPerformanceDataValue()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"variable\">$perfValue</span> = <span class=\"variable\">$perfValues</span> | <span class=\"built_in\">Sort-Object</span> -Property TimeSampled | select -Last <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span> = <span class=\"variable\">$ScriptContext</span>.CreateInstance(<span class=\"string\">\"xsd://stegenfeldt/nullschema\"</span>)</span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span> = <span class=\"variable\">$ScriptContext</span>.CreateFromObject(<span class=\"variable\">$rdsHost</span>, <span class=\"string\">\"Id=Id,Health=HealthState,Host=Path\"</span>, <span class=\"literal\">$null</span>)</span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span>[<span class=\"string\">\"Time Sampled\"</span>] = <span class=\"variable\">$perfValue</span>.TimeSampled</span><br><span class=\"line\">        <span class=\"variable\">$dataObject</span>[<span class=\"string\">\"Total Sessions\"</span>] = <span class=\"variable\">$perfValue</span>.SampleValue</span><br><span class=\"line\">        <span class=\"variable\">$ScriptContext</span>.ReturnCollection.Add(<span class=\"variable\">$dataObject</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"variable\">$criteria</span> = <span class=\"literal\">$null</span></span><br><span class=\"line\">    ++<span class=\"variable\">$i</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"Bulk disable ACS Forwarders (with wildcards)","id":"558","date":"2011-07-07T08:59:24.000Z","_content":"\nHere's a little something-something for the wicked.\n\nMe and my apprentice is currently decommissioning an entire Management Group with a thousand (-ish) agents. Long story short, we got a new Management Group, migrated all the agents, added a couple of hundreds more, deployed a bunch of gateways and now we are shutting down the old one.\n\nNow, uninstalling the old Management Group from all the agents is a breeze using SCCM and handling the few 20-ish servers that are left is not a biggie either. Shutting down ACS, however, is a different matter.\n\n<!--more-->\n\nAlthough you do configure your forwarders using Operations Manager, removing the management group you were running ACS in does not mean the agents will shut down and disable the AdtAgent service or stop trying to forward audit events to your collector. Now, selecting 10 agents at the time and running the \"Disable Audit Collection\" task--in case you did not know, there's a limitation on how many agents you can run a task on in the Operations Console--is not my idea of a jolly good day and since Powershell is a bucket of joy in comparison; here's a script for you all!\n\n[DisableACSForwarders](http://teknoglotse.nfshost.com/wp-content/uploads/2011/07/DisableACSForwarders.zip)\n\nIt is zipped to avoid security alerts, but as with any script found on the internet I implore to to read the code before actually running it.\n\nAnyway, you can use it in a couple of ways.\n\nTo run it interactively, just go to the directory where you unpacked it and run it. You will be requested to enter the FQDN of you Root Management Server and a wildcard search for ACS Forwarders.\nFor example:\n\n```powershell C:\\..\\Scripts> .\\DisableACSForwarders.ps1\nRoot Management Server: rms.teknoglot.local\nACS Forwarder name (wildcard): *.teknoglot.local```\n\nYou can also run it with parameters (for scheduling?) like this:\n\n```powershell C:\\..\\Scripts> .\\DisableACSForwarders.ps1 rms.teknoglot.local *.teknoglot.local```\n\nIf you need to run the task with different credentials there's a switch for that. Just add -UseCredentials to the command and you will be prompted for it.\nLike this:\n\n```powershell C:\\..\\Scripts> .\\DisableACSForwarders.ps1 -UseCredentials```\n\nAs you might already have realized, the wildcard search does not require actual wildcards. If you only want to disable the ACS forwarder on a single machine, just enter it's FQDN. As for what wildcards it will accept; [anything supported by the powershell -like operator](http://msdn.microsoft.com/en-us/library/aa717088%28VS.85%29.aspx \"Supporting Wildcard Characters in Cmdlet Parameters\") is valid.\n\n[UPDATE!] You might get false failures when running the script on clustered machines because of a [bug in the AC Management Pack](https://connect.microsoft.com/OpsMgr/feedback/details/523453/bug-with-microsoft-audit-collection-services-management-pack \"Bug with Microsoft Audit Collection Services Management Pack\")\n\nFor the source code, read on!\n\n<!--more-->\n\n```powershell\n## Using parameters for RMS and wildcard search\nparam(\n [string]$rootManagementServer = $(Read-Host -Prompt \";Root Management Server\";),\n [string]$filterAgents = $(Read-Host -Prompt \";ACS Forwarder name (wildcard)\";),\n [switch]$UseCredentials\n)\n\n## Make sure the $rootManagementServer variable is defined\nwhile (-not $rootManagementServer) {\n Write-Host \";`nRoot Management Server MUST be defined!\"; -ForegroundColor Red\n [string]$rootManagementServer = $(Read-Host -Prompt \";Root Management Server\";)\n}\n\nif ($UseCredentials -eq $true) {\n $taskCredentials = Get-Credential\n}\n\n$startLocation = Get-Location\n$checkPSSnapin = Get-PSSnapin | where {$_.Name -eq \";Microsoft.EnterpriseManagement.OperationsManager.Client\";}\nif ($checkPSSnapin -eq $null) {\n Add-PSSnapin \";Microsoft.EnterpriseManagement.OperationsManager.Client\";\n}\n$result = Set-Location \";OperationsManagerMonitoring::\";\n$result = New-ManagementGroupConnection -ConnectionString:$rootManagementServer\n$result = Set-Location $rootManagementServer\n\n$acsForwarderClass = Get-MonitoringClass -Name \";Microsoft.SystemCenter.ACS.Forwarder\";\n$agentNames = Get-MonitoringObject -monitoringclass:$acsForwarderClass | where {$_.Path -like $filterAgents} | Select Path\n$successfulTasks = @()\n$skippedTasks = @()\n$failedTasks = @()\n\n$monitoringClass = Get-MonitoringClass -Name \";Microsoft.SystemCenter.Agent\";\nif ($agentNames -ne $null) {\n Write-Host \";`nFound\";$agentNames.Count\";ACS forwarders with wildcard $filterAgents\";\n Write-Host \";`n`nWaiting for 5 seconds to give you a chance to abort!`n\";\n Start-Sleep -Seconds 5\n Write-Host \";Time's UP!`n`n\";\n $agentNames | ForEach-Object {\n $agentName = $_.Path\n Write-Host \";Disabling Audit Collection on\"; $agentName\n $monitoringObject = Get-MonitoringObject -monitoringclass:$monitoringClass | where {$_.DisplayName -like $agentName}\n $agentTask = $monitoringObject | Get-Task | where {$_.Name -eq \";Microsoft.SystemCenter.DisableAuditCollectionService\";}\n if ($monitoringObject.IsAvailable -eq $true) {\n if ($credentials -eq $null) {\n $result = Start-Task -Task $agentTask -TargetMonitoringObject $monitoringObject\n } else {\n $result = Start-Task -Task $agentTask -TargetMonitoringObject $monitoringObject -Credential $taskCredentials\n }\n if ($result.Status -eq \";Succeeded\";) {\n Write-Host \";Operation Successful!\"; -ForegroundColor Green\n Write-Host `n\n $successfulTasks += $agentName\n } else {\n Write-Host \";Operation failed.\"; -ForegroundColor Red\n Write-Host $result.ErrorMessage\n Write-Host `n\n $failedTasks += $agentName\n }\n } else {\n Write-Host \";The agent is unavailable, Skipping!\";\n Write-Host `n\n $skippedTasks += $agentName\n }\n }\n Write-Host \";Summary\";\n Write-Host \";`tSuccessful:`t\";$successfulTasks.count\n Write-Host \";`tFailed:`t`t\";$failedTasks.count\n Write-Host \";`tSkipped:`t\";$skippedTasks.count\n} else {\n Write-Host \";`nNo ACS Forwarders found using wildcard $filterAgents\";\n}\n\nSet-Location $startLocation\n```\n\nEnjoy!","source":"_posts/bulk-disable-acs-forwarders-with-wildcards.md","raw":"---\ntitle: Bulk disable ACS Forwarders (with wildcards)\ntags:\n  - ACS\n  - OpsMgr\n  - PoSH\n  - Script\nid: 558\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2011-07-07 10:59:24\n---\n\nHere's a little something-something for the wicked.\n\nMe and my apprentice is currently decommissioning an entire Management Group with a thousand (-ish) agents. Long story short, we got a new Management Group, migrated all the agents, added a couple of hundreds more, deployed a bunch of gateways and now we are shutting down the old one.\n\nNow, uninstalling the old Management Group from all the agents is a breeze using SCCM and handling the few 20-ish servers that are left is not a biggie either. Shutting down ACS, however, is a different matter.\n\n<!--more-->\n\nAlthough you do configure your forwarders using Operations Manager, removing the management group you were running ACS in does not mean the agents will shut down and disable the AdtAgent service or stop trying to forward audit events to your collector. Now, selecting 10 agents at the time and running the \"Disable Audit Collection\" task--in case you did not know, there's a limitation on how many agents you can run a task on in the Operations Console--is not my idea of a jolly good day and since Powershell is a bucket of joy in comparison; here's a script for you all!\n\n[DisableACSForwarders](http://teknoglotse.nfshost.com/wp-content/uploads/2011/07/DisableACSForwarders.zip)\n\nIt is zipped to avoid security alerts, but as with any script found on the internet I implore to to read the code before actually running it.\n\nAnyway, you can use it in a couple of ways.\n\nTo run it interactively, just go to the directory where you unpacked it and run it. You will be requested to enter the FQDN of you Root Management Server and a wildcard search for ACS Forwarders.\nFor example:\n\n```powershell C:\\..\\Scripts> .\\DisableACSForwarders.ps1\nRoot Management Server: rms.teknoglot.local\nACS Forwarder name (wildcard): *.teknoglot.local```\n\nYou can also run it with parameters (for scheduling?) like this:\n\n```powershell C:\\..\\Scripts> .\\DisableACSForwarders.ps1 rms.teknoglot.local *.teknoglot.local```\n\nIf you need to run the task with different credentials there's a switch for that. Just add -UseCredentials to the command and you will be prompted for it.\nLike this:\n\n```powershell C:\\..\\Scripts> .\\DisableACSForwarders.ps1 -UseCredentials```\n\nAs you might already have realized, the wildcard search does not require actual wildcards. If you only want to disable the ACS forwarder on a single machine, just enter it's FQDN. As for what wildcards it will accept; [anything supported by the powershell -like operator](http://msdn.microsoft.com/en-us/library/aa717088%28VS.85%29.aspx \"Supporting Wildcard Characters in Cmdlet Parameters\") is valid.\n\n[UPDATE!] You might get false failures when running the script on clustered machines because of a [bug in the AC Management Pack](https://connect.microsoft.com/OpsMgr/feedback/details/523453/bug-with-microsoft-audit-collection-services-management-pack \"Bug with Microsoft Audit Collection Services Management Pack\")\n\nFor the source code, read on!\n\n<!--more-->\n\n```powershell\n## Using parameters for RMS and wildcard search\nparam(\n [string]$rootManagementServer = $(Read-Host -Prompt \";Root Management Server\";),\n [string]$filterAgents = $(Read-Host -Prompt \";ACS Forwarder name (wildcard)\";),\n [switch]$UseCredentials\n)\n\n## Make sure the $rootManagementServer variable is defined\nwhile (-not $rootManagementServer) {\n Write-Host \";`nRoot Management Server MUST be defined!\"; -ForegroundColor Red\n [string]$rootManagementServer = $(Read-Host -Prompt \";Root Management Server\";)\n}\n\nif ($UseCredentials -eq $true) {\n $taskCredentials = Get-Credential\n}\n\n$startLocation = Get-Location\n$checkPSSnapin = Get-PSSnapin | where {$_.Name -eq \";Microsoft.EnterpriseManagement.OperationsManager.Client\";}\nif ($checkPSSnapin -eq $null) {\n Add-PSSnapin \";Microsoft.EnterpriseManagement.OperationsManager.Client\";\n}\n$result = Set-Location \";OperationsManagerMonitoring::\";\n$result = New-ManagementGroupConnection -ConnectionString:$rootManagementServer\n$result = Set-Location $rootManagementServer\n\n$acsForwarderClass = Get-MonitoringClass -Name \";Microsoft.SystemCenter.ACS.Forwarder\";\n$agentNames = Get-MonitoringObject -monitoringclass:$acsForwarderClass | where {$_.Path -like $filterAgents} | Select Path\n$successfulTasks = @()\n$skippedTasks = @()\n$failedTasks = @()\n\n$monitoringClass = Get-MonitoringClass -Name \";Microsoft.SystemCenter.Agent\";\nif ($agentNames -ne $null) {\n Write-Host \";`nFound\";$agentNames.Count\";ACS forwarders with wildcard $filterAgents\";\n Write-Host \";`n`nWaiting for 5 seconds to give you a chance to abort!`n\";\n Start-Sleep -Seconds 5\n Write-Host \";Time's UP!`n`n\";\n $agentNames | ForEach-Object {\n $agentName = $_.Path\n Write-Host \";Disabling Audit Collection on\"; $agentName\n $monitoringObject = Get-MonitoringObject -monitoringclass:$monitoringClass | where {$_.DisplayName -like $agentName}\n $agentTask = $monitoringObject | Get-Task | where {$_.Name -eq \";Microsoft.SystemCenter.DisableAuditCollectionService\";}\n if ($monitoringObject.IsAvailable -eq $true) {\n if ($credentials -eq $null) {\n $result = Start-Task -Task $agentTask -TargetMonitoringObject $monitoringObject\n } else {\n $result = Start-Task -Task $agentTask -TargetMonitoringObject $monitoringObject -Credential $taskCredentials\n }\n if ($result.Status -eq \";Succeeded\";) {\n Write-Host \";Operation Successful!\"; -ForegroundColor Green\n Write-Host `n\n $successfulTasks += $agentName\n } else {\n Write-Host \";Operation failed.\"; -ForegroundColor Red\n Write-Host $result.ErrorMessage\n Write-Host `n\n $failedTasks += $agentName\n }\n } else {\n Write-Host \";The agent is unavailable, Skipping!\";\n Write-Host `n\n $skippedTasks += $agentName\n }\n }\n Write-Host \";Summary\";\n Write-Host \";`tSuccessful:`t\";$successfulTasks.count\n Write-Host \";`tFailed:`t`t\";$failedTasks.count\n Write-Host \";`tSkipped:`t\";$skippedTasks.count\n} else {\n Write-Host \";`nNo ACS Forwarders found using wildcard $filterAgents\";\n}\n\nSet-Location $startLocation\n```\n\nEnjoy!","slug":"bulk-disable-acs-forwarders-with-wildcards","published":1,"updated":"2016-05-24T22:05:40.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gg0006q4o2z3t52qk6","content":"<p>Here’s a little something-something for the wicked.</p>\n<p>Me and my apprentice is currently decommissioning an entire Management Group with a thousand (-ish) agents. Long story short, we got a new Management Group, migrated all the agents, added a couple of hundreds more, deployed a bunch of gateways and now we are shutting down the old one.</p>\n<p>Now, uninstalling the old Management Group from all the agents is a breeze using SCCM and handling the few 20-ish servers that are left is not a biggie either. Shutting down ACS, however, is a different matter.</p>\n<a id=\"more\"></a>\n<p>Although you do configure your forwarders using Operations Manager, removing the management group you were running ACS in does not mean the agents will shut down and disable the AdtAgent service or stop trying to forward audit events to your collector. Now, selecting 10 agents at the time and running the “Disable Audit Collection” task–in case you did not know, there’s a limitation on how many agents you can run a task on in the Operations Console–is not my idea of a jolly good day and since Powershell is a bucket of joy in comparison; here’s a script for you all!</p>\n<p><a href=\"http://teknoglotse.nfshost.com/wp-content/uploads/2011/07/DisableACSForwarders.zip\" target=\"_blank\" rel=\"external\">DisableACSForwarders</a></p>\n<p>It is zipped to avoid security alerts, but as with any script found on the internet I implore to to read the code before actually running it.</p>\n<p>Anyway, you can use it in a couple of ways.</p>\n<p>To run it interactively, just go to the directory where you unpacked it and run it. You will be requested to enter the FQDN of you Root Management Server and a wildcard search for ACS Forwarders.<br>For example:</p>\n<figure class=\"highlight powershell\"><figcaption><span>C:\\..\\Scripts> .\\DisableACSForwarders.ps1</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">Root Management Server: rms.teknoglot.local</span><br><span class=\"line\">ACS Forwarder name (wildcard): *.teknoglot.local</span><br></pre></td></tr></table></figure>\n<p>You can also run it with parameters (for scheduling?) like this:</p>\n<figure class=\"highlight powershell\"><figcaption><span>C:\\..\\Scripts> .\\DisableACSForwarders.ps1 rms.teknoglot.local *.teknoglot.local```</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">If</span> you need to run the task with different credentials there<span class=\"string\">'s a switch for that. Just add -UseCredentials to the command and you will be prompted for it.</span><br><span class=\"line\">Like this:</span><br><span class=\"line\"></span><br><span class=\"line\">```powershell C:\\..\\Scripts&gt; .\\DisableACSForwarders.ps1 -UseCredentials</span></span><br></pre></td></tr></table></figure>\n<p>As you might already have realized, the wildcard search does not require actual wildcards. If you only want to disable the ACS forwarder on a single machine, just enter it’s FQDN. As for what wildcards it will accept; <a href=\"http://msdn.microsoft.com/en-us/library/aa717088%28VS.85%29.aspx\" title=\"Supporting Wildcard Characters in Cmdlet Parameters\" target=\"_blank\" rel=\"external\">anything supported by the powershell -like operator</a> is valid.</p>\n<p>[UPDATE!] You might get false failures when running the script on clustered machines because of a <a href=\"https://connect.microsoft.com/OpsMgr/feedback/details/523453/bug-with-microsoft-audit-collection-services-management-pack\" title=\"Bug with Microsoft Audit Collection Services Management Pack\" target=\"_blank\" rel=\"external\">bug in the AC Management Pack</a></p>\n<p>For the source code, read on!</p>\n<!--more-->\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## Using parameters for RMS and wildcard search</span></span><br><span class=\"line\"><span class=\"keyword\">param</span>(</span><br><span class=\"line\"> [string]<span class=\"variable\">$rootManagementServer</span> = $(<span class=\"built_in\">Read-Host</span> -Prompt <span class=\"string\">\";Root Management Server\"</span>;),</span><br><span class=\"line\"> [string]<span class=\"variable\">$filterAgents</span> = $(<span class=\"built_in\">Read-Host</span> -Prompt <span class=\"string\">\";ACS Forwarder name (wildcard)\"</span>;),</span><br><span class=\"line\"> [switch]<span class=\"variable\">$UseCredentials</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## Make sure the $rootManagementServer variable is defined</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"nomarkup\">-not</span> <span class=\"variable\">$rootManagementServer</span>) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`nRoot Management Server MUST be defined!\"</span>; -ForegroundColor Red</span><br><span class=\"line\"> [string]<span class=\"variable\">$rootManagementServer</span> = $(<span class=\"built_in\">Read-Host</span> -Prompt <span class=\"string\">\";Root Management Server\"</span>;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$UseCredentials</span> <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$true</span>) &#123;</span><br><span class=\"line\"> <span class=\"variable\">$taskCredentials</span> = <span class=\"built_in\">Get-Credential</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$startLocation</span> = <span class=\"built_in\">Get-Location</span></span><br><span class=\"line\"><span class=\"variable\">$checkPSSnapin</span> = <span class=\"built_in\">Get-PSSnapin</span> | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">\";Microsoft.EnterpriseManagement.OperationsManager.Client\"</span>;&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$checkPSSnapin</span> <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$null</span>) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Add-PSSnapin</span> <span class=\"string\">\";Microsoft.EnterpriseManagement.OperationsManager.Client\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$result</span> = <span class=\"built_in\">Set-Location</span> <span class=\"string\">\";OperationsManagerMonitoring::\"</span>;</span><br><span class=\"line\"><span class=\"variable\">$result</span> = New-ManagementGroupConnection -ConnectionString:<span class=\"variable\">$rootManagementServer</span></span><br><span class=\"line\"><span class=\"variable\">$result</span> = <span class=\"built_in\">Set-Location</span> <span class=\"variable\">$rootManagementServer</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$acsForwarderClass</span> = Get-MonitoringClass -Name <span class=\"string\">\";Microsoft.SystemCenter.ACS.Forwarder\"</span>;</span><br><span class=\"line\"><span class=\"variable\">$agentNames</span> = Get-MonitoringObject -monitoringclass:<span class=\"variable\">$acsForwarderClass</span> | where &#123;<span class=\"variable\">$_</span>.Path <span class=\"nomarkup\">-like</span> <span class=\"variable\">$filterAgents</span>&#125; | Select Path</span><br><span class=\"line\"><span class=\"variable\">$successfulTasks</span> = @()</span><br><span class=\"line\"><span class=\"variable\">$skippedTasks</span> = @()</span><br><span class=\"line\"><span class=\"variable\">$failedTasks</span> = @()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$monitoringClass</span> = Get-MonitoringClass -Name <span class=\"string\">\";Microsoft.SystemCenter.Agent\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$agentNames</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`nFound\"</span>;<span class=\"variable\">$agentNames</span>.Count<span class=\"string\">\";ACS forwarders with wildcard <span class=\"variable\">$filterAgents</span>\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`n`nWaiting for 5 seconds to give you a chance to abort!`n\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">5</span></span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Time's UP!`n`n\"</span>;</span><br><span class=\"line\"> <span class=\"variable\">$agentNames</span> | <span class=\"built_in\">ForEach-Object</span> &#123;</span><br><span class=\"line\"> <span class=\"variable\">$agentName</span> = <span class=\"variable\">$_</span>.Path</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Disabling Audit Collection on\"</span>; <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> <span class=\"variable\">$monitoringObject</span> = Get-MonitoringObject -monitoringclass:<span class=\"variable\">$monitoringClass</span> | where &#123;<span class=\"variable\">$_</span>.DisplayName <span class=\"nomarkup\">-like</span> <span class=\"variable\">$agentName</span>&#125;</span><br><span class=\"line\"> <span class=\"variable\">$agentTask</span> = <span class=\"variable\">$monitoringObject</span> | Get-Task | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">\";Microsoft.SystemCenter.DisableAuditCollectionService\"</span>;&#125;</span><br><span class=\"line\"> <span class=\"keyword\">if</span> (<span class=\"variable\">$monitoringObject</span>.IsAvailable <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$true</span>) &#123;</span><br><span class=\"line\"> <span class=\"keyword\">if</span> (<span class=\"variable\">$credentials</span> <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$null</span>) &#123;</span><br><span class=\"line\"> <span class=\"variable\">$result</span> = Start-Task -Task <span class=\"variable\">$agentTask</span> -TargetMonitoringObject <span class=\"variable\">$monitoringObject</span></span><br><span class=\"line\"> &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"variable\">$result</span> = Start-Task -Task <span class=\"variable\">$agentTask</span> -TargetMonitoringObject <span class=\"variable\">$monitoringObject</span> -Credential <span class=\"variable\">$taskCredentials</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"keyword\">if</span> (<span class=\"variable\">$result</span>.Status <span class=\"nomarkup\">-eq</span> <span class=\"string\">\";Succeeded\"</span>;) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Operation Successful!\"</span>; -ForegroundColor Green</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> `n</span><br><span class=\"line\"> <span class=\"variable\">$successfulTasks</span> += <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Operation failed.\"</span>; -ForegroundColor Red</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"variable\">$result</span>.ErrorMessage</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> `n</span><br><span class=\"line\"> <span class=\"variable\">$failedTasks</span> += <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";The agent is unavailable, Skipping!\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> `n</span><br><span class=\"line\"> <span class=\"variable\">$skippedTasks</span> += <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Summary\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`tSuccessful:`t\"</span>;<span class=\"variable\">$successfulTasks</span>.count</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`tFailed:`t`t\"</span>;<span class=\"variable\">$failedTasks</span>.count</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`tSkipped:`t\"</span>;<span class=\"variable\">$skippedTasks</span>.count</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`nNo ACS Forwarders found using wildcard <span class=\"variable\">$filterAgents</span>\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Set-Location</span> <span class=\"variable\">$startLocation</span></span><br></pre></td></tr></table></figure>\n<p>Enjoy!</p>\n","excerpt":"<p>Here’s a little something-something for the wicked.</p>\n<p>Me and my apprentice is currently decommissioning an entire Management Group with a thousand (-ish) agents. Long story short, we got a new Management Group, migrated all the agents, added a couple of hundreds more, deployed a bunch of gateways and now we are shutting down the old one.</p>\n<p>Now, uninstalling the old Management Group from all the agents is a breeze using SCCM and handling the few 20-ish servers that are left is not a biggie either. Shutting down ACS, however, is a different matter.</p>","more":"<p>Although you do configure your forwarders using Operations Manager, removing the management group you were running ACS in does not mean the agents will shut down and disable the AdtAgent service or stop trying to forward audit events to your collector. Now, selecting 10 agents at the time and running the “Disable Audit Collection” task–in case you did not know, there’s a limitation on how many agents you can run a task on in the Operations Console–is not my idea of a jolly good day and since Powershell is a bucket of joy in comparison; here’s a script for you all!</p>\n<p><a href=\"http://teknoglotse.nfshost.com/wp-content/uploads/2011/07/DisableACSForwarders.zip\">DisableACSForwarders</a></p>\n<p>It is zipped to avoid security alerts, but as with any script found on the internet I implore to to read the code before actually running it.</p>\n<p>Anyway, you can use it in a couple of ways.</p>\n<p>To run it interactively, just go to the directory where you unpacked it and run it. You will be requested to enter the FQDN of you Root Management Server and a wildcard search for ACS Forwarders.<br>For example:</p>\n<figure class=\"highlight powershell\"><figcaption><span>C:\\..\\Scripts> .\\DisableACSForwarders.ps1</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">Root Management Server: rms.teknoglot.local</span><br><span class=\"line\">ACS Forwarder name (wildcard): *.teknoglot.local</span><br></pre></td></tr></table></figure>\n<p>You can also run it with parameters (for scheduling?) like this:</p>\n<figure class=\"highlight powershell\"><figcaption><span>C:\\..\\Scripts> .\\DisableACSForwarders.ps1 rms.teknoglot.local *.teknoglot.local```</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">If</span> you need to run the task with different credentials there<span class=\"string\">'s a switch for that. Just add -UseCredentials to the command and you will be prompted for it.</span><br><span class=\"line\">Like this:</span><br><span class=\"line\"></span><br><span class=\"line\">```powershell C:\\..\\Scripts&gt; .\\DisableACSForwarders.ps1 -UseCredentials</span></span><br></pre></td></tr></table></figure>\n<p>As you might already have realized, the wildcard search does not require actual wildcards. If you only want to disable the ACS forwarder on a single machine, just enter it’s FQDN. As for what wildcards it will accept; <a href=\"http://msdn.microsoft.com/en-us/library/aa717088%28VS.85%29.aspx\" title=\"Supporting Wildcard Characters in Cmdlet Parameters\">anything supported by the powershell -like operator</a> is valid.</p>\n<p>[UPDATE!] You might get false failures when running the script on clustered machines because of a <a href=\"https://connect.microsoft.com/OpsMgr/feedback/details/523453/bug-with-microsoft-audit-collection-services-management-pack\" title=\"Bug with Microsoft Audit Collection Services Management Pack\">bug in the AC Management Pack</a></p>\n<p>For the source code, read on!</p>\n<!--more-->\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## Using parameters for RMS and wildcard search</span></span><br><span class=\"line\"><span class=\"keyword\">param</span>(</span><br><span class=\"line\"> [string]<span class=\"variable\">$rootManagementServer</span> = $(<span class=\"built_in\">Read-Host</span> -Prompt <span class=\"string\">\";Root Management Server\"</span>;),</span><br><span class=\"line\"> [string]<span class=\"variable\">$filterAgents</span> = $(<span class=\"built_in\">Read-Host</span> -Prompt <span class=\"string\">\";ACS Forwarder name (wildcard)\"</span>;),</span><br><span class=\"line\"> [switch]<span class=\"variable\">$UseCredentials</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## Make sure the $rootManagementServer variable is defined</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"nomarkup\">-not</span> <span class=\"variable\">$rootManagementServer</span>) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`nRoot Management Server MUST be defined!\"</span>; -ForegroundColor Red</span><br><span class=\"line\"> [string]<span class=\"variable\">$rootManagementServer</span> = $(<span class=\"built_in\">Read-Host</span> -Prompt <span class=\"string\">\";Root Management Server\"</span>;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$UseCredentials</span> <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$true</span>) &#123;</span><br><span class=\"line\"> <span class=\"variable\">$taskCredentials</span> = <span class=\"built_in\">Get-Credential</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$startLocation</span> = <span class=\"built_in\">Get-Location</span></span><br><span class=\"line\"><span class=\"variable\">$checkPSSnapin</span> = <span class=\"built_in\">Get-PSSnapin</span> | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">\";Microsoft.EnterpriseManagement.OperationsManager.Client\"</span>;&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$checkPSSnapin</span> <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$null</span>) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Add-PSSnapin</span> <span class=\"string\">\";Microsoft.EnterpriseManagement.OperationsManager.Client\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$result</span> = <span class=\"built_in\">Set-Location</span> <span class=\"string\">\";OperationsManagerMonitoring::\"</span>;</span><br><span class=\"line\"><span class=\"variable\">$result</span> = New-ManagementGroupConnection -ConnectionString:<span class=\"variable\">$rootManagementServer</span></span><br><span class=\"line\"><span class=\"variable\">$result</span> = <span class=\"built_in\">Set-Location</span> <span class=\"variable\">$rootManagementServer</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$acsForwarderClass</span> = Get-MonitoringClass -Name <span class=\"string\">\";Microsoft.SystemCenter.ACS.Forwarder\"</span>;</span><br><span class=\"line\"><span class=\"variable\">$agentNames</span> = Get-MonitoringObject -monitoringclass:<span class=\"variable\">$acsForwarderClass</span> | where &#123;<span class=\"variable\">$_</span>.Path <span class=\"nomarkup\">-like</span> <span class=\"variable\">$filterAgents</span>&#125; | Select Path</span><br><span class=\"line\"><span class=\"variable\">$successfulTasks</span> = @()</span><br><span class=\"line\"><span class=\"variable\">$skippedTasks</span> = @()</span><br><span class=\"line\"><span class=\"variable\">$failedTasks</span> = @()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$monitoringClass</span> = Get-MonitoringClass -Name <span class=\"string\">\";Microsoft.SystemCenter.Agent\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$agentNames</span> <span class=\"nomarkup\">-ne</span> <span class=\"literal\">$null</span>) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`nFound\"</span>;<span class=\"variable\">$agentNames</span>.Count<span class=\"string\">\";ACS forwarders with wildcard <span class=\"variable\">$filterAgents</span>\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`n`nWaiting for 5 seconds to give you a chance to abort!`n\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">5</span></span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Time's UP!`n`n\"</span>;</span><br><span class=\"line\"> <span class=\"variable\">$agentNames</span> | <span class=\"built_in\">ForEach-Object</span> &#123;</span><br><span class=\"line\"> <span class=\"variable\">$agentName</span> = <span class=\"variable\">$_</span>.Path</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Disabling Audit Collection on\"</span>; <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> <span class=\"variable\">$monitoringObject</span> = Get-MonitoringObject -monitoringclass:<span class=\"variable\">$monitoringClass</span> | where &#123;<span class=\"variable\">$_</span>.DisplayName <span class=\"nomarkup\">-like</span> <span class=\"variable\">$agentName</span>&#125;</span><br><span class=\"line\"> <span class=\"variable\">$agentTask</span> = <span class=\"variable\">$monitoringObject</span> | Get-Task | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">\";Microsoft.SystemCenter.DisableAuditCollectionService\"</span>;&#125;</span><br><span class=\"line\"> <span class=\"keyword\">if</span> (<span class=\"variable\">$monitoringObject</span>.IsAvailable <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$true</span>) &#123;</span><br><span class=\"line\"> <span class=\"keyword\">if</span> (<span class=\"variable\">$credentials</span> <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$null</span>) &#123;</span><br><span class=\"line\"> <span class=\"variable\">$result</span> = Start-Task -Task <span class=\"variable\">$agentTask</span> -TargetMonitoringObject <span class=\"variable\">$monitoringObject</span></span><br><span class=\"line\"> &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"variable\">$result</span> = Start-Task -Task <span class=\"variable\">$agentTask</span> -TargetMonitoringObject <span class=\"variable\">$monitoringObject</span> -Credential <span class=\"variable\">$taskCredentials</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"keyword\">if</span> (<span class=\"variable\">$result</span>.Status <span class=\"nomarkup\">-eq</span> <span class=\"string\">\";Succeeded\"</span>;) &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Operation Successful!\"</span>; -ForegroundColor Green</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> `n</span><br><span class=\"line\"> <span class=\"variable\">$successfulTasks</span> += <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Operation failed.\"</span>; -ForegroundColor Red</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"variable\">$result</span>.ErrorMessage</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> `n</span><br><span class=\"line\"> <span class=\"variable\">$failedTasks</span> += <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";The agent is unavailable, Skipping!\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> `n</span><br><span class=\"line\"> <span class=\"variable\">$skippedTasks</span> += <span class=\"variable\">$agentName</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";Summary\"</span>;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`tSuccessful:`t\"</span>;<span class=\"variable\">$successfulTasks</span>.count</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`tFailed:`t`t\"</span>;<span class=\"variable\">$failedTasks</span>.count</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`tSkipped:`t\"</span>;<span class=\"variable\">$skippedTasks</span>.count</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"built_in\">Write-Host</span> <span class=\"string\">\";`nNo ACS Forwarders found using wildcard <span class=\"variable\">$filterAgents</span>\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Set-Location</span> <span class=\"variable\">$startLocation</span></span><br></pre></td></tr></table></figure>\n<p>Enjoy!</p>"},{"title":"Cannot Delete Files with Long Paths?","id":"171","date":"2009-10-21T07:39:17.000Z","_content":"\nWhat do you do when you cannot delete a file or folder on a windows server?\n\nCheck the file permissions! And if that doesn’t help?\n\nCheck the share permissions! Yes, if it is a shared folder. And if that doesn’t help?\n\nCheck the file ownership! Great! But then what?\n\nWell, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like “lpt1” or “PRN”) or even an invalid name (silly things like a space in the beginning or the end of a filename).\nAnother possible reason could actually be that the path to the file or folder is too long. You won’t actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple “Acces Denied”.\n\nThere are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like “dokume~1.doc”) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this.\n\n1. Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way.\nThis is particularly useful if the folder you are trying to access a <acronym title=\"Distributed File System\">DFS</acronym>-share or perhaps a share on the central fileserver filepaths like “\\servername01Central ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers2.2.1 Auto-Deploying SQL-Server 2005 ClusterDocumentsPreparationsWhitepapersSQL Server 2005 Failover Clustering White Paper.doc”\n2. Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on “D:FilesharesCentral ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers” called “Autodeploymethods” and access it from “\\SRV01Autodeploymethods”. That way the filepath doesn’t exceed 255 characters.\nNow. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full <acronym title=\"Fully Qualified Domain Name\">FQDN</acronym> too, and not only the actual folder structure. Many big corporations I know uses “codes” for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database.\n\nI have only seen this phenomena on Windows systems so far, and I’ve actually used a linux Live-CD on occasion when admin access is denied.\n> Read More:\n> [http://support.microsoft.com/kb/320081](http://support.microsoft.com/kb/320081)","source":"_posts/cannot-delete-files-with-long-paths.md","raw":"---\ntitle: Cannot Delete Files with Long Paths?\ntags:\n  - Errors\n  - KB\n  - Windows\n  - Windows 2008\n  - Windows Vista\n  - Windows XP\nid: 171\ncategories:\n  - Microsoft\n  - Windows\ndate: 2009-10-21 09:39:17\n---\n\nWhat do you do when you cannot delete a file or folder on a windows server?\n\nCheck the file permissions! And if that doesn’t help?\n\nCheck the share permissions! Yes, if it is a shared folder. And if that doesn’t help?\n\nCheck the file ownership! Great! But then what?\n\nWell, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like “lpt1” or “PRN”) or even an invalid name (silly things like a space in the beginning or the end of a filename).\nAnother possible reason could actually be that the path to the file or folder is too long. You won’t actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple “Acces Denied”.\n\nThere are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like “dokume~1.doc”) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this.\n\n1. Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way.\nThis is particularly useful if the folder you are trying to access a <acronym title=\"Distributed File System\">DFS</acronym>-share or perhaps a share on the central fileserver filepaths like “\\servername01Central ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers2.2.1 Auto-Deploying SQL-Server 2005 ClusterDocumentsPreparationsWhitepapersSQL Server 2005 Failover Clustering White Paper.doc”\n2. Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on “D:FilesharesCentral ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers” called “Autodeploymethods” and access it from “\\SRV01Autodeploymethods”. That way the filepath doesn’t exceed 255 characters.\nNow. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full <acronym title=\"Fully Qualified Domain Name\">FQDN</acronym> too, and not only the actual folder structure. Many big corporations I know uses “codes” for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database.\n\nI have only seen this phenomena on Windows systems so far, and I’ve actually used a linux Live-CD on occasion when admin access is denied.\n> Read More:\n> [http://support.microsoft.com/kb/320081](http://support.microsoft.com/kb/320081)","slug":"cannot-delete-files-with-long-paths","published":1,"updated":"2016-05-24T22:04:33.779Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gi0008q4o2o5uvyk7u","content":"<p>What do you do when you cannot delete a file or folder on a windows server?</p>\n<p>Check the file permissions! And if that doesn’t help?</p>\n<p>Check the share permissions! Yes, if it is a shared folder. And if that doesn’t help?</p>\n<p>Check the file ownership! Great! But then what?</p>\n<p>Well, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like “lpt1” or “PRN”) or even an invalid name (silly things like a space in the beginning or the end of a filename).<br>Another possible reason could actually be that the path to the file or folder is too long. You won’t actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple “Acces Denied”.</p>\n<p>There are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like “dokume~1.doc”) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this.</p>\n<ol>\n<li>Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way.<br>This is particularly useful if the folder you are trying to access a <acronym title=\"Distributed File System\">DFS</acronym>-share or perhaps a share on the central fileserver filepaths like “\\servername01Central ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers2.2.1 Auto-Deploying SQL-Server 2005 ClusterDocumentsPreparationsWhitepapersSQL Server 2005 Failover Clustering White Paper.doc”</li>\n<li>Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on “D:FilesharesCentral ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers” called “Autodeploymethods” and access it from “\\SRV01Autodeploymethods”. That way the filepath doesn’t exceed 255 characters.<br>Now. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full <acronym title=\"Fully Qualified Domain Name\">FQDN</acronym> too, and not only the actual folder structure. Many big corporations I know uses “codes” for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database.</li>\n</ol>\n<p>I have only seen this phenomena on Windows systems so far, and I’ve actually used a linux Live-CD on occasion when admin access is denied.</p>\n<blockquote>\n<p>Read More:<br><a href=\"http://support.microsoft.com/kb/320081\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/320081</a></p>\n</blockquote>\n","excerpt":"","more":"<p>What do you do when you cannot delete a file or folder on a windows server?</p>\n<p>Check the file permissions! And if that doesn’t help?</p>\n<p>Check the share permissions! Yes, if it is a shared folder. And if that doesn’t help?</p>\n<p>Check the file ownership! Great! But then what?</p>\n<p>Well, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like “lpt1” or “PRN”) or even an invalid name (silly things like a space in the beginning or the end of a filename).<br>Another possible reason could actually be that the path to the file or folder is too long. You won’t actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple “Acces Denied”.</p>\n<p>There are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like “dokume~1.doc”) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this.</p>\n<ol>\n<li>Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way.<br>This is particularly useful if the folder you are trying to access a <acronym title=\"Distributed File System\">DFS</acronym>-share or perhaps a share on the central fileserver filepaths like “\\servername01Central ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers2.2.1 Auto-Deploying SQL-Server 2005 ClusterDocumentsPreparationsWhitepapersSQL Server 2005 Failover Clustering White Paper.doc”</li>\n<li>Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on “D:FilesharesCentral ProjectsCentral ServicesIT DepartmentDevelop Methods for Automatically Deploying New Central Servers” called “Autodeploymethods” and access it from “\\SRV01Autodeploymethods”. That way the filepath doesn’t exceed 255 characters.<br>Now. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full <acronym title=\"Fully Qualified Domain Name\">FQDN</acronym> too, and not only the actual folder structure. Many big corporations I know uses “codes” for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database.</li>\n</ol>\n<p>I have only seen this phenomena on Windows systems so far, and I’ve actually used a linux Live-CD on occasion when admin access is denied.</p>\n<blockquote>\n<p>Read More:<br><a href=\"http://support.microsoft.com/kb/320081\">http://support.microsoft.com/kb/320081</a></p>\n</blockquote>\n"},{"title":"Change Gateway Powershell Script","id":"261","date":"2010-03-31T13:27:08.000Z","_content":"\nThis script has pretty much already been covered in my previous post about [Changing or Replacing an Operations Manager Gateway Server](http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/).\n\nThis time I’ve basically put parameter support in it to make it easier to use.\n\nHere’s the script anyway.\n\n```powershell\nParam($OldGW,$NewGW)\n\n$OldMS= Get-ManagementServer | where {$_.Name -eq $OldGW}\n$NewMS = Get-ManagementServer | where {$_.Name -eq $NewGW}\n$agents = Get-Agent | where {$_.PrimaryManagementServerName -eq $OldGW}\n$agents = $agents\n\"Moving \" + $agents.count + \" agents from \" + $OldMS.Name + \" to \" + $NewMS.Name\nStart-Sleep -m 200\nSet-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $NewMS -FailoverServer: $OldMS\n```\n\nTo use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:Scripts) for easy access. If you don't feel like copy/pasting, you can [download the script here](http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/attachment/changegw/).\n\nTo use it, open the Operations Manager Command Shell and type:\n`C:\\ScriptsChangeGW.ps1 <old.gatewayserver.dns.name> <new.gatewayserver.dns.name>`\n\nFor example:\n\n```powershell\nC:\\ScriptsChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local\n```","source":"_posts/change-gateway-powershell-script.md","raw":"---\ntitle: Change Gateway Powershell Script\ntags:\n  - OpsMgr\n  - PoSH\n  - Script\nid: 261\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2010-03-31 15:27:08\n---\n\nThis script has pretty much already been covered in my previous post about [Changing or Replacing an Operations Manager Gateway Server](http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/).\n\nThis time I’ve basically put parameter support in it to make it easier to use.\n\nHere’s the script anyway.\n\n```powershell\nParam($OldGW,$NewGW)\n\n$OldMS= Get-ManagementServer | where {$_.Name -eq $OldGW}\n$NewMS = Get-ManagementServer | where {$_.Name -eq $NewGW}\n$agents = Get-Agent | where {$_.PrimaryManagementServerName -eq $OldGW}\n$agents = $agents\n\"Moving \" + $agents.count + \" agents from \" + $OldMS.Name + \" to \" + $NewMS.Name\nStart-Sleep -m 200\nSet-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $NewMS -FailoverServer: $OldMS\n```\n\nTo use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:Scripts) for easy access. If you don't feel like copy/pasting, you can [download the script here](http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/attachment/changegw/).\n\nTo use it, open the Operations Manager Command Shell and type:\n`C:\\ScriptsChangeGW.ps1 <old.gatewayserver.dns.name> <new.gatewayserver.dns.name>`\n\nFor example:\n\n```powershell\nC:\\ScriptsChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local\n```","slug":"change-gateway-powershell-script","published":1,"updated":"2016-05-24T22:03:32.015Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gk000aq4o29p4tnie6","content":"<p>This script has pretty much already been covered in my previous post about <a href=\"http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/\">Changing or Replacing an Operations Manager Gateway Server</a>.</p>\n<p>This time I’ve basically put parameter support in it to make it easier to use.</p>\n<p>Here’s the script anyway.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Param</span>(<span class=\"variable\">$OldGW</span>,<span class=\"variable\">$NewGW</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$OldMS</span>= Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$OldGW</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$NewMS</span> = Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$NewGW</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$agents</span> = Get-Agent | where &#123;<span class=\"variable\">$_</span>.PrimaryManagementServerName <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$OldGW</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$agents</span> = <span class=\"variable\">$agents</span></span><br><span class=\"line\"><span class=\"string\">\"Moving \"</span> + <span class=\"variable\">$agents</span>.count + <span class=\"string\">\" agents from \"</span> + <span class=\"variable\">$OldMS</span>.Name + <span class=\"string\">\" to \"</span> + <span class=\"variable\">$NewMS</span>.Name</span><br><span class=\"line\"><span class=\"built_in\">Start-Sleep</span> -m <span class=\"number\">200</span></span><br><span class=\"line\">Set-ManagementServer -AgentManagedComputer: <span class=\"variable\">$agents</span> -PrimaryManagementServer: <span class=\"variable\">$NewMS</span> -FailoverServer: <span class=\"variable\">$OldMS</span></span><br></pre></td></tr></table></figure>\n<p>To use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:Scripts) for easy access. If you don’t feel like copy/pasting, you can <a href=\"http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/attachment/changegw/\">download the script here</a>.</p>\n<p>To use it, open the Operations Manager Command Shell and type:<br><code>C:\\ScriptsChangeGW.ps1 &lt;old.gatewayserver.dns.name&gt; &lt;new.gatewayserver.dns.name&gt;</code></p>\n<p>For example:</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">C:\\ScriptsChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local</span><br></pre></td></tr></table></figure>","excerpt":"","more":"<p>This script has pretty much already been covered in my previous post about <a href=\"http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/\">Changing or Replacing an Operations Manager Gateway Server</a>.</p>\n<p>This time I’ve basically put parameter support in it to make it easier to use.</p>\n<p>Here’s the script anyway.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Param</span>(<span class=\"variable\">$OldGW</span>,<span class=\"variable\">$NewGW</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$OldMS</span>= Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$OldGW</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$NewMS</span> = Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$NewGW</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$agents</span> = Get-Agent | where &#123;<span class=\"variable\">$_</span>.PrimaryManagementServerName <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$OldGW</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$agents</span> = <span class=\"variable\">$agents</span></span><br><span class=\"line\"><span class=\"string\">\"Moving \"</span> + <span class=\"variable\">$agents</span>.count + <span class=\"string\">\" agents from \"</span> + <span class=\"variable\">$OldMS</span>.Name + <span class=\"string\">\" to \"</span> + <span class=\"variable\">$NewMS</span>.Name</span><br><span class=\"line\"><span class=\"built_in\">Start-Sleep</span> -m <span class=\"number\">200</span></span><br><span class=\"line\">Set-ManagementServer -AgentManagedComputer: <span class=\"variable\">$agents</span> -PrimaryManagementServer: <span class=\"variable\">$NewMS</span> -FailoverServer: <span class=\"variable\">$OldMS</span></span><br></pre></td></tr></table></figure>\n<p>To use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:Scripts) for easy access. If you don’t feel like copy/pasting, you can <a href=\"http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/attachment/changegw/\">download the script here</a>.</p>\n<p>To use it, open the Operations Manager Command Shell and type:<br><code>C:\\ScriptsChangeGW.ps1 &lt;old.gatewayserver.dns.name&gt; &lt;new.gatewayserver.dns.name&gt;</code></p>\n<p>For example:</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">C:\\ScriptsChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local</span><br></pre></td></tr></table></figure>"},{"title":"Clearing Disabled Discovery in OpsMgr 2007","id":"16","date":"2009-04-20T08:15:15.000Z","_content":"\nJonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion.\n\nRead more about it at [Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject](http://blogs.technet.com/jonathanalmquist/archive/2008/09/14/remove-disabledmonitoringobject.aspx \"Remove-DisabledMonitoringObject\").","source":"_posts/clearing-disabled-discovery.md","raw":"---\ntitle: Clearing Disabled Discovery in OpsMgr 2007\ntags:\n  - How-To\n  - OpsMgr\n  - Script\nid: 16\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-04-20 10:15:15\n---\n\nJonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion.\n\nRead more about it at [Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject](http://blogs.technet.com/jonathanalmquist/archive/2008/09/14/remove-disabledmonitoringobject.aspx \"Remove-DisabledMonitoringObject\").","slug":"clearing-disabled-discovery","published":1,"updated":"2016-05-24T22:01:59.117Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gm000bq4o2a9pa3dvd","content":"<p>Jonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion.</p>\n<p>Read more about it at <a href=\"http://blogs.technet.com/jonathanalmquist/archive/2008/09/14/remove-disabledmonitoringobject.aspx\" title=\"Remove-DisabledMonitoringObject\" target=\"_blank\" rel=\"external\">Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject</a>.</p>\n","excerpt":"","more":"<p>Jonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion.</p>\n<p>Read more about it at <a href=\"http://blogs.technet.com/jonathanalmquist/archive/2008/09/14/remove-disabledmonitoringobject.aspx\" title=\"Remove-DisabledMonitoringObject\">Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject</a>.</p>\n"},{"title":"Cloudflare as Dynamic DNS [#cloudflare #mikrotik #script]","id":"796","date":"2014-08-25T11:37:36.000Z","_content":"\n# Background\n\nI have, for a time, been using [CloudFlare](http://www.cloudflare.com \"CloudFlare Website\") for CDN, Optimizations and DNS Management for this and a few other domains. At the same time, I've been using [DynDNS](http://www.dyn.com \"Dyn DNS\") to provide name resolution to my home network/lab. Browsing around the [CloudFlare JSON API](https://www.cloudflare.com/docs/client-api.html \"CloudFlare Client Api\") I noticed that I can update DNS records through some fairly simple HTTP GET requests, and since the RouterOS (the operating system used by [Mikrotik's](http://www.mikrotik.com/ \"Mikrotik Website\") routerboards) has support for some pretty decent scripting I decided to let my router update CloudFlare for some custom and free dynamic DNS resolution.\n\n# Attribution\n\nMy current script is a modified version of a script developed by Konstantin Antselovich.\n\nOriginal script: [http://konstant1n.livejournal.com/9759.html](http://konstant1n.livejournal.com/9759.html \"Random Journal\")\n\nOriginal Author website: [http://konstantin.antselovich.com/](http://konstantin.antselovich.com/ \"Konstantin Antselovich\")\n\nThanks!\n\n# How you do it\n\n## What you need\n\n* RouterOS v6+ for HTTPS support\n* Cloudflare API key, aka \"Token\", found at the [account page](https://www.cloudflare.com/my-account \"CloudFlare Account Page\")\n* Cloudflare DNS Zone name\n* Cloudflare Record Id (more on that later)\n* Cloudflare subdomain name\n* Name of the external router interface\n\n<!--more-->\n\n## Getting the Record Id\n\nTo get the record id of the DNS record you want to update, I used the _[rec_load_all](https://www.cloudflare.com/docs/client-api.html#s3.3 \"rec_load_all - Get all DNS Records\")_ function of the API. And since I'm a windows admin, I use powershell for that.\n\n```powershell\n$cfDomain = \"homelab\"\n$cfToken = \"<your API Key/Token>\"\n$cfZone = \"example.com\"\n$cfEmail = \"<your CF email address>\"\n$apiLoadAllRecordsURI = \"https://www.cloudflare.com/api_json.html?a=rec_load_all&tkn=$cfToken&email=$cfEmail&z=$cfZone\"\n$restRequest = Invoke-RestMethod -Uri $apiLoadAllRecordsURI\n$restRequest.response.recs.objs | ?{$_.display_name -eq $cfDomain} | fl -Property rec_id,name,display_name,type,ttl,service_mode\n```\n\nThat should, given that you've replaced all the example variables produce something like this:\n\n```text\nrec_id : 16606003\nname : homelab.example.com\ndisplay_name : homelab\ntype : A\nttl : 1\nservice_mode : 0\n```\n\nAnd with that done, you should have everything necessary for the RouterOS script.\n\n## Building the Script\n\nI'm not going to go into the [syntax of ros scripts](http://wiki.mikrotik.com/wiki/Manual:Scripting \"RouterOS Scripting Manual\"), but I'll try to explain the different building block to some degree.\n\n### Defining our variables\n\nFirst, we'll define out variables used for the script. The global _$hostname_ variable is actually redundant as I could derive the FQDN from  _$CFDomain_ and _$CFZone_, but it's used in other scripts in my router so it's included for that purpose alone.\n\n```text\n######## Set and collect general variables #########\n:global hostname \"homelab.example.com\"\n:global resolvedIP \"\"\n:global externalIP \"\"\n:global WANInterface \"eth1-ext-internet\"\n\n######## Set CloudFlare variables #################\n:local CFemail \"<same email as in the powershell script\"\n:local CFtkn \"<your API key/token>\"\n:local CFzone \"example.com\"\n:local CFid \"16606003\"\n:local CFtype \"A\"\n:local CFttl \"1\"\n:local CFservicemode \"0\"\n:local CFDomain \"homelab\"\n:local CFDebug \"true\"\n```\n\nTake care to verify and compare the CFxx variables with the ones used in and received from the previous powershell script, but also the _$hostname_ variable.\n\n* hostname: Used in the script to lookup the currently set IP-address.\n* WANInterface: The list name of the external interface, used to find the external IP-address.\n* CFemail: Your CloudFlare Login email.\n* CFtkn: Your API Key/Token.\n* CFzone: Your DNS Zone.\n* CFid: The rec_id from the powershell script.\n* CFtype: A for IPv4 host records, AAAA for IPv6.\n* CFttl: Record time-to-live, use \"1\" for automatic.\n* CFservicemode: Use \"0\" for direct traffic or \"1\" to go through their CDN, Optimizations and Security features. I recommend \"0\" for anything but websites.\n* CFDomain: Subdomain or rather hostname for your router.\n* CFDebug: Use \"True\" to print some informational stuff to the router logs.\n\n### Resolve IP-addresses\n\nNext, we resolve two IP-addresses. First one, _$externalIP_, is the routers current external address. And the second, _$resolvedIP_, is the address currently set for our _$hostname_.\n\n```text\n######## Resolve and set IP-variables ##########\n:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];\n:set externalIP [:pick $currentIP 0 [:find $currentIP \"/\"]];\n:set resolvedIP [:resolve $hostname];\n```\n\n### Build CF API Request and log debug info\n\nNow, build the URI for the API call from our variables.\n\n```text\n######## Build CF API Url #########################\n:local CFurl \"https://www.cloudflare.com/api_json.html\\3F\"\n:set CFurl ($CFurl . \"a=rec_edit&tkn=$CFtkn&id=$CFid\");\n:set CFurl ($CFurl . \"&email=$CFemail&z=$CFzone&type=$CFtype\");\n:set CFurl ($CFurl . \"&name=$CFDomain&service_mode=$CFservicemode&ttl=$CFttl\");\n```\n\nAnd if the _$CFdebug_ variable is set to \"true\", write a little info to the router log.\n\n```text\n######## Write debug info to log #################\n:if ($CFDebug = \"true\") do={\n:log info (\"CF: hostname = $hostname\")\n:log info (\"CF: resolvedIP = $resolvedIP\")\n:log info (\"CF: currentIP = $currentIP\")\n:log info (\"CF: externalIP = $externalIP\")\n:log info (\"CF: CFurl = $CFurl&content=$externalIP\")\n};\n```\n\n### Compare and Update\n\nLast step is to compare _$externalIP_ with _$resolvedIP_. If they don't match, our external IP-address has been changed and we need to update the DNS record. To execute the HTTP GET request we use a RouterOS tool called [fetch](http://wiki.mikrotik.com/wiki/Fetch \"Mikrotik Manual: Fetch\") to which we pass the _$CFurl_ variable. The reason this will not work before RouterOS v6+ is that before that there was no support for HTTPS, and CloudFlare does not accept unencrypted traffic for their APIs.\n\nThe script block is pretty straight-forward. Compare, update, flush local DNS-cache and write to the log.\n\n```text\n######## Compare and update CF if necessary #####\n:if ($resolvedIP != $externalIP) do={\n:log info (\"CF: Updating CF, setting $CFDomain = $externalIP\")\n/tool fetch mode=https url=\"$CFurl&content=$externalIP\" keep-result=no\n/ip dns cache flush\n} else={\n:log info \"CF: No Update Needed!\"\n}\n```\n\n### Permissions/Policies\n\nThis part, I'm not entirely sure on. The script needs to do name resolution, read settings and set variables and it works for me with these policies configured:\n\n* Read\n* Write\n* Test\n* Sniff\n* Sensitive\n\nIt might be over-doing it a bit, but I have not had occasion to fiddle with them yet.\n\n### Scheduling\n\nI have this script scheduled to run once every 20 minutes. As it will only try to update the DNS records if there is a difference between them and the current external IP-address I feel fairly sure that I won't be tagged as a spammer or something by CloudFlare.\n\nThe schedule is configured with:\n\n* Start Time: startup\n* Interval: 00:20:00\n* On Event: ```/system script run <Name of your script>```\n* Policy: Read,Write, Test, Sniff, Sensitive\n\nThis schedule is also a good place for a [hairpin](http://wiki.mikrotik.com/wiki/Hairpin_NAT \"Mikrotik Wiki: Hairpin NAT\") update if it's needed.\n\n# The Copy-Paste part\n\nNow, obviously, at least make sure you proof-read the script before putting it into production. I am not a network dude, and I rarely dabble with ROS scripts. I am certain that anyone with a bit more experience could create a smarter, prettier version of this script, so **use at your own risk**. Anyway, here's the script in it's entirety.\n\n```text\n######## Set and collect general variables #########\n:global hostname \"homelab.example.com\"\n:global resolvedIP \"\"\n:global externalIP \"\"\n:global WANInterface \"eth1-ext-internet\"\n\n######## Set CloudFlare variables #################\n:local CFemail \"<same email as in the powershell script\"\n:local CFtkn \"<your API key/token>\"\n:local CFzone \"example.com\"\n:local CFid \"16606003\"\n:local CFtype \"A\"\n:local CFttl \"1\"\n:local CFservicemode \"0\"\n:local CFDomain \"homelab\"\n:local CFDebug \"true\"\n\n######## Resolve and set IP-variables ##########\n:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];\n:set externalIP [:pick $currentIP 0 [:find $currentIP \"/\"]];\n:set resolvedIP [:resolve $hostname];\n\n######## Build CF API Url #########################\n:local CFurl \"https://www.cloudflare.com/api_json.html\\3F\"\n:set CFurl ($CFurl . \"a=rec_edit&tkn=$CFtkn&id=$CFid\");\n:set CFurl ($CFurl . \"&email=$CFemail&z=$CFzone&type=$CFtype\");\n:set CFurl ($CFurl . \"&name=$CFDomain&service_mode=$CFservicemode&ttl=$CFttl\");\n\n######## Write debug info to log #################\n:if ($CFDebug = \"true\") do={\n:log info (\"CF: hostname = $hostname\")\n:log info (\"CF: resolvedIP = $resolvedIP\")\n:log info (\"CF: currentIP = $currentIP\")\n:log info (\"CF: externalIP = $externalIP\")\n:log info (\"CF: CFurl = $CFurl&content=$externalIP\")\n};\n\n######## Compare and update CF if necessary #####\n:if ($resolvedIP != $externalIP) do={\n:log info (\"CF: Updating CF, setting $CFDomain = $externalIP\")\n/tool fetch mode=https url=\"$CFurl&content=$externalIP\" keep-result=no\n/ip dns cache flush\n} else={\n:log info \"CF: No Update Needed!\"\n}\n```\n","source":"_posts/cloudflare-dynamic-dns-mikrotik.md","raw":"---\ntitle: 'Cloudflare as Dynamic DNS [#cloudflare #mikrotik #script]'\ntags:\n  - DNS\n  - Invoke-RestMethod\n  - Mikrotik\n  - PoSH\n  - RouterOS\n  - Script\nid: 796\ncategories:\n  - Mikrotik\ndate: 2014-08-25 13:37:36\n---\n\n# Background\n\nI have, for a time, been using [CloudFlare](http://www.cloudflare.com \"CloudFlare Website\") for CDN, Optimizations and DNS Management for this and a few other domains. At the same time, I've been using [DynDNS](http://www.dyn.com \"Dyn DNS\") to provide name resolution to my home network/lab. Browsing around the [CloudFlare JSON API](https://www.cloudflare.com/docs/client-api.html \"CloudFlare Client Api\") I noticed that I can update DNS records through some fairly simple HTTP GET requests, and since the RouterOS (the operating system used by [Mikrotik's](http://www.mikrotik.com/ \"Mikrotik Website\") routerboards) has support for some pretty decent scripting I decided to let my router update CloudFlare for some custom and free dynamic DNS resolution.\n\n# Attribution\n\nMy current script is a modified version of a script developed by Konstantin Antselovich.\n\nOriginal script: [http://konstant1n.livejournal.com/9759.html](http://konstant1n.livejournal.com/9759.html \"Random Journal\")\n\nOriginal Author website: [http://konstantin.antselovich.com/](http://konstantin.antselovich.com/ \"Konstantin Antselovich\")\n\nThanks!\n\n# How you do it\n\n## What you need\n\n* RouterOS v6+ for HTTPS support\n* Cloudflare API key, aka \"Token\", found at the [account page](https://www.cloudflare.com/my-account \"CloudFlare Account Page\")\n* Cloudflare DNS Zone name\n* Cloudflare Record Id (more on that later)\n* Cloudflare subdomain name\n* Name of the external router interface\n\n<!--more-->\n\n## Getting the Record Id\n\nTo get the record id of the DNS record you want to update, I used the _[rec_load_all](https://www.cloudflare.com/docs/client-api.html#s3.3 \"rec_load_all - Get all DNS Records\")_ function of the API. And since I'm a windows admin, I use powershell for that.\n\n```powershell\n$cfDomain = \"homelab\"\n$cfToken = \"<your API Key/Token>\"\n$cfZone = \"example.com\"\n$cfEmail = \"<your CF email address>\"\n$apiLoadAllRecordsURI = \"https://www.cloudflare.com/api_json.html?a=rec_load_all&tkn=$cfToken&email=$cfEmail&z=$cfZone\"\n$restRequest = Invoke-RestMethod -Uri $apiLoadAllRecordsURI\n$restRequest.response.recs.objs | ?{$_.display_name -eq $cfDomain} | fl -Property rec_id,name,display_name,type,ttl,service_mode\n```\n\nThat should, given that you've replaced all the example variables produce something like this:\n\n```text\nrec_id : 16606003\nname : homelab.example.com\ndisplay_name : homelab\ntype : A\nttl : 1\nservice_mode : 0\n```\n\nAnd with that done, you should have everything necessary for the RouterOS script.\n\n## Building the Script\n\nI'm not going to go into the [syntax of ros scripts](http://wiki.mikrotik.com/wiki/Manual:Scripting \"RouterOS Scripting Manual\"), but I'll try to explain the different building block to some degree.\n\n### Defining our variables\n\nFirst, we'll define out variables used for the script. The global _$hostname_ variable is actually redundant as I could derive the FQDN from  _$CFDomain_ and _$CFZone_, but it's used in other scripts in my router so it's included for that purpose alone.\n\n```text\n######## Set and collect general variables #########\n:global hostname \"homelab.example.com\"\n:global resolvedIP \"\"\n:global externalIP \"\"\n:global WANInterface \"eth1-ext-internet\"\n\n######## Set CloudFlare variables #################\n:local CFemail \"<same email as in the powershell script\"\n:local CFtkn \"<your API key/token>\"\n:local CFzone \"example.com\"\n:local CFid \"16606003\"\n:local CFtype \"A\"\n:local CFttl \"1\"\n:local CFservicemode \"0\"\n:local CFDomain \"homelab\"\n:local CFDebug \"true\"\n```\n\nTake care to verify and compare the CFxx variables with the ones used in and received from the previous powershell script, but also the _$hostname_ variable.\n\n* hostname: Used in the script to lookup the currently set IP-address.\n* WANInterface: The list name of the external interface, used to find the external IP-address.\n* CFemail: Your CloudFlare Login email.\n* CFtkn: Your API Key/Token.\n* CFzone: Your DNS Zone.\n* CFid: The rec_id from the powershell script.\n* CFtype: A for IPv4 host records, AAAA for IPv6.\n* CFttl: Record time-to-live, use \"1\" for automatic.\n* CFservicemode: Use \"0\" for direct traffic or \"1\" to go through their CDN, Optimizations and Security features. I recommend \"0\" for anything but websites.\n* CFDomain: Subdomain or rather hostname for your router.\n* CFDebug: Use \"True\" to print some informational stuff to the router logs.\n\n### Resolve IP-addresses\n\nNext, we resolve two IP-addresses. First one, _$externalIP_, is the routers current external address. And the second, _$resolvedIP_, is the address currently set for our _$hostname_.\n\n```text\n######## Resolve and set IP-variables ##########\n:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];\n:set externalIP [:pick $currentIP 0 [:find $currentIP \"/\"]];\n:set resolvedIP [:resolve $hostname];\n```\n\n### Build CF API Request and log debug info\n\nNow, build the URI for the API call from our variables.\n\n```text\n######## Build CF API Url #########################\n:local CFurl \"https://www.cloudflare.com/api_json.html\\3F\"\n:set CFurl ($CFurl . \"a=rec_edit&tkn=$CFtkn&id=$CFid\");\n:set CFurl ($CFurl . \"&email=$CFemail&z=$CFzone&type=$CFtype\");\n:set CFurl ($CFurl . \"&name=$CFDomain&service_mode=$CFservicemode&ttl=$CFttl\");\n```\n\nAnd if the _$CFdebug_ variable is set to \"true\", write a little info to the router log.\n\n```text\n######## Write debug info to log #################\n:if ($CFDebug = \"true\") do={\n:log info (\"CF: hostname = $hostname\")\n:log info (\"CF: resolvedIP = $resolvedIP\")\n:log info (\"CF: currentIP = $currentIP\")\n:log info (\"CF: externalIP = $externalIP\")\n:log info (\"CF: CFurl = $CFurl&content=$externalIP\")\n};\n```\n\n### Compare and Update\n\nLast step is to compare _$externalIP_ with _$resolvedIP_. If they don't match, our external IP-address has been changed and we need to update the DNS record. To execute the HTTP GET request we use a RouterOS tool called [fetch](http://wiki.mikrotik.com/wiki/Fetch \"Mikrotik Manual: Fetch\") to which we pass the _$CFurl_ variable. The reason this will not work before RouterOS v6+ is that before that there was no support for HTTPS, and CloudFlare does not accept unencrypted traffic for their APIs.\n\nThe script block is pretty straight-forward. Compare, update, flush local DNS-cache and write to the log.\n\n```text\n######## Compare and update CF if necessary #####\n:if ($resolvedIP != $externalIP) do={\n:log info (\"CF: Updating CF, setting $CFDomain = $externalIP\")\n/tool fetch mode=https url=\"$CFurl&content=$externalIP\" keep-result=no\n/ip dns cache flush\n} else={\n:log info \"CF: No Update Needed!\"\n}\n```\n\n### Permissions/Policies\n\nThis part, I'm not entirely sure on. The script needs to do name resolution, read settings and set variables and it works for me with these policies configured:\n\n* Read\n* Write\n* Test\n* Sniff\n* Sensitive\n\nIt might be over-doing it a bit, but I have not had occasion to fiddle with them yet.\n\n### Scheduling\n\nI have this script scheduled to run once every 20 minutes. As it will only try to update the DNS records if there is a difference between them and the current external IP-address I feel fairly sure that I won't be tagged as a spammer or something by CloudFlare.\n\nThe schedule is configured with:\n\n* Start Time: startup\n* Interval: 00:20:00\n* On Event: ```/system script run <Name of your script>```\n* Policy: Read,Write, Test, Sniff, Sensitive\n\nThis schedule is also a good place for a [hairpin](http://wiki.mikrotik.com/wiki/Hairpin_NAT \"Mikrotik Wiki: Hairpin NAT\") update if it's needed.\n\n# The Copy-Paste part\n\nNow, obviously, at least make sure you proof-read the script before putting it into production. I am not a network dude, and I rarely dabble with ROS scripts. I am certain that anyone with a bit more experience could create a smarter, prettier version of this script, so **use at your own risk**. Anyway, here's the script in it's entirety.\n\n```text\n######## Set and collect general variables #########\n:global hostname \"homelab.example.com\"\n:global resolvedIP \"\"\n:global externalIP \"\"\n:global WANInterface \"eth1-ext-internet\"\n\n######## Set CloudFlare variables #################\n:local CFemail \"<same email as in the powershell script\"\n:local CFtkn \"<your API key/token>\"\n:local CFzone \"example.com\"\n:local CFid \"16606003\"\n:local CFtype \"A\"\n:local CFttl \"1\"\n:local CFservicemode \"0\"\n:local CFDomain \"homelab\"\n:local CFDebug \"true\"\n\n######## Resolve and set IP-variables ##########\n:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];\n:set externalIP [:pick $currentIP 0 [:find $currentIP \"/\"]];\n:set resolvedIP [:resolve $hostname];\n\n######## Build CF API Url #########################\n:local CFurl \"https://www.cloudflare.com/api_json.html\\3F\"\n:set CFurl ($CFurl . \"a=rec_edit&tkn=$CFtkn&id=$CFid\");\n:set CFurl ($CFurl . \"&email=$CFemail&z=$CFzone&type=$CFtype\");\n:set CFurl ($CFurl . \"&name=$CFDomain&service_mode=$CFservicemode&ttl=$CFttl\");\n\n######## Write debug info to log #################\n:if ($CFDebug = \"true\") do={\n:log info (\"CF: hostname = $hostname\")\n:log info (\"CF: resolvedIP = $resolvedIP\")\n:log info (\"CF: currentIP = $currentIP\")\n:log info (\"CF: externalIP = $externalIP\")\n:log info (\"CF: CFurl = $CFurl&content=$externalIP\")\n};\n\n######## Compare and update CF if necessary #####\n:if ($resolvedIP != $externalIP) do={\n:log info (\"CF: Updating CF, setting $CFDomain = $externalIP\")\n/tool fetch mode=https url=\"$CFurl&content=$externalIP\" keep-result=no\n/ip dns cache flush\n} else={\n:log info \"CF: No Update Needed!\"\n}\n```\n","slug":"cloudflare-dynamic-dns-mikrotik","published":1,"updated":"2016-05-24T22:01:48.874Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gt000eq4o2dfdhzozn","content":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>I have, for a time, been using <a href=\"http://www.cloudflare.com\" title=\"CloudFlare Website\" target=\"_blank\" rel=\"external\">CloudFlare</a> for CDN, Optimizations and DNS Management for this and a few other domains. At the same time, I’ve been using <a href=\"http://www.dyn.com\" title=\"Dyn DNS\" target=\"_blank\" rel=\"external\">DynDNS</a> to provide name resolution to my home network/lab. Browsing around the <a href=\"https://www.cloudflare.com/docs/client-api.html\" title=\"CloudFlare Client Api\" target=\"_blank\" rel=\"external\">CloudFlare JSON API</a> I noticed that I can update DNS records through some fairly simple HTTP GET requests, and since the RouterOS (the operating system used by <a href=\"http://www.mikrotik.com/\" title=\"Mikrotik Website\" target=\"_blank\" rel=\"external\">Mikrotik’s</a> routerboards) has support for some pretty decent scripting I decided to let my router update CloudFlare for some custom and free dynamic DNS resolution.</p>\n<h1 id=\"Attribution\"><a href=\"#Attribution\" class=\"headerlink\" title=\"Attribution\"></a>Attribution</h1><p>My current script is a modified version of a script developed by Konstantin Antselovich.</p>\n<p>Original script: <a href=\"http://konstant1n.livejournal.com/9759.html\" title=\"Random Journal\" target=\"_blank\" rel=\"external\">http://konstant1n.livejournal.com/9759.html</a></p>\n<p>Original Author website: <a href=\"http://konstantin.antselovich.com/\" title=\"Konstantin Antselovich\" target=\"_blank\" rel=\"external\">http://konstantin.antselovich.com/</a></p>\n<p>Thanks!</p>\n<h1 id=\"How-you-do-it\"><a href=\"#How-you-do-it\" class=\"headerlink\" title=\"How you do it\"></a>How you do it</h1><h2 id=\"What-you-need\"><a href=\"#What-you-need\" class=\"headerlink\" title=\"What you need\"></a>What you need</h2><ul>\n<li>RouterOS v6+ for HTTPS support</li>\n<li>Cloudflare API key, aka “Token”, found at the <a href=\"https://www.cloudflare.com/my-account\" title=\"CloudFlare Account Page\" target=\"_blank\" rel=\"external\">account page</a></li>\n<li>Cloudflare DNS Zone name</li>\n<li>Cloudflare Record Id (more on that later)</li>\n<li>Cloudflare subdomain name</li>\n<li>Name of the external router interface</li>\n</ul>\n<a id=\"more\"></a>\n<h2 id=\"Getting-the-Record-Id\"><a href=\"#Getting-the-Record-Id\" class=\"headerlink\" title=\"Getting the Record Id\"></a>Getting the Record Id</h2><p>To get the record id of the DNS record you want to update, I used the _<a href=\"https://www.cloudflare.com/docs/client-api.html#s3.3\" title=\"rec_load_all - Get all DNS Records\" target=\"_blank\" rel=\"external\">rec_load_all</a>_ function of the API. And since I’m a windows admin, I use powershell for that.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$cfDomain</span> = <span class=\"string\">\"homelab\"</span></span><br><span class=\"line\"><span class=\"variable\">$cfToken</span> = <span class=\"string\">\"&lt;your API Key/Token&gt;\"</span></span><br><span class=\"line\"><span class=\"variable\">$cfZone</span> = <span class=\"string\">\"example.com\"</span></span><br><span class=\"line\"><span class=\"variable\">$cfEmail</span> = <span class=\"string\">\"&lt;your CF email address&gt;\"</span></span><br><span class=\"line\"><span class=\"variable\">$apiLoadAllRecordsURI</span> = <span class=\"string\">\"https://www.cloudflare.com/api_json.html?a=rec_load_all&amp;tkn=<span class=\"variable\">$cfToken</span>&amp;email=<span class=\"variable\">$cfEmail</span>&amp;z=<span class=\"variable\">$cfZone</span>\"</span></span><br><span class=\"line\"><span class=\"variable\">$restRequest</span> = <span class=\"built_in\">Invoke-RestMethod</span> -Uri <span class=\"variable\">$apiLoadAllRecordsURI</span></span><br><span class=\"line\"><span class=\"variable\">$restRequest</span>.response.recs.objs | ?&#123;<span class=\"variable\">$_</span>.display_name <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$cfDomain</span>&#125; | fl -Property rec_id,name,display_name,type,ttl,service_mode</span><br></pre></td></tr></table></figure>\n<p>That should, given that you’ve replaced all the example variables produce something like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">rec_id : 16606003</span><br><span class=\"line\">name : homelab.example.com</span><br><span class=\"line\">display_name : homelab</span><br><span class=\"line\">type : A</span><br><span class=\"line\">ttl : 1</span><br><span class=\"line\">service_mode : 0</span><br></pre></td></tr></table></figure>\n<p>And with that done, you should have everything necessary for the RouterOS script.</p>\n<h2 id=\"Building-the-Script\"><a href=\"#Building-the-Script\" class=\"headerlink\" title=\"Building the Script\"></a>Building the Script</h2><p>I’m not going to go into the <a href=\"http://wiki.mikrotik.com/wiki/Manual:Scripting\" title=\"RouterOS Scripting Manual\" target=\"_blank\" rel=\"external\">syntax of ros scripts</a>, but I’ll try to explain the different building block to some degree.</p>\n<h3 id=\"Defining-our-variables\"><a href=\"#Defining-our-variables\" class=\"headerlink\" title=\"Defining our variables\"></a>Defining our variables</h3><p>First, we’ll define out variables used for the script. The global <em>$hostname</em> variable is actually redundant as I could derive the FQDN from  <em>$CFDomain</em> and <em>$CFZone</em>, but it’s used in other scripts in my router so it’s included for that purpose alone.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Set and collect general variables #########</span><br><span class=\"line\">:global hostname &quot;homelab.example.com&quot;</span><br><span class=\"line\">:global resolvedIP &quot;&quot;</span><br><span class=\"line\">:global externalIP &quot;&quot;</span><br><span class=\"line\">:global WANInterface &quot;eth1-ext-internet&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Set CloudFlare variables #################</span><br><span class=\"line\">:local CFemail &quot;&lt;same email as in the powershell script&quot;</span><br><span class=\"line\">:local CFtkn &quot;&lt;your API key/token&gt;&quot;</span><br><span class=\"line\">:local CFzone &quot;example.com&quot;</span><br><span class=\"line\">:local CFid &quot;16606003&quot;</span><br><span class=\"line\">:local CFtype &quot;A&quot;</span><br><span class=\"line\">:local CFttl &quot;1&quot;</span><br><span class=\"line\">:local CFservicemode &quot;0&quot;</span><br><span class=\"line\">:local CFDomain &quot;homelab&quot;</span><br><span class=\"line\">:local CFDebug &quot;true&quot;</span><br></pre></td></tr></table></figure>\n<p>Take care to verify and compare the CFxx variables with the ones used in and received from the previous powershell script, but also the <em>$hostname</em> variable.</p>\n<ul>\n<li>hostname: Used in the script to lookup the currently set IP-address.</li>\n<li>WANInterface: The list name of the external interface, used to find the external IP-address.</li>\n<li>CFemail: Your CloudFlare Login email.</li>\n<li>CFtkn: Your API Key/Token.</li>\n<li>CFzone: Your DNS Zone.</li>\n<li>CFid: The rec_id from the powershell script.</li>\n<li>CFtype: A for IPv4 host records, AAAA for IPv6.</li>\n<li>CFttl: Record time-to-live, use “1” for automatic.</li>\n<li>CFservicemode: Use “0” for direct traffic or “1” to go through their CDN, Optimizations and Security features. I recommend “0” for anything but websites.</li>\n<li>CFDomain: Subdomain or rather hostname for your router.</li>\n<li>CFDebug: Use “True” to print some informational stuff to the router logs.</li>\n</ul>\n<h3 id=\"Resolve-IP-addresses\"><a href=\"#Resolve-IP-addresses\" class=\"headerlink\" title=\"Resolve IP-addresses\"></a>Resolve IP-addresses</h3><p>Next, we resolve two IP-addresses. First one, <em>$externalIP</em>, is the routers current external address. And the second, <em>$resolvedIP</em>, is the address currently set for our <em>$hostname</em>.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Resolve and set IP-variables ##########</span><br><span class=\"line\">:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];</span><br><span class=\"line\">:set externalIP [:pick $currentIP 0 [:find $currentIP &quot;/&quot;]];</span><br><span class=\"line\">:set resolvedIP [:resolve $hostname];</span><br></pre></td></tr></table></figure>\n<h3 id=\"Build-CF-API-Request-and-log-debug-info\"><a href=\"#Build-CF-API-Request-and-log-debug-info\" class=\"headerlink\" title=\"Build CF API Request and log debug info\"></a>Build CF API Request and log debug info</h3><p>Now, build the URI for the API call from our variables.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Build CF API Url #########################</span><br><span class=\"line\">:local CFurl &quot;https://www.cloudflare.com/api_json.html\\3F&quot;</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;a=rec_edit&amp;tkn=$CFtkn&amp;id=$CFid&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;email=$CFemail&amp;z=$CFzone&amp;type=$CFtype&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;name=$CFDomain&amp;service_mode=$CFservicemode&amp;ttl=$CFttl&quot;);</span><br></pre></td></tr></table></figure>\n<p>And if the <em>$CFdebug</em> variable is set to “true”, write a little info to the router log.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Write debug info to log #################</span><br><span class=\"line\">:if ($CFDebug = &quot;true&quot;) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: hostname = $hostname&quot;)</span><br><span class=\"line\">:log info (&quot;CF: resolvedIP = $resolvedIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: currentIP = $currentIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: externalIP = $externalIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: CFurl = $CFurl&amp;content=$externalIP&quot;)</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Compare-and-Update\"><a href=\"#Compare-and-Update\" class=\"headerlink\" title=\"Compare and Update\"></a>Compare and Update</h3><p>Last step is to compare <em>$externalIP</em> with <em>$resolvedIP</em>. If they don’t match, our external IP-address has been changed and we need to update the DNS record. To execute the HTTP GET request we use a RouterOS tool called <a href=\"http://wiki.mikrotik.com/wiki/Fetch\" title=\"Mikrotik Manual: Fetch\" target=\"_blank\" rel=\"external\">fetch</a> to which we pass the <em>$CFurl</em> variable. The reason this will not work before RouterOS v6+ is that before that there was no support for HTTPS, and CloudFlare does not accept unencrypted traffic for their APIs.</p>\n<p>The script block is pretty straight-forward. Compare, update, flush local DNS-cache and write to the log.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Compare and update CF if necessary #####</span><br><span class=\"line\">:if ($resolvedIP != $externalIP) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: Updating CF, setting $CFDomain = $externalIP&quot;)</span><br><span class=\"line\">/tool fetch mode=https url=&quot;$CFurl&amp;content=$externalIP&quot; keep-result=no</span><br><span class=\"line\">/ip dns cache flush</span><br><span class=\"line\">&#125; else=&#123;</span><br><span class=\"line\">:log info &quot;CF: No Update Needed!&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Permissions-Policies\"><a href=\"#Permissions-Policies\" class=\"headerlink\" title=\"Permissions/Policies\"></a>Permissions/Policies</h3><p>This part, I’m not entirely sure on. The script needs to do name resolution, read settings and set variables and it works for me with these policies configured:</p>\n<ul>\n<li>Read</li>\n<li>Write</li>\n<li>Test</li>\n<li>Sniff</li>\n<li>Sensitive</li>\n</ul>\n<p>It might be over-doing it a bit, but I have not had occasion to fiddle with them yet.</p>\n<h3 id=\"Scheduling\"><a href=\"#Scheduling\" class=\"headerlink\" title=\"Scheduling\"></a>Scheduling</h3><p>I have this script scheduled to run once every 20 minutes. As it will only try to update the DNS records if there is a difference between them and the current external IP-address I feel fairly sure that I won’t be tagged as a spammer or something by CloudFlare.</p>\n<p>The schedule is configured with:</p>\n<ul>\n<li>Start Time: startup</li>\n<li>Interval: 00:20:00</li>\n<li>On Event: <figure class=\"highlight plain\"><figcaption><span>script run <name of=\"\" your=\"\" script=\"\">```</name></span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">* Policy: Read,Write, Test, Sniff, Sensitive</span><br><span class=\"line\"></span><br><span class=\"line\">This schedule is also a good place for a [hairpin](http://wiki.mikrotik.com/wiki/Hairpin_NAT &quot;Mikrotik Wiki: Hairpin NAT&quot;) update if it&apos;s needed.</span><br><span class=\"line\"></span><br><span class=\"line\"># The Copy-Paste part</span><br><span class=\"line\"></span><br><span class=\"line\">Now, obviously, at least make sure you proof-read the script before putting it into production. I am not a network dude, and I rarely dabble with ROS scripts. I am certain that anyone with a bit more experience could create a smarter, prettier version of this script, so **use at your own risk**. Anyway, here&apos;s the script in it&apos;s entirety.</span><br><span class=\"line\"></span><br><span class=\"line\">```text</span><br><span class=\"line\">######## Set and collect general variables #########</span><br><span class=\"line\">:global hostname &quot;homelab.example.com&quot;</span><br><span class=\"line\">:global resolvedIP &quot;&quot;</span><br><span class=\"line\">:global externalIP &quot;&quot;</span><br><span class=\"line\">:global WANInterface &quot;eth1-ext-internet&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Set CloudFlare variables #################</span><br><span class=\"line\">:local CFemail &quot;&lt;same email as in the powershell script&quot;</span><br><span class=\"line\">:local CFtkn &quot;&lt;your API key/token&gt;&quot;</span><br><span class=\"line\">:local CFzone &quot;example.com&quot;</span><br><span class=\"line\">:local CFid &quot;16606003&quot;</span><br><span class=\"line\">:local CFtype &quot;A&quot;</span><br><span class=\"line\">:local CFttl &quot;1&quot;</span><br><span class=\"line\">:local CFservicemode &quot;0&quot;</span><br><span class=\"line\">:local CFDomain &quot;homelab&quot;</span><br><span class=\"line\">:local CFDebug &quot;true&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Resolve and set IP-variables ##########</span><br><span class=\"line\">:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];</span><br><span class=\"line\">:set externalIP [:pick $currentIP 0 [:find $currentIP &quot;/&quot;]];</span><br><span class=\"line\">:set resolvedIP [:resolve $hostname];</span><br><span class=\"line\"></span><br><span class=\"line\">######## Build CF API Url #########################</span><br><span class=\"line\">:local CFurl &quot;https://www.cloudflare.com/api_json.html\\3F&quot;</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;a=rec_edit&amp;tkn=$CFtkn&amp;id=$CFid&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;email=$CFemail&amp;z=$CFzone&amp;type=$CFtype&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;name=$CFDomain&amp;service_mode=$CFservicemode&amp;ttl=$CFttl&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">######## Write debug info to log #################</span><br><span class=\"line\">:if ($CFDebug = &quot;true&quot;) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: hostname = $hostname&quot;)</span><br><span class=\"line\">:log info (&quot;CF: resolvedIP = $resolvedIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: currentIP = $currentIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: externalIP = $externalIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: CFurl = $CFurl&amp;content=$externalIP&quot;)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Compare and update CF if necessary #####</span><br><span class=\"line\">:if ($resolvedIP != $externalIP) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: Updating CF, setting $CFDomain = $externalIP&quot;)</span><br><span class=\"line\">/tool fetch mode=https url=&quot;$CFurl&amp;content=$externalIP&quot; keep-result=no</span><br><span class=\"line\">/ip dns cache flush</span><br><span class=\"line\">&#125; else=&#123;</span><br><span class=\"line\">:log info &quot;CF: No Update Needed!&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n","excerpt":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>I have, for a time, been using <a href=\"http://www.cloudflare.com\" title=\"CloudFlare Website\">CloudFlare</a> for CDN, Optimizations and DNS Management for this and a few other domains. At the same time, I’ve been using <a href=\"http://www.dyn.com\" title=\"Dyn DNS\">DynDNS</a> to provide name resolution to my home network/lab. Browsing around the <a href=\"https://www.cloudflare.com/docs/client-api.html\" title=\"CloudFlare Client Api\">CloudFlare JSON API</a> I noticed that I can update DNS records through some fairly simple HTTP GET requests, and since the RouterOS (the operating system used by <a href=\"http://www.mikrotik.com/\" title=\"Mikrotik Website\">Mikrotik’s</a> routerboards) has support for some pretty decent scripting I decided to let my router update CloudFlare for some custom and free dynamic DNS resolution.</p>\n<h1 id=\"Attribution\"><a href=\"#Attribution\" class=\"headerlink\" title=\"Attribution\"></a>Attribution</h1><p>My current script is a modified version of a script developed by Konstantin Antselovich.</p>\n<p>Original script: <a href=\"http://konstant1n.livejournal.com/9759.html\" title=\"Random Journal\">http://konstant1n.livejournal.com/9759.html</a></p>\n<p>Original Author website: <a href=\"http://konstantin.antselovich.com/\" title=\"Konstantin Antselovich\">http://konstantin.antselovich.com/</a></p>\n<p>Thanks!</p>\n<h1 id=\"How-you-do-it\"><a href=\"#How-you-do-it\" class=\"headerlink\" title=\"How you do it\"></a>How you do it</h1><h2 id=\"What-you-need\"><a href=\"#What-you-need\" class=\"headerlink\" title=\"What you need\"></a>What you need</h2><ul>\n<li>RouterOS v6+ for HTTPS support</li>\n<li>Cloudflare API key, aka “Token”, found at the <a href=\"https://www.cloudflare.com/my-account\" title=\"CloudFlare Account Page\">account page</a></li>\n<li>Cloudflare DNS Zone name</li>\n<li>Cloudflare Record Id (more on that later)</li>\n<li>Cloudflare subdomain name</li>\n<li>Name of the external router interface</li>\n</ul>","more":"<h2 id=\"Getting-the-Record-Id\"><a href=\"#Getting-the-Record-Id\" class=\"headerlink\" title=\"Getting the Record Id\"></a>Getting the Record Id</h2><p>To get the record id of the DNS record you want to update, I used the _<a href=\"https://www.cloudflare.com/docs/client-api.html#s3.3\" title=\"rec_load_all - Get all DNS Records\">rec_load_all</a>_ function of the API. And since I’m a windows admin, I use powershell for that.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$cfDomain</span> = <span class=\"string\">\"homelab\"</span></span><br><span class=\"line\"><span class=\"variable\">$cfToken</span> = <span class=\"string\">\"&lt;your API Key/Token&gt;\"</span></span><br><span class=\"line\"><span class=\"variable\">$cfZone</span> = <span class=\"string\">\"example.com\"</span></span><br><span class=\"line\"><span class=\"variable\">$cfEmail</span> = <span class=\"string\">\"&lt;your CF email address&gt;\"</span></span><br><span class=\"line\"><span class=\"variable\">$apiLoadAllRecordsURI</span> = <span class=\"string\">\"https://www.cloudflare.com/api_json.html?a=rec_load_all&amp;tkn=<span class=\"variable\">$cfToken</span>&amp;email=<span class=\"variable\">$cfEmail</span>&amp;z=<span class=\"variable\">$cfZone</span>\"</span></span><br><span class=\"line\"><span class=\"variable\">$restRequest</span> = <span class=\"built_in\">Invoke-RestMethod</span> -Uri <span class=\"variable\">$apiLoadAllRecordsURI</span></span><br><span class=\"line\"><span class=\"variable\">$restRequest</span>.response.recs.objs | ?&#123;<span class=\"variable\">$_</span>.display_name <span class=\"nomarkup\">-eq</span> <span class=\"variable\">$cfDomain</span>&#125; | fl -Property rec_id,name,display_name,type,ttl,service_mode</span><br></pre></td></tr></table></figure>\n<p>That should, given that you’ve replaced all the example variables produce something like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">rec_id : 16606003</span><br><span class=\"line\">name : homelab.example.com</span><br><span class=\"line\">display_name : homelab</span><br><span class=\"line\">type : A</span><br><span class=\"line\">ttl : 1</span><br><span class=\"line\">service_mode : 0</span><br></pre></td></tr></table></figure>\n<p>And with that done, you should have everything necessary for the RouterOS script.</p>\n<h2 id=\"Building-the-Script\"><a href=\"#Building-the-Script\" class=\"headerlink\" title=\"Building the Script\"></a>Building the Script</h2><p>I’m not going to go into the <a href=\"http://wiki.mikrotik.com/wiki/Manual:Scripting\" title=\"RouterOS Scripting Manual\">syntax of ros scripts</a>, but I’ll try to explain the different building block to some degree.</p>\n<h3 id=\"Defining-our-variables\"><a href=\"#Defining-our-variables\" class=\"headerlink\" title=\"Defining our variables\"></a>Defining our variables</h3><p>First, we’ll define out variables used for the script. The global <em>$hostname</em> variable is actually redundant as I could derive the FQDN from  <em>$CFDomain</em> and <em>$CFZone</em>, but it’s used in other scripts in my router so it’s included for that purpose alone.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Set and collect general variables #########</span><br><span class=\"line\">:global hostname &quot;homelab.example.com&quot;</span><br><span class=\"line\">:global resolvedIP &quot;&quot;</span><br><span class=\"line\">:global externalIP &quot;&quot;</span><br><span class=\"line\">:global WANInterface &quot;eth1-ext-internet&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Set CloudFlare variables #################</span><br><span class=\"line\">:local CFemail &quot;&lt;same email as in the powershell script&quot;</span><br><span class=\"line\">:local CFtkn &quot;&lt;your API key/token&gt;&quot;</span><br><span class=\"line\">:local CFzone &quot;example.com&quot;</span><br><span class=\"line\">:local CFid &quot;16606003&quot;</span><br><span class=\"line\">:local CFtype &quot;A&quot;</span><br><span class=\"line\">:local CFttl &quot;1&quot;</span><br><span class=\"line\">:local CFservicemode &quot;0&quot;</span><br><span class=\"line\">:local CFDomain &quot;homelab&quot;</span><br><span class=\"line\">:local CFDebug &quot;true&quot;</span><br></pre></td></tr></table></figure>\n<p>Take care to verify and compare the CFxx variables with the ones used in and received from the previous powershell script, but also the <em>$hostname</em> variable.</p>\n<ul>\n<li>hostname: Used in the script to lookup the currently set IP-address.</li>\n<li>WANInterface: The list name of the external interface, used to find the external IP-address.</li>\n<li>CFemail: Your CloudFlare Login email.</li>\n<li>CFtkn: Your API Key/Token.</li>\n<li>CFzone: Your DNS Zone.</li>\n<li>CFid: The rec_id from the powershell script.</li>\n<li>CFtype: A for IPv4 host records, AAAA for IPv6.</li>\n<li>CFttl: Record time-to-live, use “1” for automatic.</li>\n<li>CFservicemode: Use “0” for direct traffic or “1” to go through their CDN, Optimizations and Security features. I recommend “0” for anything but websites.</li>\n<li>CFDomain: Subdomain or rather hostname for your router.</li>\n<li>CFDebug: Use “True” to print some informational stuff to the router logs.</li>\n</ul>\n<h3 id=\"Resolve-IP-addresses\"><a href=\"#Resolve-IP-addresses\" class=\"headerlink\" title=\"Resolve IP-addresses\"></a>Resolve IP-addresses</h3><p>Next, we resolve two IP-addresses. First one, <em>$externalIP</em>, is the routers current external address. And the second, <em>$resolvedIP</em>, is the address currently set for our <em>$hostname</em>.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Resolve and set IP-variables ##########</span><br><span class=\"line\">:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];</span><br><span class=\"line\">:set externalIP [:pick $currentIP 0 [:find $currentIP &quot;/&quot;]];</span><br><span class=\"line\">:set resolvedIP [:resolve $hostname];</span><br></pre></td></tr></table></figure>\n<h3 id=\"Build-CF-API-Request-and-log-debug-info\"><a href=\"#Build-CF-API-Request-and-log-debug-info\" class=\"headerlink\" title=\"Build CF API Request and log debug info\"></a>Build CF API Request and log debug info</h3><p>Now, build the URI for the API call from our variables.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Build CF API Url #########################</span><br><span class=\"line\">:local CFurl &quot;https://www.cloudflare.com/api_json.html\\3F&quot;</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;a=rec_edit&amp;tkn=$CFtkn&amp;id=$CFid&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;email=$CFemail&amp;z=$CFzone&amp;type=$CFtype&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;name=$CFDomain&amp;service_mode=$CFservicemode&amp;ttl=$CFttl&quot;);</span><br></pre></td></tr></table></figure>\n<p>And if the <em>$CFdebug</em> variable is set to “true”, write a little info to the router log.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Write debug info to log #################</span><br><span class=\"line\">:if ($CFDebug = &quot;true&quot;) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: hostname = $hostname&quot;)</span><br><span class=\"line\">:log info (&quot;CF: resolvedIP = $resolvedIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: currentIP = $currentIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: externalIP = $externalIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: CFurl = $CFurl&amp;content=$externalIP&quot;)</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Compare-and-Update\"><a href=\"#Compare-and-Update\" class=\"headerlink\" title=\"Compare and Update\"></a>Compare and Update</h3><p>Last step is to compare <em>$externalIP</em> with <em>$resolvedIP</em>. If they don’t match, our external IP-address has been changed and we need to update the DNS record. To execute the HTTP GET request we use a RouterOS tool called <a href=\"http://wiki.mikrotik.com/wiki/Fetch\" title=\"Mikrotik Manual: Fetch\">fetch</a> to which we pass the <em>$CFurl</em> variable. The reason this will not work before RouterOS v6+ is that before that there was no support for HTTPS, and CloudFlare does not accept unencrypted traffic for their APIs.</p>\n<p>The script block is pretty straight-forward. Compare, update, flush local DNS-cache and write to the log.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">######## Compare and update CF if necessary #####</span><br><span class=\"line\">:if ($resolvedIP != $externalIP) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: Updating CF, setting $CFDomain = $externalIP&quot;)</span><br><span class=\"line\">/tool fetch mode=https url=&quot;$CFurl&amp;content=$externalIP&quot; keep-result=no</span><br><span class=\"line\">/ip dns cache flush</span><br><span class=\"line\">&#125; else=&#123;</span><br><span class=\"line\">:log info &quot;CF: No Update Needed!&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Permissions-Policies\"><a href=\"#Permissions-Policies\" class=\"headerlink\" title=\"Permissions/Policies\"></a>Permissions/Policies</h3><p>This part, I’m not entirely sure on. The script needs to do name resolution, read settings and set variables and it works for me with these policies configured:</p>\n<ul>\n<li>Read</li>\n<li>Write</li>\n<li>Test</li>\n<li>Sniff</li>\n<li>Sensitive</li>\n</ul>\n<p>It might be over-doing it a bit, but I have not had occasion to fiddle with them yet.</p>\n<h3 id=\"Scheduling\"><a href=\"#Scheduling\" class=\"headerlink\" title=\"Scheduling\"></a>Scheduling</h3><p>I have this script scheduled to run once every 20 minutes. As it will only try to update the DNS records if there is a difference between them and the current external IP-address I feel fairly sure that I won’t be tagged as a spammer or something by CloudFlare.</p>\n<p>The schedule is configured with:</p>\n<ul>\n<li>Start Time: startup</li>\n<li>Interval: 00:20:00</li>\n<li>On Event: <figure class=\"highlight plain\"><figcaption><span>script run <Name of your script>```</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">* Policy: Read,Write, Test, Sniff, Sensitive</span><br><span class=\"line\"></span><br><span class=\"line\">This schedule is also a good place for a [hairpin](http://wiki.mikrotik.com/wiki/Hairpin_NAT &quot;Mikrotik Wiki: Hairpin NAT&quot;) update if it&apos;s needed.</span><br><span class=\"line\"></span><br><span class=\"line\"># The Copy-Paste part</span><br><span class=\"line\"></span><br><span class=\"line\">Now, obviously, at least make sure you proof-read the script before putting it into production. I am not a network dude, and I rarely dabble with ROS scripts. I am certain that anyone with a bit more experience could create a smarter, prettier version of this script, so **use at your own risk**. Anyway, here&apos;s the script in it&apos;s entirety.</span><br><span class=\"line\"></span><br><span class=\"line\">```text</span><br><span class=\"line\">######## Set and collect general variables #########</span><br><span class=\"line\">:global hostname &quot;homelab.example.com&quot;</span><br><span class=\"line\">:global resolvedIP &quot;&quot;</span><br><span class=\"line\">:global externalIP &quot;&quot;</span><br><span class=\"line\">:global WANInterface &quot;eth1-ext-internet&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Set CloudFlare variables #################</span><br><span class=\"line\">:local CFemail &quot;&lt;same email as in the powershell script&quot;</span><br><span class=\"line\">:local CFtkn &quot;&lt;your API key/token&gt;&quot;</span><br><span class=\"line\">:local CFzone &quot;example.com&quot;</span><br><span class=\"line\">:local CFid &quot;16606003&quot;</span><br><span class=\"line\">:local CFtype &quot;A&quot;</span><br><span class=\"line\">:local CFttl &quot;1&quot;</span><br><span class=\"line\">:local CFservicemode &quot;0&quot;</span><br><span class=\"line\">:local CFDomain &quot;homelab&quot;</span><br><span class=\"line\">:local CFDebug &quot;true&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Resolve and set IP-variables ##########</span><br><span class=\"line\">:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];</span><br><span class=\"line\">:set externalIP [:pick $currentIP 0 [:find $currentIP &quot;/&quot;]];</span><br><span class=\"line\">:set resolvedIP [:resolve $hostname];</span><br><span class=\"line\"></span><br><span class=\"line\">######## Build CF API Url #########################</span><br><span class=\"line\">:local CFurl &quot;https://www.cloudflare.com/api_json.html\\3F&quot;</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;a=rec_edit&amp;tkn=$CFtkn&amp;id=$CFid&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;email=$CFemail&amp;z=$CFzone&amp;type=$CFtype&quot;);</span><br><span class=\"line\">:set CFurl ($CFurl . &quot;&amp;name=$CFDomain&amp;service_mode=$CFservicemode&amp;ttl=$CFttl&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">######## Write debug info to log #################</span><br><span class=\"line\">:if ($CFDebug = &quot;true&quot;) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: hostname = $hostname&quot;)</span><br><span class=\"line\">:log info (&quot;CF: resolvedIP = $resolvedIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: currentIP = $currentIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: externalIP = $externalIP&quot;)</span><br><span class=\"line\">:log info (&quot;CF: CFurl = $CFurl&amp;content=$externalIP&quot;)</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">######## Compare and update CF if necessary #####</span><br><span class=\"line\">:if ($resolvedIP != $externalIP) do=&#123;</span><br><span class=\"line\">:log info (&quot;CF: Updating CF, setting $CFDomain = $externalIP&quot;)</span><br><span class=\"line\">/tool fetch mode=https url=&quot;$CFurl&amp;content=$externalIP&quot; keep-result=no</span><br><span class=\"line\">/ip dns cache flush</span><br><span class=\"line\">&#125; else=&#123;</span><br><span class=\"line\">:log info &quot;CF: No Update Needed!&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>"},{"title":"ESENT Error When Modifying OpsMgr Agent","id":"260","date":"2010-03-19T09:34:17.000Z","_content":"\nGetting “ESENT Kerys are required to install this application” when you are trying to modify/change an agent installation?\n\n[![image](http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image_thumb.png \"image\")](http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image.png)\n\nThis seems to be  most common on Windows 2008 and i guess it’s because of the UAC and the fact that opening the Control Panel isn’t running in administrative mode.\n\nTo work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt.\n\nBesides running through the registry to find the GUID, one of the easier ways is this:\n\n1. Open an administrative command prompt.\n2. run `wmic product`\n3. Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it.\n4. run `msiexec /i <PASTEYOURGUIDHERE>`\n5. Modify the agent as pleased\n\nThat’s pretty much it. Good luck.","source":"_posts/esent-error-when-modifying-opsmgr-agent.md","raw":"---\ntitle: ESENT Error When Modifying OpsMgr Agent\ntags:\n  - Errors\n  - How-To\n  - OpsMgr\n  - Windows\n  - Windows Installer\n  - WMI\nid: 260\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2010-03-19 10:34:17\n---\n\nGetting “ESENT Kerys are required to install this application” when you are trying to modify/change an agent installation?\n\n[![image](http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image_thumb.png \"image\")](http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image.png)\n\nThis seems to be  most common on Windows 2008 and i guess it’s because of the UAC and the fact that opening the Control Panel isn’t running in administrative mode.\n\nTo work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt.\n\nBesides running through the registry to find the GUID, one of the easier ways is this:\n\n1. Open an administrative command prompt.\n2. run `wmic product`\n3. Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it.\n4. run `msiexec /i <PASTEYOURGUIDHERE>`\n5. Modify the agent as pleased\n\nThat’s pretty much it. Good luck.","slug":"esent-error-when-modifying-opsmgr-agent","published":1,"updated":"2016-05-24T22:01:07.490Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gw000fq4o2ehw79pvt","content":"<p>Getting “ESENT Kerys are required to install this application” when you are trying to modify/change an agent installation?</p>\n<p><a href=\"http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image.png\" target=\"_blank\" rel=\"external\"><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image_thumb.png\" alt=\"image\" title=\"image\"></a></p>\n<p>This seems to be  most common on Windows 2008 and i guess it’s because of the UAC and the fact that opening the Control Panel isn’t running in administrative mode.</p>\n<p>To work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt.</p>\n<p>Besides running through the registry to find the GUID, one of the easier ways is this:</p>\n<ol>\n<li>Open an administrative command prompt.</li>\n<li>run <code>wmic product</code></li>\n<li>Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it.</li>\n<li>run <code>msiexec /i &lt;PASTEYOURGUIDHERE&gt;</code></li>\n<li>Modify the agent as pleased</li>\n</ol>\n<p>That’s pretty much it. Good luck.</p>\n","excerpt":"","more":"<p>Getting “ESENT Kerys are required to install this application” when you are trying to modify/change an agent installation?</p>\n<p><a href=\"http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image.png\"><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2010/03/image_thumb.png\" alt=\"image\" title=\"image\"></a></p>\n<p>This seems to be  most common on Windows 2008 and i guess it’s because of the UAC and the fact that opening the Control Panel isn’t running in administrative mode.</p>\n<p>To work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt.</p>\n<p>Besides running through the registry to find the GUID, one of the easier ways is this:</p>\n<ol>\n<li>Open an administrative command prompt.</li>\n<li>run <code>wmic product</code></li>\n<li>Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it.</li>\n<li>run <code>msiexec /i &lt;PASTEYOURGUIDHERE&gt;</code></li>\n<li>Modify the agent as pleased</li>\n</ol>\n<p>That’s pretty much it. Good luck.</p>\n"},{"title":"Health Rollup not working in Exchange Management Pack","id":"227","date":"2009-10-14T10:17:08.000Z","_content":"\nI’ve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don’t know how many times I’ve made a small change and tried resetting the health once again. Anyhow.   \n[Marius Sutara](http://social.technet.microsoft.com/Profile/en-US/?user=Marius%20Sutara&referrer=http%3a%2f%2fsocial.technet.microsoft.com%2fForums%2fen-US%2foperationsmanagergeneral%2fthread%2f6ad11b81-3304-40db-ae47-0f36add6e1e1&rh=EQRzBI2S0js0uB72HghHQFW%2bBWkNhiVEQ9pGFs3h9c0%3d&sp=forums) posted an [answer on TechNet forums](http://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/6ad11b81-3304-40db-ae47-0f36add6e1e1) last week with a “fix” (-ish), or rather the acknowledgement that the problem is not a <acronym title=\"AKA. Human Error, 40cm from the screen\">40c</acronym>. The problem might be related to other MP as well, but I’ve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor.\n\nIn case you wonder why on earth I post when there’s allready a “solution” out there; Pagerank, baby!   \nNot for me, but for the forum post making it show up earlier on google.","source":"_posts/health-rollup-not-working-in-exchange-management-pack.md","raw":"---\ntitle: Health Rollup not working in Exchange Management Pack\ntags:\n  - Errors\n  - Exchange\n  - Management Pack\n  - TechNet\nid: 227\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-10-14 12:17:08\n---\n\nI’ve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don’t know how many times I’ve made a small change and tried resetting the health once again. Anyhow.   \n[Marius Sutara](http://social.technet.microsoft.com/Profile/en-US/?user=Marius%20Sutara&referrer=http%3a%2f%2fsocial.technet.microsoft.com%2fForums%2fen-US%2foperationsmanagergeneral%2fthread%2f6ad11b81-3304-40db-ae47-0f36add6e1e1&rh=EQRzBI2S0js0uB72HghHQFW%2bBWkNhiVEQ9pGFs3h9c0%3d&sp=forums) posted an [answer on TechNet forums](http://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/6ad11b81-3304-40db-ae47-0f36add6e1e1) last week with a “fix” (-ish), or rather the acknowledgement that the problem is not a <acronym title=\"AKA. Human Error, 40cm from the screen\">40c</acronym>. The problem might be related to other MP as well, but I’ve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor.\n\nIn case you wonder why on earth I post when there’s allready a “solution” out there; Pagerank, baby!   \nNot for me, but for the forum post making it show up earlier on google.","slug":"health-rollup-not-working-in-exchange-management-pack","published":1,"updated":"2016-05-24T21:55:17.248Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7gz000iq4o2ct04qohd","content":"<p>I’ve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don’t know how many times I’ve made a small change and tried resetting the health once again. Anyhow.<br><a href=\"http://social.technet.microsoft.com/Profile/en-US/?user=Marius%20Sutara&amp;referrer=http%3a%2f%2fsocial.technet.microsoft.com%2fForums%2fen-US%2foperationsmanagergeneral%2fthread%2f6ad11b81-3304-40db-ae47-0f36add6e1e1&amp;rh=EQRzBI2S0js0uB72HghHQFW%2bBWkNhiVEQ9pGFs3h9c0%3d&amp;sp=forums\" target=\"_blank\" rel=\"external\">Marius Sutara</a> posted an <a href=\"http://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/6ad11b81-3304-40db-ae47-0f36add6e1e1\" target=\"_blank\" rel=\"external\">answer on TechNet forums</a> last week with a “fix” (-ish), or rather the acknowledgement that the problem is not a <acronym title=\"AKA. Human Error, 40cm from the screen\">40c</acronym>. The problem might be related to other MP as well, but I’ve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor.</p>\n<p>In case you wonder why on earth I post when there’s allready a “solution” out there; Pagerank, baby!<br>Not for me, but for the forum post making it show up earlier on google.</p>\n","excerpt":"","more":"<p>I’ve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don’t know how many times I’ve made a small change and tried resetting the health once again. Anyhow.<br><a href=\"http://social.technet.microsoft.com/Profile/en-US/?user=Marius%20Sutara&amp;referrer=http%3a%2f%2fsocial.technet.microsoft.com%2fForums%2fen-US%2foperationsmanagergeneral%2fthread%2f6ad11b81-3304-40db-ae47-0f36add6e1e1&amp;rh=EQRzBI2S0js0uB72HghHQFW%2bBWkNhiVEQ9pGFs3h9c0%3d&amp;sp=forums\">Marius Sutara</a> posted an <a href=\"http://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/6ad11b81-3304-40db-ae47-0f36add6e1e1\">answer on TechNet forums</a> last week with a “fix” (-ish), or rather the acknowledgement that the problem is not a <acronym title=\"AKA. Human Error, 40cm from the screen\">40c</acronym>. The problem might be related to other MP as well, but I’ve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor.</p>\n<p>In case you wonder why on earth I post when there’s allready a “solution” out there; Pagerank, baby!<br>Not for me, but for the forum post making it show up earlier on google.</p>\n"},{"title":"I'm moving (finally)","id":"376","date":"2011-02-01T11:10:52.000Z","_content":"\nIf you're seeing this, the move went OK. :P\n\nAnyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows?\n\nStill fiddling with the themes thought.\n\nSorry for the inconvenience!\n\nps. Post from the old site is a jump ahead.\n\n<!--more-->\n\nHi all,\n\nI'm finally getting my [male donkey](http://en.wikipedia.org/wiki/Donkey \"aka. ass\") out of the wagon and has started moving this blog to a new self-hosted server.\n\nThe current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution.\n\nAlso, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P\n\nHopefully, the transition will go mostly unnoticed apart from the automatic redirect (301 - Permanently moved) to the new domain.","source":"_posts/im-moving-finally.md","raw":"---\ntitle: I'm moving (finally)\nid: 376\ncategories:\n  - Technobabble\ndate: 2011-02-01 12:10:52\ntags:\n---\n\nIf you're seeing this, the move went OK. :P\n\nAnyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows?\n\nStill fiddling with the themes thought.\n\nSorry for the inconvenience!\n\nps. Post from the old site is a jump ahead.\n\n<!--more-->\n\nHi all,\n\nI'm finally getting my [male donkey](http://en.wikipedia.org/wiki/Donkey \"aka. ass\") out of the wagon and has started moving this blog to a new self-hosted server.\n\nThe current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution.\n\nAlso, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P\n\nHopefully, the transition will go mostly unnoticed apart from the automatic redirect (301 - Permanently moved) to the new domain.","slug":"im-moving-finally","published":1,"updated":"2016-05-24T21:55:06.929Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7h1000jq4o2s6vnewu8","content":"<p>If you’re seeing this, the move went OK. :P</p>\n<p>Anyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows?</p>\n<p>Still fiddling with the themes thought.</p>\n<p>Sorry for the inconvenience!</p>\n<p>ps. Post from the old site is a jump ahead.</p>\n<a id=\"more\"></a>\n<p>Hi all,</p>\n<p>I’m finally getting my <a href=\"http://en.wikipedia.org/wiki/Donkey\" title=\"aka. ass\" target=\"_blank\" rel=\"external\">male donkey</a> out of the wagon and has started moving this blog to a new self-hosted server.</p>\n<p>The current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution.</p>\n<p>Also, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P</p>\n<p>Hopefully, the transition will go mostly unnoticed apart from the automatic redirect (301 - Permanently moved) to the new domain.</p>\n","excerpt":"<p>If you’re seeing this, the move went OK. :P</p>\n<p>Anyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows?</p>\n<p>Still fiddling with the themes thought.</p>\n<p>Sorry for the inconvenience!</p>\n<p>ps. Post from the old site is a jump ahead.</p>","more":"<p>Hi all,</p>\n<p>I’m finally getting my <a href=\"http://en.wikipedia.org/wiki/Donkey\" title=\"aka. ass\">male donkey</a> out of the wagon and has started moving this blog to a new self-hosted server.</p>\n<p>The current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution.</p>\n<p>Also, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P</p>\n<p>Hopefully, the transition will go mostly unnoticed apart from the automatic redirect (301 - Permanently moved) to the new domain.</p>"},{"title":"In transit, again","date":"2016-06-01T19:03:35.000Z","_content":"\n# We're moving!\n\nYep. Again. Although, it's been a year or two since the last time.\n\n## The reason(s)\n\nOk, so I've using [Wordpress][1] for quite a long time now and it's been good. Mostly.\nIt's a fairly solid platform and has a whole slew of feautures that work nicely.\n\nBefore Wordpress I used Textpattern, a very slimmed, minimalistic authoring experience and my first contact with [textile][2] and\nsimilar markup/writing/notation languages. For those unaware, textile is not unlike [markdown][4].\nOr should we say that markdown is not unlike textile? Considering that textile was invented by Dean Allen two years before markdown.\nAnyhow. Both work pretty much as good as the other, allowing the author to write in any text-editor, using easily readable and fairly logical formatting.\n\nBefore that I used Movable Type, and prior to that either Dreamweaver or... well, notepad or vim.\n\nProblem with all of those platforms, however, is that they require dynamically generated webpages and technologies like PHP, Perl, .NET, Java and whatnot.\nThat, in itself, has been a very minor issue until lately. Sure, it requires servers with logics, engines, add-ons, execution rights to the local filesystem etc, but\nstill a minor nuisance. Mostly a financial nuisance really as active servers tend to cost money while finding static hosting for free is still pretty easy.\nHell! I could put a webserver on a RaspberryPi and get good performance for a small-ish blog like mine if all I am using is static content.\n\nBut, again. Not a major problem in itself. The main instigating factors to move away from Wordpress are the increasing size of the package, the lack of personal control, \nthe lack of ease to extend my platform due to ever-expanding APIs and the fact that it is so popular that every \"hacker\" and it's mother knows how to find exploits on it.\nMy webhost, [NFSN][5] has been very good at detecting probing and brute-force attempts and automatically block public access to stuff like the login-pages and XML-RPC interfaces when that happens.\nI am just so sick and tired of having to constantly be on top of it with software updates, plugin updates, theme updates, security updates, spam-filtering, re-enabling the login page...\n\n## Back to the basics\n\nTeknoglot.se will be served statically from now on, and it will be hosted for free on [Github Pages][6].\nUsing [Hexo.io][7] I can write my posts using markdown, then with a simple `hexo generate --deploy` generate and update the static files and publish them.\nNo login pages to hack, no dynamic pages to exploit, no server security to worry about.\n\nHexo is built using node.js, which I have installed for other reasons anyway, and since the actual website is build from a git repository I obviously have proper versioning on everything I do per default.\n\nThere's obviously not as many plugins, helpers, themes and features available as in Wordpress. And blogging will require some command-line stuff.\nBut I am totally fine with that. I means I can write offline, generate offline to preview. And when finished, push to the public repo.\n\n## But, comments?\n\nUsing Disqus. All client-side.\nYou need javascript, obviously, but I don't see me losing many readers for that to be frank. ;)\n\n## The kinks\n\nNo, not [the band][8]. The stuff I have missed while migrating the posts from Wordpress to Hexo.\nHere's what to expect.\n\n### Permalinks may not work\n\nI have done my best to ensure that my old permalink structure from the old site is intact.\nHexo have some limitations to categories though, meaning that I cannot yet have two main categories on the same post.\nThis do affect those articles that were available through both /code/posh/my-post, /ms/scom2012/my-post.\nFor those, I have had to pick one to be main and rely on tags to group stuff more freely. \n\n### Code-highlight artefacts\n\nWordpress highlight plugins and markdown have different syntax, and the migration plugin did not handle that.\nThis means that you might find a few `[powershell]`, `[sql]` or `[plain]` tags littered throughout the post for a while.\nIf you spot one, do comment to let me know. But I will try to convert them all as I find them.\n\n### Images and galleries\n\nNot sure I ever used a gallery, but some images may be missing as I have to migrate them manually and I am absolutely certain that I have missed at least one. Maybe two. ^That's ^a ^joke.\n\nOnce again, if you find a missing one you are welcome to post a comment to let me know.\n\n### Series\n\nNope, no such thing in Hexo at the moment.\nMay be able to use some other structure, but for now it will be normal posts with links. Probably missing a few there as well.\n\n### Post tabs\n\nAlso not available in Hexo.\nI have converted those posts to regular posts. I am working on a proper TOC to make them easier to browse.\n\n### Links\n\nAs with the images, links I have created manually may point to old wordpress folders and have to be redirected.\nI know for a fact that I have missed a few.\n\n### Graphics\n\nUsing a new theme will take a few adaptations to logos and other graphics.\nThis will change over time, so don't laugh too hard. \n\n# The Last Word\n\nThings be wonky. Have patience. Thanks!\n\n\n\n[1]: https://www.wordpress.org\n[2]: https://en.wikipedia.org/wiki/Textile_(markup_language)\n[3]: http://textpattern.com/\n[4]: https://en.wikipedia.org/wiki/Markdown\n[5]: https://www.nearlyfreespeech.net/\n[6]: https://pages.github.com/\n[7]: https://hexo.io/\n[8]: https://en.wikipedia.org/wiki/The_Kinks\n","source":"_posts/in-transit-again.md","raw":"---\ntitle: 'In transit, again'\ndate: 2016-06-01 21:03:35\ntags:\n    - Teknoglot\n    - Hexo\n    - Wordpress\ncategories:\n    - Technobabble\n---\n\n# We're moving!\n\nYep. Again. Although, it's been a year or two since the last time.\n\n## The reason(s)\n\nOk, so I've using [Wordpress][1] for quite a long time now and it's been good. Mostly.\nIt's a fairly solid platform and has a whole slew of feautures that work nicely.\n\nBefore Wordpress I used Textpattern, a very slimmed, minimalistic authoring experience and my first contact with [textile][2] and\nsimilar markup/writing/notation languages. For those unaware, textile is not unlike [markdown][4].\nOr should we say that markdown is not unlike textile? Considering that textile was invented by Dean Allen two years before markdown.\nAnyhow. Both work pretty much as good as the other, allowing the author to write in any text-editor, using easily readable and fairly logical formatting.\n\nBefore that I used Movable Type, and prior to that either Dreamweaver or... well, notepad or vim.\n\nProblem with all of those platforms, however, is that they require dynamically generated webpages and technologies like PHP, Perl, .NET, Java and whatnot.\nThat, in itself, has been a very minor issue until lately. Sure, it requires servers with logics, engines, add-ons, execution rights to the local filesystem etc, but\nstill a minor nuisance. Mostly a financial nuisance really as active servers tend to cost money while finding static hosting for free is still pretty easy.\nHell! I could put a webserver on a RaspberryPi and get good performance for a small-ish blog like mine if all I am using is static content.\n\nBut, again. Not a major problem in itself. The main instigating factors to move away from Wordpress are the increasing size of the package, the lack of personal control, \nthe lack of ease to extend my platform due to ever-expanding APIs and the fact that it is so popular that every \"hacker\" and it's mother knows how to find exploits on it.\nMy webhost, [NFSN][5] has been very good at detecting probing and brute-force attempts and automatically block public access to stuff like the login-pages and XML-RPC interfaces when that happens.\nI am just so sick and tired of having to constantly be on top of it with software updates, plugin updates, theme updates, security updates, spam-filtering, re-enabling the login page...\n\n## Back to the basics\n\nTeknoglot.se will be served statically from now on, and it will be hosted for free on [Github Pages][6].\nUsing [Hexo.io][7] I can write my posts using markdown, then with a simple `hexo generate --deploy` generate and update the static files and publish them.\nNo login pages to hack, no dynamic pages to exploit, no server security to worry about.\n\nHexo is built using node.js, which I have installed for other reasons anyway, and since the actual website is build from a git repository I obviously have proper versioning on everything I do per default.\n\nThere's obviously not as many plugins, helpers, themes and features available as in Wordpress. And blogging will require some command-line stuff.\nBut I am totally fine with that. I means I can write offline, generate offline to preview. And when finished, push to the public repo.\n\n## But, comments?\n\nUsing Disqus. All client-side.\nYou need javascript, obviously, but I don't see me losing many readers for that to be frank. ;)\n\n## The kinks\n\nNo, not [the band][8]. The stuff I have missed while migrating the posts from Wordpress to Hexo.\nHere's what to expect.\n\n### Permalinks may not work\n\nI have done my best to ensure that my old permalink structure from the old site is intact.\nHexo have some limitations to categories though, meaning that I cannot yet have two main categories on the same post.\nThis do affect those articles that were available through both /code/posh/my-post, /ms/scom2012/my-post.\nFor those, I have had to pick one to be main and rely on tags to group stuff more freely. \n\n### Code-highlight artefacts\n\nWordpress highlight plugins and markdown have different syntax, and the migration plugin did not handle that.\nThis means that you might find a few `[powershell]`, `[sql]` or `[plain]` tags littered throughout the post for a while.\nIf you spot one, do comment to let me know. But I will try to convert them all as I find them.\n\n### Images and galleries\n\nNot sure I ever used a gallery, but some images may be missing as I have to migrate them manually and I am absolutely certain that I have missed at least one. Maybe two. ^That's ^a ^joke.\n\nOnce again, if you find a missing one you are welcome to post a comment to let me know.\n\n### Series\n\nNope, no such thing in Hexo at the moment.\nMay be able to use some other structure, but for now it will be normal posts with links. Probably missing a few there as well.\n\n### Post tabs\n\nAlso not available in Hexo.\nI have converted those posts to regular posts. I am working on a proper TOC to make them easier to browse.\n\n### Links\n\nAs with the images, links I have created manually may point to old wordpress folders and have to be redirected.\nI know for a fact that I have missed a few.\n\n### Graphics\n\nUsing a new theme will take a few adaptations to logos and other graphics.\nThis will change over time, so don't laugh too hard. \n\n# The Last Word\n\nThings be wonky. Have patience. Thanks!\n\n\n\n[1]: https://www.wordpress.org\n[2]: https://en.wikipedia.org/wiki/Textile_(markup_language)\n[3]: http://textpattern.com/\n[4]: https://en.wikipedia.org/wiki/Markdown\n[5]: https://www.nearlyfreespeech.net/\n[6]: https://pages.github.com/\n[7]: https://hexo.io/\n[8]: https://en.wikipedia.org/wiki/The_Kinks\n","slug":"in-transit-again","published":1,"updated":"2016-06-01T23:16:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7h5000mq4o2579s7pbi","content":"<h1 id=\"We’re-moving\"><a href=\"#We’re-moving\" class=\"headerlink\" title=\"We’re moving!\"></a>We’re moving!</h1><p>Yep. Again. Although, it’s been a year or two since the last time.</p>\n<h2 id=\"The-reason-s\"><a href=\"#The-reason-s\" class=\"headerlink\" title=\"The reason(s)\"></a>The reason(s)</h2><p>Ok, so I’ve using <a href=\"https://www.wordpress.org\" target=\"_blank\" rel=\"external\">Wordpress</a> for quite a long time now and it’s been good. Mostly.<br>It’s a fairly solid platform and has a whole slew of feautures that work nicely.</p>\n<p>Before Wordpress I used Textpattern, a very slimmed, minimalistic authoring experience and my first contact with <a href=\"https://en.wikipedia.org/wiki/Textile_(markup_language)\" target=\"_blank\" rel=\"external\">textile</a> and<br>similar markup/writing/notation languages. For those unaware, textile is not unlike <a href=\"https://en.wikipedia.org/wiki/Markdown\" target=\"_blank\" rel=\"external\">markdown</a>.<br>Or should we say that markdown is not unlike textile? Considering that textile was invented by Dean Allen two years before markdown.<br>Anyhow. Both work pretty much as good as the other, allowing the author to write in any text-editor, using easily readable and fairly logical formatting.</p>\n<p>Before that I used Movable Type, and prior to that either Dreamweaver or… well, notepad or vim.</p>\n<p>Problem with all of those platforms, however, is that they require dynamically generated webpages and technologies like PHP, Perl, .NET, Java and whatnot.<br>That, in itself, has been a very minor issue until lately. Sure, it requires servers with logics, engines, add-ons, execution rights to the local filesystem etc, but<br>still a minor nuisance. Mostly a financial nuisance really as active servers tend to cost money while finding static hosting for free is still pretty easy.<br>Hell! I could put a webserver on a RaspberryPi and get good performance for a small-ish blog like mine if all I am using is static content.</p>\n<p>But, again. Not a major problem in itself. The main instigating factors to move away from Wordpress are the increasing size of the package, the lack of personal control,<br>the lack of ease to extend my platform due to ever-expanding APIs and the fact that it is so popular that every “hacker” and it’s mother knows how to find exploits on it.<br>My webhost, <a href=\"https://www.nearlyfreespeech.net/\" target=\"_blank\" rel=\"external\">NFSN</a> has been very good at detecting probing and brute-force attempts and automatically block public access to stuff like the login-pages and XML-RPC interfaces when that happens.<br>I am just so sick and tired of having to constantly be on top of it with software updates, plugin updates, theme updates, security updates, spam-filtering, re-enabling the login page…</p>\n<h2 id=\"Back-to-the-basics\"><a href=\"#Back-to-the-basics\" class=\"headerlink\" title=\"Back to the basics\"></a>Back to the basics</h2><p>Teknoglot.se will be served statically from now on, and it will be hosted for free on <a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"external\">Github Pages</a>.<br>Using <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo.io</a> I can write my posts using markdown, then with a simple <code>hexo generate --deploy</code> generate and update the static files and publish them.<br>No login pages to hack, no dynamic pages to exploit, no server security to worry about.</p>\n<p>Hexo is built using node.js, which I have installed for other reasons anyway, and since the actual website is build from a git repository I obviously have proper versioning on everything I do per default.</p>\n<p>There’s obviously not as many plugins, helpers, themes and features available as in Wordpress. And blogging will require some command-line stuff.<br>But I am totally fine with that. I means I can write offline, generate offline to preview. And when finished, push to the public repo.</p>\n<h2 id=\"But-comments\"><a href=\"#But-comments\" class=\"headerlink\" title=\"But, comments?\"></a>But, comments?</h2><p>Using Disqus. All client-side.<br>You need javascript, obviously, but I don’t see me losing many readers for that to be frank. ;)</p>\n<h2 id=\"The-kinks\"><a href=\"#The-kinks\" class=\"headerlink\" title=\"The kinks\"></a>The kinks</h2><p>No, not <a href=\"https://en.wikipedia.org/wiki/The_Kinks\" target=\"_blank\" rel=\"external\">the band</a>. The stuff I have missed while migrating the posts from Wordpress to Hexo.<br>Here’s what to expect.</p>\n<h3 id=\"Permalinks-may-not-work\"><a href=\"#Permalinks-may-not-work\" class=\"headerlink\" title=\"Permalinks may not work\"></a>Permalinks may not work</h3><p>I have done my best to ensure that my old permalink structure from the old site is intact.<br>Hexo have some limitations to categories though, meaning that I cannot yet have two main categories on the same post.<br>This do affect those articles that were available through both /code/posh/my-post, /ms/scom2012/my-post.<br>For those, I have had to pick one to be main and rely on tags to group stuff more freely. </p>\n<h3 id=\"Code-highlight-artefacts\"><a href=\"#Code-highlight-artefacts\" class=\"headerlink\" title=\"Code-highlight artefacts\"></a>Code-highlight artefacts</h3><p>Wordpress highlight plugins and markdown have different syntax, and the migration plugin did not handle that.<br>This means that you might find a few <code>[powershell]</code>, <code>[sql]</code> or <code>[plain]</code> tags littered throughout the post for a while.<br>If you spot one, do comment to let me know. But I will try to convert them all as I find them.</p>\n<h3 id=\"Images-and-galleries\"><a href=\"#Images-and-galleries\" class=\"headerlink\" title=\"Images and galleries\"></a>Images and galleries</h3><p>Not sure I ever used a gallery, but some images may be missing as I have to migrate them manually and I am absolutely certain that I have missed at least one. Maybe two. ^That’s ^a ^joke.</p>\n<p>Once again, if you find a missing one you are welcome to post a comment to let me know.</p>\n<h3 id=\"Series\"><a href=\"#Series\" class=\"headerlink\" title=\"Series\"></a>Series</h3><p>Nope, no such thing in Hexo at the moment.<br>May be able to use some other structure, but for now it will be normal posts with links. Probably missing a few there as well.</p>\n<h3 id=\"Post-tabs\"><a href=\"#Post-tabs\" class=\"headerlink\" title=\"Post tabs\"></a>Post tabs</h3><p>Also not available in Hexo.<br>I have converted those posts to regular posts. I am working on a proper TOC to make them easier to browse.</p>\n<h3 id=\"Links\"><a href=\"#Links\" class=\"headerlink\" title=\"Links\"></a>Links</h3><p>As with the images, links I have created manually may point to old wordpress folders and have to be redirected.<br>I know for a fact that I have missed a few.</p>\n<h3 id=\"Graphics\"><a href=\"#Graphics\" class=\"headerlink\" title=\"Graphics\"></a>Graphics</h3><p>Using a new theme will take a few adaptations to logos and other graphics.<br>This will change over time, so don’t laugh too hard. </p>\n<h1 id=\"The-Last-Word\"><a href=\"#The-Last-Word\" class=\"headerlink\" title=\"The Last Word\"></a>The Last Word</h1><p>Things be wonky. Have patience. Thanks!</p>\n","excerpt":"","more":"<h1 id=\"We’re-moving\"><a href=\"#We’re-moving\" class=\"headerlink\" title=\"We’re moving!\"></a>We’re moving!</h1><p>Yep. Again. Although, it’s been a year or two since the last time.</p>\n<h2 id=\"The-reason-s\"><a href=\"#The-reason-s\" class=\"headerlink\" title=\"The reason(s)\"></a>The reason(s)</h2><p>Ok, so I’ve using <a href=\"https://www.wordpress.org\">Wordpress</a> for quite a long time now and it’s been good. Mostly.<br>It’s a fairly solid platform and has a whole slew of feautures that work nicely.</p>\n<p>Before Wordpress I used Textpattern, a very slimmed, minimalistic authoring experience and my first contact with <a href=\"https://en.wikipedia.org/wiki/Textile_(markup_language)\">textile</a> and<br>similar markup/writing/notation languages. For those unaware, textile is not unlike <a href=\"https://en.wikipedia.org/wiki/Markdown\">markdown</a>.<br>Or should we say that markdown is not unlike textile? Considering that textile was invented by Dean Allen two years before markdown.<br>Anyhow. Both work pretty much as good as the other, allowing the author to write in any text-editor, using easily readable and fairly logical formatting.</p>\n<p>Before that I used Movable Type, and prior to that either Dreamweaver or… well, notepad or vim.</p>\n<p>Problem with all of those platforms, however, is that they require dynamically generated webpages and technologies like PHP, Perl, .NET, Java and whatnot.<br>That, in itself, has been a very minor issue until lately. Sure, it requires servers with logics, engines, add-ons, execution rights to the local filesystem etc, but<br>still a minor nuisance. Mostly a financial nuisance really as active servers tend to cost money while finding static hosting for free is still pretty easy.<br>Hell! I could put a webserver on a RaspberryPi and get good performance for a small-ish blog like mine if all I am using is static content.</p>\n<p>But, again. Not a major problem in itself. The main instigating factors to move away from Wordpress are the increasing size of the package, the lack of personal control,<br>the lack of ease to extend my platform due to ever-expanding APIs and the fact that it is so popular that every “hacker” and it’s mother knows how to find exploits on it.<br>My webhost, <a href=\"https://www.nearlyfreespeech.net/\">NFSN</a> has been very good at detecting probing and brute-force attempts and automatically block public access to stuff like the login-pages and XML-RPC interfaces when that happens.<br>I am just so sick and tired of having to constantly be on top of it with software updates, plugin updates, theme updates, security updates, spam-filtering, re-enabling the login page…</p>\n<h2 id=\"Back-to-the-basics\"><a href=\"#Back-to-the-basics\" class=\"headerlink\" title=\"Back to the basics\"></a>Back to the basics</h2><p>Teknoglot.se will be served statically from now on, and it will be hosted for free on <a href=\"https://pages.github.com/\">Github Pages</a>.<br>Using <a href=\"https://hexo.io/\">Hexo.io</a> I can write my posts using markdown, then with a simple <code>hexo generate --deploy</code> generate and update the static files and publish them.<br>No login pages to hack, no dynamic pages to exploit, no server security to worry about.</p>\n<p>Hexo is built using node.js, which I have installed for other reasons anyway, and since the actual website is build from a git repository I obviously have proper versioning on everything I do per default.</p>\n<p>There’s obviously not as many plugins, helpers, themes and features available as in Wordpress. And blogging will require some command-line stuff.<br>But I am totally fine with that. I means I can write offline, generate offline to preview. And when finished, push to the public repo.</p>\n<h2 id=\"But-comments\"><a href=\"#But-comments\" class=\"headerlink\" title=\"But, comments?\"></a>But, comments?</h2><p>Using Disqus. All client-side.<br>You need javascript, obviously, but I don’t see me losing many readers for that to be frank. ;)</p>\n<h2 id=\"The-kinks\"><a href=\"#The-kinks\" class=\"headerlink\" title=\"The kinks\"></a>The kinks</h2><p>No, not <a href=\"https://en.wikipedia.org/wiki/The_Kinks\">the band</a>. The stuff I have missed while migrating the posts from Wordpress to Hexo.<br>Here’s what to expect.</p>\n<h3 id=\"Permalinks-may-not-work\"><a href=\"#Permalinks-may-not-work\" class=\"headerlink\" title=\"Permalinks may not work\"></a>Permalinks may not work</h3><p>I have done my best to ensure that my old permalink structure from the old site is intact.<br>Hexo have some limitations to categories though, meaning that I cannot yet have two main categories on the same post.<br>This do affect those articles that were available through both /code/posh/my-post, /ms/scom2012/my-post.<br>For those, I have had to pick one to be main and rely on tags to group stuff more freely. </p>\n<h3 id=\"Code-highlight-artefacts\"><a href=\"#Code-highlight-artefacts\" class=\"headerlink\" title=\"Code-highlight artefacts\"></a>Code-highlight artefacts</h3><p>Wordpress highlight plugins and markdown have different syntax, and the migration plugin did not handle that.<br>This means that you might find a few <code>[powershell]</code>, <code>[sql]</code> or <code>[plain]</code> tags littered throughout the post for a while.<br>If you spot one, do comment to let me know. But I will try to convert them all as I find them.</p>\n<h3 id=\"Images-and-galleries\"><a href=\"#Images-and-galleries\" class=\"headerlink\" title=\"Images and galleries\"></a>Images and galleries</h3><p>Not sure I ever used a gallery, but some images may be missing as I have to migrate them manually and I am absolutely certain that I have missed at least one. Maybe two. ^That’s ^a ^joke.</p>\n<p>Once again, if you find a missing one you are welcome to post a comment to let me know.</p>\n<h3 id=\"Series\"><a href=\"#Series\" class=\"headerlink\" title=\"Series\"></a>Series</h3><p>Nope, no such thing in Hexo at the moment.<br>May be able to use some other structure, but for now it will be normal posts with links. Probably missing a few there as well.</p>\n<h3 id=\"Post-tabs\"><a href=\"#Post-tabs\" class=\"headerlink\" title=\"Post tabs\"></a>Post tabs</h3><p>Also not available in Hexo.<br>I have converted those posts to regular posts. I am working on a proper TOC to make them easier to browse.</p>\n<h3 id=\"Links\"><a href=\"#Links\" class=\"headerlink\" title=\"Links\"></a>Links</h3><p>As with the images, links I have created manually may point to old wordpress folders and have to be redirected.<br>I know for a fact that I have missed a few.</p>\n<h3 id=\"Graphics\"><a href=\"#Graphics\" class=\"headerlink\" title=\"Graphics\"></a>Graphics</h3><p>Using a new theme will take a few adaptations to logos and other graphics.<br>This will change over time, so don’t laugh too hard. </p>\n<h1 id=\"The-Last-Word\"><a href=\"#The-Last-Word\" class=\"headerlink\" title=\"The Last Word\"></a>The Last Word</h1><p>Things be wonky. Have patience. Thanks!</p>\n"},{"title":"Installing Linux Integration Services v2.1 on Red Hat ES 5","id":"291","date":"2010-08-31T10:06:04.000Z","_content":"\nOk, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5\\. Something that turned out to be a bit more to handle than I would have thought. So here's a little How-To.\n\n# Preparations\n\nRead the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;)\n\nI'm not going to go through the OS installation process here, but make sure to select the \"Software Development\" packages since you will be needing it. In case you missed it, you can install them later by running these commands.\n\n```bash\n# yum groupinstall \"Development Tools\"\n# yum install kernel-headers\n```\n\nI'm not actually sure that you need to run the kernel-headers install manually or if it's included in the \"Development Tools\" package.\n\nThe first gotcha i ran into was the fact that the link to the Linux Integration Services--previously known as Linux Integration Components or LinuxIC--on RedHat's information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404\\. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on [http://download.microsoft.com](http://download.microsoft.com) for \"Linux Integration Components\" do return the new page, and that's where I learned about the new name.\n_Thank you for making it easy for us Microsoft!\n_Here's a direct link to the search on the current name: [http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&displaylang=en&stype=s_basic](http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&displaylang=en&stype=s_basic)\nAnd here's a direct link to the actual download page: [http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551)\n\nThis download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this.\n\n```bash\n# mkdir /mnt/ISO\n# mount -o loop /root/LinuxIC v21.iso /mnt/ISO\n# mkdir /opt/linux_ic_v21_rtm\n# cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/\n# umount /mnt/ISO\n```\n\nYou probably have to be root to do this by the way.\nWith that done, let's get to the installation.\n\n# Installation\n\nAs root, do the following:\n\n```bash\n# export PATH=$PATH:/sbin\n# cd /opt/linux_ic_v21_rtm/\n# make\n make install\n# reboot\n```\n\nWhy the export PATH command? Apparently, on RHES5, /sbin is not in the PATH by default and this is something that the make scripts are completely unaware of. The \"make install\" will try to run \"depmod\" which will fail since it's not in the default path. You could also add \"PATH=$PATH/sbin\" to the root users ~/.bashrc which will put it back in the PATH but only for the root user, but I don't know if that's recommended.\nAnd, yes. You DO have to reboot after the install.\n\nIf you are running RHES5 64bit you also have to install the \"adjtimex\" package. It is in the RHN repository but also on the RHES5 Installation CD in case you have no internet connection. Install it with yum like this:\n\n```ash\n# yum install adjtimex\n```\n\nAnd from the CD (mount it first) like this:\n\n```bash\n# rpm –ivh /mnt/cdrom/Server/adjtimex-1.20-2.1.x86_64.rpm\n```\n\nAnd that's basically it for the installation.\n\n# Verification\n\nHow do you know that the driver are installed?\n\nAftr the reboot, try running \"modinfo vmbus\" which should return something like this:\n\n```bash\n# modinfo vmbus\nfilename:       /lib/modules/2.6.18-194.11.1.el5/kernel/drivers/vmbus/vmbus.ko\nverion:        2.1.25\nlicnse:        GPL\nsrcversion:     3C1899C419665CB2514F2D0\ndepends:\nvermagic:       2.6.18-194.11.1.el5 SMP mod_unload gcc-4.1\nparm:           vmbus_irq:int\npar:           vmbus_loglevel:int\n```\n\nTry that with netvsc, storvsc and blkvsc too (replace the _vmbus_ part) and you should get something similar. If you don't, the installation did not succeed.\nThe documentation also tells us to check that the components are running with \"/sbin/lsmod | grep vsc\" which should return:\n\n```bash\n# /bin/lsmod | grep vsc\nblkvsc                 70184  3\nstorvsc                64264  0\nnetvsc                 73504  0\nvmbus                  88304  3 blkvsc,storvsc,netvsc\nscs_mod              196953  6 scsi_dh,sg,blkvsc,storvsc,libata,sd_mod\n```\n\nThe numbers will probably differ from installation to installation depending on blocksizes and allocation.\n\n# Configuration\n\nConfiguration is pretty straight-forward so I'll keep this short.\n\nWhen you install the drivers you will get a new network card called **seth0**, which I presume stands for Synthetic ETHernet. There's nothing magic about it regarding configuration and \"system-configuration-network\" will work just fine.\nThe drivers will also give you a couple of SCSI-devices (if you have one attached) with the regular **/dev/sd*** naming. Simply configure these using fdisk or whatever GUI you might prefer.\n\nThere is also a note in the documentation about changing the grub configuration in the \"Additional Information...\" section. Do read that section.\n\n# Additional Comments\n\nOne thing I tend to do now that disk space is dirt cheap is to copy all ISO-files I use locally instead of mounting them when needed through Hyper-V. Simply because you can bet your insert-shorter-word-for-buttocks that the day you need it again, someone has been kind enough to have done som spring-cleaning or it's locked by another machine in the cluster. If you have it locally and followed my instructions in the \"Preparation\" section, you will allready have a /mnt/ISO directory. Only thing you'll have to do is\n\n```bash\n# mount -o loop /path/to/your.iso /mnt/ISO\n```\n\nAnd there you have it. Just remember to unmount it when you're done.\n\nI also almost never use the Hyper-V remote connection interface thingy since it will give you a GUI and the mouse just won't work. If you haven't configured a network card yet though, you could connect through Hyper-V and hit _Ctrl+Alt+F1_ to get a command prompt. Unfortunatly cut/paste don't work here, but you could run _system-configuration-network_, assign an IP-address and then connect with an SSH client. I prefer PuTTY to a degree that I usually install the ported version on my Linux desktops aswell.\n\nAnd I never logon using root. People should know this, but it should be stressed anyway. Always logon as regular user and _su_ or _sudo_ when needed. I can't understand why RHES has root-login enabled by default in the SSH-server config.\n\nGood luck!","source":"_posts/install-linuxis21-rhes5.md","raw":"---\ntitle: Installing Linux Integration Services v2.1 on Red Hat ES 5\ntags:\n  - How-To\n  - Hyper-V\n  - Linux\n  - RedHat\n  - RHES5\nid: 291\ncategories:\n  - Linux\n  - RedHat ES\ndate: 2010-08-31 12:06:04\n---\n\nOk, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5\\. Something that turned out to be a bit more to handle than I would have thought. So here's a little How-To.\n\n# Preparations\n\nRead the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;)\n\nI'm not going to go through the OS installation process here, but make sure to select the \"Software Development\" packages since you will be needing it. In case you missed it, you can install them later by running these commands.\n\n```bash\n# yum groupinstall \"Development Tools\"\n# yum install kernel-headers\n```\n\nI'm not actually sure that you need to run the kernel-headers install manually or if it's included in the \"Development Tools\" package.\n\nThe first gotcha i ran into was the fact that the link to the Linux Integration Services--previously known as Linux Integration Components or LinuxIC--on RedHat's information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404\\. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on [http://download.microsoft.com](http://download.microsoft.com) for \"Linux Integration Components\" do return the new page, and that's where I learned about the new name.\n_Thank you for making it easy for us Microsoft!\n_Here's a direct link to the search on the current name: [http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&displaylang=en&stype=s_basic](http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&displaylang=en&stype=s_basic)\nAnd here's a direct link to the actual download page: [http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551)\n\nThis download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this.\n\n```bash\n# mkdir /mnt/ISO\n# mount -o loop /root/LinuxIC v21.iso /mnt/ISO\n# mkdir /opt/linux_ic_v21_rtm\n# cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/\n# umount /mnt/ISO\n```\n\nYou probably have to be root to do this by the way.\nWith that done, let's get to the installation.\n\n# Installation\n\nAs root, do the following:\n\n```bash\n# export PATH=$PATH:/sbin\n# cd /opt/linux_ic_v21_rtm/\n# make\n make install\n# reboot\n```\n\nWhy the export PATH command? Apparently, on RHES5, /sbin is not in the PATH by default and this is something that the make scripts are completely unaware of. The \"make install\" will try to run \"depmod\" which will fail since it's not in the default path. You could also add \"PATH=$PATH/sbin\" to the root users ~/.bashrc which will put it back in the PATH but only for the root user, but I don't know if that's recommended.\nAnd, yes. You DO have to reboot after the install.\n\nIf you are running RHES5 64bit you also have to install the \"adjtimex\" package. It is in the RHN repository but also on the RHES5 Installation CD in case you have no internet connection. Install it with yum like this:\n\n```ash\n# yum install adjtimex\n```\n\nAnd from the CD (mount it first) like this:\n\n```bash\n# rpm –ivh /mnt/cdrom/Server/adjtimex-1.20-2.1.x86_64.rpm\n```\n\nAnd that's basically it for the installation.\n\n# Verification\n\nHow do you know that the driver are installed?\n\nAftr the reboot, try running \"modinfo vmbus\" which should return something like this:\n\n```bash\n# modinfo vmbus\nfilename:       /lib/modules/2.6.18-194.11.1.el5/kernel/drivers/vmbus/vmbus.ko\nverion:        2.1.25\nlicnse:        GPL\nsrcversion:     3C1899C419665CB2514F2D0\ndepends:\nvermagic:       2.6.18-194.11.1.el5 SMP mod_unload gcc-4.1\nparm:           vmbus_irq:int\npar:           vmbus_loglevel:int\n```\n\nTry that with netvsc, storvsc and blkvsc too (replace the _vmbus_ part) and you should get something similar. If you don't, the installation did not succeed.\nThe documentation also tells us to check that the components are running with \"/sbin/lsmod | grep vsc\" which should return:\n\n```bash\n# /bin/lsmod | grep vsc\nblkvsc                 70184  3\nstorvsc                64264  0\nnetvsc                 73504  0\nvmbus                  88304  3 blkvsc,storvsc,netvsc\nscs_mod              196953  6 scsi_dh,sg,blkvsc,storvsc,libata,sd_mod\n```\n\nThe numbers will probably differ from installation to installation depending on blocksizes and allocation.\n\n# Configuration\n\nConfiguration is pretty straight-forward so I'll keep this short.\n\nWhen you install the drivers you will get a new network card called **seth0**, which I presume stands for Synthetic ETHernet. There's nothing magic about it regarding configuration and \"system-configuration-network\" will work just fine.\nThe drivers will also give you a couple of SCSI-devices (if you have one attached) with the regular **/dev/sd*** naming. Simply configure these using fdisk or whatever GUI you might prefer.\n\nThere is also a note in the documentation about changing the grub configuration in the \"Additional Information...\" section. Do read that section.\n\n# Additional Comments\n\nOne thing I tend to do now that disk space is dirt cheap is to copy all ISO-files I use locally instead of mounting them when needed through Hyper-V. Simply because you can bet your insert-shorter-word-for-buttocks that the day you need it again, someone has been kind enough to have done som spring-cleaning or it's locked by another machine in the cluster. If you have it locally and followed my instructions in the \"Preparation\" section, you will allready have a /mnt/ISO directory. Only thing you'll have to do is\n\n```bash\n# mount -o loop /path/to/your.iso /mnt/ISO\n```\n\nAnd there you have it. Just remember to unmount it when you're done.\n\nI also almost never use the Hyper-V remote connection interface thingy since it will give you a GUI and the mouse just won't work. If you haven't configured a network card yet though, you could connect through Hyper-V and hit _Ctrl+Alt+F1_ to get a command prompt. Unfortunatly cut/paste don't work here, but you could run _system-configuration-network_, assign an IP-address and then connect with an SSH client. I prefer PuTTY to a degree that I usually install the ported version on my Linux desktops aswell.\n\nAnd I never logon using root. People should know this, but it should be stressed anyway. Always logon as regular user and _su_ or _sudo_ when needed. I can't understand why RHES has root-login enabled by default in the SSH-server config.\n\nGood luck!","slug":"install-linuxis21-rhes5","published":1,"updated":"2016-05-24T21:54:50.115Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7h6000oq4o2h08hy80w","content":"<p>Ok, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5. Something that turned out to be a bit more to handle than I would have thought. So here’s a little How-To.</p>\n<h1 id=\"Preparations\"><a href=\"#Preparations\" class=\"headerlink\" title=\"Preparations\"></a>Preparations</h1><p>Read the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;)</p>\n<p>I’m not going to go through the OS installation process here, but make sure to select the “Software Development” packages since you will be needing it. In case you missed it, you can install them later by running these commands.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># yum groupinstall \"Development Tools\"</span></span><br><span class=\"line\"><span class=\"comment\"># yum install kernel-headers</span></span><br></pre></td></tr></table></figure>\n<p>I’m not actually sure that you need to run the kernel-headers install manually or if it’s included in the “Development Tools” package.</p>\n<p>The first gotcha i ran into was the fact that the link to the Linux Integration Services–previously known as Linux Integration Components or LinuxIC–on RedHat’s information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on <a href=\"http://download.microsoft.com\" target=\"_blank\" rel=\"external\">http://download.microsoft.com</a> for “Linux Integration Components” do return the new page, and that’s where I learned about the new name.<br>_Thank you for making it easy for us Microsoft!<br>_Here’s a direct link to the search on the current name: <a href=\"http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&amp;displaylang=en&amp;stype=s_basic\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&amp;displaylang=en&amp;stype=s_basic</a><br>And here’s a direct link to the actual download page: <a href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551</a></p>\n<p>This download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># mkdir /mnt/ISO</span></span><br><span class=\"line\"><span class=\"comment\"># mount -o loop /root/LinuxIC v21.iso /mnt/ISO</span></span><br><span class=\"line\"><span class=\"comment\"># mkdir /opt/linux_ic_v21_rtm</span></span><br><span class=\"line\"><span class=\"comment\"># cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/</span></span><br><span class=\"line\"><span class=\"comment\"># umount /mnt/ISO</span></span><br></pre></td></tr></table></figure>\n<p>You probably have to be root to do this by the way.<br>With that done, let’s get to the installation.</p>\n<h1 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h1><p>As root, do the following:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># export PATH=$PATH:/sbin</span></span><br><span class=\"line\"><span class=\"comment\"># cd /opt/linux_ic_v21_rtm/</span></span><br><span class=\"line\"><span class=\"comment\"># make</span></span><br><span class=\"line\"> make install</span><br><span class=\"line\"><span class=\"comment\"># reboot</span></span><br></pre></td></tr></table></figure>\n<p>Why the export PATH command? Apparently, on RHES5, /sbin is not in the PATH by default and this is something that the make scripts are completely unaware of. The “make install” will try to run “depmod” which will fail since it’s not in the default path. You could also add “PATH=$PATH/sbin” to the root users ~/.bashrc which will put it back in the PATH but only for the root user, but I don’t know if that’s recommended.<br>And, yes. You DO have to reboot after the install.</p>\n<p>If you are running RHES5 64bit you also have to install the “adjtimex” package. It is in the RHN repository but also on the RHES5 Installation CD in case you have no internet connection. Install it with yum like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># yum install adjtimex</span><br></pre></td></tr></table></figure>\n<p>And from the CD (mount it first) like this:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># rpm –ivh /mnt/cdrom/Server/adjtimex-1.20-2.1.x86_64.rpm</span></span><br></pre></td></tr></table></figure>\n<p>And that’s basically it for the installation.</p>\n<h1 id=\"Verification\"><a href=\"#Verification\" class=\"headerlink\" title=\"Verification\"></a>Verification</h1><p>How do you know that the driver are installed?</p>\n<p>Aftr the reboot, try running “modinfo vmbus” which should return something like this:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># modinfo vmbus</span></span><br><span class=\"line\">filename:       /lib/modules/2.6.18-194.11.1.el5/kernel/drivers/vmbus/vmbus.ko</span><br><span class=\"line\">verion:        2.1.25</span><br><span class=\"line\">licnse:        GPL</span><br><span class=\"line\">srcversion:     3C1899C419665CB2514F2D0</span><br><span class=\"line\">depends:</span><br><span class=\"line\">vermagic:       2.6.18-194.11.1.el5 SMP mod_unload gcc-4.1</span><br><span class=\"line\">parm:           vmbus_irq:int</span><br><span class=\"line\">par:           vmbus_loglevel:int</span><br></pre></td></tr></table></figure>\n<p>Try that with netvsc, storvsc and blkvsc too (replace the <em>vmbus</em> part) and you should get something similar. If you don’t, the installation did not succeed.<br>The documentation also tells us to check that the components are running with “/sbin/lsmod | grep vsc” which should return:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># /bin/lsmod | grep vsc</span></span><br><span class=\"line\">blkvsc                 70184  3</span><br><span class=\"line\">storvsc                64264  0</span><br><span class=\"line\">netvsc                 73504  0</span><br><span class=\"line\">vmbus                  88304  3 blkvsc,storvsc,netvsc</span><br><span class=\"line\">scs_mod              196953  6 scsi_dh,sg,blkvsc,storvsc,libata,sd_mod</span><br></pre></td></tr></table></figure>\n<p>The numbers will probably differ from installation to installation depending on blocksizes and allocation.</p>\n<h1 id=\"Configuration\"><a href=\"#Configuration\" class=\"headerlink\" title=\"Configuration\"></a>Configuration</h1><p>Configuration is pretty straight-forward so I’ll keep this short.</p>\n<p>When you install the drivers you will get a new network card called <strong>seth0</strong>, which I presume stands for Synthetic ETHernet. There’s nothing magic about it regarding configuration and “system-configuration-network” will work just fine.<br>The drivers will also give you a couple of SCSI-devices (if you have one attached) with the regular <strong>/dev/sd*</strong> naming. Simply configure these using fdisk or whatever GUI you might prefer.</p>\n<p>There is also a note in the documentation about changing the grub configuration in the “Additional Information…” section. Do read that section.</p>\n<h1 id=\"Additional-Comments\"><a href=\"#Additional-Comments\" class=\"headerlink\" title=\"Additional Comments\"></a>Additional Comments</h1><p>One thing I tend to do now that disk space is dirt cheap is to copy all ISO-files I use locally instead of mounting them when needed through Hyper-V. Simply because you can bet your insert-shorter-word-for-buttocks that the day you need it again, someone has been kind enough to have done som spring-cleaning or it’s locked by another machine in the cluster. If you have it locally and followed my instructions in the “Preparation” section, you will allready have a /mnt/ISO directory. Only thing you’ll have to do is</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># mount -o loop /path/to/your.iso /mnt/ISO</span></span><br></pre></td></tr></table></figure>\n<p>And there you have it. Just remember to unmount it when you’re done.</p>\n<p>I also almost never use the Hyper-V remote connection interface thingy since it will give you a GUI and the mouse just won’t work. If you haven’t configured a network card yet though, you could connect through Hyper-V and hit <em>Ctrl+Alt+F1</em> to get a command prompt. Unfortunatly cut/paste don’t work here, but you could run <em>system-configuration-network</em>, assign an IP-address and then connect with an SSH client. I prefer PuTTY to a degree that I usually install the ported version on my Linux desktops aswell.</p>\n<p>And I never logon using root. People should know this, but it should be stressed anyway. Always logon as regular user and <em>su</em> or <em>sudo</em> when needed. I can’t understand why RHES has root-login enabled by default in the SSH-server config.</p>\n<p>Good luck!</p>\n","excerpt":"","more":"<p>Ok, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5. Something that turned out to be a bit more to handle than I would have thought. So here’s a little How-To.</p>\n<h1 id=\"Preparations\"><a href=\"#Preparations\" class=\"headerlink\" title=\"Preparations\"></a>Preparations</h1><p>Read the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;)</p>\n<p>I’m not going to go through the OS installation process here, but make sure to select the “Software Development” packages since you will be needing it. In case you missed it, you can install them later by running these commands.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># yum groupinstall \"Development Tools\"</span></span><br><span class=\"line\"><span class=\"comment\"># yum install kernel-headers</span></span><br></pre></td></tr></table></figure>\n<p>I’m not actually sure that you need to run the kernel-headers install manually or if it’s included in the “Development Tools” package.</p>\n<p>The first gotcha i ran into was the fact that the link to the Linux Integration Services–previously known as Linux Integration Components or LinuxIC–on RedHat’s information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on <a href=\"http://download.microsoft.com\">http://download.microsoft.com</a> for “Linux Integration Components” do return the new page, and that’s where I learned about the new name.<br>_Thank you for making it easy for us Microsoft!<br>_Here’s a direct link to the search on the current name: <a href=\"http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&amp;displaylang=en&amp;stype=s_basic\">http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&amp;displaylang=en&amp;stype=s_basic</a><br>And here’s a direct link to the actual download page: <a href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551\">http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551</a></p>\n<p>This download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># mkdir /mnt/ISO</span></span><br><span class=\"line\"><span class=\"comment\"># mount -o loop /root/LinuxIC v21.iso /mnt/ISO</span></span><br><span class=\"line\"><span class=\"comment\"># mkdir /opt/linux_ic_v21_rtm</span></span><br><span class=\"line\"><span class=\"comment\"># cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/</span></span><br><span class=\"line\"><span class=\"comment\"># umount /mnt/ISO</span></span><br></pre></td></tr></table></figure>\n<p>You probably have to be root to do this by the way.<br>With that done, let’s get to the installation.</p>\n<h1 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h1><p>As root, do the following:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># export PATH=$PATH:/sbin</span></span><br><span class=\"line\"><span class=\"comment\"># cd /opt/linux_ic_v21_rtm/</span></span><br><span class=\"line\"><span class=\"comment\"># make</span></span><br><span class=\"line\"> make install</span><br><span class=\"line\"><span class=\"comment\"># reboot</span></span><br></pre></td></tr></table></figure>\n<p>Why the export PATH command? Apparently, on RHES5, /sbin is not in the PATH by default and this is something that the make scripts are completely unaware of. The “make install” will try to run “depmod” which will fail since it’s not in the default path. You could also add “PATH=$PATH/sbin” to the root users ~/.bashrc which will put it back in the PATH but only for the root user, but I don’t know if that’s recommended.<br>And, yes. You DO have to reboot after the install.</p>\n<p>If you are running RHES5 64bit you also have to install the “adjtimex” package. It is in the RHN repository but also on the RHES5 Installation CD in case you have no internet connection. Install it with yum like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># yum install adjtimex</span><br></pre></td></tr></table></figure>\n<p>And from the CD (mount it first) like this:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># rpm –ivh /mnt/cdrom/Server/adjtimex-1.20-2.1.x86_64.rpm</span></span><br></pre></td></tr></table></figure>\n<p>And that’s basically it for the installation.</p>\n<h1 id=\"Verification\"><a href=\"#Verification\" class=\"headerlink\" title=\"Verification\"></a>Verification</h1><p>How do you know that the driver are installed?</p>\n<p>Aftr the reboot, try running “modinfo vmbus” which should return something like this:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># modinfo vmbus</span></span><br><span class=\"line\">filename:       /lib/modules/2.6.18-194.11.1.el5/kernel/drivers/vmbus/vmbus.ko</span><br><span class=\"line\">verion:        2.1.25</span><br><span class=\"line\">licnse:        GPL</span><br><span class=\"line\">srcversion:     3C1899C419665CB2514F2D0</span><br><span class=\"line\">depends:</span><br><span class=\"line\">vermagic:       2.6.18-194.11.1.el5 SMP mod_unload gcc-4.1</span><br><span class=\"line\">parm:           vmbus_irq:int</span><br><span class=\"line\">par:           vmbus_loglevel:int</span><br></pre></td></tr></table></figure>\n<p>Try that with netvsc, storvsc and blkvsc too (replace the <em>vmbus</em> part) and you should get something similar. If you don’t, the installation did not succeed.<br>The documentation also tells us to check that the components are running with “/sbin/lsmod | grep vsc” which should return:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># /bin/lsmod | grep vsc</span></span><br><span class=\"line\">blkvsc                 70184  3</span><br><span class=\"line\">storvsc                64264  0</span><br><span class=\"line\">netvsc                 73504  0</span><br><span class=\"line\">vmbus                  88304  3 blkvsc,storvsc,netvsc</span><br><span class=\"line\">scs_mod              196953  6 scsi_dh,sg,blkvsc,storvsc,libata,sd_mod</span><br></pre></td></tr></table></figure>\n<p>The numbers will probably differ from installation to installation depending on blocksizes and allocation.</p>\n<h1 id=\"Configuration\"><a href=\"#Configuration\" class=\"headerlink\" title=\"Configuration\"></a>Configuration</h1><p>Configuration is pretty straight-forward so I’ll keep this short.</p>\n<p>When you install the drivers you will get a new network card called <strong>seth0</strong>, which I presume stands for Synthetic ETHernet. There’s nothing magic about it regarding configuration and “system-configuration-network” will work just fine.<br>The drivers will also give you a couple of SCSI-devices (if you have one attached) with the regular <strong>/dev/sd*</strong> naming. Simply configure these using fdisk or whatever GUI you might prefer.</p>\n<p>There is also a note in the documentation about changing the grub configuration in the “Additional Information…” section. Do read that section.</p>\n<h1 id=\"Additional-Comments\"><a href=\"#Additional-Comments\" class=\"headerlink\" title=\"Additional Comments\"></a>Additional Comments</h1><p>One thing I tend to do now that disk space is dirt cheap is to copy all ISO-files I use locally instead of mounting them when needed through Hyper-V. Simply because you can bet your insert-shorter-word-for-buttocks that the day you need it again, someone has been kind enough to have done som spring-cleaning or it’s locked by another machine in the cluster. If you have it locally and followed my instructions in the “Preparation” section, you will allready have a /mnt/ISO directory. Only thing you’ll have to do is</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># mount -o loop /path/to/your.iso /mnt/ISO</span></span><br></pre></td></tr></table></figure>\n<p>And there you have it. Just remember to unmount it when you’re done.</p>\n<p>I also almost never use the Hyper-V remote connection interface thingy since it will give you a GUI and the mouse just won’t work. If you haven’t configured a network card yet though, you could connect through Hyper-V and hit <em>Ctrl+Alt+F1</em> to get a command prompt. Unfortunatly cut/paste don’t work here, but you could run <em>system-configuration-network</em>, assign an IP-address and then connect with an SSH client. I prefer PuTTY to a degree that I usually install the ported version on my Linux desktops aswell.</p>\n<p>And I never logon using root. People should know this, but it should be stressed anyway. Always logon as regular user and <em>su</em> or <em>sudo</em> when needed. I can’t understand why RHES has root-login enabled by default in the SSH-server config.</p>\n<p>Good luck!</p>\n"},{"title":"Installing SQL Reporting Services 2005 on Windows 2008 x64","id":"232","date":"2009-11-02T13:33:27.000Z","_content":"\nLet’s say you have followed this guide: [http://support.microsoft.com/kb/938245/](http://support.microsoft.com/kb/938245/ \"http://support.microsoft.com/kb/938245/\")\n\nStill not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to “Classic .NET AppPool”. It is actually noted in [KB938245](http://support.microsoft.com/kb/938245/) but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation.\n\nMaybe I am doing it wrong but this seems to be working all right for me.","source":"_posts/installing-sql-reporting-services-2005-on-windows-2008-x64.md","raw":"---\ntitle: Installing SQL Reporting Services 2005 on Windows 2008 x64\ntags:\n  - How-To\n  - IIS7\n  - Reporting Services\n  - x64\n  - OpsMgr 2007\nid: 232\ncategories:\n  - Microsoft\n  - SQL Server\ndate: 2009-11-02 14:33:27\n---\n\nLet’s say you have followed this guide: [http://support.microsoft.com/kb/938245/](http://support.microsoft.com/kb/938245/ \"http://support.microsoft.com/kb/938245/\")\n\nStill not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to “Classic .NET AppPool”. It is actually noted in [KB938245](http://support.microsoft.com/kb/938245/) but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation.\n\nMaybe I am doing it wrong but this seems to be working all right for me.","slug":"installing-sql-reporting-services-2005-on-windows-2008-x64","published":1,"updated":"2016-05-24T21:52:06.529Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7h9000sq4o2l43h0ekp","content":"<p>Let’s say you have followed this guide: <a href=\"http://support.microsoft.com/kb/938245/\" title=\"http://support.microsoft.com/kb/938245/\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/938245/</a></p>\n<p>Still not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to “Classic .NET AppPool”. It is actually noted in <a href=\"http://support.microsoft.com/kb/938245/\" target=\"_blank\" rel=\"external\">KB938245</a> but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation.</p>\n<p>Maybe I am doing it wrong but this seems to be working all right for me.</p>\n","excerpt":"","more":"<p>Let’s say you have followed this guide: <a href=\"http://support.microsoft.com/kb/938245/\" title=\"http://support.microsoft.com/kb/938245/\">http://support.microsoft.com/kb/938245/</a></p>\n<p>Still not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to “Classic .NET AppPool”. It is actually noted in <a href=\"http://support.microsoft.com/kb/938245/\">KB938245</a> but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation.</p>\n<p>Maybe I am doing it wrong but this seems to be working all right for me.</p>\n"},{"title":"Intel Drivers causes old-school freezes on Windows Vista","id":"81","date":"2007-12-01T11:31:55.000Z","_content":"\nI recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff.\n\nNow, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off.\n\nApparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called \"Windows Hybrid Hard Disk Power Savings Mode\". (Christ! Whatever happened to abrevations? I think i want those back. \"ITMD and IMSM with WHDDPSM causes hickups\"... no... wait.)\n\nAaaanyway.\nThe people over at the [forums of Notebookreview.com](http://forum.notebookreview.com) has experienced this and posted a guide with the appropriate links. \n\nCheck it out at [http://forum.notebookreview.com/showthread.php?t=160154&page=2](http://forum.notebookreview.com/showthread.php?t=160154&page=2 \"http://forum.notebookreview.com/showthread.php?t=160154&page=2\")\n\nCheers!","source":"_posts/intel-drivers-causes-old-school-freezes-on-windows-vista.md","raw":"---\ntitle: Intel Drivers causes old-school freezes on Windows Vista\ntags:\n  - Drivers\nid: 81\ncategories:\n  - Microsoft\n  - Windows Vista\ndate: 2007-12-01 12:31:55\n---\n\nI recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff.\n\nNow, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off.\n\nApparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called \"Windows Hybrid Hard Disk Power Savings Mode\". (Christ! Whatever happened to abrevations? I think i want those back. \"ITMD and IMSM with WHDDPSM causes hickups\"... no... wait.)\n\nAaaanyway.\nThe people over at the [forums of Notebookreview.com](http://forum.notebookreview.com) has experienced this and posted a guide with the appropriate links. \n\nCheck it out at [http://forum.notebookreview.com/showthread.php?t=160154&page=2](http://forum.notebookreview.com/showthread.php?t=160154&page=2 \"http://forum.notebookreview.com/showthread.php?t=160154&page=2\")\n\nCheers!","slug":"intel-drivers-causes-old-school-freezes-on-windows-vista","published":1,"updated":"2016-05-24T21:51:55.339Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hb000uq4o2gfs2sx1s","content":"<p>I recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff.</p>\n<p>Now, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off.</p>\n<p>Apparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called “Windows Hybrid Hard Disk Power Savings Mode”. (Christ! Whatever happened to abrevations? I think i want those back. “ITMD and IMSM with WHDDPSM causes hickups”… no… wait.)</p>\n<p>Aaaanyway.<br>The people over at the <a href=\"http://forum.notebookreview.com\" target=\"_blank\" rel=\"external\">forums of Notebookreview.com</a> has experienced this and posted a guide with the appropriate links. </p>\n<p>Check it out at <a href=\"http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2\" title=\"http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2\" target=\"_blank\" rel=\"external\">http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2</a></p>\n<p>Cheers!</p>\n","excerpt":"","more":"<p>I recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff.</p>\n<p>Now, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off.</p>\n<p>Apparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called “Windows Hybrid Hard Disk Power Savings Mode”. (Christ! Whatever happened to abrevations? I think i want those back. “ITMD and IMSM with WHDDPSM causes hickups”… no… wait.)</p>\n<p>Aaaanyway.<br>The people over at the <a href=\"http://forum.notebookreview.com\">forums of Notebookreview.com</a> has experienced this and posted a guide with the appropriate links. </p>\n<p>Check it out at <a href=\"http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2\" title=\"http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2\">http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2</a></p>\n<p>Cheers!</p>\n"},{"title":"Introduction to TG WinAutoSvc v1","id":"489","date":"2011-04-29T09:35:47.000Z","_content":"\n# Background\n\nFor quite some time now I've had this idea spinning around in my head to write a couple of blog-posts about some of the more useful techniques available when building management packs. Many of these techniques are already described on MSDN and Technet- or other blogs as well as on various forums, but often no more than small bits and pieces of them and I have yet to see some humanly readable information about how to tie them together into a useful management pack. I say \"humanly readable\" because the information you do find online so far may be clear and somewhat easy to understand for someone with a system development background and a pretty good idea of how object oriented development models tend to work. But the real life System Center Operations Manager engineer--you know the one who get those _\"do you think we could monitor our ...-system too?\"_ questions a couple of times a week, you know... you (most likely, being here)--tend to have a completely different background. Yet as their OpsMgr environment grows, so does the demand for custom monitoring and all of a sudden the former server engineer are now also a developer. A developer who has never before had the need to grasp such abstract concepts as classes, instances, inheritance and who probably never before have had any reason whatsoever to write any XML code.\n\n# Purpose\n\nMy idea for this series of posts is to shed some light into the world of the authoring console and modules and cookdown and so forth. I am by no means an accredited author, but I will do my best to stay human in this venture and in plain english try to explain why and how you do certain things when going from Management Pack templates, rules, monitors and the safe haven that is authoring in the Operations Console into making your scripts resuable, easy to extend and prime for cookdown using the Authoring Console and XML.\n\n# The TG WinAutoSvc Management Pack\n\nTo give the series some kind of context and at the same time not only be a matter of examples I will base them on a fully functional management pack that discovers and monitors all Windows services that are set to automatic startup. I know there is other similar management packs out there but I haven't fancied any one of them yet, and since I had the idea of writing this series I decided that building a new one would be a good way to go. Some of the interesting features with this management pack is:\n\n* You will get an instance of the service classes for each and every service.\n* It uses different classes for Own Process services and Shared Process services (svchost for example).\n* Every service have a health state (you can use them in distributed applications).\n* The service state monitors are inherited from their base classes, no coding neccesary.\n* There is only one discovery script for all kinds of windows services.\n* Extending the discovery to include different kinds of windows services, like kernel processes, is a matter of filtering.\n* It is Open Source and licensed under the [Eclipse Public License v1](http://tg-winautosvc.googlecode.com/svn/trunk/LICENSE.TXT \"Eclipse Public License v1\").\n\nMost of these features will be described thoroughly in later posts in the series and as development of it progresses I will document what I do, how I do it and why I do it in certain ways. Hopefully you will learn something new through this and get closer to becoming that MP Dev the organization asks for.\nIn the mean time, feel free to download, look at the source code (which it by no means perfect) and try it out.\n\nThe TG WinAutoSvc monitoring management pack is available for download here:\n[http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml](http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml)\n\nThe latest revision of the source code is located here:\n[http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml](http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml)\n\nA small word of advice though. If you implement this in your environment, remember that you probably have alot more automatic services than you would expect. Because of this, discovery is disabled by default.\n\nBest of luck, and enjoy!","source":"_posts/introduction-to-tg-winautosvc-v1.md","raw":"---\ntitle: Introduction to TG WinAutoSvc v1\ntags:\n  - Management Pack\n  - MP Development\n  - OpsMgr\nid: 489\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2011-04-29 11:35:47\n---\n\n# Background\n\nFor quite some time now I've had this idea spinning around in my head to write a couple of blog-posts about some of the more useful techniques available when building management packs. Many of these techniques are already described on MSDN and Technet- or other blogs as well as on various forums, but often no more than small bits and pieces of them and I have yet to see some humanly readable information about how to tie them together into a useful management pack. I say \"humanly readable\" because the information you do find online so far may be clear and somewhat easy to understand for someone with a system development background and a pretty good idea of how object oriented development models tend to work. But the real life System Center Operations Manager engineer--you know the one who get those _\"do you think we could monitor our ...-system too?\"_ questions a couple of times a week, you know... you (most likely, being here)--tend to have a completely different background. Yet as their OpsMgr environment grows, so does the demand for custom monitoring and all of a sudden the former server engineer are now also a developer. A developer who has never before had the need to grasp such abstract concepts as classes, instances, inheritance and who probably never before have had any reason whatsoever to write any XML code.\n\n# Purpose\n\nMy idea for this series of posts is to shed some light into the world of the authoring console and modules and cookdown and so forth. I am by no means an accredited author, but I will do my best to stay human in this venture and in plain english try to explain why and how you do certain things when going from Management Pack templates, rules, monitors and the safe haven that is authoring in the Operations Console into making your scripts resuable, easy to extend and prime for cookdown using the Authoring Console and XML.\n\n# The TG WinAutoSvc Management Pack\n\nTo give the series some kind of context and at the same time not only be a matter of examples I will base them on a fully functional management pack that discovers and monitors all Windows services that are set to automatic startup. I know there is other similar management packs out there but I haven't fancied any one of them yet, and since I had the idea of writing this series I decided that building a new one would be a good way to go. Some of the interesting features with this management pack is:\n\n* You will get an instance of the service classes for each and every service.\n* It uses different classes for Own Process services and Shared Process services (svchost for example).\n* Every service have a health state (you can use them in distributed applications).\n* The service state monitors are inherited from their base classes, no coding neccesary.\n* There is only one discovery script for all kinds of windows services.\n* Extending the discovery to include different kinds of windows services, like kernel processes, is a matter of filtering.\n* It is Open Source and licensed under the [Eclipse Public License v1](http://tg-winautosvc.googlecode.com/svn/trunk/LICENSE.TXT \"Eclipse Public License v1\").\n\nMost of these features will be described thoroughly in later posts in the series and as development of it progresses I will document what I do, how I do it and why I do it in certain ways. Hopefully you will learn something new through this and get closer to becoming that MP Dev the organization asks for.\nIn the mean time, feel free to download, look at the source code (which it by no means perfect) and try it out.\n\nThe TG WinAutoSvc monitoring management pack is available for download here:\n[http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml](http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml)\n\nThe latest revision of the source code is located here:\n[http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml](http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml)\n\nA small word of advice though. If you implement this in your environment, remember that you probably have alot more automatic services than you would expect. Because of this, discovery is disabled by default.\n\nBest of luck, and enjoy!","slug":"introduction-to-tg-winautosvc-v1","published":1,"updated":"2016-05-24T21:51:40.087Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hg000yq4o2wx4yplad","content":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>For quite some time now I’ve had this idea spinning around in my head to write a couple of blog-posts about some of the more useful techniques available when building management packs. Many of these techniques are already described on MSDN and Technet- or other blogs as well as on various forums, but often no more than small bits and pieces of them and I have yet to see some humanly readable information about how to tie them together into a useful management pack. I say “humanly readable” because the information you do find online so far may be clear and somewhat easy to understand for someone with a system development background and a pretty good idea of how object oriented development models tend to work. But the real life System Center Operations Manager engineer–you know the one who get those <em>“do you think we could monitor our …-system too?”</em> questions a couple of times a week, you know… you (most likely, being here)–tend to have a completely different background. Yet as their OpsMgr environment grows, so does the demand for custom monitoring and all of a sudden the former server engineer are now also a developer. A developer who has never before had the need to grasp such abstract concepts as classes, instances, inheritance and who probably never before have had any reason whatsoever to write any XML code.</p>\n<h1 id=\"Purpose\"><a href=\"#Purpose\" class=\"headerlink\" title=\"Purpose\"></a>Purpose</h1><p>My idea for this series of posts is to shed some light into the world of the authoring console and modules and cookdown and so forth. I am by no means an accredited author, but I will do my best to stay human in this venture and in plain english try to explain why and how you do certain things when going from Management Pack templates, rules, monitors and the safe haven that is authoring in the Operations Console into making your scripts resuable, easy to extend and prime for cookdown using the Authoring Console and XML.</p>\n<h1 id=\"The-TG-WinAutoSvc-Management-Pack\"><a href=\"#The-TG-WinAutoSvc-Management-Pack\" class=\"headerlink\" title=\"The TG WinAutoSvc Management Pack\"></a>The TG WinAutoSvc Management Pack</h1><p>To give the series some kind of context and at the same time not only be a matter of examples I will base them on a fully functional management pack that discovers and monitors all Windows services that are set to automatic startup. I know there is other similar management packs out there but I haven’t fancied any one of them yet, and since I had the idea of writing this series I decided that building a new one would be a good way to go. Some of the interesting features with this management pack is:</p>\n<ul>\n<li>You will get an instance of the service classes for each and every service.</li>\n<li>It uses different classes for Own Process services and Shared Process services (svchost for example).</li>\n<li>Every service have a health state (you can use them in distributed applications).</li>\n<li>The service state monitors are inherited from their base classes, no coding neccesary.</li>\n<li>There is only one discovery script for all kinds of windows services.</li>\n<li>Extending the discovery to include different kinds of windows services, like kernel processes, is a matter of filtering.</li>\n<li>It is Open Source and licensed under the <a href=\"http://tg-winautosvc.googlecode.com/svn/trunk/LICENSE.TXT\" title=\"Eclipse Public License v1\" target=\"_blank\" rel=\"external\">Eclipse Public License v1</a>.</li>\n</ul>\n<p>Most of these features will be described thoroughly in later posts in the series and as development of it progresses I will document what I do, how I do it and why I do it in certain ways. Hopefully you will learn something new through this and get closer to becoming that MP Dev the organization asks for.<br>In the mean time, feel free to download, look at the source code (which it by no means perfect) and try it out.</p>\n<p>The TG WinAutoSvc monitoring management pack is available for download here:<br><a href=\"http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml\" target=\"_blank\" rel=\"external\">http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml</a></p>\n<p>The latest revision of the source code is located here:<br><a href=\"http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml\" target=\"_blank\" rel=\"external\">http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml</a></p>\n<p>A small word of advice though. If you implement this in your environment, remember that you probably have alot more automatic services than you would expect. Because of this, discovery is disabled by default.</p>\n<p>Best of luck, and enjoy!</p>\n","excerpt":"","more":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>For quite some time now I’ve had this idea spinning around in my head to write a couple of blog-posts about some of the more useful techniques available when building management packs. Many of these techniques are already described on MSDN and Technet- or other blogs as well as on various forums, but often no more than small bits and pieces of them and I have yet to see some humanly readable information about how to tie them together into a useful management pack. I say “humanly readable” because the information you do find online so far may be clear and somewhat easy to understand for someone with a system development background and a pretty good idea of how object oriented development models tend to work. But the real life System Center Operations Manager engineer–you know the one who get those <em>“do you think we could monitor our …-system too?”</em> questions a couple of times a week, you know… you (most likely, being here)–tend to have a completely different background. Yet as their OpsMgr environment grows, so does the demand for custom monitoring and all of a sudden the former server engineer are now also a developer. A developer who has never before had the need to grasp such abstract concepts as classes, instances, inheritance and who probably never before have had any reason whatsoever to write any XML code.</p>\n<h1 id=\"Purpose\"><a href=\"#Purpose\" class=\"headerlink\" title=\"Purpose\"></a>Purpose</h1><p>My idea for this series of posts is to shed some light into the world of the authoring console and modules and cookdown and so forth. I am by no means an accredited author, but I will do my best to stay human in this venture and in plain english try to explain why and how you do certain things when going from Management Pack templates, rules, monitors and the safe haven that is authoring in the Operations Console into making your scripts resuable, easy to extend and prime for cookdown using the Authoring Console and XML.</p>\n<h1 id=\"The-TG-WinAutoSvc-Management-Pack\"><a href=\"#The-TG-WinAutoSvc-Management-Pack\" class=\"headerlink\" title=\"The TG WinAutoSvc Management Pack\"></a>The TG WinAutoSvc Management Pack</h1><p>To give the series some kind of context and at the same time not only be a matter of examples I will base them on a fully functional management pack that discovers and monitors all Windows services that are set to automatic startup. I know there is other similar management packs out there but I haven’t fancied any one of them yet, and since I had the idea of writing this series I decided that building a new one would be a good way to go. Some of the interesting features with this management pack is:</p>\n<ul>\n<li>You will get an instance of the service classes for each and every service.</li>\n<li>It uses different classes for Own Process services and Shared Process services (svchost for example).</li>\n<li>Every service have a health state (you can use them in distributed applications).</li>\n<li>The service state monitors are inherited from their base classes, no coding neccesary.</li>\n<li>There is only one discovery script for all kinds of windows services.</li>\n<li>Extending the discovery to include different kinds of windows services, like kernel processes, is a matter of filtering.</li>\n<li>It is Open Source and licensed under the <a href=\"http://tg-winautosvc.googlecode.com/svn/trunk/LICENSE.TXT\" title=\"Eclipse Public License v1\">Eclipse Public License v1</a>.</li>\n</ul>\n<p>Most of these features will be described thoroughly in later posts in the series and as development of it progresses I will document what I do, how I do it and why I do it in certain ways. Hopefully you will learn something new through this and get closer to becoming that MP Dev the organization asks for.<br>In the mean time, feel free to download, look at the source code (which it by no means perfect) and try it out.</p>\n<p>The TG WinAutoSvc monitoring management pack is available for download here:<br><a href=\"http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml\">http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml</a></p>\n<p>The latest revision of the source code is located here:<br><a href=\"http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml\">http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml</a></p>\n<p>A small word of advice though. If you implement this in your environment, remember that you probably have alot more automatic services than you would expect. Because of this, discovery is disabled by default.</p>\n<p>Best of luck, and enjoy!</p>\n"},{"title":"Let's split!","id":"381","date":"2009-04-16T01:27:06.000Z","_content":"\nNow would you look at that.\n\nSince my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That's right, you're looking at it.\n\nInstead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven't set up yet, and a personal blogg for the... personal blogging... stuff.\n\nWhen time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far.\n\nHave a nice day!","source":"_posts/lets-split.md","raw":"---\ntitle: Let's split!\nid: 381\ncategories:\n  - Technobabble\ndate: 2009-04-16 03:27:06\ntags:\n---\n\nNow would you look at that.\n\nSince my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That's right, you're looking at it.\n\nInstead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven't set up yet, and a personal blogg for the... personal blogging... stuff.\n\nWhen time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far.\n\nHave a nice day!","slug":"lets-split","published":1,"updated":"2016-05-19T09:11:09.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hi0011q4o2x2sppbkz","content":"<p>Now would you look at that.</p>\n<p>Since my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That’s right, you’re looking at it.</p>\n<p>Instead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven’t set up yet, and a personal blogg for the… personal blogging… stuff.</p>\n<p>When time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far.</p>\n<p>Have a nice day!</p>\n","excerpt":"","more":"<p>Now would you look at that.</p>\n<p>Since my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That’s right, you’re looking at it.</p>\n<p>Instead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven’t set up yet, and a personal blogg for the… personal blogging… stuff.</p>\n<p>When time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far.</p>\n<p>Have a nice day!</p>\n"},{"title":"Linux Discovery – Not Enough Entropy","id":"243","date":"2009-12-02T11:37:08.000Z","_content":"\n# Error Description\n\nHere’s a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard:\n\n```xml\n<stdout>Generating certificate with hostname=\"COMPUTERNAME\"\n\n[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]\n\nFailed to allocate resource of type random data: Failed to get random data - not enough entropy\n\n</stdout><stderr>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1\n\n</stderr><returnCode>1</returnCode>\n\n<DataItem type=\"Microsoft.SSH.SSHCommandData\" time=\"2009-08-05T11:15:01.5800358-04:00\" sourceHealthServiceId=\"0EB1D6DA-202C-7FC5-3D46-BDBB9208547D\"><SSHCommandData><stdout>Generating certificate with hostname=\"COMPUTERNAME\"\n\n[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]\n\nFailed to allocate resource of type random data: Failed to get random data - not enough entropy\n\n</stdout><stderr>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1\n\n</stderr><returnCode>1</returnCode></SSHCommandData></DataItem>\n```\n\nBut first, a little background on the actual “problem”. To generate the certificate, the _entropy_ needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won’t be able to open up communications with the <acronym title=\"Management Server\">MS</acronym>. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there’s a lot more to it, but we really don’t need to know this. What _we_ need to know is that there has to be a “bit bucket” of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there’s not much random data flowing through the hardware and there’s no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of “Not enough entropy”. So, here’s the steps I usually takes to ensure that discovery works. I use [PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html) to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it.\n\n# Workaround\n\n## 1. Check you current entropy\n\n```text\ncat /proc/sys/kernel/random/entropy_avail\n```\n\nIs it less than, or close to, 256? It probably is. If you don’t feel like connecting a mouse and start wiggling it around—not really feasible in a data center—and see if the entropy increases, you can generate your own random data.\n\n## 2. Generate you own random data.\nBe advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don’t know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running:\n\n```text\ndd if=/dev/urandom of=~/.rnd bs=1 count=1024\n```\n\nThis creates a .rnd file with 1024B of random data that the certificate creation process will use instead of the system entropy if the file exists.\n\n## 3. Uninstall and re-discover\n\nThe first failed attempt of discovery will most likely leave a non-working agent installation that we have to remove. Otherwise we will just be stuck with an “Access Denied” error. Run:\n\n```text\nrpm –e scx\n```\n\nNow, try to discover the system again.\n\n## 4. Failed again?\n\nTry generating the certificate manually by running:\n\n```text\n/opt/microsoft/scx/bin/tools/scxsslconfig -f –v\n/opt/microsoft/scx/bin/tools/scxadmin –restart\n```\n\nRetry discovery again.\n\n## 5. Still fails?\n\nUninstall the agent once more as instructed in step 3.\nStese steps have solved my problems 100% on both SUSE and RedHat and hopefully they will help you too.\n\nInterestingely enough, these problems seems to be connected to some changes in the 2.6 kernel and basically everything that uses SSL-ish certificates will be affected. Even though the symptoms may be a bit more subtle, like time-outs and disconnects. For “headless” servers like those I usually to administer where the random data tend to be much lower, there’s even specialised hardware whose sole purpose is to generate random data, like the [Entropy Key](http://www.entropykey.co.uk/). I have also been told that new servers is likely to be equipped with entropy chipsets to make sure that there’s chaos enough to avoid these new-found oddities.\n\n> Sources:\n> [http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357](http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357 \"http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357\")\n\n> [http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\n> ](http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html \"http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\")","source":"_posts/linux-discovery-not-enough-entropy.md","raw":"---\ntitle: Linux Discovery – Not Enough Entropy\ntags:\n  - How-To\n  - Linux\n  - OpsMgr\n  - TroubleShooting\n  - X-Plat\nid: 243\ncategories:\n  - Linux\n  - SLES\ndate: 2009-12-02 12:37:08\n---\n\n# Error Description\n\nHere’s a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard:\n\n```xml\n<stdout>Generating certificate with hostname=\"COMPUTERNAME\"\n\n[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]\n\nFailed to allocate resource of type random data: Failed to get random data - not enough entropy\n\n</stdout><stderr>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1\n\n</stderr><returnCode>1</returnCode>\n\n<DataItem type=\"Microsoft.SSH.SSHCommandData\" time=\"2009-08-05T11:15:01.5800358-04:00\" sourceHealthServiceId=\"0EB1D6DA-202C-7FC5-3D46-BDBB9208547D\"><SSHCommandData><stdout>Generating certificate with hostname=\"COMPUTERNAME\"\n\n[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]\n\nFailed to allocate resource of type random data: Failed to get random data - not enough entropy\n\n</stdout><stderr>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1\n\n</stderr><returnCode>1</returnCode></SSHCommandData></DataItem>\n```\n\nBut first, a little background on the actual “problem”. To generate the certificate, the _entropy_ needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won’t be able to open up communications with the <acronym title=\"Management Server\">MS</acronym>. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there’s a lot more to it, but we really don’t need to know this. What _we_ need to know is that there has to be a “bit bucket” of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there’s not much random data flowing through the hardware and there’s no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of “Not enough entropy”. So, here’s the steps I usually takes to ensure that discovery works. I use [PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html) to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it.\n\n# Workaround\n\n## 1. Check you current entropy\n\n```text\ncat /proc/sys/kernel/random/entropy_avail\n```\n\nIs it less than, or close to, 256? It probably is. If you don’t feel like connecting a mouse and start wiggling it around—not really feasible in a data center—and see if the entropy increases, you can generate your own random data.\n\n## 2. Generate you own random data.\nBe advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don’t know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running:\n\n```text\ndd if=/dev/urandom of=~/.rnd bs=1 count=1024\n```\n\nThis creates a .rnd file with 1024B of random data that the certificate creation process will use instead of the system entropy if the file exists.\n\n## 3. Uninstall and re-discover\n\nThe first failed attempt of discovery will most likely leave a non-working agent installation that we have to remove. Otherwise we will just be stuck with an “Access Denied” error. Run:\n\n```text\nrpm –e scx\n```\n\nNow, try to discover the system again.\n\n## 4. Failed again?\n\nTry generating the certificate manually by running:\n\n```text\n/opt/microsoft/scx/bin/tools/scxsslconfig -f –v\n/opt/microsoft/scx/bin/tools/scxadmin –restart\n```\n\nRetry discovery again.\n\n## 5. Still fails?\n\nUninstall the agent once more as instructed in step 3.\nStese steps have solved my problems 100% on both SUSE and RedHat and hopefully they will help you too.\n\nInterestingely enough, these problems seems to be connected to some changes in the 2.6 kernel and basically everything that uses SSL-ish certificates will be affected. Even though the symptoms may be a bit more subtle, like time-outs and disconnects. For “headless” servers like those I usually to administer where the random data tend to be much lower, there’s even specialised hardware whose sole purpose is to generate random data, like the [Entropy Key](http://www.entropykey.co.uk/). I have also been told that new servers is likely to be equipped with entropy chipsets to make sure that there’s chaos enough to avoid these new-found oddities.\n\n> Sources:\n> [http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357](http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357 \"http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357\")\n\n> [http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\n> ](http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html \"http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\")","slug":"linux-discovery-not-enough-entropy","published":1,"updated":"2016-05-24T21:50:33.353Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hl0013q4o2nxdd9xvk","content":"<h1 id=\"Error-Description\"><a href=\"#Error-Description\" class=\"headerlink\" title=\"Error Description\"></a>Error Description</h1><p>Here’s a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">stdout</span>&gt;</span>Generating certificate with hostname=\"COMPUTERNAME\"</span><br><span class=\"line\"></span><br><span class=\"line\">[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]</span><br><span class=\"line\"></span><br><span class=\"line\">Failed to allocate resource of type random data: Failed to get random data - not enough entropy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stdout</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">stderr</span>&gt;</span>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stderr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">returnCode</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">returnCode</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">DataItem</span> <span class=\"attr\">type</span>=<span class=\"string\">\"Microsoft.SSH.SSHCommandData\"</span> <span class=\"attr\">time</span>=<span class=\"string\">\"2009-08-05T11:15:01.5800358-04:00\"</span> <span class=\"attr\">sourceHealthServiceId</span>=<span class=\"string\">\"0EB1D6DA-202C-7FC5-3D46-BDBB9208547D\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">SSHCommandData</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">stdout</span>&gt;</span>Generating certificate with hostname=\"COMPUTERNAME\"</span><br><span class=\"line\"></span><br><span class=\"line\">[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]</span><br><span class=\"line\"></span><br><span class=\"line\">Failed to allocate resource of type random data: Failed to get random data - not enough entropy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stdout</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">stderr</span>&gt;</span>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stderr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">returnCode</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">returnCode</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">SSHCommandData</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">DataItem</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>But first, a little background on the actual “problem”. To generate the certificate, the <em>entropy</em> needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won’t be able to open up communications with the <acronym title=\"Management Server\">MS</acronym>. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there’s a lot more to it, but we really don’t need to know this. What <em>we</em> need to know is that there has to be a “bit bucket” of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there’s not much random data flowing through the hardware and there’s no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of “Not enough entropy”. So, here’s the steps I usually takes to ensure that discovery works. I use <a href=\"http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html\" target=\"_blank\" rel=\"external\">PuTTY</a> to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it.</p>\n<h1 id=\"Workaround\"><a href=\"#Workaround\" class=\"headerlink\" title=\"Workaround\"></a>Workaround</h1><h2 id=\"1-Check-you-current-entropy\"><a href=\"#1-Check-you-current-entropy\" class=\"headerlink\" title=\"1. Check you current entropy\"></a>1. Check you current entropy</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cat /proc/sys/kernel/random/entropy_avail</span><br></pre></td></tr></table></figure>\n<p>Is it less than, or close to, 256? It probably is. If you don’t feel like connecting a mouse and start wiggling it around—not really feasible in a data center—and see if the entropy increases, you can generate your own random data.</p>\n<h2 id=\"2-Generate-you-own-random-data\"><a href=\"#2-Generate-you-own-random-data\" class=\"headerlink\" title=\"2. Generate you own random data.\"></a>2. Generate you own random data.</h2><p>Be advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don’t know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">dd if=/dev/urandom of=~/.rnd bs=1 count=1024</span><br></pre></td></tr></table></figure>\n<p>This creates a .rnd file with 1024B of random data that the certificate creation process will use instead of the system entropy if the file exists.</p>\n<h2 id=\"3-Uninstall-and-re-discover\"><a href=\"#3-Uninstall-and-re-discover\" class=\"headerlink\" title=\"3. Uninstall and re-discover\"></a>3. Uninstall and re-discover</h2><p>The first failed attempt of discovery will most likely leave a non-working agent installation that we have to remove. Otherwise we will just be stuck with an “Access Denied” error. Run:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">rpm –e scx</span><br></pre></td></tr></table></figure>\n<p>Now, try to discover the system again.</p>\n<h2 id=\"4-Failed-again\"><a href=\"#4-Failed-again\" class=\"headerlink\" title=\"4. Failed again?\"></a>4. Failed again?</h2><p>Try generating the certificate manually by running:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/opt/microsoft/scx/bin/tools/scxsslconfig -f –v</span><br><span class=\"line\">/opt/microsoft/scx/bin/tools/scxadmin –restart</span><br></pre></td></tr></table></figure>\n<p>Retry discovery again.</p>\n<h2 id=\"5-Still-fails\"><a href=\"#5-Still-fails\" class=\"headerlink\" title=\"5. Still fails?\"></a>5. Still fails?</h2><p>Uninstall the agent once more as instructed in step 3.<br>Stese steps have solved my problems 100% on both SUSE and RedHat and hopefully they will help you too.</p>\n<p>Interestingely enough, these problems seems to be connected to some changes in the 2.6 kernel and basically everything that uses SSL-ish certificates will be affected. Even though the symptoms may be a bit more subtle, like time-outs and disconnects. For “headless” servers like those I usually to administer where the random data tend to be much lower, there’s even specialised hardware whose sole purpose is to generate random data, like the <a href=\"http://www.entropykey.co.uk/\" target=\"_blank\" rel=\"external\">Entropy Key</a>. I have also been told that new servers is likely to be equipped with entropy chipsets to make sure that there’s chaos enough to avoid these new-found oddities.</p>\n<blockquote>\n<p>Sources:<br><a href=\"http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357\" title=\"http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357\" target=\"_blank\" rel=\"external\">http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357</a></p>\n<p><a href=\"http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\" title=\"http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\" target=\"_blank\" rel=\"external\">http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\n</a></p>\n</blockquote>\n","excerpt":"","more":"<h1 id=\"Error-Description\"><a href=\"#Error-Description\" class=\"headerlink\" title=\"Error Description\"></a>Error Description</h1><p>Here’s a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">stdout</span>&gt;</span>Generating certificate with hostname=\"COMPUTERNAME\"</span><br><span class=\"line\"></span><br><span class=\"line\">[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]</span><br><span class=\"line\"></span><br><span class=\"line\">Failed to allocate resource of type random data: Failed to get random data - not enough entropy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stdout</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">stderr</span>&gt;</span>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stderr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">returnCode</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">returnCode</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">DataItem</span> <span class=\"attr\">type</span>=<span class=\"string\">\"Microsoft.SSH.SSHCommandData\"</span> <span class=\"attr\">time</span>=<span class=\"string\">\"2009-08-05T11:15:01.5800358-04:00\"</span> <span class=\"attr\">sourceHealthServiceId</span>=<span class=\"string\">\"0EB1D6DA-202C-7FC5-3D46-BDBB9208547D\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">SSHCommandData</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">stdout</span>&gt;</span>Generating certificate with hostname=\"COMPUTERNAME\"</span><br><span class=\"line\"></span><br><span class=\"line\">[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]</span><br><span class=\"line\"></span><br><span class=\"line\">Failed to allocate resource of type random data: Failed to get random data - not enough entropy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stdout</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">stderr</span>&gt;</span>error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">stderr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">returnCode</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">returnCode</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">SSHCommandData</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">DataItem</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>But first, a little background on the actual “problem”. To generate the certificate, the <em>entropy</em> needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won’t be able to open up communications with the <acronym title=\"Management Server\">MS</acronym>. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there’s a lot more to it, but we really don’t need to know this. What <em>we</em> need to know is that there has to be a “bit bucket” of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there’s not much random data flowing through the hardware and there’s no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of “Not enough entropy”. So, here’s the steps I usually takes to ensure that discovery works. I use <a href=\"http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html\">PuTTY</a> to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it.</p>\n<h1 id=\"Workaround\"><a href=\"#Workaround\" class=\"headerlink\" title=\"Workaround\"></a>Workaround</h1><h2 id=\"1-Check-you-current-entropy\"><a href=\"#1-Check-you-current-entropy\" class=\"headerlink\" title=\"1. Check you current entropy\"></a>1. Check you current entropy</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cat /proc/sys/kernel/random/entropy_avail</span><br></pre></td></tr></table></figure>\n<p>Is it less than, or close to, 256? It probably is. If you don’t feel like connecting a mouse and start wiggling it around—not really feasible in a data center—and see if the entropy increases, you can generate your own random data.</p>\n<h2 id=\"2-Generate-you-own-random-data\"><a href=\"#2-Generate-you-own-random-data\" class=\"headerlink\" title=\"2. Generate you own random data.\"></a>2. Generate you own random data.</h2><p>Be advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don’t know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">dd if=/dev/urandom of=~/.rnd bs=1 count=1024</span><br></pre></td></tr></table></figure>\n<p>This creates a .rnd file with 1024B of random data that the certificate creation process will use instead of the system entropy if the file exists.</p>\n<h2 id=\"3-Uninstall-and-re-discover\"><a href=\"#3-Uninstall-and-re-discover\" class=\"headerlink\" title=\"3. Uninstall and re-discover\"></a>3. Uninstall and re-discover</h2><p>The first failed attempt of discovery will most likely leave a non-working agent installation that we have to remove. Otherwise we will just be stuck with an “Access Denied” error. Run:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">rpm –e scx</span><br></pre></td></tr></table></figure>\n<p>Now, try to discover the system again.</p>\n<h2 id=\"4-Failed-again\"><a href=\"#4-Failed-again\" class=\"headerlink\" title=\"4. Failed again?\"></a>4. Failed again?</h2><p>Try generating the certificate manually by running:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/opt/microsoft/scx/bin/tools/scxsslconfig -f –v</span><br><span class=\"line\">/opt/microsoft/scx/bin/tools/scxadmin –restart</span><br></pre></td></tr></table></figure>\n<p>Retry discovery again.</p>\n<h2 id=\"5-Still-fails\"><a href=\"#5-Still-fails\" class=\"headerlink\" title=\"5. Still fails?\"></a>5. Still fails?</h2><p>Uninstall the agent once more as instructed in step 3.<br>Stese steps have solved my problems 100% on both SUSE and RedHat and hopefully they will help you too.</p>\n<p>Interestingely enough, these problems seems to be connected to some changes in the 2.6 kernel and basically everything that uses SSL-ish certificates will be affected. Even though the symptoms may be a bit more subtle, like time-outs and disconnects. For “headless” servers like those I usually to administer where the random data tend to be much lower, there’s even specialised hardware whose sole purpose is to generate random data, like the <a href=\"http://www.entropykey.co.uk/\">Entropy Key</a>. I have also been told that new servers is likely to be equipped with entropy chipsets to make sure that there’s chaos enough to avoid these new-found oddities.</p>\n<blockquote>\n<p>Sources:<br><a href=\"http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357\" title=\"http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357\">http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357</a></p>\n<p><a href=\"http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\" title=\"http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\">http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html\n</a></p>\n</blockquote>\n"},{"title":"Load-balanced SCOM2012 SDK Services for Network Illiterates [#opsmgr, #nlb]","id":"639","date":"2012-05-18T11:16:51.000Z","_content":"\n# Prelude\n\nNow that System Center Operations Manager no longer has that pesky Root Management Server role; a server role that in larger environments quickly became the choking point and made creating a fully Highly Available SCOM-environment both complex and frustrating to support and with little gain at that. With that gone and the SDK Service, or Data Access Service, thriving on all the Management Servers HA suddenly became pretty simple. All you have to do in SCOM2012 to make sure your management groups keep on kicking is to have at-least two Management Servers and your databases clustered.\n\nThis new distributed architecture does not only give easy HA, it also makes it possible to connect to the SDK-service—be it using the Operations Console or powershell to name two options—on _any_ Management Server. This, in turn, provides for a completely new level of scalability. Choked on sessions? Deploy a new Management Server!\n\nAnyway… given all this scalability and HA, would it not be nice if you could load-balance all these SDK-sessions you will be running from System Center Virtual Machine Manager, System Center Service Manager, System Center Orchestrator, regular scheduled powershell scripts and what-not?\n\nOf course it would! And you can! The simple solution is to use the built-in Network Load Balancer (NLB for short) feature in Windows Server and that's what we're going to discuss in this post.\nBefore we go, I'd like to point to a [great article](http://systemcentertech.com/2012/02/07/load-balance-scom-2012-operations-console-connections/) written by [Justin Cook](http://systemcentertech.com/) that is covering most bases but in a less for-dummies way. So, yeah… I suppose this is the for-dummies version then. ;)\n\nEnjoy!\n\n<!--more-->\n\n# Prerequisites\n\nWe need to have the Network Load Balancing feature installed on all our targeted Management servers. The quick way to do this is using command-line (Windows Server 2008 R2 or later?).\n\n```text\ndism /online /enable-feature /featurename:NetworkLoadBalancingFullServer\n```\n\nYou also need a plan and some information about your new cluster. Make sure you have identified the following parameters before starting the configuration:\n<div>\n<table style=\"border-collapse: collapse;\" border=\"0\"><colgroup> <col style=\"width: 307px;\" /> <col style=\"width: 307px;\" /></colgroup>\n<tbody valign=\"top\">\n<tr>\n<td style=\"padding-left: 7px; padding-right: 7px; border: solid 0.5pt;\">A Dedicated Cluster IP-Address:</td>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td>\n</tr>\n<tr>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A Dedicated Cluster DNS Name:</td>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td>\n</tr>\n<tr>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A list of SCOM2012 Management Servers:</td>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td>\n</tr>\n</tbody>\n</table>\n</div>\nYou can use this pre-flight table to take note of your IP-address, DNS Name and Server List.\n\n# Create a New Cluster\n\nOpen the Network Load Balancing Manager and create a new cluster.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png)\n\nIn the \"New Cluster\" dialogue, connect to one of your Management Servers.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png)\n\n1. Enter the name of a management server\n2. Click Connect\n3. Select the network interface to use\n4. Click Next\n\nSelect the settings on your first host in the cluster.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png)\n\n1. Make sure it's the correct IP-address.\n2. Click Next\n\nSet the Cluster IP-address.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png)\n\n1. Click Add\n2. Enter your Dedicated Cluster IP-Address and Subnet mask\n3. Click OK\n4. Click Next\n\nIf need additional IP-addresses, like an IPv6 address, you simply repeat step 1-3 before proceeding to step 4.\n\nEdit DNS Names and Cluster Operation Mode.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png)\n\n1. Select your Dedicated Cluster IP-address\n2. Enter your chosen Dedicated Cluster DNS Name\n3. Select Multicast mode\n4. Click Next\n\n> Note: We are not going to delve into the Cluster Operation Mode in this guide, but this is what I use for Operations Manager 2012.\n\n> If you want to learn more about these settings, here's the KB on the various settings: [http://support.microsoft.com/kb/323437](http://support.microsoft.com/kb/323437)\nSet your Port Rules and Affinity Settings.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png)\n\n1. Verify that Affinity is set to \"Single\". If not, Click \"Edit…\" and adjust.\n2. Click Finish\n\n> Note: \"Single\" affinity tells the cluster to always direct the same client to the same host if possible. This is required to be able to support sessions.\n\n> In the world of NLB, a \"client\" is an IP-address.\n\n## Post-Configuration\n\nNow that you have a cluster configured you have to make sure your SDK-clients are able to resolve the dedicated cluster DNS-name. The one you picked in the pre-flight table.\n\nTo enable name resolution you have to add your cluster DNS-name to your DNS-zone and point it to your dedicated cluster IP-address. Make it an A-record and it should work.\n\nIf you intend to use the cluster name from outside the local network or subnet—Operation Consoles or Powershell sessions for example—you would also need to verify that the router is able to handle the multicast packages. I am by no means a network guy, but asking the person behind that \"Don't blame the network\" sign to help you access a NLB cluster on network _X _from network _Y_ usually works. One way to troubleshoot this is to ping the cluster DNS-name from one of the hosts. If that works but you are still unable to ping from another network or subnet, then it might be a router setting.\n\n<!--more-->\n\n# Adding Hosts to the Cluster\n\nWith the cluster configured and up-and-running you need to add the rest of the Management Servers. Repeat this section for each Management Server you wish to add to the load-balancing cluster.\n\nIn the Network Load Balancing Manager, right-click your cluster and select \"Add Host To Cluster\".\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png)\n\nConnect to your next Management Server to be added\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png)\n\n1. Enter the server name of the Management Server (\"host\" in cluster terminology)\n2. Click Connect\n3. Select the IP-address of the host\n4. Click Next\n\nVerify your Host Parameters\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png)\n\n1. Doublecheck the IP-address\n2. Click Next\n\nVerify the Port Rules\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png)\n\n1. Make sure that Load is Equal and Affinity is Single\n2. Click Finish\n\n# Final Verification\n\nAfter each added host it would be proper to check if it was added correctly. The easiest way is to check their statuses in the Network Load Balancing Manager. Green is generally considered good and you want your hosts to be \"Converged\".\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png)\n\nAnother way to verify functionality is to point your Operations Manager console to the Cluster DNS-name instead and connect. If you are in a lab or in an environment where it is OK to shut down Management Servers you could try that as well.\n\nConsidering my note on routers in the Cluster Post-Configuration I guess it would be prudent to point out that you should try launching SDK-sessions from all networks you intend to connect from. Just to make sure that your routers are correctly configured to handle these kinds of sessions.\n\n<!--more-->\n\n# Postlude\n\nNow; as easy this may be I would personally argue that you should involve your network team _before_ starting to deploy your load-balanced clusters. A little heads-up is always a good thing—I have noticed that network people rarely like surprises—and they might actually be able to help you all the way is you ask nicely. And maybe they'll tell you right away that some configuration is required before-hand instead of giggling frantically in a corner at your feeble attempts to troubleshoot your fresh little cluster.\n\nSoooo… have fun!\n\nAnd remember; with great powers come great responsibility.\n\n*Sheesh! This post got out of hand!*\n","source":"_posts/load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb.md","raw":"---\ntitle: 'Load-balanced SCOM2012 SDK Services for Network Illiterates [#opsmgr, #nlb]'\ntags:\n  - Highly-Available\n  - How-To\n  - NLB\n  - OpsMgr\n  - Tutorial\nid: 639\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2012-05-18 13:16:51\n---\n\n# Prelude\n\nNow that System Center Operations Manager no longer has that pesky Root Management Server role; a server role that in larger environments quickly became the choking point and made creating a fully Highly Available SCOM-environment both complex and frustrating to support and with little gain at that. With that gone and the SDK Service, or Data Access Service, thriving on all the Management Servers HA suddenly became pretty simple. All you have to do in SCOM2012 to make sure your management groups keep on kicking is to have at-least two Management Servers and your databases clustered.\n\nThis new distributed architecture does not only give easy HA, it also makes it possible to connect to the SDK-service—be it using the Operations Console or powershell to name two options—on _any_ Management Server. This, in turn, provides for a completely new level of scalability. Choked on sessions? Deploy a new Management Server!\n\nAnyway… given all this scalability and HA, would it not be nice if you could load-balance all these SDK-sessions you will be running from System Center Virtual Machine Manager, System Center Service Manager, System Center Orchestrator, regular scheduled powershell scripts and what-not?\n\nOf course it would! And you can! The simple solution is to use the built-in Network Load Balancer (NLB for short) feature in Windows Server and that's what we're going to discuss in this post.\nBefore we go, I'd like to point to a [great article](http://systemcentertech.com/2012/02/07/load-balance-scom-2012-operations-console-connections/) written by [Justin Cook](http://systemcentertech.com/) that is covering most bases but in a less for-dummies way. So, yeah… I suppose this is the for-dummies version then. ;)\n\nEnjoy!\n\n<!--more-->\n\n# Prerequisites\n\nWe need to have the Network Load Balancing feature installed on all our targeted Management servers. The quick way to do this is using command-line (Windows Server 2008 R2 or later?).\n\n```text\ndism /online /enable-feature /featurename:NetworkLoadBalancingFullServer\n```\n\nYou also need a plan and some information about your new cluster. Make sure you have identified the following parameters before starting the configuration:\n<div>\n<table style=\"border-collapse: collapse;\" border=\"0\"><colgroup> <col style=\"width: 307px;\" /> <col style=\"width: 307px;\" /></colgroup>\n<tbody valign=\"top\">\n<tr>\n<td style=\"padding-left: 7px; padding-right: 7px; border: solid 0.5pt;\">A Dedicated Cluster IP-Address:</td>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td>\n</tr>\n<tr>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A Dedicated Cluster DNS Name:</td>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td>\n</tr>\n<tr>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A list of SCOM2012 Management Servers:</td>\n<td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td>\n</tr>\n</tbody>\n</table>\n</div>\nYou can use this pre-flight table to take note of your IP-address, DNS Name and Server List.\n\n# Create a New Cluster\n\nOpen the Network Load Balancing Manager and create a new cluster.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png)\n\nIn the \"New Cluster\" dialogue, connect to one of your Management Servers.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png)\n\n1. Enter the name of a management server\n2. Click Connect\n3. Select the network interface to use\n4. Click Next\n\nSelect the settings on your first host in the cluster.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png)\n\n1. Make sure it's the correct IP-address.\n2. Click Next\n\nSet the Cluster IP-address.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png)\n\n1. Click Add\n2. Enter your Dedicated Cluster IP-Address and Subnet mask\n3. Click OK\n4. Click Next\n\nIf need additional IP-addresses, like an IPv6 address, you simply repeat step 1-3 before proceeding to step 4.\n\nEdit DNS Names and Cluster Operation Mode.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png)\n\n1. Select your Dedicated Cluster IP-address\n2. Enter your chosen Dedicated Cluster DNS Name\n3. Select Multicast mode\n4. Click Next\n\n> Note: We are not going to delve into the Cluster Operation Mode in this guide, but this is what I use for Operations Manager 2012.\n\n> If you want to learn more about these settings, here's the KB on the various settings: [http://support.microsoft.com/kb/323437](http://support.microsoft.com/kb/323437)\nSet your Port Rules and Affinity Settings.\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png)\n\n1. Verify that Affinity is set to \"Single\". If not, Click \"Edit…\" and adjust.\n2. Click Finish\n\n> Note: \"Single\" affinity tells the cluster to always direct the same client to the same host if possible. This is required to be able to support sessions.\n\n> In the world of NLB, a \"client\" is an IP-address.\n\n## Post-Configuration\n\nNow that you have a cluster configured you have to make sure your SDK-clients are able to resolve the dedicated cluster DNS-name. The one you picked in the pre-flight table.\n\nTo enable name resolution you have to add your cluster DNS-name to your DNS-zone and point it to your dedicated cluster IP-address. Make it an A-record and it should work.\n\nIf you intend to use the cluster name from outside the local network or subnet—Operation Consoles or Powershell sessions for example—you would also need to verify that the router is able to handle the multicast packages. I am by no means a network guy, but asking the person behind that \"Don't blame the network\" sign to help you access a NLB cluster on network _X _from network _Y_ usually works. One way to troubleshoot this is to ping the cluster DNS-name from one of the hosts. If that works but you are still unable to ping from another network or subnet, then it might be a router setting.\n\n<!--more-->\n\n# Adding Hosts to the Cluster\n\nWith the cluster configured and up-and-running you need to add the rest of the Management Servers. Repeat this section for each Management Server you wish to add to the load-balancing cluster.\n\nIn the Network Load Balancing Manager, right-click your cluster and select \"Add Host To Cluster\".\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png)\n\nConnect to your next Management Server to be added\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png)\n\n1. Enter the server name of the Management Server (\"host\" in cluster terminology)\n2. Click Connect\n3. Select the IP-address of the host\n4. Click Next\n\nVerify your Host Parameters\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png)\n\n1. Doublecheck the IP-address\n2. Click Next\n\nVerify the Port Rules\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png)\n\n1. Make sure that Load is Equal and Affinity is Single\n2. Click Finish\n\n# Final Verification\n\nAfter each added host it would be proper to check if it was added correctly. The easiest way is to check their statuses in the Network Load Balancing Manager. Green is generally considered good and you want your hosts to be \"Converged\".\n\n![](http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png)\n\nAnother way to verify functionality is to point your Operations Manager console to the Cluster DNS-name instead and connect. If you are in a lab or in an environment where it is OK to shut down Management Servers you could try that as well.\n\nConsidering my note on routers in the Cluster Post-Configuration I guess it would be prudent to point out that you should try launching SDK-sessions from all networks you intend to connect from. Just to make sure that your routers are correctly configured to handle these kinds of sessions.\n\n<!--more-->\n\n# Postlude\n\nNow; as easy this may be I would personally argue that you should involve your network team _before_ starting to deploy your load-balanced clusters. A little heads-up is always a good thing—I have noticed that network people rarely like surprises—and they might actually be able to help you all the way is you ask nicely. And maybe they'll tell you right away that some configuration is required before-hand instead of giggling frantically in a corner at your feeble attempts to troubleshoot your fresh little cluster.\n\nSoooo… have fun!\n\nAnd remember; with great powers come great responsibility.\n\n*Sheesh! This post got out of hand!*\n","slug":"load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb","published":1,"updated":"2016-05-24T21:45:26.461Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hn0015q4o24l4si41l","content":"<h1 id=\"Prelude\"><a href=\"#Prelude\" class=\"headerlink\" title=\"Prelude\"></a>Prelude</h1><p>Now that System Center Operations Manager no longer has that pesky Root Management Server role; a server role that in larger environments quickly became the choking point and made creating a fully Highly Available SCOM-environment both complex and frustrating to support and with little gain at that. With that gone and the SDK Service, or Data Access Service, thriving on all the Management Servers HA suddenly became pretty simple. All you have to do in SCOM2012 to make sure your management groups keep on kicking is to have at-least two Management Servers and your databases clustered.</p>\n<p>This new distributed architecture does not only give easy HA, it also makes it possible to connect to the SDK-service—be it using the Operations Console or powershell to name two options—on <em>any</em> Management Server. This, in turn, provides for a completely new level of scalability. Choked on sessions? Deploy a new Management Server!</p>\n<p>Anyway… given all this scalability and HA, would it not be nice if you could load-balance all these SDK-sessions you will be running from System Center Virtual Machine Manager, System Center Service Manager, System Center Orchestrator, regular scheduled powershell scripts and what-not?</p>\n<p>Of course it would! And you can! The simple solution is to use the built-in Network Load Balancer (NLB for short) feature in Windows Server and that’s what we’re going to discuss in this post.<br>Before we go, I’d like to point to a <a href=\"http://systemcentertech.com/2012/02/07/load-balance-scom-2012-operations-console-connections/\" target=\"_blank\" rel=\"external\">great article</a> written by <a href=\"http://systemcentertech.com/\" target=\"_blank\" rel=\"external\">Justin Cook</a> that is covering most bases but in a less for-dummies way. So, yeah… I suppose this is the for-dummies version then. ;)</p>\n<p>Enjoy!</p>\n<a id=\"more\"></a>\n<h1 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h1><p>We need to have the Network Load Balancing feature installed on all our targeted Management servers. The quick way to do this is using command-line (Windows Server 2008 R2 or later?).</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">dism /online /enable-feature /featurename:NetworkLoadBalancingFullServer</span><br></pre></td></tr></table></figure>\n<p>You also need a plan and some information about your new cluster. Make sure you have identified the following parameters before starting the configuration:</p>\n<p><div></div></p>\n<p><table style=\"border-collapse: collapse;\" border=\"0\"><colgroup> <col style=\"width: 307px;\"> <col style=\"width: 307px;\"></colgroup></table></p>\n<p><tbody valign=\"top\"></tbody></p>\n<p><tr></tr></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border: solid 0.5pt;\">A Dedicated Cluster IP-Address:</td></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td><br></p>\n<p><tr></tr></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A Dedicated Cluster DNS Name:</td></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td><br></p>\n<p><tr></tr></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A list of SCOM2012 Management Servers:</td></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td><br><br><br><br><br>You can use this pre-flight table to take note of your IP-address, DNS Name and Server List.</p>\n<h1 id=\"Create-a-New-Cluster\"><a href=\"#Create-a-New-Cluster\" class=\"headerlink\" title=\"Create a New Cluster\"></a>Create a New Cluster</h1><p>Open the Network Load Balancing Manager and create a new cluster.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png\" alt=\"\"></p>\n<p>In the “New Cluster” dialogue, connect to one of your Management Servers.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png\" alt=\"\"></p>\n<ol>\n<li>Enter the name of a management server</li>\n<li>Click Connect</li>\n<li>Select the network interface to use</li>\n<li>Click Next</li>\n</ol>\n<p>Select the settings on your first host in the cluster.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png\" alt=\"\"></p>\n<ol>\n<li>Make sure it’s the correct IP-address.</li>\n<li>Click Next</li>\n</ol>\n<p>Set the Cluster IP-address.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png\" alt=\"\"></p>\n<ol>\n<li>Click Add</li>\n<li>Enter your Dedicated Cluster IP-Address and Subnet mask</li>\n<li>Click OK</li>\n<li>Click Next</li>\n</ol>\n<p>If need additional IP-addresses, like an IPv6 address, you simply repeat step 1-3 before proceeding to step 4.</p>\n<p>Edit DNS Names and Cluster Operation Mode.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png\" alt=\"\"></p>\n<ol>\n<li>Select your Dedicated Cluster IP-address</li>\n<li>Enter your chosen Dedicated Cluster DNS Name</li>\n<li>Select Multicast mode</li>\n<li>Click Next</li>\n</ol>\n<blockquote>\n<p>Note: We are not going to delve into the Cluster Operation Mode in this guide, but this is what I use for Operations Manager 2012.</p>\n<p>If you want to learn more about these settings, here’s the KB on the various settings: <a href=\"http://support.microsoft.com/kb/323437\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/323437</a><br>Set your Port Rules and Affinity Settings.</p>\n</blockquote>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png\" alt=\"\"></p>\n<ol>\n<li>Verify that Affinity is set to “Single”. If not, Click “Edit…” and adjust.</li>\n<li>Click Finish</li>\n</ol>\n<blockquote>\n<p>Note: “Single” affinity tells the cluster to always direct the same client to the same host if possible. This is required to be able to support sessions.</p>\n<p>In the world of NLB, a “client” is an IP-address.</p>\n</blockquote>\n<h2 id=\"Post-Configuration\"><a href=\"#Post-Configuration\" class=\"headerlink\" title=\"Post-Configuration\"></a>Post-Configuration</h2><p>Now that you have a cluster configured you have to make sure your SDK-clients are able to resolve the dedicated cluster DNS-name. The one you picked in the pre-flight table.</p>\n<p>To enable name resolution you have to add your cluster DNS-name to your DNS-zone and point it to your dedicated cluster IP-address. Make it an A-record and it should work.</p>\n<p>If you intend to use the cluster name from outside the local network or subnet—Operation Consoles or Powershell sessions for example—you would also need to verify that the router is able to handle the multicast packages. I am by no means a network guy, but asking the person behind that “Don’t blame the network” sign to help you access a NLB cluster on network _X _from network <em>Y</em> usually works. One way to troubleshoot this is to ping the cluster DNS-name from one of the hosts. If that works but you are still unable to ping from another network or subnet, then it might be a router setting.</p>\n<!--more-->\n<h1 id=\"Adding-Hosts-to-the-Cluster\"><a href=\"#Adding-Hosts-to-the-Cluster\" class=\"headerlink\" title=\"Adding Hosts to the Cluster\"></a>Adding Hosts to the Cluster</h1><p>With the cluster configured and up-and-running you need to add the rest of the Management Servers. Repeat this section for each Management Server you wish to add to the load-balancing cluster.</p>\n<p>In the Network Load Balancing Manager, right-click your cluster and select “Add Host To Cluster”.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png\" alt=\"\"></p>\n<p>Connect to your next Management Server to be added</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png\" alt=\"\"></p>\n<ol>\n<li>Enter the server name of the Management Server (“host” in cluster terminology)</li>\n<li>Click Connect</li>\n<li>Select the IP-address of the host</li>\n<li>Click Next</li>\n</ol>\n<p>Verify your Host Parameters</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png\" alt=\"\"></p>\n<ol>\n<li>Doublecheck the IP-address</li>\n<li>Click Next</li>\n</ol>\n<p>Verify the Port Rules</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png\" alt=\"\"></p>\n<ol>\n<li>Make sure that Load is Equal and Affinity is Single</li>\n<li>Click Finish</li>\n</ol>\n<h1 id=\"Final-Verification\"><a href=\"#Final-Verification\" class=\"headerlink\" title=\"Final Verification\"></a>Final Verification</h1><p>After each added host it would be proper to check if it was added correctly. The easiest way is to check their statuses in the Network Load Balancing Manager. Green is generally considered good and you want your hosts to be “Converged”.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png\" alt=\"\"></p>\n<p>Another way to verify functionality is to point your Operations Manager console to the Cluster DNS-name instead and connect. If you are in a lab or in an environment where it is OK to shut down Management Servers you could try that as well.</p>\n<p>Considering my note on routers in the Cluster Post-Configuration I guess it would be prudent to point out that you should try launching SDK-sessions from all networks you intend to connect from. Just to make sure that your routers are correctly configured to handle these kinds of sessions.</p>\n<!--more-->\n<h1 id=\"Postlude\"><a href=\"#Postlude\" class=\"headerlink\" title=\"Postlude\"></a>Postlude</h1><p>Now; as easy this may be I would personally argue that you should involve your network team <em>before</em> starting to deploy your load-balanced clusters. A little heads-up is always a good thing—I have noticed that network people rarely like surprises—and they might actually be able to help you all the way is you ask nicely. And maybe they’ll tell you right away that some configuration is required before-hand instead of giggling frantically in a corner at your feeble attempts to troubleshoot your fresh little cluster.</p>\n<p>Soooo… have fun!</p>\n<p>And remember; with great powers come great responsibility.</p>\n<p><em>Sheesh! This post got out of hand!</em></p>\n","excerpt":"<h1 id=\"Prelude\"><a href=\"#Prelude\" class=\"headerlink\" title=\"Prelude\"></a>Prelude</h1><p>Now that System Center Operations Manager no longer has that pesky Root Management Server role; a server role that in larger environments quickly became the choking point and made creating a fully Highly Available SCOM-environment both complex and frustrating to support and with little gain at that. With that gone and the SDK Service, or Data Access Service, thriving on all the Management Servers HA suddenly became pretty simple. All you have to do in SCOM2012 to make sure your management groups keep on kicking is to have at-least two Management Servers and your databases clustered.</p>\n<p>This new distributed architecture does not only give easy HA, it also makes it possible to connect to the SDK-service—be it using the Operations Console or powershell to name two options—on <em>any</em> Management Server. This, in turn, provides for a completely new level of scalability. Choked on sessions? Deploy a new Management Server!</p>\n<p>Anyway… given all this scalability and HA, would it not be nice if you could load-balance all these SDK-sessions you will be running from System Center Virtual Machine Manager, System Center Service Manager, System Center Orchestrator, regular scheduled powershell scripts and what-not?</p>\n<p>Of course it would! And you can! The simple solution is to use the built-in Network Load Balancer (NLB for short) feature in Windows Server and that’s what we’re going to discuss in this post.<br>Before we go, I’d like to point to a <a href=\"http://systemcentertech.com/2012/02/07/load-balance-scom-2012-operations-console-connections/\">great article</a> written by <a href=\"http://systemcentertech.com/\">Justin Cook</a> that is covering most bases but in a less for-dummies way. So, yeah… I suppose this is the for-dummies version then. ;)</p>\n<p>Enjoy!</p>","more":"<h1 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h1><p>We need to have the Network Load Balancing feature installed on all our targeted Management servers. The quick way to do this is using command-line (Windows Server 2008 R2 or later?).</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">dism /online /enable-feature /featurename:NetworkLoadBalancingFullServer</span><br></pre></td></tr></table></figure>\n<p>You also need a plan and some information about your new cluster. Make sure you have identified the following parameters before starting the configuration:</p>\n<p><div></p>\n<p><table style=\"border-collapse: collapse;\" border=\"0\"><colgroup> <col style=\"width: 307px;\" /> <col style=\"width: 307px;\" /></colgroup></p>\n<p><tbody valign=\"top\"></p>\n<p><tr></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border: solid 0.5pt;\">A Dedicated Cluster IP-Address:</td></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td><br></tr></p>\n<p><tr></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A Dedicated Cluster DNS Name:</td></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td><br></tr></p>\n<p><tr></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\">A list of SCOM2012 Management Servers:</td></p>\n<p><td style=\"padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;\"></td><br></tr><br></tbody><br></table><br></div><br>You can use this pre-flight table to take note of your IP-address, DNS Name and Server List.</p>\n<h1 id=\"Create-a-New-Cluster\"><a href=\"#Create-a-New-Cluster\" class=\"headerlink\" title=\"Create a New Cluster\"></a>Create a New Cluster</h1><p>Open the Network Load Balancing Manager and create a new cluster.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance1.png\" alt=\"\"></p>\n<p>In the “New Cluster” dialogue, connect to one of your Management Servers.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance2.png\" alt=\"\"></p>\n<ol>\n<li>Enter the name of a management server</li>\n<li>Click Connect</li>\n<li>Select the network interface to use</li>\n<li>Click Next</li>\n</ol>\n<p>Select the settings on your first host in the cluster.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance3.png\" alt=\"\"></p>\n<ol>\n<li>Make sure it’s the correct IP-address.</li>\n<li>Click Next</li>\n</ol>\n<p>Set the Cluster IP-address.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance4.png\" alt=\"\"></p>\n<ol>\n<li>Click Add</li>\n<li>Enter your Dedicated Cluster IP-Address and Subnet mask</li>\n<li>Click OK</li>\n<li>Click Next</li>\n</ol>\n<p>If need additional IP-addresses, like an IPv6 address, you simply repeat step 1-3 before proceeding to step 4.</p>\n<p>Edit DNS Names and Cluster Operation Mode.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance5.png\" alt=\"\"></p>\n<ol>\n<li>Select your Dedicated Cluster IP-address</li>\n<li>Enter your chosen Dedicated Cluster DNS Name</li>\n<li>Select Multicast mode</li>\n<li>Click Next</li>\n</ol>\n<blockquote>\n<p>Note: We are not going to delve into the Cluster Operation Mode in this guide, but this is what I use for Operations Manager 2012.</p>\n<p>If you want to learn more about these settings, here’s the KB on the various settings: <a href=\"http://support.microsoft.com/kb/323437\">http://support.microsoft.com/kb/323437</a><br>Set your Port Rules and Affinity Settings.</p>\n</blockquote>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance6.png\" alt=\"\"></p>\n<ol>\n<li>Verify that Affinity is set to “Single”. If not, Click “Edit…” and adjust.</li>\n<li>Click Finish</li>\n</ol>\n<blockquote>\n<p>Note: “Single” affinity tells the cluster to always direct the same client to the same host if possible. This is required to be able to support sessions.</p>\n<p>In the world of NLB, a “client” is an IP-address.</p>\n</blockquote>\n<h2 id=\"Post-Configuration\"><a href=\"#Post-Configuration\" class=\"headerlink\" title=\"Post-Configuration\"></a>Post-Configuration</h2><p>Now that you have a cluster configured you have to make sure your SDK-clients are able to resolve the dedicated cluster DNS-name. The one you picked in the pre-flight table.</p>\n<p>To enable name resolution you have to add your cluster DNS-name to your DNS-zone and point it to your dedicated cluster IP-address. Make it an A-record and it should work.</p>\n<p>If you intend to use the cluster name from outside the local network or subnet—Operation Consoles or Powershell sessions for example—you would also need to verify that the router is able to handle the multicast packages. I am by no means a network guy, but asking the person behind that “Don’t blame the network” sign to help you access a NLB cluster on network _X _from network <em>Y</em> usually works. One way to troubleshoot this is to ping the cluster DNS-name from one of the hosts. If that works but you are still unable to ping from another network or subnet, then it might be a router setting.</p>\n<!--more-->\n<h1 id=\"Adding-Hosts-to-the-Cluster\"><a href=\"#Adding-Hosts-to-the-Cluster\" class=\"headerlink\" title=\"Adding Hosts to the Cluster\"></a>Adding Hosts to the Cluster</h1><p>With the cluster configured and up-and-running you need to add the rest of the Management Servers. Repeat this section for each Management Server you wish to add to the load-balancing cluster.</p>\n<p>In the Network Load Balancing Manager, right-click your cluster and select “Add Host To Cluster”.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance7.png\" alt=\"\"></p>\n<p>Connect to your next Management Server to be added</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance8.png\" alt=\"\"></p>\n<ol>\n<li>Enter the server name of the Management Server (“host” in cluster terminology)</li>\n<li>Click Connect</li>\n<li>Select the IP-address of the host</li>\n<li>Click Next</li>\n</ol>\n<p>Verify your Host Parameters</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance9.png\" alt=\"\"></p>\n<ol>\n<li>Doublecheck the IP-address</li>\n<li>Click Next</li>\n</ol>\n<p>Verify the Port Rules</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance10.png\" alt=\"\"></p>\n<ol>\n<li>Make sure that Load is Equal and Affinity is Single</li>\n<li>Click Finish</li>\n</ol>\n<h1 id=\"Final-Verification\"><a href=\"#Final-Verification\" class=\"headerlink\" title=\"Final Verification\"></a>Final Verification</h1><p>After each added host it would be proper to check if it was added correctly. The easiest way is to check their statuses in the Network Load Balancing Manager. Green is generally considered good and you want your hosts to be “Converged”.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/05/051812_1216_Loadbalance11.png\" alt=\"\"></p>\n<p>Another way to verify functionality is to point your Operations Manager console to the Cluster DNS-name instead and connect. If you are in a lab or in an environment where it is OK to shut down Management Servers you could try that as well.</p>\n<p>Considering my note on routers in the Cluster Post-Configuration I guess it would be prudent to point out that you should try launching SDK-sessions from all networks you intend to connect from. Just to make sure that your routers are correctly configured to handle these kinds of sessions.</p>\n<!--more-->\n<h1 id=\"Postlude\"><a href=\"#Postlude\" class=\"headerlink\" title=\"Postlude\"></a>Postlude</h1><p>Now; as easy this may be I would personally argue that you should involve your network team <em>before</em> starting to deploy your load-balanced clusters. A little heads-up is always a good thing—I have noticed that network people rarely like surprises—and they might actually be able to help you all the way is you ask nicely. And maybe they’ll tell you right away that some configuration is required before-hand instead of giggling frantically in a corner at your feeble attempts to troubleshoot your fresh little cluster.</p>\n<p>Soooo… have fun!</p>\n<p>And remember; with great powers come great responsibility.</p>\n<p><em>Sheesh! This post got out of hand!</em></p>"},{"title":"Menu Problems!","id":"677","date":"2012-06-21T06:01:50.000Z","_content":"\nThe menus are looking a bit off as you may have noticed.\n\nI guess it's an issue with WordPress 3.4 and [Superfish](http://users.tpg.com.au/j_birch/plugins/superfish/ \"Superfish\") and are trying to figure out where it goes haywire.\n\nSorry for the inconvenience.\n\n# Update\n\nI switched the theme to at least get the navigation working while I try to figure out what the problem with the regular theme is.","source":"_posts/menu-problems.md","raw":"---\ntitle: Menu Problems!\ntags:\n  - Teknoglot\nid: 677\ncategories:\n  - Technobabble\ndate: 2012-06-21 08:01:50\n---\n\nThe menus are looking a bit off as you may have noticed.\n\nI guess it's an issue with WordPress 3.4 and [Superfish](http://users.tpg.com.au/j_birch/plugins/superfish/ \"Superfish\") and are trying to figure out where it goes haywire.\n\nSorry for the inconvenience.\n\n# Update\n\nI switched the theme to at least get the navigation working while I try to figure out what the problem with the regular theme is.","slug":"menu-problems","published":1,"updated":"2016-05-24T21:41:32.453Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7ho0018q4o2frtw4wuu","content":"<p>The menus are looking a bit off as you may have noticed.</p>\n<p>I guess it’s an issue with WordPress 3.4 and <a href=\"http://users.tpg.com.au/j_birch/plugins/superfish/\" title=\"Superfish\" target=\"_blank\" rel=\"external\">Superfish</a> and are trying to figure out where it goes haywire.</p>\n<p>Sorry for the inconvenience.</p>\n<h1 id=\"Update\"><a href=\"#Update\" class=\"headerlink\" title=\"Update\"></a>Update</h1><p>I switched the theme to at least get the navigation working while I try to figure out what the problem with the regular theme is.</p>\n","excerpt":"","more":"<p>The menus are looking a bit off as you may have noticed.</p>\n<p>I guess it’s an issue with WordPress 3.4 and <a href=\"http://users.tpg.com.au/j_birch/plugins/superfish/\" title=\"Superfish\">Superfish</a> and are trying to figure out where it goes haywire.</p>\n<p>Sorry for the inconvenience.</p>\n<h1 id=\"Update\"><a href=\"#Update\" class=\"headerlink\" title=\"Update\"></a>Update</h1><p>I switched the theme to at least get the navigation working while I try to figure out what the problem with the regular theme is.</p>\n"},{"title":"Microsoft Adds support for SUSE 11 in OpsMgr R2","id":"228","date":"2009-10-16T05:59:10.000Z","_content":"\nThis update hasn’t showed up in the <acronym title=\"Management Pack\">MP</acronym> Catalog yet, but the [System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here](http://www.microsoft.com/downloads/details.aspx?FamilyID=4a41a8be-0a37-4bd2-b5b1-026468b317fb).\n\nBesides SUSE 11 support, here’s the short overview.\n> The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.\n> **Feature Summary:**\n> The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including:\n\n> * Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions)* Support of Solaris Zones* Fix for defunct Process issue* The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks.* The Cross Platform Agent may not restart after the AIX server reboots.\n\n> The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update.\n\nPerfect timing, I must say, since I really need this today. :D\n\n***Update:***\nThis is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP för SUSE 11 that you have to import from disk if you need it.\n\nSo, the installation goes somewhat like this:\n\n1. Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers\n2. Import the SUSE 11 MP if necessary\n3. Re-discover your Unix/Linux machines.\n\nFiles updated in this update for R2:\n\n* .Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1)\n* .AgentManagementUnixAgentsscx-1.0.4-248.aix.5.ppc.lpp.gz\n* .AgentManagementUnixAgentsscx-1.0.4-248.aix.6.ppc.lpp.gz\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.ia64.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.parisc.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.ia64.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.parisc.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x64.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x64.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x64.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.sles.9.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.sparc.pkg.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.x86.pkg.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.8.sparc.pkg.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.9.sparc.pkg.Z\n\nFiles added:\n\n* Microsoft.Linux.SLES.11.MP\n\nAll in all, the update contains the following fixes:\n\n* KB969342\n* KB973583\n* Q954049\n* Q956240","source":"_posts/microsoft-adds-support-for-suse-11-in-opsmgr-r2.md","raw":"---\ntitle: Microsoft Adds support for SUSE 11 in OpsMgr R2\ntags:\n  - Management Pack\n  - OpsMgr\n  - SUSE 11\n  - X-Plat\nid: 228\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-10-16 07:59:10\n---\n\nThis update hasn’t showed up in the <acronym title=\"Management Pack\">MP</acronym> Catalog yet, but the [System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here](http://www.microsoft.com/downloads/details.aspx?FamilyID=4a41a8be-0a37-4bd2-b5b1-026468b317fb).\n\nBesides SUSE 11 support, here’s the short overview.\n> The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.\n> **Feature Summary:**\n> The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including:\n\n> * Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions)* Support of Solaris Zones* Fix for defunct Process issue* The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks.* The Cross Platform Agent may not restart after the AIX server reboots.\n\n> The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update.\n\nPerfect timing, I must say, since I really need this today. :D\n\n***Update:***\nThis is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP för SUSE 11 that you have to import from disk if you need it.\n\nSo, the installation goes somewhat like this:\n\n1. Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers\n2. Import the SUSE 11 MP if necessary\n3. Re-discover your Unix/Linux machines.\n\nFiles updated in this update for R2:\n\n* .Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1)\n* .AgentManagementUnixAgentsscx-1.0.4-248.aix.5.ppc.lpp.gz\n* .AgentManagementUnixAgentsscx-1.0.4-248.aix.6.ppc.lpp.gz\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.ia64.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.parisc.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.ia64.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.parisc.depot.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x64.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x64.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x64.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.sles.9.x86.rpm\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.sparc.pkg.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.x86.pkg.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.8.sparc.pkg.Z\n* .AgentManagementUnixAgentsscx-1.0.4-248.solaris.9.sparc.pkg.Z\n\nFiles added:\n\n* Microsoft.Linux.SLES.11.MP\n\nAll in all, the update contains the following fixes:\n\n* KB969342\n* KB973583\n* Q954049\n* Q956240","slug":"microsoft-adds-support-for-suse-11-in-opsmgr-r2","published":1,"updated":"2016-05-24T21:41:11.212Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hr001dq4o2emv345dk","content":"<p>This update hasn’t showed up in the <acronym title=\"Management Pack\">MP</acronym> Catalog yet, but the <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=4a41a8be-0a37-4bd2-b5b1-026468b317fb\" target=\"_blank\" rel=\"external\">System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here</a>.</p>\n<p>Besides SUSE 11 support, here’s the short overview.</p>\n<blockquote>\n<p>The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.<br><strong>Feature Summary:</strong><br>The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including:</p>\n<ul>\n<li>Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions)<em> Support of Solaris Zones</em> Fix for defunct Process issue<em> The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks.</em> The Cross Platform Agent may not restart after the AIX server reboots.</li>\n</ul>\n<p>The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update.</p>\n</blockquote>\n<p>Perfect timing, I must say, since I really need this today. :D</p>\n<p><strong><em>Update:</em></strong><br>This is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP för SUSE 11 that you have to import from disk if you need it.</p>\n<p>So, the installation goes somewhat like this:</p>\n<ol>\n<li>Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers</li>\n<li>Import the SUSE 11 MP if necessary</li>\n<li>Re-discover your Unix/Linux machines.</li>\n</ol>\n<p>Files updated in this update for R2:</p>\n<ul>\n<li>.Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1)</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.aix.5.ppc.lpp.gz</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.aix.6.ppc.lpp.gz</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.ia64.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.parisc.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.ia64.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.parisc.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x64.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x64.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x64.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.sles.9.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.sparc.pkg.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.x86.pkg.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.8.sparc.pkg.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.9.sparc.pkg.Z</li>\n</ul>\n<p>Files added:</p>\n<ul>\n<li>Microsoft.Linux.SLES.11.MP</li>\n</ul>\n<p>All in all, the update contains the following fixes:</p>\n<ul>\n<li>KB969342</li>\n<li>KB973583</li>\n<li>Q954049</li>\n<li>Q956240</li>\n</ul>\n","excerpt":"","more":"<p>This update hasn’t showed up in the <acronym title=\"Management Pack\">MP</acronym> Catalog yet, but the <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=4a41a8be-0a37-4bd2-b5b1-026468b317fb\">System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here</a>.</p>\n<p>Besides SUSE 11 support, here’s the short overview.</p>\n<blockquote>\n<p>The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.<br><strong>Feature Summary:</strong><br>The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including:</p>\n<ul>\n<li>Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions)<em> Support of Solaris Zones</em> Fix for defunct Process issue<em> The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks.</em> The Cross Platform Agent may not restart after the AIX server reboots.</li>\n</ul>\n<p>The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update.</p>\n</blockquote>\n<p>Perfect timing, I must say, since I really need this today. :D</p>\n<p><strong><em>Update:</em></strong><br>This is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP för SUSE 11 that you have to import from disk if you need it.</p>\n<p>So, the installation goes somewhat like this:</p>\n<ol>\n<li>Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers</li>\n<li>Import the SUSE 11 MP if necessary</li>\n<li>Re-discover your Unix/Linux machines.</li>\n</ol>\n<p>Files updated in this update for R2:</p>\n<ul>\n<li>.Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1)</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.aix.5.ppc.lpp.gz</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.aix.6.ppc.lpp.gz</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.ia64.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.parisc.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.ia64.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.parisc.depot.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x64.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x64.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x64.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.sles.9.x86.rpm</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.sparc.pkg.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.x86.pkg.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.8.sparc.pkg.Z</li>\n<li>.AgentManagementUnixAgentsscx-1.0.4-248.solaris.9.sparc.pkg.Z</li>\n</ul>\n<p>Files added:</p>\n<ul>\n<li>Microsoft.Linux.SLES.11.MP</li>\n</ul>\n<p>All in all, the update contains the following fixes:</p>\n<ul>\n<li>KB969342</li>\n<li>KB973583</li>\n<li>Q954049</li>\n<li>Q956240</li>\n</ul>\n"},{"title":"Move complete, welcome to teknoglot.se!","id":"439","date":"2011-02-04T13:07:41.000Z","_content":"\nOh my God, I actually moved my blog for real. I think I've been putting this upp for nearly half a year now and even though I actually went and bought a \"real\" domain-name for it.\n\nBut now it'd done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they're talking about.\n\nThe design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one.\n\nSo, welcome!","source":"_posts/move-complete-welcome-to-teknoglot-se.md","raw":"---\ntitle: 'Move complete, welcome to teknoglot.se!'\nid: 439\ncategories:\n  - Technobabble\ndate: 2011-02-04 14:07:41\ntags:\n---\n\nOh my God, I actually moved my blog for real. I think I've been putting this upp for nearly half a year now and even though I actually went and bought a \"real\" domain-name for it.\n\nBut now it'd done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they're talking about.\n\nThe design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one.\n\nSo, welcome!","slug":"move-complete-welcome-to-teknoglot-se","published":1,"updated":"2016-05-19T09:11:09.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hu001gq4o2a1daunmu","content":"<p>Oh my God, I actually moved my blog for real. I think I’ve been putting this upp for nearly half a year now and even though I actually went and bought a “real” domain-name for it.</p>\n<p>But now it’d done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they’re talking about.</p>\n<p>The design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one.</p>\n<p>So, welcome!</p>\n","excerpt":"","more":"<p>Oh my God, I actually moved my blog for real. I think I’ve been putting this upp for nearly half a year now and even though I actually went and bought a “real” domain-name for it.</p>\n<p>But now it’d done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they’re talking about.</p>\n<p>The design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one.</p>\n<p>So, welcome!</p>\n"},{"title":"MSMQ 3 MP for OpsMgr v.6.0.6587.0 Released","id":"149","date":"2009-04-28T13:30:18.000Z","_content":"\nLast friday, 24/4 -09,  Microsoft released an [updated Management Pack for MSMQ 3.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&displaylang=en \"Message Queuing Management Pack for Operations Manager 2007\").\n\n# Quick Details\n\n  <table style=\"height: 60px\" cellspacing=\"0\" cellpadding=\"0\" width=\"469\" border=\"0\"><tbody>     <tr>       <td class=\"quickInfoName\">File Name:</td>        <td class=\"quickInfoValue\">Message Queuing System Center Operations Manager 2007 MP.MSI</td>     </tr>      <tr>       <td class=\"quickInfoName\">Version:</td>        <td class=\"quickInfoValue\">6.0.6587.0</td>     </tr>      <tr>       <td class=\"quickInfoName\">Date Published:</td>        <td class=\"quickInfoValue\">4/24/2009</td>     </tr>      <tr>       <td class=\"quickInfoName\">Language:</td>        <td class=\"quickInfoValue\">English</td>     </tr>      <tr>       <td class=\"quickInfoName\">Download Size:</td>        <td class=\"quickInfoValue\">502 KB</td>     </tr>   </tbody></table>  \n\n# Release History\n\n* 6/3/2008 - Initial Release, version 6.0.6278.23\\. Refer to the MP guide for further details.*   4/24/2009 - Undated release, version 6.0.6587.0\\. Refer to the MP guide for further details.  \n\nThe MP Guide does not really say much about what's updated and I don't know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.","source":"_posts/msmq-3-mp-for-opsmgr-v6065870-released.md","raw":"---\ntitle: MSMQ 3 MP for OpsMgr v.6.0.6587.0 Released\ntags:\n  - Management Pack\n  - MSMQ\n  - OpsMgr\nid: 149\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-04-28 15:30:18\n---\n\nLast friday, 24/4 -09,  Microsoft released an [updated Management Pack for MSMQ 3.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&displaylang=en \"Message Queuing Management Pack for Operations Manager 2007\").\n\n# Quick Details\n\n  <table style=\"height: 60px\" cellspacing=\"0\" cellpadding=\"0\" width=\"469\" border=\"0\"><tbody>     <tr>       <td class=\"quickInfoName\">File Name:</td>        <td class=\"quickInfoValue\">Message Queuing System Center Operations Manager 2007 MP.MSI</td>     </tr>      <tr>       <td class=\"quickInfoName\">Version:</td>        <td class=\"quickInfoValue\">6.0.6587.0</td>     </tr>      <tr>       <td class=\"quickInfoName\">Date Published:</td>        <td class=\"quickInfoValue\">4/24/2009</td>     </tr>      <tr>       <td class=\"quickInfoName\">Language:</td>        <td class=\"quickInfoValue\">English</td>     </tr>      <tr>       <td class=\"quickInfoName\">Download Size:</td>        <td class=\"quickInfoValue\">502 KB</td>     </tr>   </tbody></table>  \n\n# Release History\n\n* 6/3/2008 - Initial Release, version 6.0.6278.23\\. Refer to the MP guide for further details.*   4/24/2009 - Undated release, version 6.0.6587.0\\. Refer to the MP guide for further details.  \n\nThe MP Guide does not really say much about what's updated and I don't know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.","slug":"msmq-3-mp-for-opsmgr-v6065870-released","published":1,"updated":"2016-05-24T21:38:02.584Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hw001kq4o2k6enoedb","content":"<p>Last friday, 24/4 -09,  Microsoft released an <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en\" title=\"Message Queuing Management Pack for Operations Manager 2007\" target=\"_blank\" rel=\"external\">updated Management Pack for MSMQ 3.0</a>.</p>\n<h1 id=\"Quick-Details\"><a href=\"#Quick-Details\" class=\"headerlink\" title=\"Quick Details\"></a>Quick Details</h1>  <table style=\"height: 60px\" cellspacing=\"0\" cellpadding=\"0\" width=\"469\" border=\"0\"><tbody>     <tr>       <td class=\"quickInfoName\">File Name:</td>        <td class=\"quickInfoValue\">Message Queuing System Center Operations Manager 2007 MP.MSI</td>     </tr>      <tr>       <td class=\"quickInfoName\">Version:</td>        <td class=\"quickInfoValue\">6.0.6587.0</td>     </tr>      <tr>       <td class=\"quickInfoName\">Date Published:</td>        <td class=\"quickInfoValue\">4/24/2009</td>     </tr>      <tr>       <td class=\"quickInfoName\">Language:</td>        <td class=\"quickInfoValue\">English</td>     </tr>      <tr>       <td class=\"quickInfoName\">Download Size:</td>        <td class=\"quickInfoValue\">502 KB</td>     </tr>   </tbody></table>  \n\n<h1 id=\"Release-History\"><a href=\"#Release-History\" class=\"headerlink\" title=\"Release History\"></a>Release History</h1><ul>\n<li>6/3/2008 - Initial Release, version 6.0.6278.23. Refer to the MP guide for further details.*   4/24/2009 - Undated release, version 6.0.6587.0. Refer to the MP guide for further details.  </li>\n</ul>\n<p>The MP Guide does not really say much about what’s updated and I don’t know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.</p>\n","excerpt":"","more":"<p>Last friday, 24/4 -09,  Microsoft released an <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en\" title=\"Message Queuing Management Pack for Operations Manager 2007\">updated Management Pack for MSMQ 3.0</a>.</p>\n<h1 id=\"Quick-Details\"><a href=\"#Quick-Details\" class=\"headerlink\" title=\"Quick Details\"></a>Quick Details</h1>  <table style=\"height: 60px\" cellspacing=\"0\" cellpadding=\"0\" width=\"469\" border=\"0\"><tbody>     <tr>       <td class=\"quickInfoName\">File Name:</td>        <td class=\"quickInfoValue\">Message Queuing System Center Operations Manager 2007 MP.MSI</td>     </tr>      <tr>       <td class=\"quickInfoName\">Version:</td>        <td class=\"quickInfoValue\">6.0.6587.0</td>     </tr>      <tr>       <td class=\"quickInfoName\">Date Published:</td>        <td class=\"quickInfoValue\">4/24/2009</td>     </tr>      <tr>       <td class=\"quickInfoName\">Language:</td>        <td class=\"quickInfoValue\">English</td>     </tr>      <tr>       <td class=\"quickInfoName\">Download Size:</td>        <td class=\"quickInfoValue\">502 KB</td>     </tr>   </tbody></table>  \n\n<h1 id=\"Release-History\"><a href=\"#Release-History\" class=\"headerlink\" title=\"Release History\"></a>Release History</h1><ul>\n<li>6/3/2008 - Initial Release, version 6.0.6278.23. Refer to the MP guide for further details.*   4/24/2009 - Undated release, version 6.0.6587.0. Refer to the MP guide for further details.  </li>\n</ul>\n<p>The MP Guide does not really say much about what’s updated and I don’t know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.</p>\n"},{"title":"MSMQ 4 and MSMQ 5 MP for OpsMgr Released! (finally)","id":"268","date":"2010-04-06T10:09:57.000Z","_content":"\nAfter a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released.\n\nBoth seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP.\n\n### Message Queuing 4.0 Management Pack for Operations Manager 2007\n    > **Quick Details**\n> \n> Version: 6.0.6700.83\n> \n> Date Published: 4/5/2010\n> \n> Language: English  \n\nDownload here: [http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&displaylang=en)\n\n### Message Queuing 5.0 Management Pack for Operations Manager 2007\n  > **Quick Details**\n> \n> Version: 6.0.6700.88\n> \n> Date Published: 4/5/2010\n> \n> Language: English  \n\nDownload here: [http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&displaylang=en)","source":"_posts/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally.md","raw":"---\ntitle: MSMQ 4 and MSMQ 5 MP for OpsMgr Released! (finally)\ntags:\n  - Management Pack\n  - MSMQ\nid: 268\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2010-04-06 12:09:57\n---\n\nAfter a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released.\n\nBoth seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP.\n\n### Message Queuing 4.0 Management Pack for Operations Manager 2007\n    > **Quick Details**\n> \n> Version: 6.0.6700.83\n> \n> Date Published: 4/5/2010\n> \n> Language: English  \n\nDownload here: [http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&displaylang=en)\n\n### Message Queuing 5.0 Management Pack for Operations Manager 2007\n  > **Quick Details**\n> \n> Version: 6.0.6700.88\n> \n> Date Published: 4/5/2010\n> \n> Language: English  \n\nDownload here: [http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&displaylang=en)","slug":"msmq-4-and-msmq-5-mp-for-opsmgr-released-finally","published":1,"updated":"2016-05-24T21:37:28.780Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7hz001mq4o2owmv64n1","content":"<p>After a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released.</p>\n<p>Both seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP.</p>\n<h3 id=\"Message-Queuing-4-0-Management-Pack-for-Operations-Manager-2007\"><a href=\"#Message-Queuing-4-0-Management-Pack-for-Operations-Manager-2007\" class=\"headerlink\" title=\"Message Queuing 4.0 Management Pack for Operations Manager 2007\"></a>Message Queuing 4.0 Management Pack for Operations Manager 2007</h3><pre><code>&gt; **Quick Details**\n</code></pre><blockquote>\n<p>Version: 6.0.6700.83</p>\n<p>Date Published: 4/5/2010</p>\n<p>Language: English  </p>\n</blockquote>\n<p>Download here: <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en</a></p>\n<h3 id=\"Message-Queuing-5-0-Management-Pack-for-Operations-Manager-2007\"><a href=\"#Message-Queuing-5-0-Management-Pack-for-Operations-Manager-2007\" class=\"headerlink\" title=\"Message Queuing 5.0 Management Pack for Operations Manager 2007\"></a>Message Queuing 5.0 Management Pack for Operations Manager 2007</h3><blockquote>\n<p><strong>Quick Details</strong></p>\n<p>Version: 6.0.6700.88</p>\n<p>Date Published: 4/5/2010</p>\n<p>Language: English  </p>\n</blockquote>\n<p>Download here: <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en</a></p>\n","excerpt":"","more":"<p>After a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released.</p>\n<p>Both seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP.</p>\n<h3 id=\"Message-Queuing-4-0-Management-Pack-for-Operations-Manager-2007\"><a href=\"#Message-Queuing-4-0-Management-Pack-for-Operations-Manager-2007\" class=\"headerlink\" title=\"Message Queuing 4.0 Management Pack for Operations Manager 2007\"></a>Message Queuing 4.0 Management Pack for Operations Manager 2007</h3><pre><code>&gt; **Quick Details**\n</code></pre><blockquote>\n<p>Version: 6.0.6700.83</p>\n<p>Date Published: 4/5/2010</p>\n<p>Language: English  </p>\n</blockquote>\n<p>Download here: <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en\">http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en</a></p>\n<h3 id=\"Message-Queuing-5-0-Management-Pack-for-Operations-Manager-2007\"><a href=\"#Message-Queuing-5-0-Management-Pack-for-Operations-Manager-2007\" class=\"headerlink\" title=\"Message Queuing 5.0 Management Pack for Operations Manager 2007\"></a>Message Queuing 5.0 Management Pack for Operations Manager 2007</h3><blockquote>\n<p><strong>Quick Details</strong></p>\n<p>Version: 6.0.6700.88</p>\n<p>Date Published: 4/5/2010</p>\n<p>Language: English  </p>\n</blockquote>\n<p>Download here: <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en\">http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en</a></p>\n"},{"title":"MSMQ Management Pack: Subscript Out of Range","id":"182","date":"2009-06-24T07:51:01.000Z","_content":"\n<span style=\"color: #800000;\"><span style=\"text-decoration: underline;\">UPDATE: This problem seems to be fixed in the latest update!</span></span>\n\nThe MSMQ Management Pack seems to have a few problems with it's discovery script that can lead to the following error showing up in the logs:\n\n```text\nThe process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:\n\nC:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: '[number: 0]'\n\nCommand executed: \"C:WINDOWSsystem32cscript.exe\" /nologo \"DiscoverQueues.vbs\" {615D37C9-477D-62E2-0833-6ECBF0E89A87} {A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7} \"MASKED.server.fqdn\" \"MSMQ\" \"true\" \"true\" \"False\" \"false\"\nWorking Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788\n\nOne or more workflows were affected by this.\n\nWorkflow name: Microsoft.MSMQ.2003.DiscoverQueues\n\nInstance name: MASKED.server.fqdn\n\nInstance ID: {A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7}\n\nManagement group: MASKED\n```\n\nThis seems to be related to the discovery of public queues on _some_ servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set `DiscoverPublic` to `False`.\n![Screenshot of Override](http://teknoglotse.nfshost.com/wp-content/uploads/2009/06/screenshot1245833173.png \"screenshot1245833173\")","source":"_posts/msmq-mp-subscriptoutofrange.md","raw":"---\ntitle: 'MSMQ Management Pack: Subscript Out of Range'\ntags:\n  - Errors\n  - Fixed\n  - MSMQ\n  - OpsMgr\n  - Quick-fix\nid: 182\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-06-24 09:51:01\n---\n\n<span style=\"color: #800000;\"><span style=\"text-decoration: underline;\">UPDATE: This problem seems to be fixed in the latest update!</span></span>\n\nThe MSMQ Management Pack seems to have a few problems with it's discovery script that can lead to the following error showing up in the logs:\n\n```text\nThe process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:\n\nC:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: '[number: 0]'\n\nCommand executed: \"C:WINDOWSsystem32cscript.exe\" /nologo \"DiscoverQueues.vbs\" {615D37C9-477D-62E2-0833-6ECBF0E89A87} {A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7} \"MASKED.server.fqdn\" \"MSMQ\" \"true\" \"true\" \"False\" \"false\"\nWorking Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788\n\nOne or more workflows were affected by this.\n\nWorkflow name: Microsoft.MSMQ.2003.DiscoverQueues\n\nInstance name: MASKED.server.fqdn\n\nInstance ID: {A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7}\n\nManagement group: MASKED\n```\n\nThis seems to be related to the discovery of public queues on _some_ servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set `DiscoverPublic` to `False`.\n![Screenshot of Override](http://teknoglotse.nfshost.com/wp-content/uploads/2009/06/screenshot1245833173.png \"screenshot1245833173\")","slug":"msmq-mp-subscriptoutofrange","published":1,"updated":"2016-05-24T21:36:42.232Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7i4001pq4o2kj9lc5am","content":"<p><span style=\"color: #800000;\"><span style=\"text-decoration: underline;\">UPDATE: This problem seems to be fixed in the latest update!</span></span></p>\n<p>The MSMQ Management Pack seems to have a few problems with it’s discovery script that can lead to the following error showing up in the logs:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">The process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:</span><br><span class=\"line\"></span><br><span class=\"line\">C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: &apos;[number: 0]&apos;</span><br><span class=\"line\"></span><br><span class=\"line\">Command executed: &quot;C:WINDOWSsystem32cscript.exe&quot; /nologo &quot;DiscoverQueues.vbs&quot; &#123;615D37C9-477D-62E2-0833-6ECBF0E89A87&#125; &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125; &quot;MASKED.server.fqdn&quot; &quot;MSMQ&quot; &quot;true&quot; &quot;true&quot; &quot;False&quot; &quot;false&quot;</span><br><span class=\"line\">Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788</span><br><span class=\"line\"></span><br><span class=\"line\">One or more workflows were affected by this.</span><br><span class=\"line\"></span><br><span class=\"line\">Workflow name: Microsoft.MSMQ.2003.DiscoverQueues</span><br><span class=\"line\"></span><br><span class=\"line\">Instance name: MASKED.server.fqdn</span><br><span class=\"line\"></span><br><span class=\"line\">Instance ID: &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Management group: MASKED</span><br></pre></td></tr></table></figure>\n<p>This seems to be related to the discovery of public queues on <em>some</em> servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set <code>DiscoverPublic</code> to <code>False</code>.<br><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2009/06/screenshot1245833173.png\" alt=\"Screenshot of Override\" title=\"screenshot1245833173\"></p>\n","excerpt":"","more":"<p><span style=\"color: #800000;\"><span style=\"text-decoration: underline;\">UPDATE: This problem seems to be fixed in the latest update!</span></span></p>\n<p>The MSMQ Management Pack seems to have a few problems with it’s discovery script that can lead to the following error showing up in the logs:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">The process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:</span><br><span class=\"line\"></span><br><span class=\"line\">C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: &apos;[number: 0]&apos;</span><br><span class=\"line\"></span><br><span class=\"line\">Command executed: &quot;C:WINDOWSsystem32cscript.exe&quot; /nologo &quot;DiscoverQueues.vbs&quot; &#123;615D37C9-477D-62E2-0833-6ECBF0E89A87&#125; &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125; &quot;MASKED.server.fqdn&quot; &quot;MSMQ&quot; &quot;true&quot; &quot;true&quot; &quot;False&quot; &quot;false&quot;</span><br><span class=\"line\">Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788</span><br><span class=\"line\"></span><br><span class=\"line\">One or more workflows were affected by this.</span><br><span class=\"line\"></span><br><span class=\"line\">Workflow name: Microsoft.MSMQ.2003.DiscoverQueues</span><br><span class=\"line\"></span><br><span class=\"line\">Instance name: MASKED.server.fqdn</span><br><span class=\"line\"></span><br><span class=\"line\">Instance ID: &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Management group: MASKED</span><br></pre></td></tr></table></figure>\n<p>This seems to be related to the discovery of public queues on <em>some</em> servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set <code>DiscoverPublic</code> to <code>False</code>.<br><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2009/06/screenshot1245833173.png\" alt=\"Screenshot of Override\" title=\"screenshot1245833173\"></p>\n"},{"title":"My impression of EXT4 -- WTH!?","id":"209","date":"2009-09-17T17:43:47.000Z","_content":"\nOk, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.\nManaged to get the Citrix client running (way more easy on Ubuntu than Fedora, I'll be back on that) and all without too much fuzz.\n\nFirst reboot gave me a \"let's FSCK!\". So I FSCK-ed and booted up to the desktop.\n\nSecond reboot gave me a \"let's FSCK!\". And I did. Booted to the desktop.\n\nThird boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again.\n\nFourth boot gave me a \"let's FSCK!\". I replied with \"Well FSCK You!\"\n\nFifth boot gave me a \"let's FSCK!\". I rebooted back to Windows 7.\n\nTonight I am reinstalling Ubuntu 9.04 x64 with EXT3.","source":"_posts/my-impression-of-ext4-wth.md","raw":"---\ntitle: My impression of EXT4 -- WTH!?\ntags:\n  - Linux\n  - Rant\nid: 209\ncategories:\n  - Linux\ndate: 2009-09-17 19:43:47\n---\n\nOk, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.\nManaged to get the Citrix client running (way more easy on Ubuntu than Fedora, I'll be back on that) and all without too much fuzz.\n\nFirst reboot gave me a \"let's FSCK!\". So I FSCK-ed and booted up to the desktop.\n\nSecond reboot gave me a \"let's FSCK!\". And I did. Booted to the desktop.\n\nThird boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again.\n\nFourth boot gave me a \"let's FSCK!\". I replied with \"Well FSCK You!\"\n\nFifth boot gave me a \"let's FSCK!\". I rebooted back to Windows 7.\n\nTonight I am reinstalling Ubuntu 9.04 x64 with EXT3.","slug":"my-impression-of-ext4-wth","published":1,"updated":"2016-05-19T09:11:09.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7i7001sq4o2vcikza8d","content":"<p>Ok, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.<br>Managed to get the Citrix client running (way more easy on Ubuntu than Fedora, I’ll be back on that) and all without too much fuzz.</p>\n<p>First reboot gave me a “let’s FSCK!”. So I FSCK-ed and booted up to the desktop.</p>\n<p>Second reboot gave me a “let’s FSCK!”. And I did. Booted to the desktop.</p>\n<p>Third boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again.</p>\n<p>Fourth boot gave me a “let’s FSCK!”. I replied with “Well FSCK You!”</p>\n<p>Fifth boot gave me a “let’s FSCK!”. I rebooted back to Windows 7.</p>\n<p>Tonight I am reinstalling Ubuntu 9.04 x64 with EXT3.</p>\n","excerpt":"","more":"<p>Ok, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.<br>Managed to get the Citrix client running (way more easy on Ubuntu than Fedora, I’ll be back on that) and all without too much fuzz.</p>\n<p>First reboot gave me a “let’s FSCK!”. So I FSCK-ed and booted up to the desktop.</p>\n<p>Second reboot gave me a “let’s FSCK!”. And I did. Booted to the desktop.</p>\n<p>Third boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again.</p>\n<p>Fourth boot gave me a “let’s FSCK!”. I replied with “Well FSCK You!”</p>\n<p>Fifth boot gave me a “let’s FSCK!”. I rebooted back to Windows 7.</p>\n<p>Tonight I am reinstalling Ubuntu 9.04 x64 with EXT3.</p>\n"},{"title":"NetworkAdapterCheck.vbs fails on Windows 2000","id":"125","date":"2009-04-26T09:21:18.000Z","_content":"\n# Problem\n\nHere's my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack för Operations Manager 2007 that is causing the [failed to create System.PropertyBagData](http://www.teknoglot.se/ms/opsmgr2007/failed-to-create-propertybagdata-opsmgr/ \"failed to create System.PropertyBagData\") error i wrote about earlier.\nThis information in also available on [https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&SiteID=446](https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&SiteID=446)\n\n# Symptoms\n\nThis \"research\" comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this:\n\n```text\nThe process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0\n\nCommand executed: \"C:WINNTsystem32cscript.exe\" /nologo \"NetworkAdapterCheck.vbs\" MASKEDCOMPUTERNAME 0 false true false\nWorking Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781\n\nOne or more workflows were affected by this.\n\nWorkflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealth\nInstance name: 0\nInstance ID: {F4C478D3-38E5-8C29-3957-E3B7F486216E}\nManagement group: MASKED\n```\n\nThis error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server.\n\n<!--more-->\n\n# Probable Cause\n\nI am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn't.\nSince I didn't have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added\n\n```vbs\nwscript.echo \"Line XX:\" & Err.Number\n```\n\nafter each object/function call in the Main Sub.\nThe problem seems to be at line 118:\n\n```vbs\nSet WMISet = WMIGetInstance(\"winmgmts:\" + TargetComputer + \"rootcimv2\", query)\n```\n\nAt line 119 I had a debug line that never executes and it would seem like the script is unable to process the query and exits without any error codes.\n\nThe query variable contains the following:\n\n```sql\nWin32_NetworkAdapter Where DeviceID='0' And ( NetConnectionStatus = '0' )\n```\n\nWhen I was debugging this I started the script like this:\n\n```cmd\ncscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED 0 false true false\n```\n\nI did find that if I change the parameters to this:\n\n```cmd\ncscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED 0 false false false\n```\n\nThen the script runs smoothly and produces an XML-output like this:\n\n```xml\n<Collection>\n  <DataItem type=\"System.PropertyBagData\" time=\"2009-04-22T15:03:44.6495202+02:00\" sourceHealthServiceId=\"C9F5A9F7-00A3-8A86-57B5-34FB634471A8\">\n  <Property Name=\"State\" VariantType=\"8\">GOOD</Property>\n  </DataItem>\n</Collection>\n```\n\n# Comments\n\nThere's quite the lot of similar errors posted on various forums on the internet but most of them ends up pointing towards the Antivirus Software as the perp and we have tried various exceptions on the server like excluding HealthExplorer.exe, MonitoringHost.exe and also the entire Health Service State folder with no improvement. But since I was able to run the scripts from other locations (not excluded) on the same server I find it hard to believe that the AV would be blocking it.\n","source":"_posts/networkadaptercheck-fails-on-win2k.md","raw":"---\ntitle: NetworkAdapterCheck.vbs fails on Windows 2000\ntags:\n  - Errors\n  - Management Pack\n  - OpsMgr\n  - Script\nid: 125\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-04-26 11:21:18\n---\n\n# Problem\n\nHere's my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack för Operations Manager 2007 that is causing the [failed to create System.PropertyBagData](http://www.teknoglot.se/ms/opsmgr2007/failed-to-create-propertybagdata-opsmgr/ \"failed to create System.PropertyBagData\") error i wrote about earlier.\nThis information in also available on [https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&SiteID=446](https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&SiteID=446)\n\n# Symptoms\n\nThis \"research\" comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this:\n\n```text\nThe process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0\n\nCommand executed: \"C:WINNTsystem32cscript.exe\" /nologo \"NetworkAdapterCheck.vbs\" MASKEDCOMPUTERNAME 0 false true false\nWorking Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781\n\nOne or more workflows were affected by this.\n\nWorkflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealth\nInstance name: 0\nInstance ID: {F4C478D3-38E5-8C29-3957-E3B7F486216E}\nManagement group: MASKED\n```\n\nThis error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server.\n\n<!--more-->\n\n# Probable Cause\n\nI am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn't.\nSince I didn't have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added\n\n```vbs\nwscript.echo \"Line XX:\" & Err.Number\n```\n\nafter each object/function call in the Main Sub.\nThe problem seems to be at line 118:\n\n```vbs\nSet WMISet = WMIGetInstance(\"winmgmts:\" + TargetComputer + \"rootcimv2\", query)\n```\n\nAt line 119 I had a debug line that never executes and it would seem like the script is unable to process the query and exits without any error codes.\n\nThe query variable contains the following:\n\n```sql\nWin32_NetworkAdapter Where DeviceID='0' And ( NetConnectionStatus = '0' )\n```\n\nWhen I was debugging this I started the script like this:\n\n```cmd\ncscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED 0 false true false\n```\n\nI did find that if I change the parameters to this:\n\n```cmd\ncscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED 0 false false false\n```\n\nThen the script runs smoothly and produces an XML-output like this:\n\n```xml\n<Collection>\n  <DataItem type=\"System.PropertyBagData\" time=\"2009-04-22T15:03:44.6495202+02:00\" sourceHealthServiceId=\"C9F5A9F7-00A3-8A86-57B5-34FB634471A8\">\n  <Property Name=\"State\" VariantType=\"8\">GOOD</Property>\n  </DataItem>\n</Collection>\n```\n\n# Comments\n\nThere's quite the lot of similar errors posted on various forums on the internet but most of them ends up pointing towards the Antivirus Software as the perp and we have tried various exceptions on the server like excluding HealthExplorer.exe, MonitoringHost.exe and also the entire Health Service State folder with no improvement. But since I was able to run the scripts from other locations (not excluded) on the same server I find it hard to believe that the AV would be blocking it.\n","slug":"networkadaptercheck-fails-on-win2k","published":1,"updated":"2016-05-24T21:34:44.009Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7ie001vq4o2aqyej17g","content":"<h1 id=\"Problem\"><a href=\"#Problem\" class=\"headerlink\" title=\"Problem\"></a>Problem</h1><p>Here’s my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack för Operations Manager 2007 that is causing the <a href=\"http://www.teknoglot.se/ms/opsmgr2007/failed-to-create-propertybagdata-opsmgr/\" title=\"failed to create System.PropertyBagData\">failed to create System.PropertyBagData</a> error i wrote about earlier.<br>This information in also available on <a href=\"https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446\" target=\"_blank\" rel=\"external\">https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446</a></p>\n<h1 id=\"Symptoms\"><a href=\"#Symptoms\" class=\"headerlink\" title=\"Symptoms\"></a>Symptoms</h1><p>This “research” comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">The process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0</span><br><span class=\"line\"></span><br><span class=\"line\">Command executed: &quot;C:WINNTsystem32cscript.exe&quot; /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKEDCOMPUTERNAME 0 false true false</span><br><span class=\"line\">Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781</span><br><span class=\"line\"></span><br><span class=\"line\">One or more workflows were affected by this.</span><br><span class=\"line\"></span><br><span class=\"line\">Workflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealth</span><br><span class=\"line\">Instance name: 0</span><br><span class=\"line\">Instance ID: &#123;F4C478D3-38E5-8C29-3957-E3B7F486216E&#125;</span><br><span class=\"line\">Management group: MASKED</span><br></pre></td></tr></table></figure>\n<p>This error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server.</p>\n<a id=\"more\"></a>\n<h1 id=\"Probable-Cause\"><a href=\"#Probable-Cause\" class=\"headerlink\" title=\"Probable Cause\"></a>Probable Cause</h1><p>I am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn’t.<br>Since I didn’t have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added</p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"code\"><pre><span class=\"line\">wscript.echo <span class=\"string\">\"Line XX:\"</span> &amp; <span class=\"built_in\">Err</span>.Number</span><br></pre></td></tr></table></figure>\n<p>after each object/function call in the Main Sub.<br>The problem seems to be at line 118:</p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Set</span> WMISet = WMIGetInstance(<span class=\"string\">\"winmgmts:\"</span> + TargetComputer + <span class=\"string\">\"rootcimv2\"</span>, query)</span><br></pre></td></tr></table></figure>\n<p>At line 119 I had a debug line that never executes and it would seem like the script is unable to process the query and exits without any error codes.</p>\n<p>The query variable contains the following:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">Win32_NetworkAdapter Where DeviceID='0' And ( NetConnectionStatus = '0' )</span><br></pre></td></tr></table></figure>\n<p>When I was debugging this I started the script like this:</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"code\"><pre><span class=\"line\">cscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED <span class=\"number\">0</span> false true false</span><br></pre></td></tr></table></figure>\n<p>I did find that if I change the parameters to this:</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"code\"><pre><span class=\"line\">cscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED <span class=\"number\">0</span> false false false</span><br></pre></td></tr></table></figure>\n<p>Then the script runs smoothly and produces an XML-output like this:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Collection</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">DataItem</span> <span class=\"attr\">type</span>=<span class=\"string\">\"System.PropertyBagData\"</span> <span class=\"attr\">time</span>=<span class=\"string\">\"2009-04-22T15:03:44.6495202+02:00\"</span> <span class=\"attr\">sourceHealthServiceId</span>=<span class=\"string\">\"C9F5A9F7-00A3-8A86-57B5-34FB634471A8\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Property</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"State\"</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span>GOOD<span class=\"tag\">&lt;/<span class=\"name\">Property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">DataItem</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">Collection</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Comments\"><a href=\"#Comments\" class=\"headerlink\" title=\"Comments\"></a>Comments</h1><p>There’s quite the lot of similar errors posted on various forums on the internet but most of them ends up pointing towards the Antivirus Software as the perp and we have tried various exceptions on the server like excluding HealthExplorer.exe, MonitoringHost.exe and also the entire Health Service State folder with no improvement. But since I was able to run the scripts from other locations (not excluded) on the same server I find it hard to believe that the AV would be blocking it.</p>\n","excerpt":"<h1 id=\"Problem\"><a href=\"#Problem\" class=\"headerlink\" title=\"Problem\"></a>Problem</h1><p>Here’s my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack för Operations Manager 2007 that is causing the <a href=\"http://www.teknoglot.se/ms/opsmgr2007/failed-to-create-propertybagdata-opsmgr/\" title=\"failed to create System.PropertyBagData\">failed to create System.PropertyBagData</a> error i wrote about earlier.<br>This information in also available on <a href=\"https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446\">https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446</a></p>\n<h1 id=\"Symptoms\"><a href=\"#Symptoms\" class=\"headerlink\" title=\"Symptoms\"></a>Symptoms</h1><p>This “research” comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">The process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0</span><br><span class=\"line\"></span><br><span class=\"line\">Command executed: &quot;C:WINNTsystem32cscript.exe&quot; /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKEDCOMPUTERNAME 0 false true false</span><br><span class=\"line\">Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781</span><br><span class=\"line\"></span><br><span class=\"line\">One or more workflows were affected by this.</span><br><span class=\"line\"></span><br><span class=\"line\">Workflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealth</span><br><span class=\"line\">Instance name: 0</span><br><span class=\"line\">Instance ID: &#123;F4C478D3-38E5-8C29-3957-E3B7F486216E&#125;</span><br><span class=\"line\">Management group: MASKED</span><br></pre></td></tr></table></figure>\n<p>This error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server.</p>","more":"<h1 id=\"Probable-Cause\"><a href=\"#Probable-Cause\" class=\"headerlink\" title=\"Probable Cause\"></a>Probable Cause</h1><p>I am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn’t.<br>Since I didn’t have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added</p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"code\"><pre><span class=\"line\">wscript.echo <span class=\"string\">\"Line XX:\"</span> &amp; <span class=\"built_in\">Err</span>.Number</span><br></pre></td></tr></table></figure>\n<p>after each object/function call in the Main Sub.<br>The problem seems to be at line 118:</p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Set</span> WMISet = WMIGetInstance(<span class=\"string\">\"winmgmts:\"</span> + TargetComputer + <span class=\"string\">\"rootcimv2\"</span>, query)</span><br></pre></td></tr></table></figure>\n<p>At line 119 I had a debug line that never executes and it would seem like the script is unable to process the query and exits without any error codes.</p>\n<p>The query variable contains the following:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">Win32_NetworkAdapter Where DeviceID='0' And ( NetConnectionStatus = '0' )</span><br></pre></td></tr></table></figure>\n<p>When I was debugging this I started the script like this:</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"code\"><pre><span class=\"line\">cscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED <span class=\"number\">0</span> false true false</span><br></pre></td></tr></table></figure>\n<p>I did find that if I change the parameters to this:</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"code\"><pre><span class=\"line\">cscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED <span class=\"number\">0</span> false false false</span><br></pre></td></tr></table></figure>\n<p>Then the script runs smoothly and produces an XML-output like this:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Collection</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">DataItem</span> <span class=\"attr\">type</span>=<span class=\"string\">\"System.PropertyBagData\"</span> <span class=\"attr\">time</span>=<span class=\"string\">\"2009-04-22T15:03:44.6495202+02:00\"</span> <span class=\"attr\">sourceHealthServiceId</span>=<span class=\"string\">\"C9F5A9F7-00A3-8A86-57B5-34FB634471A8\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Property</span> <span class=\"attr\">Name</span>=<span class=\"string\">\"State\"</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span>GOOD<span class=\"tag\">&lt;/<span class=\"name\">Property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">DataItem</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">Collection</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Comments\"><a href=\"#Comments\" class=\"headerlink\" title=\"Comments\"></a>Comments</h1><p>There’s quite the lot of similar errors posted on various forums on the internet but most of them ends up pointing towards the Antivirus Software as the perp and we have tried various exceptions on the server like excluding HealthExplorer.exe, MonitoringHost.exe and also the entire Health Service State folder with no improvement. But since I was able to run the scripts from other locations (not excluded) on the same server I find it hard to believe that the AV would be blocking it.</p>"},{"title":"NVidia problems in Ubuntu 8.10","id":"98","date":"2008-11-10T08:20:14.000Z","_content":"\n[updated, scroll down if you want to skip some nonsense]\n\nSo, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04\\. And the upgrade itself was really easy. I just opened the \"Software Sources\", set the  _Release upgrade_ to **Normal Releases** (you find it under the _Updates_ tab).\nAfter that you get the option to do a _Distribution Upgrade_, which I did (took some 45 minutes to finish).\n\nI did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling.\n\nWhat I have come down to right now is doing the following:\n> **sudo apt-get install module-assistant**\nThis will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers.\n\n<span style=\"text-decoration: line-through;\">Going back to the \"Software Sources\" under i check the \"Unsopported updates\".</span>\nThen i execute\n> <span style=\"text-decoration: line-through;\">sudo apt-get autoremove</span>\n> <span style=\"text-decoration: line-through;\">sudo apt-get install nvidia-177-kernel-source</span>\n> **m-a auto-install nvidia**\n**UPDATE!**\n\nAfter fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers.\n\n1.  In a terminal, run _sudo apt-get install module assistant_\n2.  In a terminal, run _sudo m-a auto-install nvidia_\n3.  Open the \"Hardware Drivers\" application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you'll get the green recycle icon and be asked to reboot to activate the settings.\nHopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) )\n\nAnyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I've actually not find information anywhere yet that solve the problem totally and, well... that's why I did decide to post in here.\n\nFeel free to leave a comment if you got any more info or if you got any help from this.","source":"_posts/nvidia-problems-in-ubuntu-810.md","raw":"---\ntitle: NVidia problems in Ubuntu 8.10\ntags:\n  - Drivers\n  - NVidia\nid: 98\ncategories:\n  - Linux\n  - Ubuntu\ndate: 2008-11-10 09:20:14\n---\n\n[updated, scroll down if you want to skip some nonsense]\n\nSo, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04\\. And the upgrade itself was really easy. I just opened the \"Software Sources\", set the  _Release upgrade_ to **Normal Releases** (you find it under the _Updates_ tab).\nAfter that you get the option to do a _Distribution Upgrade_, which I did (took some 45 minutes to finish).\n\nI did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling.\n\nWhat I have come down to right now is doing the following:\n> **sudo apt-get install module-assistant**\nThis will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers.\n\n<span style=\"text-decoration: line-through;\">Going back to the \"Software Sources\" under i check the \"Unsopported updates\".</span>\nThen i execute\n> <span style=\"text-decoration: line-through;\">sudo apt-get autoremove</span>\n> <span style=\"text-decoration: line-through;\">sudo apt-get install nvidia-177-kernel-source</span>\n> **m-a auto-install nvidia**\n**UPDATE!**\n\nAfter fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers.\n\n1.  In a terminal, run _sudo apt-get install module assistant_\n2.  In a terminal, run _sudo m-a auto-install nvidia_\n3.  Open the \"Hardware Drivers\" application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you'll get the green recycle icon and be asked to reboot to activate the settings.\nHopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) )\n\nAnyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I've actually not find information anywhere yet that solve the problem totally and, well... that's why I did decide to post in here.\n\nFeel free to leave a comment if you got any more info or if you got any help from this.","slug":"nvidia-problems-in-ubuntu-810","published":1,"updated":"2016-05-24T21:31:04.466Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7ii001yq4o2g5ll06yk","content":"<p>[updated, scroll down if you want to skip some nonsense]</p>\n<p>So, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04. And the upgrade itself was really easy. I just opened the “Software Sources”, set the  <em>Release upgrade</em> to <strong>Normal Releases</strong> (you find it under the <em>Updates</em> tab).<br>After that you get the option to do a <em>Distribution Upgrade</em>, which I did (took some 45 minutes to finish).</p>\n<p>I did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling.</p>\n<p>What I have come down to right now is doing the following:</p>\n<blockquote>\n<p><strong>sudo apt-get install module-assistant</strong><br>This will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers.</p>\n</blockquote>\n<p><span style=\"text-decoration: line-through;\">Going back to the “Software Sources” under i check the “Unsopported updates”.</span><br>Then i execute</p>\n<blockquote>\n<p><span style=\"text-decoration: line-through;\">sudo apt-get autoremove</span><br><span style=\"text-decoration: line-through;\">sudo apt-get install nvidia-177-kernel-source</span><br><strong>m-a auto-install nvidia</strong><br><strong>UPDATE!</strong></p>\n</blockquote>\n<p>After fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers.</p>\n<ol>\n<li>In a terminal, run <em>sudo apt-get install module assistant</em></li>\n<li>In a terminal, run <em>sudo m-a auto-install nvidia</em></li>\n<li>Open the “Hardware Drivers” application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you’ll get the green recycle icon and be asked to reboot to activate the settings.<br>Hopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) )</li>\n</ol>\n<p>Anyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I’ve actually not find information anywhere yet that solve the problem totally and, well… that’s why I did decide to post in here.</p>\n<p>Feel free to leave a comment if you got any more info or if you got any help from this.</p>\n","excerpt":"","more":"<p>[updated, scroll down if you want to skip some nonsense]</p>\n<p>So, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04. And the upgrade itself was really easy. I just opened the “Software Sources”, set the  <em>Release upgrade</em> to <strong>Normal Releases</strong> (you find it under the <em>Updates</em> tab).<br>After that you get the option to do a <em>Distribution Upgrade</em>, which I did (took some 45 minutes to finish).</p>\n<p>I did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling.</p>\n<p>What I have come down to right now is doing the following:</p>\n<blockquote>\n<p><strong>sudo apt-get install module-assistant</strong><br>This will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers.</p>\n</blockquote>\n<p><span style=\"text-decoration: line-through;\">Going back to the “Software Sources” under i check the “Unsopported updates”.</span><br>Then i execute</p>\n<blockquote>\n<p><span style=\"text-decoration: line-through;\">sudo apt-get autoremove</span><br><span style=\"text-decoration: line-through;\">sudo apt-get install nvidia-177-kernel-source</span><br><strong>m-a auto-install nvidia</strong><br><strong>UPDATE!</strong></p>\n</blockquote>\n<p>After fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers.</p>\n<ol>\n<li>In a terminal, run <em>sudo apt-get install module assistant</em></li>\n<li>In a terminal, run <em>sudo m-a auto-install nvidia</em></li>\n<li>Open the “Hardware Drivers” application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you’ll get the green recycle icon and be asked to reboot to activate the settings.<br>Hopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) )</li>\n</ol>\n<p>Anyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I’ve actually not find information anywhere yet that solve the problem totally and, well… that’s why I did decide to post in here.</p>\n<p>Feel free to leave a comment if you got any more info or if you got any help from this.</p>\n"},{"title":"OpsMgr 2007 Connectivity Map","id":"505","date":"2011-05-17T09:47:18.000Z","_content":"\n[![SCOM Connectivity Map](http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png \"SCOM Connectivity Map\")](http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png)I've had this little visio drawing lying around on my desktop for a while now and I thought that it might be a nice thing to share.\n\nIt is nothing ground breaking at all and all the information is available at the [Operations Manager 2007 R2 Supported Configurations](http://technet.microsoft.com/en-us/library/bb309428.aspx \"Operations Manager 2007 R2 Supported Configurations\") page on Technet, but I find the visual map easier to read and I use it personally to quickly look up all port openings for the most common components in Operations Manager.\n\nIt is missing a few components like ACS, AEM and XPlat, but I usually just look them up when needed.\n\nHave fun!","source":"_posts/opsmgr-2007-connectivity-map.md","raw":"---\ntitle: OpsMgr 2007 Connectivity Map\ntags:\n  - OpsMgr\n  - Quick Reference\nid: 505\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2011-05-17 11:47:18\n---\n\n[![SCOM Connectivity Map](http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png \"SCOM Connectivity Map\")](http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png)I've had this little visio drawing lying around on my desktop for a while now and I thought that it might be a nice thing to share.\n\nIt is nothing ground breaking at all and all the information is available at the [Operations Manager 2007 R2 Supported Configurations](http://technet.microsoft.com/en-us/library/bb309428.aspx \"Operations Manager 2007 R2 Supported Configurations\") page on Technet, but I find the visual map easier to read and I use it personally to quickly look up all port openings for the most common components in Operations Manager.\n\nIt is missing a few components like ACS, AEM and XPlat, but I usually just look them up when needed.\n\nHave fun!","slug":"opsmgr-2007-connectivity-map","published":1,"updated":"2016-05-24T21:30:53.254Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7iw0022q4o2x54fs6ja","content":"<p><a href=\"http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png\" target=\"_blank\" rel=\"external\"><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png\" alt=\"SCOM Connectivity Map\" title=\"SCOM Connectivity Map\"></a>I’ve had this little visio drawing lying around on my desktop for a while now and I thought that it might be a nice thing to share.</p>\n<p>It is nothing ground breaking at all and all the information is available at the <a href=\"http://technet.microsoft.com/en-us/library/bb309428.aspx\" title=\"Operations Manager 2007 R2 Supported Configurations\" target=\"_blank\" rel=\"external\">Operations Manager 2007 R2 Supported Configurations</a> page on Technet, but I find the visual map easier to read and I use it personally to quickly look up all port openings for the most common components in Operations Manager.</p>\n<p>It is missing a few components like ACS, AEM and XPlat, but I usually just look them up when needed.</p>\n<p>Have fun!</p>\n","excerpt":"","more":"<p><a href=\"http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map.png\"><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2011/05/SCOM_Connectivity_Map-300x279.png\" alt=\"SCOM Connectivity Map\" title=\"SCOM Connectivity Map\"></a>I’ve had this little visio drawing lying around on my desktop for a while now and I thought that it might be a nice thing to share.</p>\n<p>It is nothing ground breaking at all and all the information is available at the <a href=\"http://technet.microsoft.com/en-us/library/bb309428.aspx\" title=\"Operations Manager 2007 R2 Supported Configurations\">Operations Manager 2007 R2 Supported Configurations</a> page on Technet, but I find the visual map easier to read and I use it personally to quickly look up all port openings for the most common components in Operations Manager.</p>\n<p>It is missing a few components like ACS, AEM and XPlat, but I usually just look them up when needed.</p>\n<p>Have fun!</p>\n"},{"title":"OpsMgr 2007 R2 Documentation","id":"578","date":"2011-08-08T20:52:27.000Z","_content":"\nHere a link to the [System Center Operations Manager 2007 R2 Documentation](http://www.microsoft.com/download/en/details.aspx?id=4561 \"System Center Operations Manager 2007 R2 Documentation\") for those of you out there who keeps asking of its whereabouts and then tell me to not tell you to [google for it](http://www.google.se/search?q=opsmgr+2007+r2+documentation \"opsmgr 2007 r2 documentation\").\n\nSo now I can direct you to my site, tell you to click on \"OpsMgr 2007\" to the left and browse through my posts instead of wasting precious time on googling and pretend being more helpful.\nTo the rest of the world, sorry for wasting your time!\n\nHappy now, eh?","source":"_posts/opsmgr-2007-r2-documentation.md","raw":"---\ntitle: OpsMgr 2007 R2 Documentation\ntags:\n  - Rant\n  - Sillyness\n  - Teach a Man to Fish\nid: 578\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2011-08-08 22:52:27\n---\n\nHere a link to the [System Center Operations Manager 2007 R2 Documentation](http://www.microsoft.com/download/en/details.aspx?id=4561 \"System Center Operations Manager 2007 R2 Documentation\") for those of you out there who keeps asking of its whereabouts and then tell me to not tell you to [google for it](http://www.google.se/search?q=opsmgr+2007+r2+documentation \"opsmgr 2007 r2 documentation\").\n\nSo now I can direct you to my site, tell you to click on \"OpsMgr 2007\" to the left and browse through my posts instead of wasting precious time on googling and pretend being more helpful.\nTo the rest of the world, sorry for wasting your time!\n\nHappy now, eh?","slug":"opsmgr-2007-r2-documentation","published":1,"updated":"2016-05-24T21:30:38.928Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7iz0026q4o2yftymaxa","content":"<p>Here a link to the <a href=\"http://www.microsoft.com/download/en/details.aspx?id=4561\" title=\"System Center Operations Manager 2007 R2 Documentation\" target=\"_blank\" rel=\"external\">System Center Operations Manager 2007 R2 Documentation</a> for those of you out there who keeps asking of its whereabouts and then tell me to not tell you to <a href=\"http://www.google.se/search?q=opsmgr+2007+r2+documentation\" title=\"opsmgr 2007 r2 documentation\" target=\"_blank\" rel=\"external\">google for it</a>.</p>\n<p>So now I can direct you to my site, tell you to click on “OpsMgr 2007” to the left and browse through my posts instead of wasting precious time on googling and pretend being more helpful.<br>To the rest of the world, sorry for wasting your time!</p>\n<p>Happy now, eh?</p>\n","excerpt":"","more":"<p>Here a link to the <a href=\"http://www.microsoft.com/download/en/details.aspx?id=4561\" title=\"System Center Operations Manager 2007 R2 Documentation\">System Center Operations Manager 2007 R2 Documentation</a> for those of you out there who keeps asking of its whereabouts and then tell me to not tell you to <a href=\"http://www.google.se/search?q=opsmgr+2007+r2+documentation\" title=\"opsmgr 2007 r2 documentation\">google for it</a>.</p>\n<p>So now I can direct you to my site, tell you to click on “OpsMgr 2007” to the left and browse through my posts instead of wasting precious time on googling and pretend being more helpful.<br>To the rest of the world, sorry for wasting your time!</p>\n<p>Happy now, eh?</p>\n"},{"title":"OpsMgr 2012 Agent Failover – A Faster Script with Wildcards [#opsmgr, #powershell]","id":"710","date":"2012-06-28T12:28:36.000Z","_content":"\nNow we're gonna make things even faster! In the [previous post](http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/ \"OpsMgr 2012 Agent Failover – Simple Script with Wildcards [#opsmgr, #powershell]\") on the subject of [Agent Fail-over in Operations Manager 2012](http://www.teknoglot.se/series/om2012-failover-mgmt/) we created a script that will go through a selection of agents and make sure that they all have up-to-date fail-over settings. We are doing the same thing in this one, but making it go faster. In my lab, it's about five times faster in fact and I only have about 20 agents to play with. Not really a big deal, but scale it up a bit and add a few thousand agents and the pay-off will be very significant.\n\nAs usual, the script will work as is, but it really is more to show the concept. You would have to add filtering to make sure you don't mix agents behind gateway servers and agents behind management servers. Giving an agent behind a gateway a management servers as it's fail-over server will likely not help you in any way.\n\nWe will pretty quickly go \"advanced\" this time, so buckle up. ;)\n\n<!--more-->\n\nBeing a slight modification of the script in the last post I am not going to go through those details. Use that post if you need references to the Inputs, the OpsMgr 2012 Modules, Management Group connection and gathering your agents and management servers.\n\n### Why Is It Faster?\n\nWe are doing the same thing, on the same agents and with the same servers. And we already did some optimization by loading them all into memory and working from there. How do you make it faster? Basically, I'm cutting the over-head of the cmdlets and how they work. You may have noticed that in the \"Do Stuff\" section, we are actually calling the _Set-SCOMParentManagementServer_ cmdlet twice! Once for the primary Management Server and once for the fail-over Management Servers. In effect, we connect, fire a command, wait for result, and disconnect two times for each agent. And pretty much only because the cmdlet does not offer support to set primary and fail-over management servers at the same time. Any attempt to do so will return an ambiguous parameter error.\n\nI don't like that. A brief look at the agent object class, [Microsoft.EnterpriseManagement.Administration.AgentManagedComputer](http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.aspx), revealed a method called [SetManagementServers](http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.setmanagementservers \"AgentManagedComputer.SetManagementServers Method\"). This method takes, or actually \"requires\", two parameters. One for primary and one for fail-over management servers. Yay!\n\nUsing this method saves us a bunch of over-head and a couple of round-trips to the SDK-service.\n\n### The Challenge\n\nUnfortunately, you cannot simply toss an array of management servers at the SetManagementServers method. With a bit of knowledge or keen eyes you will spot the problem right away. I didn't and was pulling my hair for a while until I realized what caused the errors. Looking closer at how the method is defined we see this:\n\n[csharp]public void SetManagementServers (\n ManagementServer managementServer,\n IList failoverManagementServers\n )[/csharp]\n\nYou see that _IList<ManagementServer>_ part?\nThat's the problem. When you run _Get-SCOMManagementServer_ and save the result to a powershell variable, you will get a powershell \"Enumerable\". In C#, that would be a class that implements the _IEnumerable_ interface. Sad part is, it does not also implement _IList_. If you are thinking \"IList... IEnumerable... Interface... Whaaaaa...???\" right now, don't worry. You don't have to understand this to read the script later on, just think of it as different types of data.\n\nTo get around this, we create a new object based on the dotNET List type and populate it with the management servers in our $scomFailOverMS array.\n\n[powershell]$scomMSList = New-Object 'Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]'\nforeach ($scomMS in $scomFailOverMS) {\n # Loop through the array and add your failover MSs to the list\n $scomMSList.Add($scomMS)\n}[/powershell]\n> Note:We have to do that foreach loop since our $scomMSList object do not implement IEnumerable\nStill with me?\n\n### Configuring the Agent\n\nAs the method exist on that _AgentManagedComputer_ class we will call it on our $scomAgent object, like this:\n\n[powershell]$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)[/powershell]\n\nAnd we're done!\n\nI had some doubt that this would be an improvement at first since we have to create our own objects and run an extra foreach-loop, but as we only work on objects in memory and only speak to the SDK service once per agent, we cut a lot of over-head and delays from our execution. On 20-ish agents in a lab, I've measured the execution time drop to barely a fifth.\n\n### The Copy/Paste Part\n\nAnd here's the entire script with a few added comments for clarity. Read, adapt and try it. In a lab, preferably.\n\n[powershell]# Input SCOM Management Server to connect to in this session\n[string]$inputScomMS = \"scomms02.domain.local\"\n# Input an existing agent you want to modify\n[string]$inputTargetAgent = \"*.domain.local\"\n\n### Connect to SCOM 2012 Management Group ###\nIf (Get-Module -Name \"OperationsManager\") {\n\ttry {\n\t\tImport-Module -Name \"OperationsManager\"\n\t} catch {\n\t\techo \"Could not load Operations Manager module\"\n\t\texit\n\t}\n}\nNew-SCOMManagementGroupConnection -ComputerName $inputScomMS\n### END ###\n\n$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}\n# Get all of the management servers\n# It is ofcourse possible to search by hostname and wildcards using selected\n# parameters to the cmdlet.\n$scomManagementServers = Get-SCOMManagementServer\n# Switch to the following line to only get Gateway Servers\n#$scomManagementServers = Get-SCOMGatewayManagementServer\nforeach ($scomAgent in $scomAgents) {\n\t# Get the primary management server for the agent\n\t$scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n\t# Remove the primary MS from \"all MS\" array to use it for FailOver servers\n\t$scomFailOverMS = $scomManagementServers | where {$_.Name -ne $scomPrimaryMS.Name}\n\n\t# Create a new IList derived object for the failover MSs\n\t# You have to do this because the SetManagementServers() method requires an\n\t# IList and the MS-array is an IEnumerable type. So we basically create\n\t# a new IList object och the ManagementServer type.\n\t$scomMSList = New-Object 'Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]'\n\tforeach ($scomMS in $scomFailOverMS) {\n\t\t# Loop through the array and add your failover MSs to the list\n\t\t$scomMSList.Add($scomMS)\n\t}\n\t$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)\n}\n[/powershell]\n\nGLHF!","source":"_posts/opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell.md","raw":"---\ntitle: >-\n  OpsMgr 2012 Agent Failover – A Faster Script with Wildcards [#opsmgr,\n  #powershell]\ntags:\n  - Fail-over\n  - OpsMgr\n  - PoSH\n  - Script\nid: 710\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2012-06-28 14:28:36\n---\n\nNow we're gonna make things even faster! In the [previous post](http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/ \"OpsMgr 2012 Agent Failover – Simple Script with Wildcards [#opsmgr, #powershell]\") on the subject of [Agent Fail-over in Operations Manager 2012](http://www.teknoglot.se/series/om2012-failover-mgmt/) we created a script that will go through a selection of agents and make sure that they all have up-to-date fail-over settings. We are doing the same thing in this one, but making it go faster. In my lab, it's about five times faster in fact and I only have about 20 agents to play with. Not really a big deal, but scale it up a bit and add a few thousand agents and the pay-off will be very significant.\n\nAs usual, the script will work as is, but it really is more to show the concept. You would have to add filtering to make sure you don't mix agents behind gateway servers and agents behind management servers. Giving an agent behind a gateway a management servers as it's fail-over server will likely not help you in any way.\n\nWe will pretty quickly go \"advanced\" this time, so buckle up. ;)\n\n<!--more-->\n\nBeing a slight modification of the script in the last post I am not going to go through those details. Use that post if you need references to the Inputs, the OpsMgr 2012 Modules, Management Group connection and gathering your agents and management servers.\n\n### Why Is It Faster?\n\nWe are doing the same thing, on the same agents and with the same servers. And we already did some optimization by loading them all into memory and working from there. How do you make it faster? Basically, I'm cutting the over-head of the cmdlets and how they work. You may have noticed that in the \"Do Stuff\" section, we are actually calling the _Set-SCOMParentManagementServer_ cmdlet twice! Once for the primary Management Server and once for the fail-over Management Servers. In effect, we connect, fire a command, wait for result, and disconnect two times for each agent. And pretty much only because the cmdlet does not offer support to set primary and fail-over management servers at the same time. Any attempt to do so will return an ambiguous parameter error.\n\nI don't like that. A brief look at the agent object class, [Microsoft.EnterpriseManagement.Administration.AgentManagedComputer](http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.aspx), revealed a method called [SetManagementServers](http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.setmanagementservers \"AgentManagedComputer.SetManagementServers Method\"). This method takes, or actually \"requires\", two parameters. One for primary and one for fail-over management servers. Yay!\n\nUsing this method saves us a bunch of over-head and a couple of round-trips to the SDK-service.\n\n### The Challenge\n\nUnfortunately, you cannot simply toss an array of management servers at the SetManagementServers method. With a bit of knowledge or keen eyes you will spot the problem right away. I didn't and was pulling my hair for a while until I realized what caused the errors. Looking closer at how the method is defined we see this:\n\n[csharp]public void SetManagementServers (\n ManagementServer managementServer,\n IList failoverManagementServers\n )[/csharp]\n\nYou see that _IList<ManagementServer>_ part?\nThat's the problem. When you run _Get-SCOMManagementServer_ and save the result to a powershell variable, you will get a powershell \"Enumerable\". In C#, that would be a class that implements the _IEnumerable_ interface. Sad part is, it does not also implement _IList_. If you are thinking \"IList... IEnumerable... Interface... Whaaaaa...???\" right now, don't worry. You don't have to understand this to read the script later on, just think of it as different types of data.\n\nTo get around this, we create a new object based on the dotNET List type and populate it with the management servers in our $scomFailOverMS array.\n\n[powershell]$scomMSList = New-Object 'Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]'\nforeach ($scomMS in $scomFailOverMS) {\n # Loop through the array and add your failover MSs to the list\n $scomMSList.Add($scomMS)\n}[/powershell]\n> Note:We have to do that foreach loop since our $scomMSList object do not implement IEnumerable\nStill with me?\n\n### Configuring the Agent\n\nAs the method exist on that _AgentManagedComputer_ class we will call it on our $scomAgent object, like this:\n\n[powershell]$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)[/powershell]\n\nAnd we're done!\n\nI had some doubt that this would be an improvement at first since we have to create our own objects and run an extra foreach-loop, but as we only work on objects in memory and only speak to the SDK service once per agent, we cut a lot of over-head and delays from our execution. On 20-ish agents in a lab, I've measured the execution time drop to barely a fifth.\n\n### The Copy/Paste Part\n\nAnd here's the entire script with a few added comments for clarity. Read, adapt and try it. In a lab, preferably.\n\n[powershell]# Input SCOM Management Server to connect to in this session\n[string]$inputScomMS = \"scomms02.domain.local\"\n# Input an existing agent you want to modify\n[string]$inputTargetAgent = \"*.domain.local\"\n\n### Connect to SCOM 2012 Management Group ###\nIf (Get-Module -Name \"OperationsManager\") {\n\ttry {\n\t\tImport-Module -Name \"OperationsManager\"\n\t} catch {\n\t\techo \"Could not load Operations Manager module\"\n\t\texit\n\t}\n}\nNew-SCOMManagementGroupConnection -ComputerName $inputScomMS\n### END ###\n\n$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}\n# Get all of the management servers\n# It is ofcourse possible to search by hostname and wildcards using selected\n# parameters to the cmdlet.\n$scomManagementServers = Get-SCOMManagementServer\n# Switch to the following line to only get Gateway Servers\n#$scomManagementServers = Get-SCOMGatewayManagementServer\nforeach ($scomAgent in $scomAgents) {\n\t# Get the primary management server for the agent\n\t$scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n\t# Remove the primary MS from \"all MS\" array to use it for FailOver servers\n\t$scomFailOverMS = $scomManagementServers | where {$_.Name -ne $scomPrimaryMS.Name}\n\n\t# Create a new IList derived object for the failover MSs\n\t# You have to do this because the SetManagementServers() method requires an\n\t# IList and the MS-array is an IEnumerable type. So we basically create\n\t# a new IList object och the ManagementServer type.\n\t$scomMSList = New-Object 'Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]'\n\tforeach ($scomMS in $scomFailOverMS) {\n\t\t# Loop through the array and add your failover MSs to the list\n\t\t$scomMSList.Add($scomMS)\n\t}\n\t$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)\n}\n[/powershell]\n\nGLHF!","slug":"opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell","published":1,"updated":"2016-05-24T21:30:23.119Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7j1002aq4o2v1elhqqn","content":"<p>Now we’re gonna make things even faster! In the <a href=\"http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/\" title=\"OpsMgr 2012 Agent Failover – Simple Script with Wildcards [#opsmgr, #powershell]\">previous post</a> on the subject of <a href=\"http://www.teknoglot.se/series/om2012-failover-mgmt/\">Agent Fail-over in Operations Manager 2012</a> we created a script that will go through a selection of agents and make sure that they all have up-to-date fail-over settings. We are doing the same thing in this one, but making it go faster. In my lab, it’s about five times faster in fact and I only have about 20 agents to play with. Not really a big deal, but scale it up a bit and add a few thousand agents and the pay-off will be very significant.</p>\n<p>As usual, the script will work as is, but it really is more to show the concept. You would have to add filtering to make sure you don’t mix agents behind gateway servers and agents behind management servers. Giving an agent behind a gateway a management servers as it’s fail-over server will likely not help you in any way.</p>\n<p>We will pretty quickly go “advanced” this time, so buckle up. ;)</p>\n<a id=\"more\"></a>\n<p>Being a slight modification of the script in the last post I am not going to go through those details. Use that post if you need references to the Inputs, the OpsMgr 2012 Modules, Management Group connection and gathering your agents and management servers.</p>\n<h3 id=\"Why-Is-It-Faster\"><a href=\"#Why-Is-It-Faster\" class=\"headerlink\" title=\"Why Is It Faster?\"></a>Why Is It Faster?</h3><p>We are doing the same thing, on the same agents and with the same servers. And we already did some optimization by loading them all into memory and working from there. How do you make it faster? Basically, I’m cutting the over-head of the cmdlets and how they work. You may have noticed that in the “Do Stuff” section, we are actually calling the <em>Set-SCOMParentManagementServer</em> cmdlet twice! Once for the primary Management Server and once for the fail-over Management Servers. In effect, we connect, fire a command, wait for result, and disconnect two times for each agent. And pretty much only because the cmdlet does not offer support to set primary and fail-over management servers at the same time. Any attempt to do so will return an ambiguous parameter error.</p>\n<p>I don’t like that. A brief look at the agent object class, <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.aspx\" target=\"_blank\" rel=\"external\">Microsoft.EnterpriseManagement.Administration.AgentManagedComputer</a>, revealed a method called <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.setmanagementservers\" title=\"AgentManagedComputer.SetManagementServers Method\" target=\"_blank\" rel=\"external\">SetManagementServers</a>. This method takes, or actually “requires”, two parameters. One for primary and one for fail-over management servers. Yay!</p>\n<p>Using this method saves us a bunch of over-head and a couple of round-trips to the SDK-service.</p>\n<h3 id=\"The-Challenge\"><a href=\"#The-Challenge\" class=\"headerlink\" title=\"The Challenge\"></a>The Challenge</h3><p>Unfortunately, you cannot simply toss an array of management servers at the SetManagementServers method. With a bit of knowledge or keen eyes you will spot the problem right away. I didn’t and was pulling my hair for a while until I realized what caused the errors. Looking closer at how the method is defined we see this:</p>\n<p>[csharp]public void SetManagementServers (<br> ManagementServer managementServer,<br> IList failoverManagementServers<br> )[/csharp]</p>\n<p>You see that <em>IList<managementserver></managementserver></em> part?<br>That’s the problem. When you run <em>Get-SCOMManagementServer</em> and save the result to a powershell variable, you will get a powershell “Enumerable”. In C#, that would be a class that implements the <em>IEnumerable</em> interface. Sad part is, it does not also implement <em>IList</em>. If you are thinking “IList… IEnumerable… Interface… Whaaaaa…???” right now, don’t worry. You don’t have to understand this to read the script later on, just think of it as different types of data.</p>\n<p>To get around this, we create a new object based on the dotNET List type and populate it with the management servers in our $scomFailOverMS array.</p>\n<p>[powershell]$scomMSList = New-Object ‘Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]’<br>foreach ($scomMS in $scomFailOverMS) {</p>\n<h1 id=\"Loop-through-the-array-and-add-your-failover-MSs-to-the-list\"><a href=\"#Loop-through-the-array-and-add-your-failover-MSs-to-the-list\" class=\"headerlink\" title=\"Loop through the array and add your failover MSs to the list\"></a>Loop through the array and add your failover MSs to the list</h1><p> $scomMSList.Add($scomMS)<br>}[/powershell]</p>\n<blockquote>\n<p>Note:We have to do that foreach loop since our $scomMSList object do not implement IEnumerable<br>Still with me?</p>\n</blockquote>\n<h3 id=\"Configuring-the-Agent\"><a href=\"#Configuring-the-Agent\" class=\"headerlink\" title=\"Configuring the Agent\"></a>Configuring the Agent</h3><p>As the method exist on that <em>AgentManagedComputer</em> class we will call it on our $scomAgent object, like this:</p>\n<p>[powershell]$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)[/powershell]</p>\n<p>And we’re done!</p>\n<p>I had some doubt that this would be an improvement at first since we have to create our own objects and run an extra foreach-loop, but as we only work on objects in memory and only speak to the SDK service once per agent, we cut a lot of over-head and delays from our execution. On 20-ish agents in a lab, I’ve measured the execution time drop to barely a fifth.</p>\n<h3 id=\"The-Copy-Paste-Part\"><a href=\"#The-Copy-Paste-Part\" class=\"headerlink\" title=\"The Copy/Paste Part\"></a>The Copy/Paste Part</h3><p>And here’s the entire script with a few added comments for clarity. Read, adapt and try it. In a lab, preferably.</p>\n<p>[powershell]# Input SCOM Management Server to connect to in this session<br>[string]$inputScomMS = “scomms02.domain.local”</p>\n<h1 id=\"Input-an-existing-agent-you-want-to-modify\"><a href=\"#Input-an-existing-agent-you-want-to-modify\" class=\"headerlink\" title=\"Input an existing agent you want to modify\"></a>Input an existing agent you want to modify</h1><p>[string]$inputTargetAgent = “*.domain.local”</p>\n<h3 id=\"Connect-to-SCOM-2012-Management-Group\"><a href=\"#Connect-to-SCOM-2012-Management-Group\" class=\"headerlink\" title=\"Connect to SCOM 2012 Management Group\"></a>Connect to SCOM 2012 Management Group</h3><p>If (Get-Module -Name “OperationsManager”) {<br>    try {<br>        Import-Module -Name “OperationsManager”<br>    } catch {<br>        echo “Could not load Operations Manager module”<br>        exit<br>    }<br>}<br>New-SCOMManagementGroupConnection -ComputerName $inputScomMS</p>\n<h3 id=\"END\"><a href=\"#END\" class=\"headerlink\" title=\"END\"></a>END</h3><p>$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}</p>\n<h1 id=\"Get-all-of-the-management-servers\"><a href=\"#Get-all-of-the-management-servers\" class=\"headerlink\" title=\"Get all of the management servers\"></a>Get all of the management servers</h1><h1 id=\"It-is-ofcourse-possible-to-search-by-hostname-and-wildcards-using-selected\"><a href=\"#It-is-ofcourse-possible-to-search-by-hostname-and-wildcards-using-selected\" class=\"headerlink\" title=\"It is ofcourse possible to search by hostname and wildcards using selected\"></a>It is ofcourse possible to search by hostname and wildcards using selected</h1><h1 id=\"parameters-to-the-cmdlet\"><a href=\"#parameters-to-the-cmdlet\" class=\"headerlink\" title=\"parameters to the cmdlet.\"></a>parameters to the cmdlet.</h1><p>$scomManagementServers = Get-SCOMManagementServer</p>\n<h1 id=\"Switch-to-the-following-line-to-only-get-Gateway-Servers\"><a href=\"#Switch-to-the-following-line-to-only-get-Gateway-Servers\" class=\"headerlink\" title=\"Switch to the following line to only get Gateway Servers\"></a>Switch to the following line to only get Gateway Servers</h1><p>#$scomManagementServers = Get-SCOMGatewayManagementServer<br>foreach ($scomAgent in $scomAgents) {</p>\n<pre><code># Get the primary management server for the agent\n$scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n# Remove the primary MS from &quot;all MS&quot; array to use it for FailOver servers\n$scomFailOverMS = $scomManagementServers | where {$_.Name -ne $scomPrimaryMS.Name}\n\n# Create a new IList derived object for the failover MSs\n# You have to do this because the SetManagementServers() method requires an\n# IList and the MS-array is an IEnumerable type. So we basically create\n# a new IList object och the ManagementServer type.\n$scomMSList = New-Object &apos;Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]&apos;\nforeach ($scomMS in $scomFailOverMS) {\n    # Loop through the array and add your failover MSs to the list\n    $scomMSList.Add($scomMS)\n}\n$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)\n</code></pre><p>}<br>[/powershell]</p>\n<p>GLHF!</p>\n","excerpt":"<p>Now we’re gonna make things even faster! In the <a href=\"http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/\" title=\"OpsMgr 2012 Agent Failover – Simple Script with Wildcards [#opsmgr, #powershell]\">previous post</a> on the subject of <a href=\"http://www.teknoglot.se/series/om2012-failover-mgmt/\">Agent Fail-over in Operations Manager 2012</a> we created a script that will go through a selection of agents and make sure that they all have up-to-date fail-over settings. We are doing the same thing in this one, but making it go faster. In my lab, it’s about five times faster in fact and I only have about 20 agents to play with. Not really a big deal, but scale it up a bit and add a few thousand agents and the pay-off will be very significant.</p>\n<p>As usual, the script will work as is, but it really is more to show the concept. You would have to add filtering to make sure you don’t mix agents behind gateway servers and agents behind management servers. Giving an agent behind a gateway a management servers as it’s fail-over server will likely not help you in any way.</p>\n<p>We will pretty quickly go “advanced” this time, so buckle up. ;)</p>","more":"<p>Being a slight modification of the script in the last post I am not going to go through those details. Use that post if you need references to the Inputs, the OpsMgr 2012 Modules, Management Group connection and gathering your agents and management servers.</p>\n<h3 id=\"Why-Is-It-Faster\"><a href=\"#Why-Is-It-Faster\" class=\"headerlink\" title=\"Why Is It Faster?\"></a>Why Is It Faster?</h3><p>We are doing the same thing, on the same agents and with the same servers. And we already did some optimization by loading them all into memory and working from there. How do you make it faster? Basically, I’m cutting the over-head of the cmdlets and how they work. You may have noticed that in the “Do Stuff” section, we are actually calling the <em>Set-SCOMParentManagementServer</em> cmdlet twice! Once for the primary Management Server and once for the fail-over Management Servers. In effect, we connect, fire a command, wait for result, and disconnect two times for each agent. And pretty much only because the cmdlet does not offer support to set primary and fail-over management servers at the same time. Any attempt to do so will return an ambiguous parameter error.</p>\n<p>I don’t like that. A brief look at the agent object class, <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.aspx\">Microsoft.EnterpriseManagement.Administration.AgentManagedComputer</a>, revealed a method called <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.enterprisemanagement.administration.agentmanagedcomputer.setmanagementservers\" title=\"AgentManagedComputer.SetManagementServers Method\">SetManagementServers</a>. This method takes, or actually “requires”, two parameters. One for primary and one for fail-over management servers. Yay!</p>\n<p>Using this method saves us a bunch of over-head and a couple of round-trips to the SDK-service.</p>\n<h3 id=\"The-Challenge\"><a href=\"#The-Challenge\" class=\"headerlink\" title=\"The Challenge\"></a>The Challenge</h3><p>Unfortunately, you cannot simply toss an array of management servers at the SetManagementServers method. With a bit of knowledge or keen eyes you will spot the problem right away. I didn’t and was pulling my hair for a while until I realized what caused the errors. Looking closer at how the method is defined we see this:</p>\n<p>[csharp]public void SetManagementServers (<br> ManagementServer managementServer,<br> IList failoverManagementServers<br> )[/csharp]</p>\n<p>You see that <em>IList<ManagementServer></em> part?<br>That’s the problem. When you run <em>Get-SCOMManagementServer</em> and save the result to a powershell variable, you will get a powershell “Enumerable”. In C#, that would be a class that implements the <em>IEnumerable</em> interface. Sad part is, it does not also implement <em>IList</em>. If you are thinking “IList… IEnumerable… Interface… Whaaaaa…???” right now, don’t worry. You don’t have to understand this to read the script later on, just think of it as different types of data.</p>\n<p>To get around this, we create a new object based on the dotNET List type and populate it with the management servers in our $scomFailOverMS array.</p>\n<p>[powershell]$scomMSList = New-Object ‘Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]’<br>foreach ($scomMS in $scomFailOverMS) {</p>\n<h1 id=\"Loop-through-the-array-and-add-your-failover-MSs-to-the-list\"><a href=\"#Loop-through-the-array-and-add-your-failover-MSs-to-the-list\" class=\"headerlink\" title=\"Loop through the array and add your failover MSs to the list\"></a>Loop through the array and add your failover MSs to the list</h1><p> $scomMSList.Add($scomMS)<br>}[/powershell]</p>\n<blockquote>\n<p>Note:We have to do that foreach loop since our $scomMSList object do not implement IEnumerable<br>Still with me?</p>\n</blockquote>\n<h3 id=\"Configuring-the-Agent\"><a href=\"#Configuring-the-Agent\" class=\"headerlink\" title=\"Configuring the Agent\"></a>Configuring the Agent</h3><p>As the method exist on that <em>AgentManagedComputer</em> class we will call it on our $scomAgent object, like this:</p>\n<p>[powershell]$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)[/powershell]</p>\n<p>And we’re done!</p>\n<p>I had some doubt that this would be an improvement at first since we have to create our own objects and run an extra foreach-loop, but as we only work on objects in memory and only speak to the SDK service once per agent, we cut a lot of over-head and delays from our execution. On 20-ish agents in a lab, I’ve measured the execution time drop to barely a fifth.</p>\n<h3 id=\"The-Copy-Paste-Part\"><a href=\"#The-Copy-Paste-Part\" class=\"headerlink\" title=\"The Copy/Paste Part\"></a>The Copy/Paste Part</h3><p>And here’s the entire script with a few added comments for clarity. Read, adapt and try it. In a lab, preferably.</p>\n<p>[powershell]# Input SCOM Management Server to connect to in this session<br>[string]$inputScomMS = “scomms02.domain.local”</p>\n<h1 id=\"Input-an-existing-agent-you-want-to-modify\"><a href=\"#Input-an-existing-agent-you-want-to-modify\" class=\"headerlink\" title=\"Input an existing agent you want to modify\"></a>Input an existing agent you want to modify</h1><p>[string]$inputTargetAgent = “*.domain.local”</p>\n<h3 id=\"Connect-to-SCOM-2012-Management-Group\"><a href=\"#Connect-to-SCOM-2012-Management-Group\" class=\"headerlink\" title=\"Connect to SCOM 2012 Management Group\"></a>Connect to SCOM 2012 Management Group</h3><p>If (Get-Module -Name “OperationsManager”) {<br>    try {<br>        Import-Module -Name “OperationsManager”<br>    } catch {<br>        echo “Could not load Operations Manager module”<br>        exit<br>    }<br>}<br>New-SCOMManagementGroupConnection -ComputerName $inputScomMS</p>\n<h3 id=\"END\"><a href=\"#END\" class=\"headerlink\" title=\"END\"></a>END</h3><p>$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}</p>\n<h1 id=\"Get-all-of-the-management-servers\"><a href=\"#Get-all-of-the-management-servers\" class=\"headerlink\" title=\"Get all of the management servers\"></a>Get all of the management servers</h1><h1 id=\"It-is-ofcourse-possible-to-search-by-hostname-and-wildcards-using-selected\"><a href=\"#It-is-ofcourse-possible-to-search-by-hostname-and-wildcards-using-selected\" class=\"headerlink\" title=\"It is ofcourse possible to search by hostname and wildcards using selected\"></a>It is ofcourse possible to search by hostname and wildcards using selected</h1><h1 id=\"parameters-to-the-cmdlet\"><a href=\"#parameters-to-the-cmdlet\" class=\"headerlink\" title=\"parameters to the cmdlet.\"></a>parameters to the cmdlet.</h1><p>$scomManagementServers = Get-SCOMManagementServer</p>\n<h1 id=\"Switch-to-the-following-line-to-only-get-Gateway-Servers\"><a href=\"#Switch-to-the-following-line-to-only-get-Gateway-Servers\" class=\"headerlink\" title=\"Switch to the following line to only get Gateway Servers\"></a>Switch to the following line to only get Gateway Servers</h1><p>#$scomManagementServers = Get-SCOMGatewayManagementServer<br>foreach ($scomAgent in $scomAgents) {</p>\n<pre><code># Get the primary management server for the agent\n$scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n# Remove the primary MS from &quot;all MS&quot; array to use it for FailOver servers\n$scomFailOverMS = $scomManagementServers | where {$_.Name -ne $scomPrimaryMS.Name}\n\n# Create a new IList derived object for the failover MSs\n# You have to do this because the SetManagementServers() method requires an\n# IList and the MS-array is an IEnumerable type. So we basically create\n# a new IList object och the ManagementServer type.\n$scomMSList = New-Object &apos;Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]&apos;\nforeach ($scomMS in $scomFailOverMS) {\n    # Loop through the array and add your failover MSs to the list\n    $scomMSList.Add($scomMS)\n}\n$scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList)\n</code></pre><p>}<br>[/powershell]</p>\n<p>GLHF!</p>"},{"title":"OpsMgr 2012 Agent Failover - Simple Script with Wildcards [#opsmgr, #powershell]","id":"685","date":"2012-06-21T08:58:13.000Z","_content":"\nIn the last post, [OpsMgr 2012 Agent & Gateway Failover – The Basics](http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-gateway-failover-the-basics/ \"OpsMgr 2012 Agent & Gateway Failover – The Basics [#opsmgr, #powershell]\"), we looked at the basics of the Agent and Gateway fail-over configuration cmdlets and how to use them in a direct and interactive setting. This is absolutely useful when you got this specific agent that you need to configure with a specific fail-over management server.\n\nTo spice it up a little, we are going to add a little intelligence to it and enable wild-card selections while at it. The scenario we are building this script for is that now and then you want to make sure that certain agents have fail-over management servers configured. You also want to make sure that all management servers that are not the primary management server of any selected agent will be in that list of fail-over servers. This would include any new management servers as well as exclude any removed ones. In short, make sure your agent fail-over settings are up-to-date with the current environment.\n\n<!--more-->\n\n### Inputs\n\nTo use this script you need to know which management server you should connect your powershell session to and which agent, or agents, you want to check and configure.\n\n[powershell]\n\n# Input SCOM Management Server to connect to in this session\n[string]$inputScomMS = \"scomms01.domain.local\"\n# Input an existing agent you want to modify\n[string]$inputTargetAgent = \"*.domain.local\"\n\n[/powershell]\n> Note: If you are using load-balanced SDK-services, or \"Data Access Services\", pointing _$inputScomMS_ to that virtual host-name will work perfectly fine.\nThis example uses a wild-card for the agent selection and I guess it's the most likely scenario for this script, but a single host-name obviously works fine as well. Supported wildcard selections are [documented at TechNet](http://technet.microsoft.com/en-us/library/ee692793.aspx). An array of computer-names or a comma-separated list, however, will not work. You could easily add that functionality but it's out of scope for this example.\n\n### Connect to Your Management Group\n\nTo run any script against an Operations Manager 2012 Management Group we need a connection to one. To connect to a management group we have to load the OperationsManager module. Lets check for a loaded module, load it if necessary and connect to the Management Server from the _$inputScomMS_ setting. If loading the module fails--maybe it is not installed--we will exit the script.\n\n[powershell]\n\n# Check if OperationsManager module is loaded\nIf (Get-Module -Name \"OperationsManager\") {\n try {\n # Try to load the module\n Import-Module -Name \"OperationsManager\"\n } catch {\n # Did not work, exit the script\n echo \"Could not load Operations Manager module\"\n exit\n }\n}\n# Module is loaded, connect to Management Group/Server\nNew-SCOMManagementGroupConnection -ComputerName $inputScomMS\n\n[/powershell]\n\nA good idea would, of course, be to first check if we already have an existing management group connection before creating a new one. But that's up to you.\n\n### Rally Your Agents (and Management Servers)\n\nSince we cannot manage manually installed agents--that would be AD-integrated or installed locally using Configuration Manager or maybe the wizard--through powershell we don't even want to try. So we'll exclude them.\n\nWe also need all the available management servers. <del>This will not handle Gateway servers as they have their own cmdlet, _Get-SCOMGatewayManagementServer_, in Operations Manager 2012.</del> Strike that! There is a specific cmdlet for Gateway Servers in OpsMgr 2012, but the regular _Get-SCOMManagementServer_ actually don't care whether it's a normal Management Server or a Gateway Server. The _Get-SCOMGatewayManagementServer_, however, only return real Gateway Servers. That means that this script will not care if it is a Management Server or a Gateway Server, so be sure to add some kind of filtering before running it in a Management Group containing management servers.\n\n[powershell]\n\n# Select matching remotely manageable agents\n$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}\n# Get all management servers\n$scomManagementServers = Get-SCOMManagementServer\n\n[/powershell]\n\nThe reason I like to store all matching agents in a variable is that we will save ourselves a lot of trips to the Data Access Service later on, and we also get a nice collection to run our foreach-loop on. This method is much faster than running _Get-SCOMAgent_ inline as we did in \"The Basics\".\n> Note: It would probably be a good idea to check that _$scomAgents_ actually contains anything; checking for _$null_ with a simple _if() _would be enough.\n\n### Do Stuff\n\nWe have our connection to the management group, we have collected our agents, and we have our management servers. It's time to loop through the agents and set their Primary and Fail-over management servers.\n\n[powershell]\n\nforeach ($scomAgent in $scomAgents) {\n # Get the primary management server for the agent\n $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n # Remove the primary MS from \"all MS\" array to use it for FailOver servers\n $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}\n # Set Primary Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS\n # Set Fail-over Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS\n}\n\n[/powershell]\n\nThe nice thing about loading the agents and the management servers into variables is that all the information you need for this script is pre-cached in memory. You don't have to connect to the management group to find out which management server happens is the primary for each agent. And you don't have to run _Get-SCOMManagementServer_ for each agent to select which ones that will be fail-over management servers. All that information is in memory, and memory is fast.\n\n### The Copy/Paste Part\n\nAs usual, here's the entire script for you to copy. Read it, try it, adapt it...\n\n[powershell]\n\n# Input SCOM Management Server to connect to in this session\n[string]$inputScomMS = \"scomms02.domain.local\"\n# Input an existing agent you want to modify\n[string]$inputTargetAgent = \"*.domain.local\"\n\n### Connect to SCOM 2012 Management Group ###\n# Check if OperationsManager module is loaded\nIf (Get-Module -Name \"OperationsManager\") {\n try {\n # Try to load the module\n Import-Module -Name \"OperationsManager\"\n } catch {\n # Did not work, exit the script\n echo \"Could not load Operations Manager module\"\n exit\n }\n}\n# Module is loaded, connect to Management Group/Server\nNew-SCOMManagementGroupConnection -ComputerName $inputScomMS\n### END ###\n\n# Select matching remotely manageable agents\n$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}\n# Get all management servers\n$scomManagementServers = Get-SCOMManagementServer\nforeach ($scomAgent in $scomAgents) {\n # Get the primary management server for the agent\n $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n # Remove the primary MS from \"all MS\" array to use it for FailOver servers\n $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}\n # Set Primary Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS\n # Set Fail-over Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS\n}\n\n### Done!\n\n[/powershell]\n\nGLHF!","source":"_posts/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell.md","raw":"---\ntitle: >-\n  OpsMgr 2012 Agent Failover - Simple Script with Wildcards [#opsmgr,\n  #powershell]\ntags:\n  - Fail-over\n  - OpsMgr\n  - PoSH\nid: 685\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2012-06-21 10:58:13\n---\n\nIn the last post, [OpsMgr 2012 Agent & Gateway Failover – The Basics](http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-gateway-failover-the-basics/ \"OpsMgr 2012 Agent & Gateway Failover – The Basics [#opsmgr, #powershell]\"), we looked at the basics of the Agent and Gateway fail-over configuration cmdlets and how to use them in a direct and interactive setting. This is absolutely useful when you got this specific agent that you need to configure with a specific fail-over management server.\n\nTo spice it up a little, we are going to add a little intelligence to it and enable wild-card selections while at it. The scenario we are building this script for is that now and then you want to make sure that certain agents have fail-over management servers configured. You also want to make sure that all management servers that are not the primary management server of any selected agent will be in that list of fail-over servers. This would include any new management servers as well as exclude any removed ones. In short, make sure your agent fail-over settings are up-to-date with the current environment.\n\n<!--more-->\n\n### Inputs\n\nTo use this script you need to know which management server you should connect your powershell session to and which agent, or agents, you want to check and configure.\n\n[powershell]\n\n# Input SCOM Management Server to connect to in this session\n[string]$inputScomMS = \"scomms01.domain.local\"\n# Input an existing agent you want to modify\n[string]$inputTargetAgent = \"*.domain.local\"\n\n[/powershell]\n> Note: If you are using load-balanced SDK-services, or \"Data Access Services\", pointing _$inputScomMS_ to that virtual host-name will work perfectly fine.\nThis example uses a wild-card for the agent selection and I guess it's the most likely scenario for this script, but a single host-name obviously works fine as well. Supported wildcard selections are [documented at TechNet](http://technet.microsoft.com/en-us/library/ee692793.aspx). An array of computer-names or a comma-separated list, however, will not work. You could easily add that functionality but it's out of scope for this example.\n\n### Connect to Your Management Group\n\nTo run any script against an Operations Manager 2012 Management Group we need a connection to one. To connect to a management group we have to load the OperationsManager module. Lets check for a loaded module, load it if necessary and connect to the Management Server from the _$inputScomMS_ setting. If loading the module fails--maybe it is not installed--we will exit the script.\n\n[powershell]\n\n# Check if OperationsManager module is loaded\nIf (Get-Module -Name \"OperationsManager\") {\n try {\n # Try to load the module\n Import-Module -Name \"OperationsManager\"\n } catch {\n # Did not work, exit the script\n echo \"Could not load Operations Manager module\"\n exit\n }\n}\n# Module is loaded, connect to Management Group/Server\nNew-SCOMManagementGroupConnection -ComputerName $inputScomMS\n\n[/powershell]\n\nA good idea would, of course, be to first check if we already have an existing management group connection before creating a new one. But that's up to you.\n\n### Rally Your Agents (and Management Servers)\n\nSince we cannot manage manually installed agents--that would be AD-integrated or installed locally using Configuration Manager or maybe the wizard--through powershell we don't even want to try. So we'll exclude them.\n\nWe also need all the available management servers. <del>This will not handle Gateway servers as they have their own cmdlet, _Get-SCOMGatewayManagementServer_, in Operations Manager 2012.</del> Strike that! There is a specific cmdlet for Gateway Servers in OpsMgr 2012, but the regular _Get-SCOMManagementServer_ actually don't care whether it's a normal Management Server or a Gateway Server. The _Get-SCOMGatewayManagementServer_, however, only return real Gateway Servers. That means that this script will not care if it is a Management Server or a Gateway Server, so be sure to add some kind of filtering before running it in a Management Group containing management servers.\n\n[powershell]\n\n# Select matching remotely manageable agents\n$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}\n# Get all management servers\n$scomManagementServers = Get-SCOMManagementServer\n\n[/powershell]\n\nThe reason I like to store all matching agents in a variable is that we will save ourselves a lot of trips to the Data Access Service later on, and we also get a nice collection to run our foreach-loop on. This method is much faster than running _Get-SCOMAgent_ inline as we did in \"The Basics\".\n> Note: It would probably be a good idea to check that _$scomAgents_ actually contains anything; checking for _$null_ with a simple _if() _would be enough.\n\n### Do Stuff\n\nWe have our connection to the management group, we have collected our agents, and we have our management servers. It's time to loop through the agents and set their Primary and Fail-over management servers.\n\n[powershell]\n\nforeach ($scomAgent in $scomAgents) {\n # Get the primary management server for the agent\n $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n # Remove the primary MS from \"all MS\" array to use it for FailOver servers\n $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}\n # Set Primary Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS\n # Set Fail-over Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS\n}\n\n[/powershell]\n\nThe nice thing about loading the agents and the management servers into variables is that all the information you need for this script is pre-cached in memory. You don't have to connect to the management group to find out which management server happens is the primary for each agent. And you don't have to run _Get-SCOMManagementServer_ for each agent to select which ones that will be fail-over management servers. All that information is in memory, and memory is fast.\n\n### The Copy/Paste Part\n\nAs usual, here's the entire script for you to copy. Read it, try it, adapt it...\n\n[powershell]\n\n# Input SCOM Management Server to connect to in this session\n[string]$inputScomMS = \"scomms02.domain.local\"\n# Input an existing agent you want to modify\n[string]$inputTargetAgent = \"*.domain.local\"\n\n### Connect to SCOM 2012 Management Group ###\n# Check if OperationsManager module is loaded\nIf (Get-Module -Name \"OperationsManager\") {\n try {\n # Try to load the module\n Import-Module -Name \"OperationsManager\"\n } catch {\n # Did not work, exit the script\n echo \"Could not load Operations Manager module\"\n exit\n }\n}\n# Module is loaded, connect to Management Group/Server\nNew-SCOMManagementGroupConnection -ComputerName $inputScomMS\n### END ###\n\n# Select matching remotely manageable agents\n$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}\n# Get all management servers\n$scomManagementServers = Get-SCOMManagementServer\nforeach ($scomAgent in $scomAgents) {\n # Get the primary management server for the agent\n $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}\n # Remove the primary MS from \"all MS\" array to use it for FailOver servers\n $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}\n # Set Primary Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS\n # Set Fail-over Management Server\n Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS\n}\n\n### Done!\n\n[/powershell]\n\nGLHF!","slug":"opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell","published":1,"updated":"2016-05-24T21:30:13.989Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7j7002eq4o2237ghxqh","content":"<p>In the last post, <a href=\"http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-gateway-failover-the-basics/\" title=\"OpsMgr 2012 Agent &amp; Gateway Failover – The Basics [#opsmgr, #powershell]\">OpsMgr 2012 Agent &amp; Gateway Failover – The Basics</a>, we looked at the basics of the Agent and Gateway fail-over configuration cmdlets and how to use them in a direct and interactive setting. This is absolutely useful when you got this specific agent that you need to configure with a specific fail-over management server.</p>\n<p>To spice it up a little, we are going to add a little intelligence to it and enable wild-card selections while at it. The scenario we are building this script for is that now and then you want to make sure that certain agents have fail-over management servers configured. You also want to make sure that all management servers that are not the primary management server of any selected agent will be in that list of fail-over servers. This would include any new management servers as well as exclude any removed ones. In short, make sure your agent fail-over settings are up-to-date with the current environment.</p>\n<a id=\"more\"></a>\n<h3 id=\"Inputs\"><a href=\"#Inputs\" class=\"headerlink\" title=\"Inputs\"></a>Inputs</h3><p>To use this script you need to know which management server you should connect your powershell session to and which agent, or agents, you want to check and configure.</p>\n<p>[powershell]</p>\n<h1 id=\"Input-SCOM-Management-Server-to-connect-to-in-this-session\"><a href=\"#Input-SCOM-Management-Server-to-connect-to-in-this-session\" class=\"headerlink\" title=\"Input SCOM Management Server to connect to in this session\"></a>Input SCOM Management Server to connect to in this session</h1><p>[string]$inputScomMS = “scomms01.domain.local”</p>\n<h1 id=\"Input-an-existing-agent-you-want-to-modify\"><a href=\"#Input-an-existing-agent-you-want-to-modify\" class=\"headerlink\" title=\"Input an existing agent you want to modify\"></a>Input an existing agent you want to modify</h1><p>[string]$inputTargetAgent = “*.domain.local”</p>\n<p>[/powershell]</p>\n<blockquote>\n<p>Note: If you are using load-balanced SDK-services, or “Data Access Services”, pointing <em>$inputScomMS</em> to that virtual host-name will work perfectly fine.<br>This example uses a wild-card for the agent selection and I guess it’s the most likely scenario for this script, but a single host-name obviously works fine as well. Supported wildcard selections are <a href=\"http://technet.microsoft.com/en-us/library/ee692793.aspx\" target=\"_blank\" rel=\"external\">documented at TechNet</a>. An array of computer-names or a comma-separated list, however, will not work. You could easily add that functionality but it’s out of scope for this example.</p>\n</blockquote>\n<h3 id=\"Connect-to-Your-Management-Group\"><a href=\"#Connect-to-Your-Management-Group\" class=\"headerlink\" title=\"Connect to Your Management Group\"></a>Connect to Your Management Group</h3><p>To run any script against an Operations Manager 2012 Management Group we need a connection to one. To connect to a management group we have to load the OperationsManager module. Lets check for a loaded module, load it if necessary and connect to the Management Server from the <em>$inputScomMS</em> setting. If loading the module fails–maybe it is not installed–we will exit the script.</p>\n<p>[powershell]</p>\n<h1 id=\"Check-if-OperationsManager-module-is-loaded\"><a href=\"#Check-if-OperationsManager-module-is-loaded\" class=\"headerlink\" title=\"Check if OperationsManager module is loaded\"></a>Check if OperationsManager module is loaded</h1><p>If (Get-Module -Name “OperationsManager”) {<br> try {</p>\n<h1 id=\"Try-to-load-the-module\"><a href=\"#Try-to-load-the-module\" class=\"headerlink\" title=\"Try to load the module\"></a>Try to load the module</h1><p> Import-Module -Name “OperationsManager”<br> } catch {</p>\n<h1 id=\"Did-not-work-exit-the-script\"><a href=\"#Did-not-work-exit-the-script\" class=\"headerlink\" title=\"Did not work, exit the script\"></a>Did not work, exit the script</h1><p> echo “Could not load Operations Manager module”<br> exit<br> }<br>}</p>\n<h1 id=\"Module-is-loaded-connect-to-Management-Group-Server\"><a href=\"#Module-is-loaded-connect-to-Management-Group-Server\" class=\"headerlink\" title=\"Module is loaded, connect to Management Group/Server\"></a>Module is loaded, connect to Management Group/Server</h1><p>New-SCOMManagementGroupConnection -ComputerName $inputScomMS</p>\n<p>[/powershell]</p>\n<p>A good idea would, of course, be to first check if we already have an existing management group connection before creating a new one. But that’s up to you.</p>\n<h3 id=\"Rally-Your-Agents-and-Management-Servers\"><a href=\"#Rally-Your-Agents-and-Management-Servers\" class=\"headerlink\" title=\"Rally Your Agents (and Management Servers)\"></a>Rally Your Agents (and Management Servers)</h3><p>Since we cannot manage manually installed agents–that would be AD-integrated or installed locally using Configuration Manager or maybe the wizard–through powershell we don’t even want to try. So we’ll exclude them.</p>\n<p>We also need all the available management servers. <del>This will not handle Gateway servers as they have their own cmdlet, <em>Get-SCOMGatewayManagementServer</em>, in Operations Manager 2012.</del> Strike that! There is a specific cmdlet for Gateway Servers in OpsMgr 2012, but the regular <em>Get-SCOMManagementServer</em> actually don’t care whether it’s a normal Management Server or a Gateway Server. The <em>Get-SCOMGatewayManagementServer</em>, however, only return real Gateway Servers. That means that this script will not care if it is a Management Server or a Gateway Server, so be sure to add some kind of filtering before running it in a Management Group containing management servers.</p>\n<p>[powershell]</p>\n<h1 id=\"Select-matching-remotely-manageable-agents\"><a href=\"#Select-matching-remotely-manageable-agents\" class=\"headerlink\" title=\"Select matching remotely manageable agents\"></a>Select matching remotely manageable agents</h1><p>$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}</p>\n<h1 id=\"Get-all-management-servers\"><a href=\"#Get-all-management-servers\" class=\"headerlink\" title=\"Get all management servers\"></a>Get all management servers</h1><p>$scomManagementServers = Get-SCOMManagementServer</p>\n<p>[/powershell]</p>\n<p>The reason I like to store all matching agents in a variable is that we will save ourselves a lot of trips to the Data Access Service later on, and we also get a nice collection to run our foreach-loop on. This method is much faster than running <em>Get-SCOMAgent</em> inline as we did in “The Basics”.</p>\n<blockquote>\n<p>Note: It would probably be a good idea to check that <em>$scomAgents</em> actually contains anything; checking for <em>$null</em> with a simple _if() _would be enough.</p>\n</blockquote>\n<h3 id=\"Do-Stuff\"><a href=\"#Do-Stuff\" class=\"headerlink\" title=\"Do Stuff\"></a>Do Stuff</h3><p>We have our connection to the management group, we have collected our agents, and we have our management servers. It’s time to loop through the agents and set their Primary and Fail-over management servers.</p>\n<p>[powershell]</p>\n<p>foreach ($scomAgent in $scomAgents) {</p>\n<h1 id=\"Get-the-primary-management-server-for-the-agent\"><a href=\"#Get-the-primary-management-server-for-the-agent\" class=\"headerlink\" title=\"Get the primary management server for the agent\"></a>Get the primary management server for the agent</h1><p> $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}</p>\n<h1 id=\"Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers\"><a href=\"#Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers\" class=\"headerlink\" title=\"Remove the primary MS from “all MS” array to use it for FailOver servers\"></a>Remove the primary MS from “all MS” array to use it for FailOver servers</h1><p> $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}</p>\n<h1 id=\"Set-Primary-Management-Server\"><a href=\"#Set-Primary-Management-Server\" class=\"headerlink\" title=\"Set Primary Management Server\"></a>Set Primary Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS</p>\n<h1 id=\"Set-Fail-over-Management-Server\"><a href=\"#Set-Fail-over-Management-Server\" class=\"headerlink\" title=\"Set Fail-over Management Server\"></a>Set Fail-over Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS<br>}</p>\n<p>[/powershell]</p>\n<p>The nice thing about loading the agents and the management servers into variables is that all the information you need for this script is pre-cached in memory. You don’t have to connect to the management group to find out which management server happens is the primary for each agent. And you don’t have to run <em>Get-SCOMManagementServer</em> for each agent to select which ones that will be fail-over management servers. All that information is in memory, and memory is fast.</p>\n<h3 id=\"The-Copy-Paste-Part\"><a href=\"#The-Copy-Paste-Part\" class=\"headerlink\" title=\"The Copy/Paste Part\"></a>The Copy/Paste Part</h3><p>As usual, here’s the entire script for you to copy. Read it, try it, adapt it…</p>\n<p>[powershell]</p>\n<h1 id=\"Input-SCOM-Management-Server-to-connect-to-in-this-session-1\"><a href=\"#Input-SCOM-Management-Server-to-connect-to-in-this-session-1\" class=\"headerlink\" title=\"Input SCOM Management Server to connect to in this session\"></a>Input SCOM Management Server to connect to in this session</h1><p>[string]$inputScomMS = “scomms02.domain.local”</p>\n<h1 id=\"Input-an-existing-agent-you-want-to-modify-1\"><a href=\"#Input-an-existing-agent-you-want-to-modify-1\" class=\"headerlink\" title=\"Input an existing agent you want to modify\"></a>Input an existing agent you want to modify</h1><p>[string]$inputTargetAgent = “*.domain.local”</p>\n<h3 id=\"Connect-to-SCOM-2012-Management-Group\"><a href=\"#Connect-to-SCOM-2012-Management-Group\" class=\"headerlink\" title=\"Connect to SCOM 2012 Management Group\"></a>Connect to SCOM 2012 Management Group</h3><h1 id=\"Check-if-OperationsManager-module-is-loaded-1\"><a href=\"#Check-if-OperationsManager-module-is-loaded-1\" class=\"headerlink\" title=\"Check if OperationsManager module is loaded\"></a>Check if OperationsManager module is loaded</h1><p>If (Get-Module -Name “OperationsManager”) {<br> try {</p>\n<h1 id=\"Try-to-load-the-module-1\"><a href=\"#Try-to-load-the-module-1\" class=\"headerlink\" title=\"Try to load the module\"></a>Try to load the module</h1><p> Import-Module -Name “OperationsManager”<br> } catch {</p>\n<h1 id=\"Did-not-work-exit-the-script-1\"><a href=\"#Did-not-work-exit-the-script-1\" class=\"headerlink\" title=\"Did not work, exit the script\"></a>Did not work, exit the script</h1><p> echo “Could not load Operations Manager module”<br> exit<br> }<br>}</p>\n<h1 id=\"Module-is-loaded-connect-to-Management-Group-Server-1\"><a href=\"#Module-is-loaded-connect-to-Management-Group-Server-1\" class=\"headerlink\" title=\"Module is loaded, connect to Management Group/Server\"></a>Module is loaded, connect to Management Group/Server</h1><p>New-SCOMManagementGroupConnection -ComputerName $inputScomMS</p>\n<h3 id=\"END\"><a href=\"#END\" class=\"headerlink\" title=\"END\"></a>END</h3><h1 id=\"Select-matching-remotely-manageable-agents-1\"><a href=\"#Select-matching-remotely-manageable-agents-1\" class=\"headerlink\" title=\"Select matching remotely manageable agents\"></a>Select matching remotely manageable agents</h1><p>$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}</p>\n<h1 id=\"Get-all-management-servers-1\"><a href=\"#Get-all-management-servers-1\" class=\"headerlink\" title=\"Get all management servers\"></a>Get all management servers</h1><p>$scomManagementServers = Get-SCOMManagementServer<br>foreach ($scomAgent in $scomAgents) {</p>\n<h1 id=\"Get-the-primary-management-server-for-the-agent-1\"><a href=\"#Get-the-primary-management-server-for-the-agent-1\" class=\"headerlink\" title=\"Get the primary management server for the agent\"></a>Get the primary management server for the agent</h1><p> $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}</p>\n<h1 id=\"Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers-1\"><a href=\"#Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers-1\" class=\"headerlink\" title=\"Remove the primary MS from “all MS” array to use it for FailOver servers\"></a>Remove the primary MS from “all MS” array to use it for FailOver servers</h1><p> $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}</p>\n<h1 id=\"Set-Primary-Management-Server-1\"><a href=\"#Set-Primary-Management-Server-1\" class=\"headerlink\" title=\"Set Primary Management Server\"></a>Set Primary Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS</p>\n<h1 id=\"Set-Fail-over-Management-Server-1\"><a href=\"#Set-Fail-over-Management-Server-1\" class=\"headerlink\" title=\"Set Fail-over Management Server\"></a>Set Fail-over Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS<br>}</p>\n<h3 id=\"Done\"><a href=\"#Done\" class=\"headerlink\" title=\"Done!\"></a>Done!</h3><p>[/powershell]</p>\n<p>GLHF!</p>\n","excerpt":"<p>In the last post, <a href=\"http://www.teknoglot.se/code/powershell/opsmgr-2012-agent-gateway-failover-the-basics/\" title=\"OpsMgr 2012 Agent &amp; Gateway Failover – The Basics [#opsmgr, #powershell]\">OpsMgr 2012 Agent &amp; Gateway Failover – The Basics</a>, we looked at the basics of the Agent and Gateway fail-over configuration cmdlets and how to use them in a direct and interactive setting. This is absolutely useful when you got this specific agent that you need to configure with a specific fail-over management server.</p>\n<p>To spice it up a little, we are going to add a little intelligence to it and enable wild-card selections while at it. The scenario we are building this script for is that now and then you want to make sure that certain agents have fail-over management servers configured. You also want to make sure that all management servers that are not the primary management server of any selected agent will be in that list of fail-over servers. This would include any new management servers as well as exclude any removed ones. In short, make sure your agent fail-over settings are up-to-date with the current environment.</p>","more":"<h3 id=\"Inputs\"><a href=\"#Inputs\" class=\"headerlink\" title=\"Inputs\"></a>Inputs</h3><p>To use this script you need to know which management server you should connect your powershell session to and which agent, or agents, you want to check and configure.</p>\n<p>[powershell]</p>\n<h1 id=\"Input-SCOM-Management-Server-to-connect-to-in-this-session\"><a href=\"#Input-SCOM-Management-Server-to-connect-to-in-this-session\" class=\"headerlink\" title=\"Input SCOM Management Server to connect to in this session\"></a>Input SCOM Management Server to connect to in this session</h1><p>[string]$inputScomMS = “scomms01.domain.local”</p>\n<h1 id=\"Input-an-existing-agent-you-want-to-modify\"><a href=\"#Input-an-existing-agent-you-want-to-modify\" class=\"headerlink\" title=\"Input an existing agent you want to modify\"></a>Input an existing agent you want to modify</h1><p>[string]$inputTargetAgent = “*.domain.local”</p>\n<p>[/powershell]</p>\n<blockquote>\n<p>Note: If you are using load-balanced SDK-services, or “Data Access Services”, pointing <em>$inputScomMS</em> to that virtual host-name will work perfectly fine.<br>This example uses a wild-card for the agent selection and I guess it’s the most likely scenario for this script, but a single host-name obviously works fine as well. Supported wildcard selections are <a href=\"http://technet.microsoft.com/en-us/library/ee692793.aspx\">documented at TechNet</a>. An array of computer-names or a comma-separated list, however, will not work. You could easily add that functionality but it’s out of scope for this example.</p>\n</blockquote>\n<h3 id=\"Connect-to-Your-Management-Group\"><a href=\"#Connect-to-Your-Management-Group\" class=\"headerlink\" title=\"Connect to Your Management Group\"></a>Connect to Your Management Group</h3><p>To run any script against an Operations Manager 2012 Management Group we need a connection to one. To connect to a management group we have to load the OperationsManager module. Lets check for a loaded module, load it if necessary and connect to the Management Server from the <em>$inputScomMS</em> setting. If loading the module fails–maybe it is not installed–we will exit the script.</p>\n<p>[powershell]</p>\n<h1 id=\"Check-if-OperationsManager-module-is-loaded\"><a href=\"#Check-if-OperationsManager-module-is-loaded\" class=\"headerlink\" title=\"Check if OperationsManager module is loaded\"></a>Check if OperationsManager module is loaded</h1><p>If (Get-Module -Name “OperationsManager”) {<br> try {</p>\n<h1 id=\"Try-to-load-the-module\"><a href=\"#Try-to-load-the-module\" class=\"headerlink\" title=\"Try to load the module\"></a>Try to load the module</h1><p> Import-Module -Name “OperationsManager”<br> } catch {</p>\n<h1 id=\"Did-not-work-exit-the-script\"><a href=\"#Did-not-work-exit-the-script\" class=\"headerlink\" title=\"Did not work, exit the script\"></a>Did not work, exit the script</h1><p> echo “Could not load Operations Manager module”<br> exit<br> }<br>}</p>\n<h1 id=\"Module-is-loaded-connect-to-Management-Group-Server\"><a href=\"#Module-is-loaded-connect-to-Management-Group-Server\" class=\"headerlink\" title=\"Module is loaded, connect to Management Group/Server\"></a>Module is loaded, connect to Management Group/Server</h1><p>New-SCOMManagementGroupConnection -ComputerName $inputScomMS</p>\n<p>[/powershell]</p>\n<p>A good idea would, of course, be to first check if we already have an existing management group connection before creating a new one. But that’s up to you.</p>\n<h3 id=\"Rally-Your-Agents-and-Management-Servers\"><a href=\"#Rally-Your-Agents-and-Management-Servers\" class=\"headerlink\" title=\"Rally Your Agents (and Management Servers)\"></a>Rally Your Agents (and Management Servers)</h3><p>Since we cannot manage manually installed agents–that would be AD-integrated or installed locally using Configuration Manager or maybe the wizard–through powershell we don’t even want to try. So we’ll exclude them.</p>\n<p>We also need all the available management servers. <del>This will not handle Gateway servers as they have their own cmdlet, <em>Get-SCOMGatewayManagementServer</em>, in Operations Manager 2012.</del> Strike that! There is a specific cmdlet for Gateway Servers in OpsMgr 2012, but the regular <em>Get-SCOMManagementServer</em> actually don’t care whether it’s a normal Management Server or a Gateway Server. The <em>Get-SCOMGatewayManagementServer</em>, however, only return real Gateway Servers. That means that this script will not care if it is a Management Server or a Gateway Server, so be sure to add some kind of filtering before running it in a Management Group containing management servers.</p>\n<p>[powershell]</p>\n<h1 id=\"Select-matching-remotely-manageable-agents\"><a href=\"#Select-matching-remotely-manageable-agents\" class=\"headerlink\" title=\"Select matching remotely manageable agents\"></a>Select matching remotely manageable agents</h1><p>$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}</p>\n<h1 id=\"Get-all-management-servers\"><a href=\"#Get-all-management-servers\" class=\"headerlink\" title=\"Get all management servers\"></a>Get all management servers</h1><p>$scomManagementServers = Get-SCOMManagementServer</p>\n<p>[/powershell]</p>\n<p>The reason I like to store all matching agents in a variable is that we will save ourselves a lot of trips to the Data Access Service later on, and we also get a nice collection to run our foreach-loop on. This method is much faster than running <em>Get-SCOMAgent</em> inline as we did in “The Basics”.</p>\n<blockquote>\n<p>Note: It would probably be a good idea to check that <em>$scomAgents</em> actually contains anything; checking for <em>$null</em> with a simple _if() _would be enough.</p>\n</blockquote>\n<h3 id=\"Do-Stuff\"><a href=\"#Do-Stuff\" class=\"headerlink\" title=\"Do Stuff\"></a>Do Stuff</h3><p>We have our connection to the management group, we have collected our agents, and we have our management servers. It’s time to loop through the agents and set their Primary and Fail-over management servers.</p>\n<p>[powershell]</p>\n<p>foreach ($scomAgent in $scomAgents) {</p>\n<h1 id=\"Get-the-primary-management-server-for-the-agent\"><a href=\"#Get-the-primary-management-server-for-the-agent\" class=\"headerlink\" title=\"Get the primary management server for the agent\"></a>Get the primary management server for the agent</h1><p> $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}</p>\n<h1 id=\"Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers\"><a href=\"#Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers\" class=\"headerlink\" title=\"Remove the primary MS from “all MS” array to use it for FailOver servers\"></a>Remove the primary MS from “all MS” array to use it for FailOver servers</h1><p> $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}</p>\n<h1 id=\"Set-Primary-Management-Server\"><a href=\"#Set-Primary-Management-Server\" class=\"headerlink\" title=\"Set Primary Management Server\"></a>Set Primary Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS</p>\n<h1 id=\"Set-Fail-over-Management-Server\"><a href=\"#Set-Fail-over-Management-Server\" class=\"headerlink\" title=\"Set Fail-over Management Server\"></a>Set Fail-over Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS<br>}</p>\n<p>[/powershell]</p>\n<p>The nice thing about loading the agents and the management servers into variables is that all the information you need for this script is pre-cached in memory. You don’t have to connect to the management group to find out which management server happens is the primary for each agent. And you don’t have to run <em>Get-SCOMManagementServer</em> for each agent to select which ones that will be fail-over management servers. All that information is in memory, and memory is fast.</p>\n<h3 id=\"The-Copy-Paste-Part\"><a href=\"#The-Copy-Paste-Part\" class=\"headerlink\" title=\"The Copy/Paste Part\"></a>The Copy/Paste Part</h3><p>As usual, here’s the entire script for you to copy. Read it, try it, adapt it…</p>\n<p>[powershell]</p>\n<h1 id=\"Input-SCOM-Management-Server-to-connect-to-in-this-session-1\"><a href=\"#Input-SCOM-Management-Server-to-connect-to-in-this-session-1\" class=\"headerlink\" title=\"Input SCOM Management Server to connect to in this session\"></a>Input SCOM Management Server to connect to in this session</h1><p>[string]$inputScomMS = “scomms02.domain.local”</p>\n<h1 id=\"Input-an-existing-agent-you-want-to-modify-1\"><a href=\"#Input-an-existing-agent-you-want-to-modify-1\" class=\"headerlink\" title=\"Input an existing agent you want to modify\"></a>Input an existing agent you want to modify</h1><p>[string]$inputTargetAgent = “*.domain.local”</p>\n<h3 id=\"Connect-to-SCOM-2012-Management-Group\"><a href=\"#Connect-to-SCOM-2012-Management-Group\" class=\"headerlink\" title=\"Connect to SCOM 2012 Management Group\"></a>Connect to SCOM 2012 Management Group</h3><h1 id=\"Check-if-OperationsManager-module-is-loaded-1\"><a href=\"#Check-if-OperationsManager-module-is-loaded-1\" class=\"headerlink\" title=\"Check if OperationsManager module is loaded\"></a>Check if OperationsManager module is loaded</h1><p>If (Get-Module -Name “OperationsManager”) {<br> try {</p>\n<h1 id=\"Try-to-load-the-module-1\"><a href=\"#Try-to-load-the-module-1\" class=\"headerlink\" title=\"Try to load the module\"></a>Try to load the module</h1><p> Import-Module -Name “OperationsManager”<br> } catch {</p>\n<h1 id=\"Did-not-work-exit-the-script-1\"><a href=\"#Did-not-work-exit-the-script-1\" class=\"headerlink\" title=\"Did not work, exit the script\"></a>Did not work, exit the script</h1><p> echo “Could not load Operations Manager module”<br> exit<br> }<br>}</p>\n<h1 id=\"Module-is-loaded-connect-to-Management-Group-Server-1\"><a href=\"#Module-is-loaded-connect-to-Management-Group-Server-1\" class=\"headerlink\" title=\"Module is loaded, connect to Management Group/Server\"></a>Module is loaded, connect to Management Group/Server</h1><p>New-SCOMManagementGroupConnection -ComputerName $inputScomMS</p>\n<h3 id=\"END\"><a href=\"#END\" class=\"headerlink\" title=\"END\"></a>END</h3><h1 id=\"Select-matching-remotely-manageable-agents-1\"><a href=\"#Select-matching-remotely-manageable-agents-1\" class=\"headerlink\" title=\"Select matching remotely manageable agents\"></a>Select matching remotely manageable agents</h1><p>$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where {$_.ManuallyInstalled -ne $true}</p>\n<h1 id=\"Get-all-management-servers-1\"><a href=\"#Get-all-management-servers-1\" class=\"headerlink\" title=\"Get all management servers\"></a>Get all management servers</h1><p>$scomManagementServers = Get-SCOMManagementServer<br>foreach ($scomAgent in $scomAgents) {</p>\n<h1 id=\"Get-the-primary-management-server-for-the-agent-1\"><a href=\"#Get-the-primary-management-server-for-the-agent-1\" class=\"headerlink\" title=\"Get the primary management server for the agent\"></a>Get the primary management server for the agent</h1><p> $scomPrimaryMS = $scomManagementServers | where {$_.Name -eq $scomAgent.PrimaryManagementServerName}</p>\n<h1 id=\"Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers-1\"><a href=\"#Remove-the-primary-MS-from-“all-MS”-array-to-use-it-for-FailOver-servers-1\" class=\"headerlink\" title=\"Remove the primary MS from “all MS” array to use it for FailOver servers\"></a>Remove the primary MS from “all MS” array to use it for FailOver servers</h1><p> $scomFailOverMS = $scomManagementServers | Where-Object {$_.Name -ne $scomPrimaryMS.Name}</p>\n<h1 id=\"Set-Primary-Management-Server-1\"><a href=\"#Set-Primary-Management-Server-1\" class=\"headerlink\" title=\"Set Primary Management Server\"></a>Set Primary Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS</p>\n<h1 id=\"Set-Fail-over-Management-Server-1\"><a href=\"#Set-Fail-over-Management-Server-1\" class=\"headerlink\" title=\"Set Fail-over Management Server\"></a>Set Fail-over Management Server</h1><p> Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS<br>}</p>\n<h3 id=\"Done\"><a href=\"#Done\" class=\"headerlink\" title=\"Done!\"></a>Done!</h3><p>[/powershell]</p>\n<p>GLHF!</p>"},{"title":"OpsMgr 2012 Agent & Gateway Failover - The Basics [#opsmgr, #powershell]","id":"659","date":"2012-05-30T12:12:37.000Z","_content":"\nI have [previously](http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/ \"Replace/Change a Gateway Server\") posted a few [scripts](http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/ \"Change Gateway Powershell Script\") on managing and [configuring fail-over](http://www.teknoglot.se/ms/opsmgr2007/loadbalancing-ps-script-opsmgr/ \"“Load Balancing” Powershell Script for Operations Manager\") management servers on gateways and agents in System Center Operations Manager 2007 R2.\n\nNow that System Center 2012 Operations Manager is RTM and users are starting to explore the differences between the versions I see more and more questions on how you do, in OpsMgr 2012, what you did in OpsMgr 2007\\. In a few posts henceforth I will go through Agent and Gateway server fail-over configuration and management. In this first post I'll look at the very basics of fail-over configuration, the cmdlets to use and some one-liners.\n\n<!--more-->\n\n### The cmdlet\n\nFirst of all, the cmdlets of OpsMgr powershell have all got new names looking like _Verb_-SCOM_noun_ and to list them all in the console you can execute the following command:\n\n[powershell]get-command *SCOM*[/powershell]\n\nThe cmdlet we are looking for to set and manage primary and fail-over management servers is\n\n[powershell]Get-SCOMParentManagementServer[/powershell]\n\nAs usual, you can pass the cmdlet as a parameter to get-help for information about its parameters and a few use-cases.\n> **SYNOPSIS**\n> \n> Changes the primary and failover management servers for an agent or gateway management server.\n> \n> \n> **SYNTAX**\n> \n> Set-SCOMParentManagementServer -Agent -PrimaryServer [-PassThru ] [-Confirm ] [-WhatIf ] []\n> \n> Set-SCOMParentManagementServer -Agent -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []\n> \n> Set-SCOMParentManagementServer -GatewayServer -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []\n> \n> Set-SCOMParentManagementServer -GatewayServer -PrimaryServer [-PassThru] [-Confirm] [-WhatIf] []\nBut that's so boring to read the manual is a bit sketchy on how it behaves and the limitations.\n\n#### The One-Liners!\n\nI have compiled a few examples for a few common tasks to better illustrate it's uses.\n\n##### Set Primary Management Server on Agent\n\n[powershell]\n\n#Set Primary Management Server on Agent\nSet-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName \"AGENT.domain.local\") -PrimaryServer (Get-SCOMManagementServer -Name \"SCOMMS01.domain.local\")\n\n[/powershell]\n\n##### Set Fail-over Management Server on Agent\n\n[powershell]\n\n#Set Fail-over Management Server on Agent\nSet-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName \"AGENT.domain.local\") -FailoverServer (Get-SCOMManagementServer -Name \"SCOMMS02.domain.local\")\n\n[/powershell]\n\n##### Set Primary Management Server on Gateway\n\n[powershell]\n\n#Set Primary Management Server on Gateway\nSet-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name \"SCOMGW01.domain.local\") -PrimaryServer (Get-SCOMManagementServer -Name \"SCOMMS01.domain.local\")\n\n[/powershell]\n\n##### Set Fail-over Management Server on Gateway\n\n[powershell]\n\n#Set Fail-over Management Server on Gateway\nSet-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name \"SCOMGW01.domain.local\") -FailoverServer (Get-SCOMManagementServer -Name \"SCOMMS02.domain.local\")\n\n[/powershell]\n\n#### A few reflections\n\nAs you may notice, if you have used the OpsMgr 2007 _Set-ManagementServer_ cmdlet you actually have to use separate parameters depending on whether you are configuring management servers on an agent or a gateway server. You probably also noticed that to get an object for a gateway server you also have to use _Get-SCOMGatewayManagementServer_ in OpsMgr 2012.\n\nFor some reason, there's different properties on agent objects compared to management and gateway servers. On an MS or GW, you use _-Name_ to select by name, while on an agent you have to use _-DNSHostName_. Both of these parameters take wild-cards making it possible to find all the agents named \"*.domain.local\".\n\nWhile _-PrimaryServer_ only takes a single object the _-Agent_, _-GatewayServer_ and _-FailoverServer_ can take an array or collection of objects.\n\nOne more \"gotcha\" I ran into is the fact that trying to set both_ -PrimaryServer_ and _-FailoverServer_ in the same command will fail with an \"AmbiguousParameterSet\" error. You have to run it once for the Primary Management Server and once for your Fail-over Management Servers.\n\n### Related Snippets\n\nApart from setting your management servers you might also want to read your agent's current configuration as well.\n\n##### Get current Primary Management Server on Agent\n\n[powershell]\n\n#Get current Primary MS on Agent\n$agent = Get-SCOMAgent -DNSHostName \"AGENT.domain.local\"\n$primaryMS = $agent.GetPrimaryManagementServer()\nwrite-host \"Current Primary ManagementServer: \"$primaryMS.Name\n\n[/powershell]\n\n##### Get current Failover Management Server on Agent\n\n[powershell]\n\n#Get current Failover MS on Agent\n$agent = Get-SCOMAgent -DNSHostName \"AGENT.domain.local\"\n$failoverMSs = $agent.GetFailoverManagementServers()\nwrite-host \"Got\"$failoverMSs.Count\"failover Management Servers\"\nforeach($failoverMS in $failoverMSs) {\n $failoverMS.Name\n}\n\n[/powershell]\n\nI think that would be all for this post. Next one will touch on a little more intelligence and a few ways to automatically select \"other\" management servers as fail-over management servers.\n\nEnjoy!","source":"_posts/opsmgr-2012-agent-gateway-failover-the-basics.md","raw":"---\ntitle: 'OpsMgr 2012 Agent & Gateway Failover - The Basics [#opsmgr, #powershell]'\ntags:\n  - Fail-over\n  - How-To\n  - OpsMgr\n  - PoSH\n  - Scripts\nid: 659\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2012-05-30 14:12:37\n---\n\nI have [previously](http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/ \"Replace/Change a Gateway Server\") posted a few [scripts](http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/ \"Change Gateway Powershell Script\") on managing and [configuring fail-over](http://www.teknoglot.se/ms/opsmgr2007/loadbalancing-ps-script-opsmgr/ \"“Load Balancing” Powershell Script for Operations Manager\") management servers on gateways and agents in System Center Operations Manager 2007 R2.\n\nNow that System Center 2012 Operations Manager is RTM and users are starting to explore the differences between the versions I see more and more questions on how you do, in OpsMgr 2012, what you did in OpsMgr 2007\\. In a few posts henceforth I will go through Agent and Gateway server fail-over configuration and management. In this first post I'll look at the very basics of fail-over configuration, the cmdlets to use and some one-liners.\n\n<!--more-->\n\n### The cmdlet\n\nFirst of all, the cmdlets of OpsMgr powershell have all got new names looking like _Verb_-SCOM_noun_ and to list them all in the console you can execute the following command:\n\n[powershell]get-command *SCOM*[/powershell]\n\nThe cmdlet we are looking for to set and manage primary and fail-over management servers is\n\n[powershell]Get-SCOMParentManagementServer[/powershell]\n\nAs usual, you can pass the cmdlet as a parameter to get-help for information about its parameters and a few use-cases.\n> **SYNOPSIS**\n> \n> Changes the primary and failover management servers for an agent or gateway management server.\n> \n> \n> **SYNTAX**\n> \n> Set-SCOMParentManagementServer -Agent -PrimaryServer [-PassThru ] [-Confirm ] [-WhatIf ] []\n> \n> Set-SCOMParentManagementServer -Agent -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []\n> \n> Set-SCOMParentManagementServer -GatewayServer -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []\n> \n> Set-SCOMParentManagementServer -GatewayServer -PrimaryServer [-PassThru] [-Confirm] [-WhatIf] []\nBut that's so boring to read the manual is a bit sketchy on how it behaves and the limitations.\n\n#### The One-Liners!\n\nI have compiled a few examples for a few common tasks to better illustrate it's uses.\n\n##### Set Primary Management Server on Agent\n\n[powershell]\n\n#Set Primary Management Server on Agent\nSet-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName \"AGENT.domain.local\") -PrimaryServer (Get-SCOMManagementServer -Name \"SCOMMS01.domain.local\")\n\n[/powershell]\n\n##### Set Fail-over Management Server on Agent\n\n[powershell]\n\n#Set Fail-over Management Server on Agent\nSet-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName \"AGENT.domain.local\") -FailoverServer (Get-SCOMManagementServer -Name \"SCOMMS02.domain.local\")\n\n[/powershell]\n\n##### Set Primary Management Server on Gateway\n\n[powershell]\n\n#Set Primary Management Server on Gateway\nSet-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name \"SCOMGW01.domain.local\") -PrimaryServer (Get-SCOMManagementServer -Name \"SCOMMS01.domain.local\")\n\n[/powershell]\n\n##### Set Fail-over Management Server on Gateway\n\n[powershell]\n\n#Set Fail-over Management Server on Gateway\nSet-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name \"SCOMGW01.domain.local\") -FailoverServer (Get-SCOMManagementServer -Name \"SCOMMS02.domain.local\")\n\n[/powershell]\n\n#### A few reflections\n\nAs you may notice, if you have used the OpsMgr 2007 _Set-ManagementServer_ cmdlet you actually have to use separate parameters depending on whether you are configuring management servers on an agent or a gateway server. You probably also noticed that to get an object for a gateway server you also have to use _Get-SCOMGatewayManagementServer_ in OpsMgr 2012.\n\nFor some reason, there's different properties on agent objects compared to management and gateway servers. On an MS or GW, you use _-Name_ to select by name, while on an agent you have to use _-DNSHostName_. Both of these parameters take wild-cards making it possible to find all the agents named \"*.domain.local\".\n\nWhile _-PrimaryServer_ only takes a single object the _-Agent_, _-GatewayServer_ and _-FailoverServer_ can take an array or collection of objects.\n\nOne more \"gotcha\" I ran into is the fact that trying to set both_ -PrimaryServer_ and _-FailoverServer_ in the same command will fail with an \"AmbiguousParameterSet\" error. You have to run it once for the Primary Management Server and once for your Fail-over Management Servers.\n\n### Related Snippets\n\nApart from setting your management servers you might also want to read your agent's current configuration as well.\n\n##### Get current Primary Management Server on Agent\n\n[powershell]\n\n#Get current Primary MS on Agent\n$agent = Get-SCOMAgent -DNSHostName \"AGENT.domain.local\"\n$primaryMS = $agent.GetPrimaryManagementServer()\nwrite-host \"Current Primary ManagementServer: \"$primaryMS.Name\n\n[/powershell]\n\n##### Get current Failover Management Server on Agent\n\n[powershell]\n\n#Get current Failover MS on Agent\n$agent = Get-SCOMAgent -DNSHostName \"AGENT.domain.local\"\n$failoverMSs = $agent.GetFailoverManagementServers()\nwrite-host \"Got\"$failoverMSs.Count\"failover Management Servers\"\nforeach($failoverMS in $failoverMSs) {\n $failoverMS.Name\n}\n\n[/powershell]\n\nI think that would be all for this post. Next one will touch on a little more intelligence and a few ways to automatically select \"other\" management servers as fail-over management servers.\n\nEnjoy!","slug":"opsmgr-2012-agent-gateway-failover-the-basics","published":1,"updated":"2016-05-24T21:30:05.315Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jb002hq4o2kji8hcst","content":"<p>I have <a href=\"http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/\" title=\"Replace/Change a Gateway Server\">previously</a> posted a few <a href=\"http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/\" title=\"Change Gateway Powershell Script\">scripts</a> on managing and <a href=\"http://www.teknoglot.se/ms/opsmgr2007/loadbalancing-ps-script-opsmgr/\" title=\"“Load Balancing” Powershell Script for Operations Manager\">configuring fail-over</a> management servers on gateways and agents in System Center Operations Manager 2007 R2.</p>\n<p>Now that System Center 2012 Operations Manager is RTM and users are starting to explore the differences between the versions I see more and more questions on how you do, in OpsMgr 2012, what you did in OpsMgr 2007. In a few posts henceforth I will go through Agent and Gateway server fail-over configuration and management. In this first post I’ll look at the very basics of fail-over configuration, the cmdlets to use and some one-liners.</p>\n<a id=\"more\"></a>\n<h3 id=\"The-cmdlet\"><a href=\"#The-cmdlet\" class=\"headerlink\" title=\"The cmdlet\"></a>The cmdlet</h3><p>First of all, the cmdlets of OpsMgr powershell have all got new names looking like <em>Verb</em>-SCOM<em>noun</em> and to list them all in the console you can execute the following command:</p>\n<p>[powershell]get-command <em>SCOM</em>[/powershell]</p>\n<p>The cmdlet we are looking for to set and manage primary and fail-over management servers is</p>\n<p>[powershell]Get-SCOMParentManagementServer[/powershell]</p>\n<p>As usual, you can pass the cmdlet as a parameter to get-help for information about its parameters and a few use-cases.</p>\n<blockquote>\n<p><strong>SYNOPSIS</strong></p>\n<p>Changes the primary and failover management servers for an agent or gateway management server.</p>\n<p><strong>SYNTAX</strong></p>\n<p>Set-SCOMParentManagementServer -Agent -PrimaryServer [-PassThru ] [-Confirm ] [-WhatIf ] []</p>\n<p>Set-SCOMParentManagementServer -Agent -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []</p>\n<p>Set-SCOMParentManagementServer -GatewayServer -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []</p>\n<p>Set-SCOMParentManagementServer -GatewayServer -PrimaryServer [-PassThru] [-Confirm] [-WhatIf] []<br>But that’s so boring to read the manual is a bit sketchy on how it behaves and the limitations.</p>\n</blockquote>\n<h4 id=\"The-One-Liners\"><a href=\"#The-One-Liners\" class=\"headerlink\" title=\"The One-Liners!\"></a>The One-Liners!</h4><p>I have compiled a few examples for a few common tasks to better illustrate it’s uses.</p>\n<h5 id=\"Set-Primary-Management-Server-on-Agent\"><a href=\"#Set-Primary-Management-Server-on-Agent\" class=\"headerlink\" title=\"Set Primary Management Server on Agent\"></a>Set Primary Management Server on Agent</h5><p>[powershell]</p>\n<p>#Set Primary Management Server on Agent<br>Set-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName “AGENT.domain.local”) -PrimaryServer (Get-SCOMManagementServer -Name “SCOMMS01.domain.local”)</p>\n<p>[/powershell]</p>\n<h5 id=\"Set-Fail-over-Management-Server-on-Agent\"><a href=\"#Set-Fail-over-Management-Server-on-Agent\" class=\"headerlink\" title=\"Set Fail-over Management Server on Agent\"></a>Set Fail-over Management Server on Agent</h5><p>[powershell]</p>\n<p>#Set Fail-over Management Server on Agent<br>Set-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName “AGENT.domain.local”) -FailoverServer (Get-SCOMManagementServer -Name “SCOMMS02.domain.local”)</p>\n<p>[/powershell]</p>\n<h5 id=\"Set-Primary-Management-Server-on-Gateway\"><a href=\"#Set-Primary-Management-Server-on-Gateway\" class=\"headerlink\" title=\"Set Primary Management Server on Gateway\"></a>Set Primary Management Server on Gateway</h5><p>[powershell]</p>\n<p>#Set Primary Management Server on Gateway<br>Set-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name “SCOMGW01.domain.local”) -PrimaryServer (Get-SCOMManagementServer -Name “SCOMMS01.domain.local”)</p>\n<p>[/powershell]</p>\n<h5 id=\"Set-Fail-over-Management-Server-on-Gateway\"><a href=\"#Set-Fail-over-Management-Server-on-Gateway\" class=\"headerlink\" title=\"Set Fail-over Management Server on Gateway\"></a>Set Fail-over Management Server on Gateway</h5><p>[powershell]</p>\n<p>#Set Fail-over Management Server on Gateway<br>Set-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name “SCOMGW01.domain.local”) -FailoverServer (Get-SCOMManagementServer -Name “SCOMMS02.domain.local”)</p>\n<p>[/powershell]</p>\n<h4 id=\"A-few-reflections\"><a href=\"#A-few-reflections\" class=\"headerlink\" title=\"A few reflections\"></a>A few reflections</h4><p>As you may notice, if you have used the OpsMgr 2007 <em>Set-ManagementServer</em> cmdlet you actually have to use separate parameters depending on whether you are configuring management servers on an agent or a gateway server. You probably also noticed that to get an object for a gateway server you also have to use <em>Get-SCOMGatewayManagementServer</em> in OpsMgr 2012.</p>\n<p>For some reason, there’s different properties on agent objects compared to management and gateway servers. On an MS or GW, you use <em>-Name</em> to select by name, while on an agent you have to use <em>-DNSHostName</em>. Both of these parameters take wild-cards making it possible to find all the agents named “*.domain.local”.</p>\n<p>While <em>-PrimaryServer</em> only takes a single object the <em>-Agent</em>, <em>-GatewayServer</em> and <em>-FailoverServer</em> can take an array or collection of objects.</p>\n<p>One more “gotcha” I ran into is the fact that trying to set both<em> -PrimaryServer</em> and <em>-FailoverServer</em> in the same command will fail with an “AmbiguousParameterSet” error. You have to run it once for the Primary Management Server and once for your Fail-over Management Servers.</p>\n<h3 id=\"Related-Snippets\"><a href=\"#Related-Snippets\" class=\"headerlink\" title=\"Related Snippets\"></a>Related Snippets</h3><p>Apart from setting your management servers you might also want to read your agent’s current configuration as well.</p>\n<h5 id=\"Get-current-Primary-Management-Server-on-Agent\"><a href=\"#Get-current-Primary-Management-Server-on-Agent\" class=\"headerlink\" title=\"Get current Primary Management Server on Agent\"></a>Get current Primary Management Server on Agent</h5><p>[powershell]</p>\n<p>#Get current Primary MS on Agent<br>$agent = Get-SCOMAgent -DNSHostName “AGENT.domain.local”<br>$primaryMS = $agent.GetPrimaryManagementServer()<br>write-host “Current Primary ManagementServer: “$primaryMS.Name</p>\n<p>[/powershell]</p>\n<h5 id=\"Get-current-Failover-Management-Server-on-Agent\"><a href=\"#Get-current-Failover-Management-Server-on-Agent\" class=\"headerlink\" title=\"Get current Failover Management Server on Agent\"></a>Get current Failover Management Server on Agent</h5><p>[powershell]</p>\n<p>#Get current Failover MS on Agent<br>$agent = Get-SCOMAgent -DNSHostName “AGENT.domain.local”<br>$failoverMSs = $agent.GetFailoverManagementServers()<br>write-host “Got”$failoverMSs.Count”failover Management Servers”<br>foreach($failoverMS in $failoverMSs) {<br> $failoverMS.Name<br>}</p>\n<p>[/powershell]</p>\n<p>I think that would be all for this post. Next one will touch on a little more intelligence and a few ways to automatically select “other” management servers as fail-over management servers.</p>\n<p>Enjoy!</p>\n","excerpt":"<p>I have <a href=\"http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/\" title=\"Replace/Change a Gateway Server\">previously</a> posted a few <a href=\"http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/\" title=\"Change Gateway Powershell Script\">scripts</a> on managing and <a href=\"http://www.teknoglot.se/ms/opsmgr2007/loadbalancing-ps-script-opsmgr/\" title=\"“Load Balancing” Powershell Script for Operations Manager\">configuring fail-over</a> management servers on gateways and agents in System Center Operations Manager 2007 R2.</p>\n<p>Now that System Center 2012 Operations Manager is RTM and users are starting to explore the differences between the versions I see more and more questions on how you do, in OpsMgr 2012, what you did in OpsMgr 2007. In a few posts henceforth I will go through Agent and Gateway server fail-over configuration and management. In this first post I’ll look at the very basics of fail-over configuration, the cmdlets to use and some one-liners.</p>","more":"<h3 id=\"The-cmdlet\"><a href=\"#The-cmdlet\" class=\"headerlink\" title=\"The cmdlet\"></a>The cmdlet</h3><p>First of all, the cmdlets of OpsMgr powershell have all got new names looking like <em>Verb</em>-SCOM<em>noun</em> and to list them all in the console you can execute the following command:</p>\n<p>[powershell]get-command <em>SCOM</em>[/powershell]</p>\n<p>The cmdlet we are looking for to set and manage primary and fail-over management servers is</p>\n<p>[powershell]Get-SCOMParentManagementServer[/powershell]</p>\n<p>As usual, you can pass the cmdlet as a parameter to get-help for information about its parameters and a few use-cases.</p>\n<blockquote>\n<p><strong>SYNOPSIS</strong></p>\n<p>Changes the primary and failover management servers for an agent or gateway management server.</p>\n<p><strong>SYNTAX</strong></p>\n<p>Set-SCOMParentManagementServer -Agent -PrimaryServer [-PassThru ] [-Confirm ] [-WhatIf ] []</p>\n<p>Set-SCOMParentManagementServer -Agent -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []</p>\n<p>Set-SCOMParentManagementServer -GatewayServer -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] []</p>\n<p>Set-SCOMParentManagementServer -GatewayServer -PrimaryServer [-PassThru] [-Confirm] [-WhatIf] []<br>But that’s so boring to read the manual is a bit sketchy on how it behaves and the limitations.</p>\n</blockquote>\n<h4 id=\"The-One-Liners\"><a href=\"#The-One-Liners\" class=\"headerlink\" title=\"The One-Liners!\"></a>The One-Liners!</h4><p>I have compiled a few examples for a few common tasks to better illustrate it’s uses.</p>\n<h5 id=\"Set-Primary-Management-Server-on-Agent\"><a href=\"#Set-Primary-Management-Server-on-Agent\" class=\"headerlink\" title=\"Set Primary Management Server on Agent\"></a>Set Primary Management Server on Agent</h5><p>[powershell]</p>\n<p>#Set Primary Management Server on Agent<br>Set-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName “AGENT.domain.local”) -PrimaryServer (Get-SCOMManagementServer -Name “SCOMMS01.domain.local”)</p>\n<p>[/powershell]</p>\n<h5 id=\"Set-Fail-over-Management-Server-on-Agent\"><a href=\"#Set-Fail-over-Management-Server-on-Agent\" class=\"headerlink\" title=\"Set Fail-over Management Server on Agent\"></a>Set Fail-over Management Server on Agent</h5><p>[powershell]</p>\n<p>#Set Fail-over Management Server on Agent<br>Set-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName “AGENT.domain.local”) -FailoverServer (Get-SCOMManagementServer -Name “SCOMMS02.domain.local”)</p>\n<p>[/powershell]</p>\n<h5 id=\"Set-Primary-Management-Server-on-Gateway\"><a href=\"#Set-Primary-Management-Server-on-Gateway\" class=\"headerlink\" title=\"Set Primary Management Server on Gateway\"></a>Set Primary Management Server on Gateway</h5><p>[powershell]</p>\n<p>#Set Primary Management Server on Gateway<br>Set-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name “SCOMGW01.domain.local”) -PrimaryServer (Get-SCOMManagementServer -Name “SCOMMS01.domain.local”)</p>\n<p>[/powershell]</p>\n<h5 id=\"Set-Fail-over-Management-Server-on-Gateway\"><a href=\"#Set-Fail-over-Management-Server-on-Gateway\" class=\"headerlink\" title=\"Set Fail-over Management Server on Gateway\"></a>Set Fail-over Management Server on Gateway</h5><p>[powershell]</p>\n<p>#Set Fail-over Management Server on Gateway<br>Set-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name “SCOMGW01.domain.local”) -FailoverServer (Get-SCOMManagementServer -Name “SCOMMS02.domain.local”)</p>\n<p>[/powershell]</p>\n<h4 id=\"A-few-reflections\"><a href=\"#A-few-reflections\" class=\"headerlink\" title=\"A few reflections\"></a>A few reflections</h4><p>As you may notice, if you have used the OpsMgr 2007 <em>Set-ManagementServer</em> cmdlet you actually have to use separate parameters depending on whether you are configuring management servers on an agent or a gateway server. You probably also noticed that to get an object for a gateway server you also have to use <em>Get-SCOMGatewayManagementServer</em> in OpsMgr 2012.</p>\n<p>For some reason, there’s different properties on agent objects compared to management and gateway servers. On an MS or GW, you use <em>-Name</em> to select by name, while on an agent you have to use <em>-DNSHostName</em>. Both of these parameters take wild-cards making it possible to find all the agents named “*.domain.local”.</p>\n<p>While <em>-PrimaryServer</em> only takes a single object the <em>-Agent</em>, <em>-GatewayServer</em> and <em>-FailoverServer</em> can take an array or collection of objects.</p>\n<p>One more “gotcha” I ran into is the fact that trying to set both<em> -PrimaryServer</em> and <em>-FailoverServer</em> in the same command will fail with an “AmbiguousParameterSet” error. You have to run it once for the Primary Management Server and once for your Fail-over Management Servers.</p>\n<h3 id=\"Related-Snippets\"><a href=\"#Related-Snippets\" class=\"headerlink\" title=\"Related Snippets\"></a>Related Snippets</h3><p>Apart from setting your management servers you might also want to read your agent’s current configuration as well.</p>\n<h5 id=\"Get-current-Primary-Management-Server-on-Agent\"><a href=\"#Get-current-Primary-Management-Server-on-Agent\" class=\"headerlink\" title=\"Get current Primary Management Server on Agent\"></a>Get current Primary Management Server on Agent</h5><p>[powershell]</p>\n<p>#Get current Primary MS on Agent<br>$agent = Get-SCOMAgent -DNSHostName “AGENT.domain.local”<br>$primaryMS = $agent.GetPrimaryManagementServer()<br>write-host “Current Primary ManagementServer: “$primaryMS.Name</p>\n<p>[/powershell]</p>\n<h5 id=\"Get-current-Failover-Management-Server-on-Agent\"><a href=\"#Get-current-Failover-Management-Server-on-Agent\" class=\"headerlink\" title=\"Get current Failover Management Server on Agent\"></a>Get current Failover Management Server on Agent</h5><p>[powershell]</p>\n<p>#Get current Failover MS on Agent<br>$agent = Get-SCOMAgent -DNSHostName “AGENT.domain.local”<br>$failoverMSs = $agent.GetFailoverManagementServers()<br>write-host “Got”$failoverMSs.Count”failover Management Servers”<br>foreach($failoverMS in $failoverMSs) {<br> $failoverMS.Name<br>}</p>\n<p>[/powershell]</p>\n<p>I think that would be all for this post. Next one will touch on a little more intelligence and a few ways to automatically select “other” management servers as fail-over management servers.</p>\n<p>Enjoy!</p>"},{"title":"OpsMgr 2012 R2 UR4 - Field Notes [#opsmgr]","id":"865","date":"2014-10-30T10:41:47.000Z","_content":"\n_Quick and unrefined notes on Update Roll-up 4 for System Center 2012 R2 -\nOperations Manager_\n\n## Preparation\n\nThe usual routine applies. Check the [KB](http://support.microsoft.com/kb/2992020) for instructions and take not of\nknown issues. Check if [Kevin Holman](http://blogs.technet.com/b/kevinholman/) has written something about it. As this\nis an update _roll up_, I pre-emptively expect that [gotchas in UR3](http://www.teknoglot.se/ms/opsmgr2012/opsmgr2012r2ur3-field-notes/) may\napply. Remember to open the update catalog in IE as the downloader is not\nworking in other browsers.\n\nDownload, unpack, toss what languages that does not apply to your organization.\n\nIt is advised to disable any mail-generating alert subscriptions during the\nupgrade process to avoid unnecessary spammage.\n\n## Issues - So Far\n\n[updated: 2014-11-03]\n\n*   Got a few problems with cross-platform monitoring templates not working after the update. This was due to [missing files](https://social.technet.microsoft.com/Forums/en-US/e2378c57-02fb-43ac-b263-f28f26e21161/2012-r2-ur4-missing-files) in the update package. Make sure you download the [updated version](http://www.microsoft.com/en-us/download/details.aspx?id=29696)!\n\nHave not updated a customer using gateways yet, so unless they\nhave fixed the issues in UR3, expect an update to this section soon.\n\n## Planning\n\nAs with all update roll-ups, you've got a number of MSP files to install on\nthe different server roles, some SQL-scripts for the OpsDB and OpsDW and a few\nupdated management packs. I've updated the components in the following order.\n\n*   Management Servers (and consoles installed on them)\n*   SQL-Scripts\n*   Management Packs (might need an updated console for this)\n*   Consoles\n*   Gateway Servers\n*   Web Console\n*   Agents\n\nAs usual, the first management server update takes the longest as that's\nwhen the process is updating the databases. You absolutely _must_ wait for it to\ncomplete before updating anything else. Feel free to prepare the other\nmanagement servers by copying installations files, logging in and starting up\nyour command prompts as admin. I never update more than one management server at\nthe time anyway. Less to worry about that way.\n\n## Installation\n\n### Management Servers\n\nOpen a command prompt (powershell will work just fine) as Administrator and\nexecute the MSP-file. First management server will take some time, so be\npatient. If a management server has multiple roles, you can update those while\nlogged in as well.\n\n### SQL-Scripts\n\nThe installation package will unpack these scripts under `%SystemDrive%\\Program\nFiles\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update\nRollups`. Run the `UR_Datawarehouse.sql` one on the OpsDW first, then the\n`Update_rollup_mom_db.sql` on OpsDB. If you're getting deadlocks, try again. If\nthat don't help, stop the management server services and try again. _Do not\ncontinue with the next script ​until you've succeeded with the first._\n\nIf you've installed UR3, the OpsDW-script is pretty quick (not sure if\nit's changed at all) and the OpsDB is a bit less prone to deadlocks.\n\n### Management Packs\n\nJust import the management packs from the %SystemDrive%\\Program Files\\System\nCenter 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups\nfolder. Might have to retry as the console can do a little poor job of\ncalculating the dependencies.\n\n### Console\n\nThe easiest one, just install the MSP-file.\n\n### Gateway\n\nInstallation is a breeze. Make sure to check `%SystemDrive%\\Program Files\\System\nCenter Operations Manager\\Gateway\\AgentManagement\\<architecture>` for updated\nagent files. If not, copy from same folder on any management server.\n\n### Web Console\n\nInstallation is very simple. Install the MSP from an administrative command\nprompt. If you're affected by [KB911722](http://support.microsoft.com/kb/911722) and need the web console fixes, you\nneed to edit `%windir%\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config`\nby adding the following line:\n\n`<machineKey validationKey=\"AutoGenerate,IsolateApps\"\ndecryptionKey=\"AutoGenerate,IsolateApps\" validation=\"3DES\" decryption=\"3DES\"/>`\n\n### Agents\n\nNormal update procedure applies. Use \"Pending Management\", SCCM, manual\ninstallations or whatever method you'd like.\n\n## Summary\n\nIf you already have UR3, this one is very quick. If you are updating a fresh\ninstallation, wait a day or your management group may end up uninitialized for\nreasons. Remember to enable your subscriptions when done.\n \n\nGLHF!","source":"_posts/opsmgr-2012-r2-ur4-field-notes.md","raw":"---\ntitle: 'OpsMgr 2012 R2 UR4 - Field Notes [#opsmgr]'\ntags:\n  - Field Notes\n  - OpsMgr\n  - Update Rollup\nid: 865\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2014-10-30 11:41:47\n---\n\n_Quick and unrefined notes on Update Roll-up 4 for System Center 2012 R2 -\nOperations Manager_\n\n## Preparation\n\nThe usual routine applies. Check the [KB](http://support.microsoft.com/kb/2992020) for instructions and take not of\nknown issues. Check if [Kevin Holman](http://blogs.technet.com/b/kevinholman/) has written something about it. As this\nis an update _roll up_, I pre-emptively expect that [gotchas in UR3](http://www.teknoglot.se/ms/opsmgr2012/opsmgr2012r2ur3-field-notes/) may\napply. Remember to open the update catalog in IE as the downloader is not\nworking in other browsers.\n\nDownload, unpack, toss what languages that does not apply to your organization.\n\nIt is advised to disable any mail-generating alert subscriptions during the\nupgrade process to avoid unnecessary spammage.\n\n## Issues - So Far\n\n[updated: 2014-11-03]\n\n*   Got a few problems with cross-platform monitoring templates not working after the update. This was due to [missing files](https://social.technet.microsoft.com/Forums/en-US/e2378c57-02fb-43ac-b263-f28f26e21161/2012-r2-ur4-missing-files) in the update package. Make sure you download the [updated version](http://www.microsoft.com/en-us/download/details.aspx?id=29696)!\n\nHave not updated a customer using gateways yet, so unless they\nhave fixed the issues in UR3, expect an update to this section soon.\n\n## Planning\n\nAs with all update roll-ups, you've got a number of MSP files to install on\nthe different server roles, some SQL-scripts for the OpsDB and OpsDW and a few\nupdated management packs. I've updated the components in the following order.\n\n*   Management Servers (and consoles installed on them)\n*   SQL-Scripts\n*   Management Packs (might need an updated console for this)\n*   Consoles\n*   Gateway Servers\n*   Web Console\n*   Agents\n\nAs usual, the first management server update takes the longest as that's\nwhen the process is updating the databases. You absolutely _must_ wait for it to\ncomplete before updating anything else. Feel free to prepare the other\nmanagement servers by copying installations files, logging in and starting up\nyour command prompts as admin. I never update more than one management server at\nthe time anyway. Less to worry about that way.\n\n## Installation\n\n### Management Servers\n\nOpen a command prompt (powershell will work just fine) as Administrator and\nexecute the MSP-file. First management server will take some time, so be\npatient. If a management server has multiple roles, you can update those while\nlogged in as well.\n\n### SQL-Scripts\n\nThe installation package will unpack these scripts under `%SystemDrive%\\Program\nFiles\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update\nRollups`. Run the `UR_Datawarehouse.sql` one on the OpsDW first, then the\n`Update_rollup_mom_db.sql` on OpsDB. If you're getting deadlocks, try again. If\nthat don't help, stop the management server services and try again. _Do not\ncontinue with the next script ​until you've succeeded with the first._\n\nIf you've installed UR3, the OpsDW-script is pretty quick (not sure if\nit's changed at all) and the OpsDB is a bit less prone to deadlocks.\n\n### Management Packs\n\nJust import the management packs from the %SystemDrive%\\Program Files\\System\nCenter 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups\nfolder. Might have to retry as the console can do a little poor job of\ncalculating the dependencies.\n\n### Console\n\nThe easiest one, just install the MSP-file.\n\n### Gateway\n\nInstallation is a breeze. Make sure to check `%SystemDrive%\\Program Files\\System\nCenter Operations Manager\\Gateway\\AgentManagement\\<architecture>` for updated\nagent files. If not, copy from same folder on any management server.\n\n### Web Console\n\nInstallation is very simple. Install the MSP from an administrative command\nprompt. If you're affected by [KB911722](http://support.microsoft.com/kb/911722) and need the web console fixes, you\nneed to edit `%windir%\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config`\nby adding the following line:\n\n`<machineKey validationKey=\"AutoGenerate,IsolateApps\"\ndecryptionKey=\"AutoGenerate,IsolateApps\" validation=\"3DES\" decryption=\"3DES\"/>`\n\n### Agents\n\nNormal update procedure applies. Use \"Pending Management\", SCCM, manual\ninstallations or whatever method you'd like.\n\n## Summary\n\nIf you already have UR3, this one is very quick. If you are updating a fresh\ninstallation, wait a day or your management group may end up uninitialized for\nreasons. Remember to enable your subscriptions when done.\n \n\nGLHF!","slug":"opsmgr-2012-r2-ur4-field-notes","published":1,"updated":"2016-05-24T21:29:50.237Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jd002jq4o220fzgifc","content":"<p><em>Quick and unrefined notes on Update Roll-up 4 for System Center 2012 R2 -<br>Operations Manager</em></p>\n<h2 id=\"Preparation\"><a href=\"#Preparation\" class=\"headerlink\" title=\"Preparation\"></a>Preparation</h2><p>The usual routine applies. Check the <a href=\"http://support.microsoft.com/kb/2992020\" target=\"_blank\" rel=\"external\">KB</a> for instructions and take not of<br>known issues. Check if <a href=\"http://blogs.technet.com/b/kevinholman/\" target=\"_blank\" rel=\"external\">Kevin Holman</a> has written something about it. As this<br>is an update <em>roll up</em>, I pre-emptively expect that <a href=\"http://www.teknoglot.se/ms/opsmgr2012/opsmgr2012r2ur3-field-notes/\">gotchas in UR3</a> may<br>apply. Remember to open the update catalog in IE as the downloader is not<br>working in other browsers.</p>\n<p>Download, unpack, toss what languages that does not apply to your organization.</p>\n<p>It is advised to disable any mail-generating alert subscriptions during the<br>upgrade process to avoid unnecessary spammage.</p>\n<h2 id=\"Issues-So-Far\"><a href=\"#Issues-So-Far\" class=\"headerlink\" title=\"Issues - So Far\"></a>Issues - So Far</h2><p>[updated: 2014-11-03]</p>\n<ul>\n<li>Got a few problems with cross-platform monitoring templates not working after the update. This was due to <a href=\"https://social.technet.microsoft.com/Forums/en-US/e2378c57-02fb-43ac-b263-f28f26e21161/2012-r2-ur4-missing-files\" target=\"_blank\" rel=\"external\">missing files</a> in the update package. Make sure you download the <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=29696\" target=\"_blank\" rel=\"external\">updated version</a>!</li>\n</ul>\n<p>Have not updated a customer using gateways yet, so unless they<br>have fixed the issues in UR3, expect an update to this section soon.</p>\n<h2 id=\"Planning\"><a href=\"#Planning\" class=\"headerlink\" title=\"Planning\"></a>Planning</h2><p>As with all update roll-ups, you’ve got a number of MSP files to install on<br>the different server roles, some SQL-scripts for the OpsDB and OpsDW and a few<br>updated management packs. I’ve updated the components in the following order.</p>\n<ul>\n<li>Management Servers (and consoles installed on them)</li>\n<li>SQL-Scripts</li>\n<li>Management Packs (might need an updated console for this)</li>\n<li>Consoles</li>\n<li>Gateway Servers</li>\n<li>Web Console</li>\n<li>Agents</li>\n</ul>\n<p>As usual, the first management server update takes the longest as that’s<br>when the process is updating the databases. You absolutely <em>must</em> wait for it to<br>complete before updating anything else. Feel free to prepare the other<br>management servers by copying installations files, logging in and starting up<br>your command prompts as admin. I never update more than one management server at<br>the time anyway. Less to worry about that way.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><h3 id=\"Management-Servers\"><a href=\"#Management-Servers\" class=\"headerlink\" title=\"Management Servers\"></a>Management Servers</h3><p>Open a command prompt (powershell will work just fine) as Administrator and<br>execute the MSP-file. First management server will take some time, so be<br>patient. If a management server has multiple roles, you can update those while<br>logged in as well.</p>\n<h3 id=\"SQL-Scripts\"><a href=\"#SQL-Scripts\" class=\"headerlink\" title=\"SQL-Scripts\"></a>SQL-Scripts</h3><p>The installation package will unpack these scripts under <code>%SystemDrive%\\Program\nFiles\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update\nRollups</code>. Run the <code>UR_Datawarehouse.sql</code> one on the OpsDW first, then the<br><code>Update_rollup_mom_db.sql</code> on OpsDB. If you’re getting deadlocks, try again. If<br>that don’t help, stop the management server services and try again. <em>Do not<br>continue with the next script ​until you’ve succeeded with the first.</em></p>\n<p>If you’ve installed UR3, the OpsDW-script is pretty quick (not sure if<br>it’s changed at all) and the OpsDB is a bit less prone to deadlocks.</p>\n<h3 id=\"Management-Packs\"><a href=\"#Management-Packs\" class=\"headerlink\" title=\"Management Packs\"></a>Management Packs</h3><p>Just import the management packs from the %SystemDrive%\\Program Files\\System<br>Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups<br>folder. Might have to retry as the console can do a little poor job of<br>calculating the dependencies.</p>\n<h3 id=\"Console\"><a href=\"#Console\" class=\"headerlink\" title=\"Console\"></a>Console</h3><p>The easiest one, just install the MSP-file.</p>\n<h3 id=\"Gateway\"><a href=\"#Gateway\" class=\"headerlink\" title=\"Gateway\"></a>Gateway</h3><p>Installation is a breeze. Make sure to check <code>%SystemDrive%\\Program Files\\System\nCenter Operations Manager\\Gateway\\AgentManagement\\&lt;architecture&gt;</code> for updated<br>agent files. If not, copy from same folder on any management server.</p>\n<h3 id=\"Web-Console\"><a href=\"#Web-Console\" class=\"headerlink\" title=\"Web Console\"></a>Web Console</h3><p>Installation is very simple. Install the MSP from an administrative command<br>prompt. If you’re affected by <a href=\"http://support.microsoft.com/kb/911722\" target=\"_blank\" rel=\"external\">KB911722</a> and need the web console fixes, you<br>need to edit <code>%windir%\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config</code><br>by adding the following line:</p>\n<p><code>&lt;machineKey validationKey=&quot;AutoGenerate,IsolateApps&quot;\ndecryptionKey=&quot;AutoGenerate,IsolateApps&quot; validation=&quot;3DES&quot; decryption=&quot;3DES&quot;/&gt;</code></p>\n<h3 id=\"Agents\"><a href=\"#Agents\" class=\"headerlink\" title=\"Agents\"></a>Agents</h3><p>Normal update procedure applies. Use “Pending Management”, SCCM, manual<br>installations or whatever method you’d like.</p>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>If you already have UR3, this one is very quick. If you are updating a fresh<br>installation, wait a day or your management group may end up uninitialized for<br>reasons. Remember to enable your subscriptions when done.</p>\n<p>GLHF!</p>\n","excerpt":"","more":"<p><em>Quick and unrefined notes on Update Roll-up 4 for System Center 2012 R2 -<br>Operations Manager</em></p>\n<h2 id=\"Preparation\"><a href=\"#Preparation\" class=\"headerlink\" title=\"Preparation\"></a>Preparation</h2><p>The usual routine applies. Check the <a href=\"http://support.microsoft.com/kb/2992020\">KB</a> for instructions and take not of<br>known issues. Check if <a href=\"http://blogs.technet.com/b/kevinholman/\">Kevin Holman</a> has written something about it. As this<br>is an update <em>roll up</em>, I pre-emptively expect that <a href=\"http://www.teknoglot.se/ms/opsmgr2012/opsmgr2012r2ur3-field-notes/\">gotchas in UR3</a> may<br>apply. Remember to open the update catalog in IE as the downloader is not<br>working in other browsers.</p>\n<p>Download, unpack, toss what languages that does not apply to your organization.</p>\n<p>It is advised to disable any mail-generating alert subscriptions during the<br>upgrade process to avoid unnecessary spammage.</p>\n<h2 id=\"Issues-So-Far\"><a href=\"#Issues-So-Far\" class=\"headerlink\" title=\"Issues - So Far\"></a>Issues - So Far</h2><p>[updated: 2014-11-03]</p>\n<ul>\n<li>Got a few problems with cross-platform monitoring templates not working after the update. This was due to <a href=\"https://social.technet.microsoft.com/Forums/en-US/e2378c57-02fb-43ac-b263-f28f26e21161/2012-r2-ur4-missing-files\">missing files</a> in the update package. Make sure you download the <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=29696\">updated version</a>!</li>\n</ul>\n<p>Have not updated a customer using gateways yet, so unless they<br>have fixed the issues in UR3, expect an update to this section soon.</p>\n<h2 id=\"Planning\"><a href=\"#Planning\" class=\"headerlink\" title=\"Planning\"></a>Planning</h2><p>As with all update roll-ups, you’ve got a number of MSP files to install on<br>the different server roles, some SQL-scripts for the OpsDB and OpsDW and a few<br>updated management packs. I’ve updated the components in the following order.</p>\n<ul>\n<li>Management Servers (and consoles installed on them)</li>\n<li>SQL-Scripts</li>\n<li>Management Packs (might need an updated console for this)</li>\n<li>Consoles</li>\n<li>Gateway Servers</li>\n<li>Web Console</li>\n<li>Agents</li>\n</ul>\n<p>As usual, the first management server update takes the longest as that’s<br>when the process is updating the databases. You absolutely <em>must</em> wait for it to<br>complete before updating anything else. Feel free to prepare the other<br>management servers by copying installations files, logging in and starting up<br>your command prompts as admin. I never update more than one management server at<br>the time anyway. Less to worry about that way.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><h3 id=\"Management-Servers\"><a href=\"#Management-Servers\" class=\"headerlink\" title=\"Management Servers\"></a>Management Servers</h3><p>Open a command prompt (powershell will work just fine) as Administrator and<br>execute the MSP-file. First management server will take some time, so be<br>patient. If a management server has multiple roles, you can update those while<br>logged in as well.</p>\n<h3 id=\"SQL-Scripts\"><a href=\"#SQL-Scripts\" class=\"headerlink\" title=\"SQL-Scripts\"></a>SQL-Scripts</h3><p>The installation package will unpack these scripts under <code>%SystemDrive%\\Program\nFiles\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update\nRollups</code>. Run the <code>UR_Datawarehouse.sql</code> one on the OpsDW first, then the<br><code>Update_rollup_mom_db.sql</code> on OpsDB. If you’re getting deadlocks, try again. If<br>that don’t help, stop the management server services and try again. <em>Do not<br>continue with the next script ​until you’ve succeeded with the first.</em></p>\n<p>If you’ve installed UR3, the OpsDW-script is pretty quick (not sure if<br>it’s changed at all) and the OpsDB is a bit less prone to deadlocks.</p>\n<h3 id=\"Management-Packs\"><a href=\"#Management-Packs\" class=\"headerlink\" title=\"Management Packs\"></a>Management Packs</h3><p>Just import the management packs from the %SystemDrive%\\Program Files\\System<br>Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups<br>folder. Might have to retry as the console can do a little poor job of<br>calculating the dependencies.</p>\n<h3 id=\"Console\"><a href=\"#Console\" class=\"headerlink\" title=\"Console\"></a>Console</h3><p>The easiest one, just install the MSP-file.</p>\n<h3 id=\"Gateway\"><a href=\"#Gateway\" class=\"headerlink\" title=\"Gateway\"></a>Gateway</h3><p>Installation is a breeze. Make sure to check <code>%SystemDrive%\\Program Files\\System\nCenter Operations Manager\\Gateway\\AgentManagement\\&lt;architecture&gt;</code> for updated<br>agent files. If not, copy from same folder on any management server.</p>\n<h3 id=\"Web-Console\"><a href=\"#Web-Console\" class=\"headerlink\" title=\"Web Console\"></a>Web Console</h3><p>Installation is very simple. Install the MSP from an administrative command<br>prompt. If you’re affected by <a href=\"http://support.microsoft.com/kb/911722\">KB911722</a> and need the web console fixes, you<br>need to edit <code>%windir%\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config</code><br>by adding the following line:</p>\n<p><code>&lt;machineKey validationKey=&quot;AutoGenerate,IsolateApps&quot;\ndecryptionKey=&quot;AutoGenerate,IsolateApps&quot; validation=&quot;3DES&quot; decryption=&quot;3DES&quot;/&gt;</code></p>\n<h3 id=\"Agents\"><a href=\"#Agents\" class=\"headerlink\" title=\"Agents\"></a>Agents</h3><p>Normal update procedure applies. Use “Pending Management”, SCCM, manual<br>installations or whatever method you’d like.</p>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>If you already have UR3, this one is very quick. If you are updating a fresh<br>installation, wait a day or your management group may end up uninitialized for<br>reasons. Remember to enable your subscriptions when done.</p>\n<p>GLHF!</p>\n"},{"title":"OpsMgr 2012 R2 UR3 - Field Notes [#opsmgr]","id":"818","date":"2014-09-02T09:30:18.000Z","_content":"\n_Quick and unrefined notes on Update Roll-up 3 for System Center 2012 R2 - Operations Manager._\n\n## Preparation\n\nUsual routine, check the [KB](http://support.microsoft.com/kb/2965445 \"Update Roll-up 3 for System Center 2012 R2 Operations Manager\") for instructions and known issues. Double-check with [Holman's](http://blogs.technet.com/b/kevinholman/archive/2014/08/07/ur3-for-scom-2012-r2-step-by-step.aspx \"UR3 for SCOM 2012 R2 – Step by Step\") blog and take note of any irregularities. \n[Download](http://catalog.update.microsoft.com/v7/site/Search.aspx?q=2965445 \"Hell-spawn\"), curse your favourite deity and re-try in IE. Unpack the CAB-files (why do you keep putting them in CAB-files?) and throw away all the unnecessary language-specific console patches.\n\nNotify affected parts of the organisation, I've had the benefit to work with good release managers at all clients so far, so no biggie. Then try to close as many consoles as possible to avoid any blocks in database.\n\nMake sure you have the credentials for the Data Access service account at hand.\n\n### Issues - So Far\n\n_(updated 2014-09-02)_\n\n*   The SQL Script for the OpsDW was deadlocked at all sites and customers without exception. It's easily fixed by stopping the management server services.</p>\n*   A few dashboards (the 2012 versions) went blank. Self-healed after some aggregation job over night. From what I've noticed, only the SLA Dashboards are affected but never all of them.\n\n*   Agents behind daisy-chained Gateways is not identified as in need of an update. \"Repairing\" them from the Console is one work-around that seems to work consistently.\n\n*   A few agents that was updated using Windows Update did not report as updated. Repair fixed that nuisance.\n\n*   Had to flush the cache on a few Gateways to avoid heartbeat failures from their agents. Only daisy-chained ones if I recall correctly.\n<!--more-->\n\n## Planning\n\n<p>UR3 is like most update roll-ups you've seen so far. There's a bunch of <abbr title=\"Microsoft Patch\">msp</abbr> files you install on the different server roles, a few SQL-scripts for the OpsDB and the OpsDW and some updated core management packs. I have used the following order and that has worked quite nicely.\n\n*   Management Servers (and locally installed consoles)\n*   SQL-Scripts\n*   Management Packs<sup id=\"fnref-818-2\">[1](#fn-818-2)</sup>\n*   Consoles<sup id=\"fnref-818-1\">[2](#fn-818-1)</sup>\n*   Gateway Servers<sup id=\"fnref2:818-1\">[2](#fn-818-1)</sup>\n*   Web Console<sup id=\"fnref3:818-1\">[2](#fn-818-1)</sup>\n*   Agents<sup id=\"fnref4:818-1\">[2](#fn-818-1)</sup>\n\nThe first management server takes the longest time as it will update the databases as well and you _must_ wait for it to complete before hitting any extra management servers. Otherwise the databases isn't marked as updated and multiple installations will try to update the same stuff at the same time, and that's generally bad. I'd recommend to never update more than one management server at the same time, although it is possible.\n\n## Installation\n\n### Management Servers\n\nFairly straight-forward. Run the <abbr title=\"Microsoft Patch\">msp</abbr>-file for the server update in an administrative command prompt and follow the wizard. First server takes a while (anything from 10-40 minutes depending on management group size and load in my experience). When that's done, move on to the next management server. If your management servers have multiple roles, like Console, Web Console or Reporting, go ahead and update those at once.\n\n### SQL-Scripts\n\nThe scripts are unpacked by the setup. You will find them under `%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update Rollups`. Do OpsDW first using the `UR_Datawarehouse.sql` script, then go for OpsDB using `Update_rollup_mom_db.sql`. I've gotten the deadlock error on all installations so far and the best way to avoid that is to stop the management server services for this part. It's _absolutely crucial_ to have the scripts run to successful completion before running the next or moving on to any other server roles.\n\n### Console\n\nNothing out of the ordinary here, make sure you run the Console <abbr title=\"Microsoft Patch\">msp</abbr> in an administrative command prompt.\n\n### Management Packs\n\nThe updated core management packs are unpacked into `%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups`. Import them using one of the updated consoles.\n\n### Gateway\n\nNext-next-next if running as administrator. Take effort to verify that the agent updates has been distributed into the `%SystemDrive%\\Program Files\\System Center Operations Manager\\Gateway\\AgentManagement\\<architecture>` folder. If not, copy them from the same folder from any of the management servers.\n\n### Web Console\n\nNo problems so far as long as you run the Web Console <abbr title=\"Microsoft Patch\">msp</abbr> as administrator.\n\n### Agents\n\nUpdate them as usual, using \"Pending Management\", windows update, manual installation, <abbr title=\"System Center Configurations Manager\">SCCM</abbr> or whatever method you usually employ. Agent version will not be updated in the Console, but it will be visible under `Monitoring/Operations Manager/Agent Management/Agents by Version`.\n\n## Summary\n\nFairly simple update, the SQL Scripts can catch your off-guard if you do not know about them. Had some issues with Gateways, but it's a pretty quick update in most environments. Have not experienced any reboots or service outages on updated systems.\n\nGLHF!\n\n<div class=\"footnotes\">\n\n* * *\n\n1.  You're going to need at least one updated console to import the MP-updates. [↩](#fnref-818-2)\n\n2.  These can all be executed in parallel, agents behind Gateways will obviously need to be updated _after_ the gateway. [↩](#fnref-818-1) [↩](#fnref2:818-1) [↩](#fnref3:818-1) [↩](#fnref4:818-1)\n</div>","source":"_posts/opsmgr2012r2ur3-field-notes.md","raw":"---\ntitle: 'OpsMgr 2012 R2 UR3 - Field Notes [#opsmgr]'\ntags:\n  - Field Notes\n  - OpsMgr\n  - Update Rollup\nid: 818\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2014-09-02 11:30:18\n---\n\n_Quick and unrefined notes on Update Roll-up 3 for System Center 2012 R2 - Operations Manager._\n\n## Preparation\n\nUsual routine, check the [KB](http://support.microsoft.com/kb/2965445 \"Update Roll-up 3 for System Center 2012 R2 Operations Manager\") for instructions and known issues. Double-check with [Holman's](http://blogs.technet.com/b/kevinholman/archive/2014/08/07/ur3-for-scom-2012-r2-step-by-step.aspx \"UR3 for SCOM 2012 R2 – Step by Step\") blog and take note of any irregularities. \n[Download](http://catalog.update.microsoft.com/v7/site/Search.aspx?q=2965445 \"Hell-spawn\"), curse your favourite deity and re-try in IE. Unpack the CAB-files (why do you keep putting them in CAB-files?) and throw away all the unnecessary language-specific console patches.\n\nNotify affected parts of the organisation, I've had the benefit to work with good release managers at all clients so far, so no biggie. Then try to close as many consoles as possible to avoid any blocks in database.\n\nMake sure you have the credentials for the Data Access service account at hand.\n\n### Issues - So Far\n\n_(updated 2014-09-02)_\n\n*   The SQL Script for the OpsDW was deadlocked at all sites and customers without exception. It's easily fixed by stopping the management server services.</p>\n*   A few dashboards (the 2012 versions) went blank. Self-healed after some aggregation job over night. From what I've noticed, only the SLA Dashboards are affected but never all of them.\n\n*   Agents behind daisy-chained Gateways is not identified as in need of an update. \"Repairing\" them from the Console is one work-around that seems to work consistently.\n\n*   A few agents that was updated using Windows Update did not report as updated. Repair fixed that nuisance.\n\n*   Had to flush the cache on a few Gateways to avoid heartbeat failures from their agents. Only daisy-chained ones if I recall correctly.\n<!--more-->\n\n## Planning\n\n<p>UR3 is like most update roll-ups you've seen so far. There's a bunch of <abbr title=\"Microsoft Patch\">msp</abbr> files you install on the different server roles, a few SQL-scripts for the OpsDB and the OpsDW and some updated core management packs. I have used the following order and that has worked quite nicely.\n\n*   Management Servers (and locally installed consoles)\n*   SQL-Scripts\n*   Management Packs<sup id=\"fnref-818-2\">[1](#fn-818-2)</sup>\n*   Consoles<sup id=\"fnref-818-1\">[2](#fn-818-1)</sup>\n*   Gateway Servers<sup id=\"fnref2:818-1\">[2](#fn-818-1)</sup>\n*   Web Console<sup id=\"fnref3:818-1\">[2](#fn-818-1)</sup>\n*   Agents<sup id=\"fnref4:818-1\">[2](#fn-818-1)</sup>\n\nThe first management server takes the longest time as it will update the databases as well and you _must_ wait for it to complete before hitting any extra management servers. Otherwise the databases isn't marked as updated and multiple installations will try to update the same stuff at the same time, and that's generally bad. I'd recommend to never update more than one management server at the same time, although it is possible.\n\n## Installation\n\n### Management Servers\n\nFairly straight-forward. Run the <abbr title=\"Microsoft Patch\">msp</abbr>-file for the server update in an administrative command prompt and follow the wizard. First server takes a while (anything from 10-40 minutes depending on management group size and load in my experience). When that's done, move on to the next management server. If your management servers have multiple roles, like Console, Web Console or Reporting, go ahead and update those at once.\n\n### SQL-Scripts\n\nThe scripts are unpacked by the setup. You will find them under `%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update Rollups`. Do OpsDW first using the `UR_Datawarehouse.sql` script, then go for OpsDB using `Update_rollup_mom_db.sql`. I've gotten the deadlock error on all installations so far and the best way to avoid that is to stop the management server services for this part. It's _absolutely crucial_ to have the scripts run to successful completion before running the next or moving on to any other server roles.\n\n### Console\n\nNothing out of the ordinary here, make sure you run the Console <abbr title=\"Microsoft Patch\">msp</abbr> in an administrative command prompt.\n\n### Management Packs\n\nThe updated core management packs are unpacked into `%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups`. Import them using one of the updated consoles.\n\n### Gateway\n\nNext-next-next if running as administrator. Take effort to verify that the agent updates has been distributed into the `%SystemDrive%\\Program Files\\System Center Operations Manager\\Gateway\\AgentManagement\\<architecture>` folder. If not, copy them from the same folder from any of the management servers.\n\n### Web Console\n\nNo problems so far as long as you run the Web Console <abbr title=\"Microsoft Patch\">msp</abbr> as administrator.\n\n### Agents\n\nUpdate them as usual, using \"Pending Management\", windows update, manual installation, <abbr title=\"System Center Configurations Manager\">SCCM</abbr> or whatever method you usually employ. Agent version will not be updated in the Console, but it will be visible under `Monitoring/Operations Manager/Agent Management/Agents by Version`.\n\n## Summary\n\nFairly simple update, the SQL Scripts can catch your off-guard if you do not know about them. Had some issues with Gateways, but it's a pretty quick update in most environments. Have not experienced any reboots or service outages on updated systems.\n\nGLHF!\n\n<div class=\"footnotes\">\n\n* * *\n\n1.  You're going to need at least one updated console to import the MP-updates. [↩](#fnref-818-2)\n\n2.  These can all be executed in parallel, agents behind Gateways will obviously need to be updated _after_ the gateway. [↩](#fnref-818-1) [↩](#fnref2:818-1) [↩](#fnref3:818-1) [↩](#fnref4:818-1)\n</div>","slug":"opsmgr2012r2ur3-field-notes","published":1,"updated":"2016-05-24T21:29:36.201Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jg002nq4o288tp3r2v","content":"<p><em>Quick and unrefined notes on Update Roll-up 3 for System Center 2012 R2 - Operations Manager.</em></p>\n<h2 id=\"Preparation\"><a href=\"#Preparation\" class=\"headerlink\" title=\"Preparation\"></a>Preparation</h2><p>Usual routine, check the <a href=\"http://support.microsoft.com/kb/2965445\" title=\"Update Roll-up 3 for System Center 2012 R2 Operations Manager\" target=\"_blank\" rel=\"external\">KB</a> for instructions and known issues. Double-check with <a href=\"http://blogs.technet.com/b/kevinholman/archive/2014/08/07/ur3-for-scom-2012-r2-step-by-step.aspx\" title=\"UR3 for SCOM 2012 R2 – Step by Step\" target=\"_blank\" rel=\"external\">Holman’s</a> blog and take note of any irregularities.<br><a href=\"http://catalog.update.microsoft.com/v7/site/Search.aspx?q=2965445\" title=\"Hell-spawn\" target=\"_blank\" rel=\"external\">Download</a>, curse your favourite deity and re-try in IE. Unpack the CAB-files (why do you keep putting them in CAB-files?) and throw away all the unnecessary language-specific console patches.</p>\n<p>Notify affected parts of the organisation, I’ve had the benefit to work with good release managers at all clients so far, so no biggie. Then try to close as many consoles as possible to avoid any blocks in database.</p>\n<p>Make sure you have the credentials for the Data Access service account at hand.</p>\n<h3 id=\"Issues-So-Far\"><a href=\"#Issues-So-Far\" class=\"headerlink\" title=\"Issues - So Far\"></a>Issues - So Far</h3><p><em>(updated 2014-09-02)</em></p>\n<ul>\n<li>The SQL Script for the OpsDW was deadlocked at all sites and customers without exception. It’s easily fixed by stopping the management server services.<p></p></li>\n<li><p>A few dashboards (the 2012 versions) went blank. Self-healed after some aggregation job over night. From what I’ve noticed, only the SLA Dashboards are affected but never all of them.</p>\n</li>\n<li><p>Agents behind daisy-chained Gateways is not identified as in need of an update. “Repairing” them from the Console is one work-around that seems to work consistently.</p>\n</li>\n<li><p>A few agents that was updated using Windows Update did not report as updated. Repair fixed that nuisance.</p>\n</li>\n<li><p>Had to flush the cache on a few Gateways to avoid heartbeat failures from their agents. Only daisy-chained ones if I recall correctly.</p>\n<a id=\"more\"></a>\n</li>\n</ul>\n<h2 id=\"Planning\"><a href=\"#Planning\" class=\"headerlink\" title=\"Planning\"></a>Planning</h2><p></p><p>UR3 is like most update roll-ups you’ve seen so far. There’s a bunch of <abbr title=\"Microsoft Patch\">msp</abbr> files you install on the different server roles, a few SQL-scripts for the OpsDB and the OpsDW and some updated core management packs. I have used the following order and that has worked quite nicely.</p>\n<ul>\n<li>Management Servers (and locally installed consoles)</li>\n<li>SQL-Scripts</li>\n<li>Management Packs<sup id=\"fnref-818-2\"><a href=\"#fn-818-2\">1</a></sup></li>\n<li>Consoles<sup id=\"fnref-818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n<li>Gateway Servers<sup id=\"fnref2:818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n<li>Web Console<sup id=\"fnref3:818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n<li>Agents<sup id=\"fnref4:818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n</ul>\n<p>The first management server takes the longest time as it will update the databases as well and you <em>must</em> wait for it to complete before hitting any extra management servers. Otherwise the databases isn’t marked as updated and multiple installations will try to update the same stuff at the same time, and that’s generally bad. I’d recommend to never update more than one management server at the same time, although it is possible.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><h3 id=\"Management-Servers\"><a href=\"#Management-Servers\" class=\"headerlink\" title=\"Management Servers\"></a>Management Servers</h3><p>Fairly straight-forward. Run the <abbr title=\"Microsoft Patch\">msp</abbr>-file for the server update in an administrative command prompt and follow the wizard. First server takes a while (anything from 10-40 minutes depending on management group size and load in my experience). When that’s done, move on to the next management server. If your management servers have multiple roles, like Console, Web Console or Reporting, go ahead and update those at once.</p>\n<h3 id=\"SQL-Scripts\"><a href=\"#SQL-Scripts\" class=\"headerlink\" title=\"SQL-Scripts\"></a>SQL-Scripts</h3><p>The scripts are unpacked by the setup. You will find them under <code>%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update Rollups</code>. Do OpsDW first using the <code>UR_Datawarehouse.sql</code> script, then go for OpsDB using <code>Update_rollup_mom_db.sql</code>. I’ve gotten the deadlock error on all installations so far and the best way to avoid that is to stop the management server services for this part. It’s <em>absolutely crucial</em> to have the scripts run to successful completion before running the next or moving on to any other server roles.</p>\n<h3 id=\"Console\"><a href=\"#Console\" class=\"headerlink\" title=\"Console\"></a>Console</h3><p>Nothing out of the ordinary here, make sure you run the Console <abbr title=\"Microsoft Patch\">msp</abbr> in an administrative command prompt.</p>\n<h3 id=\"Management-Packs\"><a href=\"#Management-Packs\" class=\"headerlink\" title=\"Management Packs\"></a>Management Packs</h3><p>The updated core management packs are unpacked into <code>%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups</code>. Import them using one of the updated consoles.</p>\n<h3 id=\"Gateway\"><a href=\"#Gateway\" class=\"headerlink\" title=\"Gateway\"></a>Gateway</h3><p>Next-next-next if running as administrator. Take effort to verify that the agent updates has been distributed into the <code>%SystemDrive%\\Program Files\\System Center Operations Manager\\Gateway\\AgentManagement\\&lt;architecture&gt;</code> folder. If not, copy them from the same folder from any of the management servers.</p>\n<h3 id=\"Web-Console\"><a href=\"#Web-Console\" class=\"headerlink\" title=\"Web Console\"></a>Web Console</h3><p>No problems so far as long as you run the Web Console <abbr title=\"Microsoft Patch\">msp</abbr> as administrator.</p>\n<h3 id=\"Agents\"><a href=\"#Agents\" class=\"headerlink\" title=\"Agents\"></a>Agents</h3><p>Update them as usual, using “Pending Management”, windows update, manual installation, <abbr title=\"System Center Configurations Manager\">SCCM</abbr> or whatever method you usually employ. Agent version will not be updated in the Console, but it will be visible under <code>Monitoring/Operations Manager/Agent Management/Agents by Version</code>.</p>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>Fairly simple update, the SQL Scripts can catch your off-guard if you do not know about them. Had some issues with Gateways, but it’s a pretty quick update in most environments. Have not experienced any reboots or service outages on updated systems.</p>\n<p>GLHF!</p>\n<div class=\"footnotes\"><br><br><em> </em> *<br><br>1.  You’re going to need at least one updated console to import the MP-updates. <a href=\"#fnref-818-2\">↩</a><br><br>2.  These can all be executed in parallel, agents behind Gateways will obviously need to be updated <em>after</em> the gateway. <a href=\"#fnref-818-1\">↩</a> <a href=\"#fnref2:818-1\">↩</a> <a href=\"#fnref3:818-1\">↩</a> <a href=\"#fnref4:818-1\">↩</a><br></div>","excerpt":"<p><em>Quick and unrefined notes on Update Roll-up 3 for System Center 2012 R2 - Operations Manager.</em></p>\n<h2 id=\"Preparation\"><a href=\"#Preparation\" class=\"headerlink\" title=\"Preparation\"></a>Preparation</h2><p>Usual routine, check the <a href=\"http://support.microsoft.com/kb/2965445\" title=\"Update Roll-up 3 for System Center 2012 R2 Operations Manager\">KB</a> for instructions and known issues. Double-check with <a href=\"http://blogs.technet.com/b/kevinholman/archive/2014/08/07/ur3-for-scom-2012-r2-step-by-step.aspx\" title=\"UR3 for SCOM 2012 R2 – Step by Step\">Holman’s</a> blog and take note of any irregularities.<br><a href=\"http://catalog.update.microsoft.com/v7/site/Search.aspx?q=2965445\" title=\"Hell-spawn\">Download</a>, curse your favourite deity and re-try in IE. Unpack the CAB-files (why do you keep putting them in CAB-files?) and throw away all the unnecessary language-specific console patches.</p>\n<p>Notify affected parts of the organisation, I’ve had the benefit to work with good release managers at all clients so far, so no biggie. Then try to close as many consoles as possible to avoid any blocks in database.</p>\n<p>Make sure you have the credentials for the Data Access service account at hand.</p>\n<h3 id=\"Issues-So-Far\"><a href=\"#Issues-So-Far\" class=\"headerlink\" title=\"Issues - So Far\"></a>Issues - So Far</h3><p><em>(updated 2014-09-02)</em></p>\n<ul>\n<li>The SQL Script for the OpsDW was deadlocked at all sites and customers without exception. It’s easily fixed by stopping the management server services.</p></li>\n<li><p>A few dashboards (the 2012 versions) went blank. Self-healed after some aggregation job over night. From what I’ve noticed, only the SLA Dashboards are affected but never all of them.</p>\n</li>\n<li><p>Agents behind daisy-chained Gateways is not identified as in need of an update. “Repairing” them from the Console is one work-around that seems to work consistently.</p>\n</li>\n<li><p>A few agents that was updated using Windows Update did not report as updated. Repair fixed that nuisance.</p>\n</li>\n<li><p>Had to flush the cache on a few Gateways to avoid heartbeat failures from their agents. Only daisy-chained ones if I recall correctly.</p>","more":"</li>\n</ul>\n<h2 id=\"Planning\"><a href=\"#Planning\" class=\"headerlink\" title=\"Planning\"></a>Planning</h2><p><p>UR3 is like most update roll-ups you’ve seen so far. There’s a bunch of <abbr title=\"Microsoft Patch\">msp</abbr> files you install on the different server roles, a few SQL-scripts for the OpsDB and the OpsDW and some updated core management packs. I have used the following order and that has worked quite nicely.</p>\n<ul>\n<li>Management Servers (and locally installed consoles)</li>\n<li>SQL-Scripts</li>\n<li>Management Packs<sup id=\"fnref-818-2\"><a href=\"#fn-818-2\">1</a></sup></li>\n<li>Consoles<sup id=\"fnref-818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n<li>Gateway Servers<sup id=\"fnref2:818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n<li>Web Console<sup id=\"fnref3:818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n<li>Agents<sup id=\"fnref4:818-1\"><a href=\"#fn-818-1\">2</a></sup></li>\n</ul>\n<p>The first management server takes the longest time as it will update the databases as well and you <em>must</em> wait for it to complete before hitting any extra management servers. Otherwise the databases isn’t marked as updated and multiple installations will try to update the same stuff at the same time, and that’s generally bad. I’d recommend to never update more than one management server at the same time, although it is possible.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><h3 id=\"Management-Servers\"><a href=\"#Management-Servers\" class=\"headerlink\" title=\"Management Servers\"></a>Management Servers</h3><p>Fairly straight-forward. Run the <abbr title=\"Microsoft Patch\">msp</abbr>-file for the server update in an administrative command prompt and follow the wizard. First server takes a while (anything from 10-40 minutes depending on management group size and load in my experience). When that’s done, move on to the next management server. If your management servers have multiple roles, like Console, Web Console or Reporting, go ahead and update those at once.</p>\n<h3 id=\"SQL-Scripts\"><a href=\"#SQL-Scripts\" class=\"headerlink\" title=\"SQL-Scripts\"></a>SQL-Scripts</h3><p>The scripts are unpacked by the setup. You will find them under <code>%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update Rollups</code>. Do OpsDW first using the <code>UR_Datawarehouse.sql</code> script, then go for OpsDB using <code>Update_rollup_mom_db.sql</code>. I’ve gotten the deadlock error on all installations so far and the best way to avoid that is to stop the management server services for this part. It’s <em>absolutely crucial</em> to have the scripts run to successful completion before running the next or moving on to any other server roles.</p>\n<h3 id=\"Console\"><a href=\"#Console\" class=\"headerlink\" title=\"Console\"></a>Console</h3><p>Nothing out of the ordinary here, make sure you run the Console <abbr title=\"Microsoft Patch\">msp</abbr> in an administrative command prompt.</p>\n<h3 id=\"Management-Packs\"><a href=\"#Management-Packs\" class=\"headerlink\" title=\"Management Packs\"></a>Management Packs</h3><p>The updated core management packs are unpacked into <code>%SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups</code>. Import them using one of the updated consoles.</p>\n<h3 id=\"Gateway\"><a href=\"#Gateway\" class=\"headerlink\" title=\"Gateway\"></a>Gateway</h3><p>Next-next-next if running as administrator. Take effort to verify that the agent updates has been distributed into the <code>%SystemDrive%\\Program Files\\System Center Operations Manager\\Gateway\\AgentManagement\\&lt;architecture&gt;</code> folder. If not, copy them from the same folder from any of the management servers.</p>\n<h3 id=\"Web-Console\"><a href=\"#Web-Console\" class=\"headerlink\" title=\"Web Console\"></a>Web Console</h3><p>No problems so far as long as you run the Web Console <abbr title=\"Microsoft Patch\">msp</abbr> as administrator.</p>\n<h3 id=\"Agents\"><a href=\"#Agents\" class=\"headerlink\" title=\"Agents\"></a>Agents</h3><p>Update them as usual, using “Pending Management”, windows update, manual installation, <abbr title=\"System Center Configurations Manager\">SCCM</abbr> or whatever method you usually employ. Agent version will not be updated in the Console, but it will be visible under <code>Monitoring/Operations Manager/Agent Management/Agents by Version</code>.</p>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>Fairly simple update, the SQL Scripts can catch your off-guard if you do not know about them. Had some issues with Gateways, but it’s a pretty quick update in most environments. Have not experienced any reboots or service outages on updated systems.</p>\n<p>GLHF!</p>\n<div class=\"footnotes\"><br><br><em> </em> *<br><br>1.  You’re going to need at least one updated console to import the MP-updates. <a href=\"#fnref-818-2\">↩</a><br><br>2.  These can all be executed in parallel, agents behind Gateways will obviously need to be updated <em>after</em> the gateway. <a href=\"#fnref-818-1\">↩</a> <a href=\"#fnref2:818-1\">↩</a> <a href=\"#fnref3:818-1\">↩</a> <a href=\"#fnref4:818-1\">↩</a><br></div>"},{"title":"Parameter Replacement in AlertName","id":"586","date":"2012-04-09T20:04:48.000Z","_content":"\n# ...and why you should not use it\n\n## A Disclaimer\n\nI have had serious doubts about actually writing this article for almost a year now for reasons that I will explain further on. But as others have discovered this \"feature\" as well--maybe \"hack\" would be a better name for it--I feel the need to explain how it works and also why you should not use it. Knowledge is power, and even if I advice against using this technique it is also a good way to understand how SCOM uses display-strings in management packs.\n\n## The Good News\n\nYes, you can use parameter replacement in you AlertName.\n\nWith \"parameter replacement\" i mean using some kind of substitute text, or mnemonic if you like, that at run-time get translated into something useful. If you have written any kind of alert generating rules or monitors, you most like included something like _$Data/Context/Property[@Name='SomeDataFromAPropertyBag']$_ into your alert description.\n\nIn this dialog, you also have the possibility to set the Alert Name. And if you are lazy, like I am, you probably also noticed that it is impossible to insert any kind of dynamic data into that field as well. This is especially annoying when you are writing a management pack that needs to look different in the Alert Views in the console, and you want to monitor 50 different Events or Performance counters or Log entries that are pretty much the same apart from a Name or ID.\nOf course I could not refrain from copy-pasting a _$Data/Context...$_ into the alert name only to realize that it simply is not being parsed and translated into the value of the specified parameter. Over time I have settled for a stand-point that it's probably a performance issue and I have also used that as an argument for this apparent lack of simplicity that some of my customers have been questioning.\n\nTwo, maybe three, years later. Microsoft releases an update to the core agent monitoring packs. Much to my surprise, one performance monitor suddenly generated alerts with a dynamic performance value in the Alert Name. You know, that field that is not gettingt parsed I was mentioning in the earlier paragraph. It actually looked pretty bad and made it very much impossible to practice any kind of alert supression, but still. It actually had a parsed value in the Alert Name.\nAs the lack of this feature had me irked before, I exported the core MP and started reading through the XML to find out how they did it. To my surprise, it was actually pretty simple if you ditched the Authoring Console and used your trusty text-editor instead.\n\n## How To Do It\n\nIn simple terms, if you know your SCOM XML out-side-in, you add the parameters to your \"Alert\" and modify your DisplayString, the one under LanguagePacks, to call that parameter by it's relative ID.\n\nJust in case you happen to be a regular mortal, here's the step-by-step guide. ;)\n\nIn this example I have created a silly-simple Alert Generating EventLog rule in wich I have added some parameters to the description. It pretty much looks like this:\n\n![Alert Description Dialog](http://teknoglotse.nfshost.com/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png)\n\nSaving the MP at this point I will have a new WriteAlert action with a bunch of parameters and a displaystring with a unique ID.\nThe resulting XML-code for the WriteAlert action looks like this:\n\n```xml\n[xml highlight=\"7,8,9,10,11,12,13\"]\n<WriteAction ID=\"Alert\" TypeID=\"Health!System.Health.GenerateAlert\">\n  <Priority>1</Priority>\n  <Severity>2</Severity>\n  <AlertName />\n  <AlertDescription />\n  <AlertOwner />\n  <AlertMessageId>$MPElement[Name=\"TestMP.MyEventlogAlertRule.AlertMessage\"]$</AlertMessageId>\n  <AlertParameters>\n    <AlertParameter1>$Data/EventDescription$</AlertParameter1>\n    <AlertParameter2>$Data/LoggingComputer$</AlertParameter2>\n    <AlertParameter3>$Data/UserName$</AlertParameter3>\n    <AlertParameter4>$Data/EventNumber$</AlertParameter4>\n  </AlertParameters>\n  <Suppression />\n  <Custom1 />\n  <Custom2 />\n  <Custom3 />\n  <Custom4 />\n  <Custom5 />\n  <Custom6 />\n  <Custom7 />\n  <Custom8 />\n  <Custom9 />\n  <Custom10 />\n</WriteAction>\n```\n\nIn this slab of code, you've got the Parameters, their \"relative ID\" (the number in the Tag), and also the which is what you would need to search for among the displaystrings. Take note of the you want to use in your AlertName since you are going to need it later. A quick search for \"TestMP.MyEventlogAlertRule.AlertMessage\" will lead you to the actual message, which should looke similar to this:\n\n```xml\n<DisplayString ElementID=\"TestMP.MyEventlogAlertRule.AlertMessage\">\n  <Name>I want Parameter Replacement here:</Name>\n  <Description>Event Description: {0}\n{1}\n{2}\n{3}\n  </Description>\n</DisplayString>\n```\n\nYou should have one of these for every language you have configured in your management pack.\nAs you may notice, the Description does not contain any XPaths of any kind but rather references to the parameters defined in the WriteAction. That would be the {X} thingies within the description tags. You may also notice that the AlertParameters starts from \"1\" while the parameter references begin with \"0\". In practice, that means that _{0}_ in the displaystring definition equals to _AlertParameter1_ and so forth.\n\nNow, with this in mind, adding a Parameter to AlertName if very simple and straight-forward. Simply decide which parameter your want to use and add it's reference to the Name definition.\nSo, let's say I have the above alert message and I want to include _UserName_ in the Alert Name, I would change the <Name> tag to:\n\n```xml\n<Name>I want Parameter Replacement here:{2}</Name>\n```\n\nThat's it folks!\nSave the XML, make sure you verify it and import it into your Operations Manager LAB and watch the magic. Just make sure you continue reading this post as the next part about the downsides is pretty important.\n\n## The Downside\n\nThe negative effects of using Parameter Replacement in AlertName really boils down to two main perspectives. These are, if I may say to, pretty major and is the reason I have been reluctant on posting this, sort of, how-to.\n\n### You are breaking your subscriptions and connectors\n\nApparently, parameter replacement is not working in subscriptions and connectors, be it 3:rd-party, Universal, Orchestrator IPs et.c. Basically anything other than the Operations Console will not be able to handle your parameters in AlertName. This will give you a _\"{1} in {2} has received an error\"_ instead of _\"veryimportant.log in C:\\Logs\\ImportantSystem\\ has received an error\"_ in anything except the Operations Console. Now, this might not be a bad thing if the Operations Console is your only interface to Operations Manager, but if you would like to forward these alerts to a mobile phone, IM user or a mail recipient it will be utterly useless. I have not verified this, but I am not sure if Alert Suppression is actually parsing the parameters as well. Also. If you, by means of connectors or System Center Orchestrator, are generating incidents from alerts the AlertName forwarded will be equally useless for anyone receiving it.\n\n### It's killing your health perspective\n\nMight sound drastic, but I'm quite serious about this. Using Parameter Replacement in AlertName might be useful for alert generating rules, but should never be used in a monitor. The reason is pretty simple actually. If you are using a monitor, you are without a doubt interested in it's state. Otherwise, you would not use a monitor, am I right? I cannot see how it would make sense to create a monitor that does not reflect the health of a specific checkpoint. Much less having a monitor generating alerts that might confuse any service desk operator about what monitor that caused the alert. Also--I have not tested this--I assume that a monitor would not update it's AlertName once the alert are generated making it more difficult to troubleshoot. Alert generating rules are, to me, something I tend to use only when all other options fail for some reason and I do not like to monitor things to cannot have health. And since parameters in AlertName is nothing for monitors I also question whether it actually is usable at all.\n\n## The Conclusion\n\nWhile this is an interesting techique and a good way to enjoy MP Authoring and learn about the behaviour of display strings and languages in you Management Packs, I would definitely consider it a mostly academical exercise. Only in <span style=\"text-decoration: underline;\">extreme</span> use-cases and situations would I consider it a viably option and while it might look good in the console, do be aware of the limitations. I have also not seen anything about it on MSDN, and I have serious doubts about it being a supported feature. I have personally been using it in transition to a \"better\" management pack to get alerting running quickly, yet a prefered solution would actually be using a custom datasouce and a decent macro-enabled text-editor--not to mention snippets--to bulk-generate your monitors and/or rules.\n\n> MP Authoring\n\n> is fun and powerful\n\n> -- be resposible\n","source":"_posts/parameter-replacement-in-alertname.md","raw":"---\ntitle: Parameter Replacement in AlertName\ntags:\n  - MP Development\n  - OpsMgr\nid: 586\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2012-04-09 22:04:48\n---\n\n# ...and why you should not use it\n\n## A Disclaimer\n\nI have had serious doubts about actually writing this article for almost a year now for reasons that I will explain further on. But as others have discovered this \"feature\" as well--maybe \"hack\" would be a better name for it--I feel the need to explain how it works and also why you should not use it. Knowledge is power, and even if I advice against using this technique it is also a good way to understand how SCOM uses display-strings in management packs.\n\n## The Good News\n\nYes, you can use parameter replacement in you AlertName.\n\nWith \"parameter replacement\" i mean using some kind of substitute text, or mnemonic if you like, that at run-time get translated into something useful. If you have written any kind of alert generating rules or monitors, you most like included something like _$Data/Context/Property[@Name='SomeDataFromAPropertyBag']$_ into your alert description.\n\nIn this dialog, you also have the possibility to set the Alert Name. And if you are lazy, like I am, you probably also noticed that it is impossible to insert any kind of dynamic data into that field as well. This is especially annoying when you are writing a management pack that needs to look different in the Alert Views in the console, and you want to monitor 50 different Events or Performance counters or Log entries that are pretty much the same apart from a Name or ID.\nOf course I could not refrain from copy-pasting a _$Data/Context...$_ into the alert name only to realize that it simply is not being parsed and translated into the value of the specified parameter. Over time I have settled for a stand-point that it's probably a performance issue and I have also used that as an argument for this apparent lack of simplicity that some of my customers have been questioning.\n\nTwo, maybe three, years later. Microsoft releases an update to the core agent monitoring packs. Much to my surprise, one performance monitor suddenly generated alerts with a dynamic performance value in the Alert Name. You know, that field that is not gettingt parsed I was mentioning in the earlier paragraph. It actually looked pretty bad and made it very much impossible to practice any kind of alert supression, but still. It actually had a parsed value in the Alert Name.\nAs the lack of this feature had me irked before, I exported the core MP and started reading through the XML to find out how they did it. To my surprise, it was actually pretty simple if you ditched the Authoring Console and used your trusty text-editor instead.\n\n## How To Do It\n\nIn simple terms, if you know your SCOM XML out-side-in, you add the parameters to your \"Alert\" and modify your DisplayString, the one under LanguagePacks, to call that parameter by it's relative ID.\n\nJust in case you happen to be a regular mortal, here's the step-by-step guide. ;)\n\nIn this example I have created a silly-simple Alert Generating EventLog rule in wich I have added some parameters to the description. It pretty much looks like this:\n\n![Alert Description Dialog](http://teknoglotse.nfshost.com/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png)\n\nSaving the MP at this point I will have a new WriteAlert action with a bunch of parameters and a displaystring with a unique ID.\nThe resulting XML-code for the WriteAlert action looks like this:\n\n```xml\n[xml highlight=\"7,8,9,10,11,12,13\"]\n<WriteAction ID=\"Alert\" TypeID=\"Health!System.Health.GenerateAlert\">\n  <Priority>1</Priority>\n  <Severity>2</Severity>\n  <AlertName />\n  <AlertDescription />\n  <AlertOwner />\n  <AlertMessageId>$MPElement[Name=\"TestMP.MyEventlogAlertRule.AlertMessage\"]$</AlertMessageId>\n  <AlertParameters>\n    <AlertParameter1>$Data/EventDescription$</AlertParameter1>\n    <AlertParameter2>$Data/LoggingComputer$</AlertParameter2>\n    <AlertParameter3>$Data/UserName$</AlertParameter3>\n    <AlertParameter4>$Data/EventNumber$</AlertParameter4>\n  </AlertParameters>\n  <Suppression />\n  <Custom1 />\n  <Custom2 />\n  <Custom3 />\n  <Custom4 />\n  <Custom5 />\n  <Custom6 />\n  <Custom7 />\n  <Custom8 />\n  <Custom9 />\n  <Custom10 />\n</WriteAction>\n```\n\nIn this slab of code, you've got the Parameters, their \"relative ID\" (the number in the Tag), and also the which is what you would need to search for among the displaystrings. Take note of the you want to use in your AlertName since you are going to need it later. A quick search for \"TestMP.MyEventlogAlertRule.AlertMessage\" will lead you to the actual message, which should looke similar to this:\n\n```xml\n<DisplayString ElementID=\"TestMP.MyEventlogAlertRule.AlertMessage\">\n  <Name>I want Parameter Replacement here:</Name>\n  <Description>Event Description: {0}\n{1}\n{2}\n{3}\n  </Description>\n</DisplayString>\n```\n\nYou should have one of these for every language you have configured in your management pack.\nAs you may notice, the Description does not contain any XPaths of any kind but rather references to the parameters defined in the WriteAction. That would be the {X} thingies within the description tags. You may also notice that the AlertParameters starts from \"1\" while the parameter references begin with \"0\". In practice, that means that _{0}_ in the displaystring definition equals to _AlertParameter1_ and so forth.\n\nNow, with this in mind, adding a Parameter to AlertName if very simple and straight-forward. Simply decide which parameter your want to use and add it's reference to the Name definition.\nSo, let's say I have the above alert message and I want to include _UserName_ in the Alert Name, I would change the <Name> tag to:\n\n```xml\n<Name>I want Parameter Replacement here:{2}</Name>\n```\n\nThat's it folks!\nSave the XML, make sure you verify it and import it into your Operations Manager LAB and watch the magic. Just make sure you continue reading this post as the next part about the downsides is pretty important.\n\n## The Downside\n\nThe negative effects of using Parameter Replacement in AlertName really boils down to two main perspectives. These are, if I may say to, pretty major and is the reason I have been reluctant on posting this, sort of, how-to.\n\n### You are breaking your subscriptions and connectors\n\nApparently, parameter replacement is not working in subscriptions and connectors, be it 3:rd-party, Universal, Orchestrator IPs et.c. Basically anything other than the Operations Console will not be able to handle your parameters in AlertName. This will give you a _\"{1} in {2} has received an error\"_ instead of _\"veryimportant.log in C:\\Logs\\ImportantSystem\\ has received an error\"_ in anything except the Operations Console. Now, this might not be a bad thing if the Operations Console is your only interface to Operations Manager, but if you would like to forward these alerts to a mobile phone, IM user or a mail recipient it will be utterly useless. I have not verified this, but I am not sure if Alert Suppression is actually parsing the parameters as well. Also. If you, by means of connectors or System Center Orchestrator, are generating incidents from alerts the AlertName forwarded will be equally useless for anyone receiving it.\n\n### It's killing your health perspective\n\nMight sound drastic, but I'm quite serious about this. Using Parameter Replacement in AlertName might be useful for alert generating rules, but should never be used in a monitor. The reason is pretty simple actually. If you are using a monitor, you are without a doubt interested in it's state. Otherwise, you would not use a monitor, am I right? I cannot see how it would make sense to create a monitor that does not reflect the health of a specific checkpoint. Much less having a monitor generating alerts that might confuse any service desk operator about what monitor that caused the alert. Also--I have not tested this--I assume that a monitor would not update it's AlertName once the alert are generated making it more difficult to troubleshoot. Alert generating rules are, to me, something I tend to use only when all other options fail for some reason and I do not like to monitor things to cannot have health. And since parameters in AlertName is nothing for monitors I also question whether it actually is usable at all.\n\n## The Conclusion\n\nWhile this is an interesting techique and a good way to enjoy MP Authoring and learn about the behaviour of display strings and languages in you Management Packs, I would definitely consider it a mostly academical exercise. Only in <span style=\"text-decoration: underline;\">extreme</span> use-cases and situations would I consider it a viably option and while it might look good in the console, do be aware of the limitations. I have also not seen anything about it on MSDN, and I have serious doubts about it being a supported feature. I have personally been using it in transition to a \"better\" management pack to get alerting running quickly, yet a prefered solution would actually be using a custom datasouce and a decent macro-enabled text-editor--not to mention snippets--to bulk-generate your monitors and/or rules.\n\n> MP Authoring\n\n> is fun and powerful\n\n> -- be resposible\n","slug":"parameter-replacement-in-alertname","published":1,"updated":"2016-05-24T21:29:18.143Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7ji002pq4o28zte13lp","content":"<h1 id=\"…and-why-you-should-not-use-it\"><a href=\"#…and-why-you-should-not-use-it\" class=\"headerlink\" title=\"…and why you should not use it\"></a>…and why you should not use it</h1><h2 id=\"A-Disclaimer\"><a href=\"#A-Disclaimer\" class=\"headerlink\" title=\"A Disclaimer\"></a>A Disclaimer</h2><p>I have had serious doubts about actually writing this article for almost a year now for reasons that I will explain further on. But as others have discovered this “feature” as well–maybe “hack” would be a better name for it–I feel the need to explain how it works and also why you should not use it. Knowledge is power, and even if I advice against using this technique it is also a good way to understand how SCOM uses display-strings in management packs.</p>\n<h2 id=\"The-Good-News\"><a href=\"#The-Good-News\" class=\"headerlink\" title=\"The Good News\"></a>The Good News</h2><p>Yes, you can use parameter replacement in you AlertName.</p>\n<p>With “parameter replacement” i mean using some kind of substitute text, or mnemonic if you like, that at run-time get translated into something useful. If you have written any kind of alert generating rules or monitors, you most like included something like <em>$Data/Context/Property[@Name=’SomeDataFromAPropertyBag’]$</em> into your alert description.</p>\n<p>In this dialog, you also have the possibility to set the Alert Name. And if you are lazy, like I am, you probably also noticed that it is impossible to insert any kind of dynamic data into that field as well. This is especially annoying when you are writing a management pack that needs to look different in the Alert Views in the console, and you want to monitor 50 different Events or Performance counters or Log entries that are pretty much the same apart from a Name or ID.<br>Of course I could not refrain from copy-pasting a <em>$Data/Context…$</em> into the alert name only to realize that it simply is not being parsed and translated into the value of the specified parameter. Over time I have settled for a stand-point that it’s probably a performance issue and I have also used that as an argument for this apparent lack of simplicity that some of my customers have been questioning.</p>\n<p>Two, maybe three, years later. Microsoft releases an update to the core agent monitoring packs. Much to my surprise, one performance monitor suddenly generated alerts with a dynamic performance value in the Alert Name. You know, that field that is not gettingt parsed I was mentioning in the earlier paragraph. It actually looked pretty bad and made it very much impossible to practice any kind of alert supression, but still. It actually had a parsed value in the Alert Name.<br>As the lack of this feature had me irked before, I exported the core MP and started reading through the XML to find out how they did it. To my surprise, it was actually pretty simple if you ditched the Authoring Console and used your trusty text-editor instead.</p>\n<h2 id=\"How-To-Do-It\"><a href=\"#How-To-Do-It\" class=\"headerlink\" title=\"How To Do It\"></a>How To Do It</h2><p>In simple terms, if you know your SCOM XML out-side-in, you add the parameters to your “Alert” and modify your DisplayString, the one under LanguagePacks, to call that parameter by it’s relative ID.</p>\n<p>Just in case you happen to be a regular mortal, here’s the step-by-step guide. ;)</p>\n<p>In this example I have created a silly-simple Alert Generating EventLog rule in wich I have added some parameters to the description. It pretty much looks like this:</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png\" alt=\"Alert Description Dialog\"></p>\n<p>Saving the MP at this point I will have a new WriteAlert action with a bunch of parameters and a displaystring with a unique ID.<br>The resulting XML-code for the WriteAlert action looks like this:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\">[xml highlight=\"7,8,9,10,11,12,13\"]</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">WriteAction</span> <span class=\"attr\">ID</span>=<span class=\"string\">\"Alert\"</span> <span class=\"attr\">TypeID</span>=<span class=\"string\">\"Health!System.Health.GenerateAlert\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Priority</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">Priority</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Severity</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">Severity</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertName</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertDescription</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertOwner</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertMessageId</span>&gt;</span>$MPElement[Name=\"TestMP.MyEventlogAlertRule.AlertMessage\"]$<span class=\"tag\">&lt;/<span class=\"name\">AlertMessageId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertParameters</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter1</span>&gt;</span>$Data/EventDescription$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter2</span>&gt;</span>$Data/LoggingComputer$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter3</span>&gt;</span>$Data/UserName$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter3</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter4</span>&gt;</span>$Data/EventNumber$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter4</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">AlertParameters</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Suppression</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom1</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom2</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom3</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom4</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom5</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom6</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom7</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom8</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom9</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom10</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">WriteAction</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>In this slab of code, you’ve got the Parameters, their “relative ID” (the number in the Tag), and also the which is what you would need to search for among the displaystrings. Take note of the you want to use in your AlertName since you are going to need it later. A quick search for “TestMP.MyEventlogAlertRule.AlertMessage” will lead you to the actual message, which should looke similar to this:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">DisplayString</span> <span class=\"attr\">ElementID</span>=<span class=\"string\">\"TestMP.MyEventlogAlertRule.AlertMessage\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Name</span>&gt;</span>I want Parameter Replacement here:<span class=\"tag\">&lt;/<span class=\"name\">Name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Description</span>&gt;</span>Event Description: &#123;0&#125;</span><br><span class=\"line\">&#123;1&#125;</span><br><span class=\"line\">&#123;2&#125;</span><br><span class=\"line\">&#123;3&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">Description</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">DisplayString</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>You should have one of these for every language you have configured in your management pack.<br>As you may notice, the Description does not contain any XPaths of any kind but rather references to the parameters defined in the WriteAction. That would be the {X} thingies within the description tags. You may also notice that the AlertParameters starts from “1” while the parameter references begin with “0”. In practice, that means that <em>{0}</em> in the displaystring definition equals to <em>AlertParameter1</em> and so forth.</p>\n<p>Now, with this in mind, adding a Parameter to AlertName if very simple and straight-forward. Simply decide which parameter your want to use and add it’s reference to the Name definition.<br>So, let’s say I have the above alert message and I want to include <em>UserName</em> in the Alert Name, I would change the <name> tag to:</name></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Name</span>&gt;</span>I want Parameter Replacement here:&#123;2&#125;<span class=\"tag\">&lt;/<span class=\"name\">Name</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>That’s it folks!<br>Save the XML, make sure you verify it and import it into your Operations Manager LAB and watch the magic. Just make sure you continue reading this post as the next part about the downsides is pretty important.</p>\n<h2 id=\"The-Downside\"><a href=\"#The-Downside\" class=\"headerlink\" title=\"The Downside\"></a>The Downside</h2><p>The negative effects of using Parameter Replacement in AlertName really boils down to two main perspectives. These are, if I may say to, pretty major and is the reason I have been reluctant on posting this, sort of, how-to.</p>\n<h3 id=\"You-are-breaking-your-subscriptions-and-connectors\"><a href=\"#You-are-breaking-your-subscriptions-and-connectors\" class=\"headerlink\" title=\"You are breaking your subscriptions and connectors\"></a>You are breaking your subscriptions and connectors</h3><p>Apparently, parameter replacement is not working in subscriptions and connectors, be it 3:rd-party, Universal, Orchestrator IPs et.c. Basically anything other than the Operations Console will not be able to handle your parameters in AlertName. This will give you a <em>“{1} in {2} has received an error”</em> instead of <em>“veryimportant.log in C:\\Logs\\ImportantSystem\\ has received an error”</em> in anything except the Operations Console. Now, this might not be a bad thing if the Operations Console is your only interface to Operations Manager, but if you would like to forward these alerts to a mobile phone, IM user or a mail recipient it will be utterly useless. I have not verified this, but I am not sure if Alert Suppression is actually parsing the parameters as well. Also. If you, by means of connectors or System Center Orchestrator, are generating incidents from alerts the AlertName forwarded will be equally useless for anyone receiving it.</p>\n<h3 id=\"It’s-killing-your-health-perspective\"><a href=\"#It’s-killing-your-health-perspective\" class=\"headerlink\" title=\"It’s killing your health perspective\"></a>It’s killing your health perspective</h3><p>Might sound drastic, but I’m quite serious about this. Using Parameter Replacement in AlertName might be useful for alert generating rules, but should never be used in a monitor. The reason is pretty simple actually. If you are using a monitor, you are without a doubt interested in it’s state. Otherwise, you would not use a monitor, am I right? I cannot see how it would make sense to create a monitor that does not reflect the health of a specific checkpoint. Much less having a monitor generating alerts that might confuse any service desk operator about what monitor that caused the alert. Also–I have not tested this–I assume that a monitor would not update it’s AlertName once the alert are generated making it more difficult to troubleshoot. Alert generating rules are, to me, something I tend to use only when all other options fail for some reason and I do not like to monitor things to cannot have health. And since parameters in AlertName is nothing for monitors I also question whether it actually is usable at all.</p>\n<h2 id=\"The-Conclusion\"><a href=\"#The-Conclusion\" class=\"headerlink\" title=\"The Conclusion\"></a>The Conclusion</h2><p>While this is an interesting techique and a good way to enjoy MP Authoring and learn about the behaviour of display strings and languages in you Management Packs, I would definitely consider it a mostly academical exercise. Only in <span style=\"text-decoration: underline;\">extreme</span> use-cases and situations would I consider it a viably option and while it might look good in the console, do be aware of the limitations. I have also not seen anything about it on MSDN, and I have serious doubts about it being a supported feature. I have personally been using it in transition to a “better” management pack to get alerting running quickly, yet a prefered solution would actually be using a custom datasouce and a decent macro-enabled text-editor–not to mention snippets–to bulk-generate your monitors and/or rules.</p>\n<blockquote>\n<p>MP Authoring</p>\n<p>is fun and powerful</p>\n<p>– be resposible</p>\n</blockquote>\n","excerpt":"","more":"<h1 id=\"…and-why-you-should-not-use-it\"><a href=\"#…and-why-you-should-not-use-it\" class=\"headerlink\" title=\"…and why you should not use it\"></a>…and why you should not use it</h1><h2 id=\"A-Disclaimer\"><a href=\"#A-Disclaimer\" class=\"headerlink\" title=\"A Disclaimer\"></a>A Disclaimer</h2><p>I have had serious doubts about actually writing this article for almost a year now for reasons that I will explain further on. But as others have discovered this “feature” as well–maybe “hack” would be a better name for it–I feel the need to explain how it works and also why you should not use it. Knowledge is power, and even if I advice against using this technique it is also a good way to understand how SCOM uses display-strings in management packs.</p>\n<h2 id=\"The-Good-News\"><a href=\"#The-Good-News\" class=\"headerlink\" title=\"The Good News\"></a>The Good News</h2><p>Yes, you can use parameter replacement in you AlertName.</p>\n<p>With “parameter replacement” i mean using some kind of substitute text, or mnemonic if you like, that at run-time get translated into something useful. If you have written any kind of alert generating rules or monitors, you most like included something like <em>$Data/Context/Property[@Name=’SomeDataFromAPropertyBag’]$</em> into your alert description.</p>\n<p>In this dialog, you also have the possibility to set the Alert Name. And if you are lazy, like I am, you probably also noticed that it is impossible to insert any kind of dynamic data into that field as well. This is especially annoying when you are writing a management pack that needs to look different in the Alert Views in the console, and you want to monitor 50 different Events or Performance counters or Log entries that are pretty much the same apart from a Name or ID.<br>Of course I could not refrain from copy-pasting a <em>$Data/Context…$</em> into the alert name only to realize that it simply is not being parsed and translated into the value of the specified parameter. Over time I have settled for a stand-point that it’s probably a performance issue and I have also used that as an argument for this apparent lack of simplicity that some of my customers have been questioning.</p>\n<p>Two, maybe three, years later. Microsoft releases an update to the core agent monitoring packs. Much to my surprise, one performance monitor suddenly generated alerts with a dynamic performance value in the Alert Name. You know, that field that is not gettingt parsed I was mentioning in the earlier paragraph. It actually looked pretty bad and made it very much impossible to practice any kind of alert supression, but still. It actually had a parsed value in the Alert Name.<br>As the lack of this feature had me irked before, I exported the core MP and started reading through the XML to find out how they did it. To my surprise, it was actually pretty simple if you ditched the Authoring Console and used your trusty text-editor instead.</p>\n<h2 id=\"How-To-Do-It\"><a href=\"#How-To-Do-It\" class=\"headerlink\" title=\"How To Do It\"></a>How To Do It</h2><p>In simple terms, if you know your SCOM XML out-side-in, you add the parameters to your “Alert” and modify your DisplayString, the one under LanguagePacks, to call that parameter by it’s relative ID.</p>\n<p>Just in case you happen to be a regular mortal, here’s the step-by-step guide. ;)</p>\n<p>In this example I have created a silly-simple Alert Generating EventLog rule in wich I have added some parameters to the description. It pretty much looks like this:</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2012/04/ParamReplacement_AlertDescriptionDialog.png\" alt=\"Alert Description Dialog\"></p>\n<p>Saving the MP at this point I will have a new WriteAlert action with a bunch of parameters and a displaystring with a unique ID.<br>The resulting XML-code for the WriteAlert action looks like this:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\">[xml highlight=\"7,8,9,10,11,12,13\"]</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">WriteAction</span> <span class=\"attr\">ID</span>=<span class=\"string\">\"Alert\"</span> <span class=\"attr\">TypeID</span>=<span class=\"string\">\"Health!System.Health.GenerateAlert\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Priority</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">Priority</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Severity</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">Severity</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertName</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertDescription</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertOwner</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertMessageId</span>&gt;</span>$MPElement[Name=\"TestMP.MyEventlogAlertRule.AlertMessage\"]$<span class=\"tag\">&lt;/<span class=\"name\">AlertMessageId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">AlertParameters</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter1</span>&gt;</span>$Data/EventDescription$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter2</span>&gt;</span>$Data/LoggingComputer$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter3</span>&gt;</span>$Data/UserName$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter3</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">AlertParameter4</span>&gt;</span>$Data/EventNumber$<span class=\"tag\">&lt;/<span class=\"name\">AlertParameter4</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">AlertParameters</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Suppression</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom1</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom2</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom3</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom4</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom5</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom6</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom7</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom8</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom9</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Custom10</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">WriteAction</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>In this slab of code, you’ve got the Parameters, their “relative ID” (the number in the Tag), and also the which is what you would need to search for among the displaystrings. Take note of the you want to use in your AlertName since you are going to need it later. A quick search for “TestMP.MyEventlogAlertRule.AlertMessage” will lead you to the actual message, which should looke similar to this:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">DisplayString</span> <span class=\"attr\">ElementID</span>=<span class=\"string\">\"TestMP.MyEventlogAlertRule.AlertMessage\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Name</span>&gt;</span>I want Parameter Replacement here:<span class=\"tag\">&lt;/<span class=\"name\">Name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Description</span>&gt;</span>Event Description: &#123;0&#125;</span><br><span class=\"line\">&#123;1&#125;</span><br><span class=\"line\">&#123;2&#125;</span><br><span class=\"line\">&#123;3&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">Description</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">DisplayString</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>You should have one of these for every language you have configured in your management pack.<br>As you may notice, the Description does not contain any XPaths of any kind but rather references to the parameters defined in the WriteAction. That would be the {X} thingies within the description tags. You may also notice that the AlertParameters starts from “1” while the parameter references begin with “0”. In practice, that means that <em>{0}</em> in the displaystring definition equals to <em>AlertParameter1</em> and so forth.</p>\n<p>Now, with this in mind, adding a Parameter to AlertName if very simple and straight-forward. Simply decide which parameter your want to use and add it’s reference to the Name definition.<br>So, let’s say I have the above alert message and I want to include <em>UserName</em> in the Alert Name, I would change the <Name> tag to:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Name</span>&gt;</span>I want Parameter Replacement here:&#123;2&#125;<span class=\"tag\">&lt;/<span class=\"name\">Name</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>That’s it folks!<br>Save the XML, make sure you verify it and import it into your Operations Manager LAB and watch the magic. Just make sure you continue reading this post as the next part about the downsides is pretty important.</p>\n<h2 id=\"The-Downside\"><a href=\"#The-Downside\" class=\"headerlink\" title=\"The Downside\"></a>The Downside</h2><p>The negative effects of using Parameter Replacement in AlertName really boils down to two main perspectives. These are, if I may say to, pretty major and is the reason I have been reluctant on posting this, sort of, how-to.</p>\n<h3 id=\"You-are-breaking-your-subscriptions-and-connectors\"><a href=\"#You-are-breaking-your-subscriptions-and-connectors\" class=\"headerlink\" title=\"You are breaking your subscriptions and connectors\"></a>You are breaking your subscriptions and connectors</h3><p>Apparently, parameter replacement is not working in subscriptions and connectors, be it 3:rd-party, Universal, Orchestrator IPs et.c. Basically anything other than the Operations Console will not be able to handle your parameters in AlertName. This will give you a <em>“{1} in {2} has received an error”</em> instead of <em>“veryimportant.log in C:\\Logs\\ImportantSystem\\ has received an error”</em> in anything except the Operations Console. Now, this might not be a bad thing if the Operations Console is your only interface to Operations Manager, but if you would like to forward these alerts to a mobile phone, IM user or a mail recipient it will be utterly useless. I have not verified this, but I am not sure if Alert Suppression is actually parsing the parameters as well. Also. If you, by means of connectors or System Center Orchestrator, are generating incidents from alerts the AlertName forwarded will be equally useless for anyone receiving it.</p>\n<h3 id=\"It’s-killing-your-health-perspective\"><a href=\"#It’s-killing-your-health-perspective\" class=\"headerlink\" title=\"It’s killing your health perspective\"></a>It’s killing your health perspective</h3><p>Might sound drastic, but I’m quite serious about this. Using Parameter Replacement in AlertName might be useful for alert generating rules, but should never be used in a monitor. The reason is pretty simple actually. If you are using a monitor, you are without a doubt interested in it’s state. Otherwise, you would not use a monitor, am I right? I cannot see how it would make sense to create a monitor that does not reflect the health of a specific checkpoint. Much less having a monitor generating alerts that might confuse any service desk operator about what monitor that caused the alert. Also–I have not tested this–I assume that a monitor would not update it’s AlertName once the alert are generated making it more difficult to troubleshoot. Alert generating rules are, to me, something I tend to use only when all other options fail for some reason and I do not like to monitor things to cannot have health. And since parameters in AlertName is nothing for monitors I also question whether it actually is usable at all.</p>\n<h2 id=\"The-Conclusion\"><a href=\"#The-Conclusion\" class=\"headerlink\" title=\"The Conclusion\"></a>The Conclusion</h2><p>While this is an interesting techique and a good way to enjoy MP Authoring and learn about the behaviour of display strings and languages in you Management Packs, I would definitely consider it a mostly academical exercise. Only in <span style=\"text-decoration: underline;\">extreme</span> use-cases and situations would I consider it a viably option and while it might look good in the console, do be aware of the limitations. I have also not seen anything about it on MSDN, and I have serious doubts about it being a supported feature. I have personally been using it in transition to a “better” management pack to get alerting running quickly, yet a prefered solution would actually be using a custom datasouce and a decent macro-enabled text-editor–not to mention snippets–to bulk-generate your monitors and/or rules.</p>\n<blockquote>\n<p>MP Authoring</p>\n<p>is fun and powerful</p>\n<p>– be resposible</p>\n</blockquote>\n"},{"title":"Quest Software acquires eXc and VizionCore","id":"87","date":"2008-01-30T11:09:18.000Z","_content":"\nYes, I am officially slow. But never mind.\n\n[Quest Software](http://www.quest.com/) is a rather nice software developer with some interesting products for a wide range of [Microsoft](http://www.microsoft.com) systems -- like [Site Administrator](http://www.quest.com/site-administrator-for-sharepoint/) and [Recovery Manager](http://www.quest.com/recovery-manager-for-sharepoint/) for SharePoint -- but also database and application servers like [SAP](http://www.sap.com/) and Oracle E-business.\n\nI have lately been working with some of their [MOSS](http://www.microsoft.com/sharepoint/default.mspx)-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at.\n\nQuite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. [eXc](http://www.excsoftware.com/version3/version3/Default.aspx) does it's thing in the <span class=\"removed_link\" title=\"http://www.microsoft.com/mom\">Microsoft SCOM/MOM</span> arena while [VizionCore](http://www.vizioncore.com/) dances with virtualization techniques. At least, that's where I've come across them both.\n\nHow will this affect me, then?\nNot very much it would seem. Here's what VizionCore says about their part:\n> “The completion of this acquisition signals another major step in Vizioncore’s evolution and growth in the virtualization market,” said David Bieneman, CEO of VizionCore. “While maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.”\n\nIn my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a \"Strategic Partner\" to VizionCore even before the acquisition.\n\neXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills -- or lack thereof -- does not reflect their programming skills. But still... no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony.\n\n## references:\n\n- [Quest Software Continues Its Value Add to Microsoft System Center](http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6540)\n- [Quest Software Completes Acquisition of VizionCore...](http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6752)\n","source":"_posts/quest-software-acquires-exc-and-vizioncore.md","raw":"---\ntitle: Quest Software acquires eXc and VizionCore\ntags:\n  - OpsMgr\nid: 87\ncategories:\n  - Technobabble\ndate: 2008-01-30 12:09:18\n---\n\nYes, I am officially slow. But never mind.\n\n[Quest Software](http://www.quest.com/) is a rather nice software developer with some interesting products for a wide range of [Microsoft](http://www.microsoft.com) systems -- like [Site Administrator](http://www.quest.com/site-administrator-for-sharepoint/) and [Recovery Manager](http://www.quest.com/recovery-manager-for-sharepoint/) for SharePoint -- but also database and application servers like [SAP](http://www.sap.com/) and Oracle E-business.\n\nI have lately been working with some of their [MOSS](http://www.microsoft.com/sharepoint/default.mspx)-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at.\n\nQuite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. [eXc](http://www.excsoftware.com/version3/version3/Default.aspx) does it's thing in the <span class=\"removed_link\" title=\"http://www.microsoft.com/mom\">Microsoft SCOM/MOM</span> arena while [VizionCore](http://www.vizioncore.com/) dances with virtualization techniques. At least, that's where I've come across them both.\n\nHow will this affect me, then?\nNot very much it would seem. Here's what VizionCore says about their part:\n> “The completion of this acquisition signals another major step in Vizioncore’s evolution and growth in the virtualization market,” said David Bieneman, CEO of VizionCore. “While maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.”\n\nIn my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a \"Strategic Partner\" to VizionCore even before the acquisition.\n\neXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills -- or lack thereof -- does not reflect their programming skills. But still... no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony.\n\n## references:\n\n- [Quest Software Continues Its Value Add to Microsoft System Center](http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6540)\n- [Quest Software Completes Acquisition of VizionCore...](http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6752)\n","slug":"quest-software-acquires-exc-and-vizioncore","published":1,"updated":"2016-05-24T21:24:45.359Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jk002tq4o2bcrmrtwa","content":"<p>Yes, I am officially slow. But never mind.</p>\n<p><a href=\"http://www.quest.com/\" target=\"_blank\" rel=\"external\">Quest Software</a> is a rather nice software developer with some interesting products for a wide range of <a href=\"http://www.microsoft.com\" target=\"_blank\" rel=\"external\">Microsoft</a> systems – like <a href=\"http://www.quest.com/site-administrator-for-sharepoint/\" target=\"_blank\" rel=\"external\">Site Administrator</a> and <a href=\"http://www.quest.com/recovery-manager-for-sharepoint/\" target=\"_blank\" rel=\"external\">Recovery Manager</a> for SharePoint – but also database and application servers like <a href=\"http://www.sap.com/\" target=\"_blank\" rel=\"external\">SAP</a> and Oracle E-business.</p>\n<p>I have lately been working with some of their <a href=\"http://www.microsoft.com/sharepoint/default.mspx\" target=\"_blank\" rel=\"external\">MOSS</a>-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at.</p>\n<p>Quite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. <a href=\"http://www.excsoftware.com/version3/version3/Default.aspx\" target=\"_blank\" rel=\"external\">eXc</a> does it’s thing in the <span class=\"removed_link\" title=\"http://www.microsoft.com/mom\">Microsoft SCOM/MOM</span> arena while <a href=\"http://www.vizioncore.com/\" target=\"_blank\" rel=\"external\">VizionCore</a> dances with virtualization techniques. At least, that’s where I’ve come across them both.</p>\n<p>How will this affect me, then?<br>Not very much it would seem. Here’s what VizionCore says about their part:</p>\n<blockquote>\n<p>“The completion of this acquisition signals another major step in Vizioncore’s evolution and growth in the virtualization market,” said David Bieneman, CEO of VizionCore. “While maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.”</p>\n</blockquote>\n<p>In my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a “Strategic Partner” to VizionCore even before the acquisition.</p>\n<p>eXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills – or lack thereof – does not reflect their programming skills. But still… no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony.</p>\n<h2 id=\"references\"><a href=\"#references\" class=\"headerlink\" title=\"references:\"></a>references:</h2><ul>\n<li><a href=\"http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6540\" target=\"_blank\" rel=\"external\">Quest Software Continues Its Value Add to Microsoft System Center</a></li>\n<li><a href=\"http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6752\" target=\"_blank\" rel=\"external\">Quest Software Completes Acquisition of VizionCore…</a></li>\n</ul>\n","excerpt":"","more":"<p>Yes, I am officially slow. But never mind.</p>\n<p><a href=\"http://www.quest.com/\">Quest Software</a> is a rather nice software developer with some interesting products for a wide range of <a href=\"http://www.microsoft.com\">Microsoft</a> systems – like <a href=\"http://www.quest.com/site-administrator-for-sharepoint/\">Site Administrator</a> and <a href=\"http://www.quest.com/recovery-manager-for-sharepoint/\">Recovery Manager</a> for SharePoint – but also database and application servers like <a href=\"http://www.sap.com/\">SAP</a> and Oracle E-business.</p>\n<p>I have lately been working with some of their <a href=\"http://www.microsoft.com/sharepoint/default.mspx\">MOSS</a>-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at.</p>\n<p>Quite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. <a href=\"http://www.excsoftware.com/version3/version3/Default.aspx\">eXc</a> does it’s thing in the <span class=\"removed_link\" title=\"http://www.microsoft.com/mom\">Microsoft SCOM/MOM</span> arena while <a href=\"http://www.vizioncore.com/\">VizionCore</a> dances with virtualization techniques. At least, that’s where I’ve come across them both.</p>\n<p>How will this affect me, then?<br>Not very much it would seem. Here’s what VizionCore says about their part:</p>\n<blockquote>\n<p>“The completion of this acquisition signals another major step in Vizioncore’s evolution and growth in the virtualization market,” said David Bieneman, CEO of VizionCore. “While maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.”</p>\n</blockquote>\n<p>In my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a “Strategic Partner” to VizionCore even before the acquisition.</p>\n<p>eXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills – or lack thereof – does not reflect their programming skills. But still… no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony.</p>\n<h2 id=\"references\"><a href=\"#references\" class=\"headerlink\" title=\"references:\"></a>references:</h2><ul>\n<li><a href=\"http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6540\">Quest Software Continues Its Value Add to Microsoft System Center</a></li>\n<li><a href=\"http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6752\">Quest Software Completes Acquisition of VizionCore…</a></li>\n</ul>\n"},{"title":"Quick Demo - Add Windows Performance Collection Rule [#opsmgr, #mpauthoring]","id":"764","date":"2013-02-21T08:25:39.000Z","_content":"\nBy request, I uploaded a short clip demonstrating how you would add a windows performance counter to a performance collection rule using the Authoring Console.\n\nIt is a fairly simple task to complete but does require the [Authoring Console](http://www.microsoft.com/en-us/download/details.aspx?id=18222 \"System Center Operations Manager 2007 R2 Authoring Resource Kit\"), obviously, and a better target class than what I use in the demo. The demo also assumes that this counter exist on all the targeted servers in your environment. It would be wise, when making your management pack, to check that it's there on all targeted operating systems, and that's what I use Performance Monitor for. (just search for _perfmon_ in your start menu or run perfmon.exe)\n\nEnjoy.\n\n[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/4G4aXslrjvQ/0.jpg)](http://www.youtube.com/watch?v=4G4aXslrjvQ)\n","source":"_posts/quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring.md","raw":"---\ntitle: 'Quick Demo - Add Windows Performance Collection Rule [#opsmgr, #mpauthoring]'\ntags:\n  - Management Pack\n  - MP Development\n  - OpsMgr\n  - Video\nid: 764\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2013-02-21 09:25:39\n---\n\nBy request, I uploaded a short clip demonstrating how you would add a windows performance counter to a performance collection rule using the Authoring Console.\n\nIt is a fairly simple task to complete but does require the [Authoring Console](http://www.microsoft.com/en-us/download/details.aspx?id=18222 \"System Center Operations Manager 2007 R2 Authoring Resource Kit\"), obviously, and a better target class than what I use in the demo. The demo also assumes that this counter exist on all the targeted servers in your environment. It would be wise, when making your management pack, to check that it's there on all targeted operating systems, and that's what I use Performance Monitor for. (just search for _perfmon_ in your start menu or run perfmon.exe)\n\nEnjoy.\n\n[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/4G4aXslrjvQ/0.jpg)](http://www.youtube.com/watch?v=4G4aXslrjvQ)\n","slug":"quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring","published":1,"updated":"2016-05-24T21:22:37.292Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jm002vq4o2mewjflqv","content":"<p>By request, I uploaded a short clip demonstrating how you would add a windows performance counter to a performance collection rule using the Authoring Console.</p>\n<p>It is a fairly simple task to complete but does require the <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=18222\" title=\"System Center Operations Manager 2007 R2 Authoring Resource Kit\" target=\"_blank\" rel=\"external\">Authoring Console</a>, obviously, and a better target class than what I use in the demo. The demo also assumes that this counter exist on all the targeted servers in your environment. It would be wise, when making your management pack, to check that it’s there on all targeted operating systems, and that’s what I use Performance Monitor for. (just search for <em>perfmon</em> in your start menu or run perfmon.exe)</p>\n<p>Enjoy.</p>\n<p><a href=\"http://www.youtube.com/watch?v=4G4aXslrjvQ\" target=\"_blank\" rel=\"external\"><img src=\"http://img.youtube.com/vi/4G4aXslrjvQ/0.jpg\" alt=\"IMAGE ALT TEXT HERE\"></a></p>\n","excerpt":"","more":"<p>By request, I uploaded a short clip demonstrating how you would add a windows performance counter to a performance collection rule using the Authoring Console.</p>\n<p>It is a fairly simple task to complete but does require the <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=18222\" title=\"System Center Operations Manager 2007 R2 Authoring Resource Kit\">Authoring Console</a>, obviously, and a better target class than what I use in the demo. The demo also assumes that this counter exist on all the targeted servers in your environment. It would be wise, when making your management pack, to check that it’s there on all targeted operating systems, and that’s what I use Performance Monitor for. (just search for <em>perfmon</em> in your start menu or run perfmon.exe)</p>\n<p>Enjoy.</p>\n<p><a href=\"http://www.youtube.com/watch?v=4G4aXslrjvQ\"><img src=\"http://img.youtube.com/vi/4G4aXslrjvQ/0.jpg\" alt=\"IMAGE ALT TEXT HERE\"></a></p>\n"},{"title":"Quick-Hack: Send SMS through Powershell [#powershell]","id":"607","date":"2012-05-15T13:14:00.000Z","_content":"\nDecided to do a quick-hack/fast-publish on this one as I have had a bit less time to create a nice clean production-ready version as of yet... and people has been asking about how far off the article is.\n\nWhat this script does is to send a text message using a GSM/GPRS modem connected to a local (or LAN-connected with local drivers) serial port using Powershell.\n\n# Disclaimer!\n\nThis script \"works\" but is not fit for production. See it as an example of the general concept to evolve and adapt into something worthy of production use.\n\nWhat's missing in the latest iteration is:\n\n* A working Event-Handler to deal with asynchronous call-backs.\n* Support for AT+MSGW (write to modem memory)\n* Reusing messages in modem memory for multiple recipients.\n* Various error- and exeption-handlers.\n* Actually verifying that the modem is AT-capable.\n* Querying the system for available modems and their ports.\n\n\n# The Script\n\nSo, a short note before digging into the script. Prerequisites for this script is that you have identified which COM-port to use and it's supported baud-rates and whether it supports DTR or not. If you do not know what the hell I am talking about, you could probably have it work with my preconfigured settings anyway. If you are unsure about if your modem supports AT commands you could open a serial connection to the modem using Hyperterminal or PuTTY and run AT+CMGF=1\\. If supported, the return should be OK. If it is not supported (you get ERROR instead) you would have to use PDU-mode which require a bit of hex-encoding of your messages. This is nothing I have had to do yet and will not be including in this script. Maybe in the future. Maybe.\n\nSo, looking a some powershelling then. First thing would be to connect to the modem.\n\n```powershell\n# Create your instance of the SerialPort Class\n$serialPort = new-Object System.IO.Ports.SerialPort\n# Set various COM-port settings\n$serialPort.PortName = \"COM1\"\n$serialPort.BaudRate = 19200\n$serialPort.WriteTimeout = 500\n$serialPort.ReadTimeout = 3000\n$serialPort.DtrEnable = \"true\"\n# Open the connection\n$serialPort.Open()\n```\n\nWith the connection established, you the set to modem in AT-mode and start sending the message to the modem.\n\n```powershell\n# Tell the modem you want to use AT-mode\n$serialPort.Write(\"AT+CMGF=1`r`n\")\n\n# Start feeding message data to the modem\n# Begin with the phone number, international\n# style and a <CL>... that's the `r`n part\n$serialPort.Write(\"AT+CMGS=`\"+46888888888`\"`r`n\")\n\n# Now, write the message to the modem\n$serialPort.Write(\"This is a test!`r`n\")\n\n# Send a Ctrl+Z to end the message.\n$serialPort.Write($([char] 26))\n```\n\nAs you may notice, the message is only stored in the modems memory until you send a Ctrl+z which will end the message and send it. It is possible to add more text to the message before sending it if you would like. Personally, I prefer to store the message into a regular powershell variable and pass that one to the script. The SerialPort library is sort of clever and a local phone number will probably work. For safety, I always use international number with country code as it will work every time.\n\nOnly thing left now is to close the serial port connection and end the script. Like this.\n\n```powershell\n$serialPort.Close()\n```\n\n## The Copy/Paste part\n\nHere's the entire script with some added control-features and check to avoid trying to send text messages with no serial connection.\n\n```powershell\n### DISCLAIMER ###\n## This script is a quick-hack to demonstrate\n## the basics of sending an SMS using an AT-\n## compatible GSM modem connected a local\n## serial port through PowerShell.\n## No error-handling is implemented and this\n## is NOT a script fit for production.\n##################\n\n# Create your instance of the SerialPort Class\n$serialPort = new-Object System.IO.Ports.SerialPort\n# Set various COM-port settings\n$serialPort.PortName = \"COM1\"\n$serialPort.BaudRate = 19200\n$serialPort.WriteTimeout = 500\n$serialPort.ReadTimeout = 3000\n$serialPort.DtrEnable = \"true\"\n# Open the connection\n$serialPort.Open()\n# Add variables for phone number and the message.\n$phoneNumber = \"+46888888888\"\n$textMessage = \"This is a test message!\"\n\ntry {\n $serialPort.Open()\n}\ncatch {\n # Wait for 5s and try again\n # Told you this is a quick-hack, right?\n Start-Sleep -Seconds 5\n $serialPort.Open()\n}\nIf ($serialPort.IsOpen -eq $true) {\n # Tell the modem you want to use AT-mode\n $serialPort.Write(\"AT+CMGF=1`r`n\")\n # Start feeding message data to the modem\n # Begin with the phone number, international\n # style and a <CL>... that's the `r`n part\n $serialPort.Write(\"AT+CMGS=`\"$phoneNumber`\"`r`n\")\n # Give the modem some time to react...\n Start-Sleep -Seconds 1\n # Now, write the message to the modem\n $serialPort.Write(\"$textMessage`r`n\")\n # Send a Ctrl+Z to end the message.\n $serialPort.Write($([char] 26))\n # Wait for modem to send it\n Start-Sleep -Seconds 1\n}\n# Close the Serial Port connection\n$serialPort.Close()\nif ($serialPort.IsOpen -eq $false) {\n echo \"Port Closed!\"\n}\n\n# That's all folks\n# Now, add call-backs, event-handlers, and return-\n# message handling.\n```\n\nEnjoy!","source":"_posts/quick-hack-send-sms-through-powershell-powershell.md","raw":"---\ntitle: 'Quick-Hack: Send SMS through Powershell [#powershell]'\ntags:\n  - GSM\n  - PoSH\n  - Quick-hack\n  - SMS\nid: 607\ncategories:\n  - Code\n  - PoSH\ndate: 2012-05-15 15:14:00\n---\n\nDecided to do a quick-hack/fast-publish on this one as I have had a bit less time to create a nice clean production-ready version as of yet... and people has been asking about how far off the article is.\n\nWhat this script does is to send a text message using a GSM/GPRS modem connected to a local (or LAN-connected with local drivers) serial port using Powershell.\n\n# Disclaimer!\n\nThis script \"works\" but is not fit for production. See it as an example of the general concept to evolve and adapt into something worthy of production use.\n\nWhat's missing in the latest iteration is:\n\n* A working Event-Handler to deal with asynchronous call-backs.\n* Support for AT+MSGW (write to modem memory)\n* Reusing messages in modem memory for multiple recipients.\n* Various error- and exeption-handlers.\n* Actually verifying that the modem is AT-capable.\n* Querying the system for available modems and their ports.\n\n\n# The Script\n\nSo, a short note before digging into the script. Prerequisites for this script is that you have identified which COM-port to use and it's supported baud-rates and whether it supports DTR or not. If you do not know what the hell I am talking about, you could probably have it work with my preconfigured settings anyway. If you are unsure about if your modem supports AT commands you could open a serial connection to the modem using Hyperterminal or PuTTY and run AT+CMGF=1\\. If supported, the return should be OK. If it is not supported (you get ERROR instead) you would have to use PDU-mode which require a bit of hex-encoding of your messages. This is nothing I have had to do yet and will not be including in this script. Maybe in the future. Maybe.\n\nSo, looking a some powershelling then. First thing would be to connect to the modem.\n\n```powershell\n# Create your instance of the SerialPort Class\n$serialPort = new-Object System.IO.Ports.SerialPort\n# Set various COM-port settings\n$serialPort.PortName = \"COM1\"\n$serialPort.BaudRate = 19200\n$serialPort.WriteTimeout = 500\n$serialPort.ReadTimeout = 3000\n$serialPort.DtrEnable = \"true\"\n# Open the connection\n$serialPort.Open()\n```\n\nWith the connection established, you the set to modem in AT-mode and start sending the message to the modem.\n\n```powershell\n# Tell the modem you want to use AT-mode\n$serialPort.Write(\"AT+CMGF=1`r`n\")\n\n# Start feeding message data to the modem\n# Begin with the phone number, international\n# style and a <CL>... that's the `r`n part\n$serialPort.Write(\"AT+CMGS=`\"+46888888888`\"`r`n\")\n\n# Now, write the message to the modem\n$serialPort.Write(\"This is a test!`r`n\")\n\n# Send a Ctrl+Z to end the message.\n$serialPort.Write($([char] 26))\n```\n\nAs you may notice, the message is only stored in the modems memory until you send a Ctrl+z which will end the message and send it. It is possible to add more text to the message before sending it if you would like. Personally, I prefer to store the message into a regular powershell variable and pass that one to the script. The SerialPort library is sort of clever and a local phone number will probably work. For safety, I always use international number with country code as it will work every time.\n\nOnly thing left now is to close the serial port connection and end the script. Like this.\n\n```powershell\n$serialPort.Close()\n```\n\n## The Copy/Paste part\n\nHere's the entire script with some added control-features and check to avoid trying to send text messages with no serial connection.\n\n```powershell\n### DISCLAIMER ###\n## This script is a quick-hack to demonstrate\n## the basics of sending an SMS using an AT-\n## compatible GSM modem connected a local\n## serial port through PowerShell.\n## No error-handling is implemented and this\n## is NOT a script fit for production.\n##################\n\n# Create your instance of the SerialPort Class\n$serialPort = new-Object System.IO.Ports.SerialPort\n# Set various COM-port settings\n$serialPort.PortName = \"COM1\"\n$serialPort.BaudRate = 19200\n$serialPort.WriteTimeout = 500\n$serialPort.ReadTimeout = 3000\n$serialPort.DtrEnable = \"true\"\n# Open the connection\n$serialPort.Open()\n# Add variables for phone number and the message.\n$phoneNumber = \"+46888888888\"\n$textMessage = \"This is a test message!\"\n\ntry {\n $serialPort.Open()\n}\ncatch {\n # Wait for 5s and try again\n # Told you this is a quick-hack, right?\n Start-Sleep -Seconds 5\n $serialPort.Open()\n}\nIf ($serialPort.IsOpen -eq $true) {\n # Tell the modem you want to use AT-mode\n $serialPort.Write(\"AT+CMGF=1`r`n\")\n # Start feeding message data to the modem\n # Begin with the phone number, international\n # style and a <CL>... that's the `r`n part\n $serialPort.Write(\"AT+CMGS=`\"$phoneNumber`\"`r`n\")\n # Give the modem some time to react...\n Start-Sleep -Seconds 1\n # Now, write the message to the modem\n $serialPort.Write(\"$textMessage`r`n\")\n # Send a Ctrl+Z to end the message.\n $serialPort.Write($([char] 26))\n # Wait for modem to send it\n Start-Sleep -Seconds 1\n}\n# Close the Serial Port connection\n$serialPort.Close()\nif ($serialPort.IsOpen -eq $false) {\n echo \"Port Closed!\"\n}\n\n# That's all folks\n# Now, add call-backs, event-handlers, and return-\n# message handling.\n```\n\nEnjoy!","slug":"quick-hack-send-sms-through-powershell-powershell","published":1,"updated":"2016-05-24T21:20:26.798Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jp0030q4o26vds18qu","content":"<p>Decided to do a quick-hack/fast-publish on this one as I have had a bit less time to create a nice clean production-ready version as of yet… and people has been asking about how far off the article is.</p>\n<p>What this script does is to send a text message using a GSM/GPRS modem connected to a local (or LAN-connected with local drivers) serial port using Powershell.</p>\n<h1 id=\"Disclaimer\"><a href=\"#Disclaimer\" class=\"headerlink\" title=\"Disclaimer!\"></a>Disclaimer!</h1><p>This script “works” but is not fit for production. See it as an example of the general concept to evolve and adapt into something worthy of production use.</p>\n<p>What’s missing in the latest iteration is:</p>\n<ul>\n<li>A working Event-Handler to deal with asynchronous call-backs.</li>\n<li>Support for AT+MSGW (write to modem memory)</li>\n<li>Reusing messages in modem memory for multiple recipients.</li>\n<li>Various error- and exeption-handlers.</li>\n<li>Actually verifying that the modem is AT-capable.</li>\n<li>Querying the system for available modems and their ports.</li>\n</ul>\n<h1 id=\"The-Script\"><a href=\"#The-Script\" class=\"headerlink\" title=\"The Script\"></a>The Script</h1><p>So, a short note before digging into the script. Prerequisites for this script is that you have identified which COM-port to use and it’s supported baud-rates and whether it supports DTR or not. If you do not know what the hell I am talking about, you could probably have it work with my preconfigured settings anyway. If you are unsure about if your modem supports AT commands you could open a serial connection to the modem using Hyperterminal or PuTTY and run AT+CMGF=1. If supported, the return should be OK. If it is not supported (you get ERROR instead) you would have to use PDU-mode which require a bit of hex-encoding of your messages. This is nothing I have had to do yet and will not be including in this script. Maybe in the future. Maybe.</p>\n<p>So, looking a some powershelling then. First thing would be to connect to the modem.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Create your instance of the SerialPort Class</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span> = <span class=\"built_in\">new-Object</span> System.IO.Ports.SerialPort</span><br><span class=\"line\"><span class=\"comment\"># Set various COM-port settings</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.PortName = <span class=\"string\">\"COM1\"</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.BaudRate = <span class=\"number\">19200</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.WriteTimeout = <span class=\"number\">500</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.ReadTimeout = <span class=\"number\">3000</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.DtrEnable = <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"comment\"># Open the connection</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Open()</span><br></pre></td></tr></table></figure>\n<p>With the connection established, you the set to modem in AT-mode and start sending the message to the modem.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Tell the modem you want to use AT-mode</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGF=1`r`n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Start feeding message data to the modem</span></span><br><span class=\"line\"><span class=\"comment\"># Begin with the phone number, international</span></span><br><span class=\"line\"><span class=\"comment\"># style and a &lt;CL&gt;... that's the `r`n part</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGS=`\"+46888888888`\"`r`n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Now, write the message to the modem</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"This is a test!`r`n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Send a Ctrl+Z to end the message.</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write($([char] <span class=\"number\">26</span>))</span><br></pre></td></tr></table></figure>\n<p>As you may notice, the message is only stored in the modems memory until you send a Ctrl+z which will end the message and send it. It is possible to add more text to the message before sending it if you would like. Personally, I prefer to store the message into a regular powershell variable and pass that one to the script. The SerialPort library is sort of clever and a local phone number will probably work. For safety, I always use international number with country code as it will work every time.</p>\n<p>Only thing left now is to close the serial port connection and end the script. Like this.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$serialPort</span>.Close()</span><br></pre></td></tr></table></figure>\n<h2 id=\"The-Copy-Paste-part\"><a href=\"#The-Copy-Paste-part\" class=\"headerlink\" title=\"The Copy/Paste part\"></a>The Copy/Paste part</h2><p>Here’s the entire script with some added control-features and check to avoid trying to send text messages with no serial connection.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### DISCLAIMER ###</span></span><br><span class=\"line\"><span class=\"comment\">## This script is a quick-hack to demonstrate</span></span><br><span class=\"line\"><span class=\"comment\">## the basics of sending an SMS using an AT-</span></span><br><span class=\"line\"><span class=\"comment\">## compatible GSM modem connected a local</span></span><br><span class=\"line\"><span class=\"comment\">## serial port through PowerShell.</span></span><br><span class=\"line\"><span class=\"comment\">## No error-handling is implemented and this</span></span><br><span class=\"line\"><span class=\"comment\">## is NOT a script fit for production.</span></span><br><span class=\"line\"><span class=\"comment\">##################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Create your instance of the SerialPort Class</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span> = <span class=\"built_in\">new-Object</span> System.IO.Ports.SerialPort</span><br><span class=\"line\"><span class=\"comment\"># Set various COM-port settings</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.PortName = <span class=\"string\">\"COM1\"</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.BaudRate = <span class=\"number\">19200</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.WriteTimeout = <span class=\"number\">500</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.ReadTimeout = <span class=\"number\">3000</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.DtrEnable = <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"comment\"># Open the connection</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Open()</span><br><span class=\"line\"><span class=\"comment\"># Add variables for phone number and the message.</span></span><br><span class=\"line\"><span class=\"variable\">$phoneNumber</span> = <span class=\"string\">\"+46888888888\"</span></span><br><span class=\"line\"><span class=\"variable\">$textMessage</span> = <span class=\"string\">\"This is a test message!\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Open()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">catch</span> &#123;</span><br><span class=\"line\"> <span class=\"comment\"># Wait for 5s and try again</span></span><br><span class=\"line\"> <span class=\"comment\"># Told you this is a quick-hack, right?</span></span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">5</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Open()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">If</span> (<span class=\"variable\">$serialPort</span>.IsOpen <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$true</span>) &#123;</span><br><span class=\"line\"> <span class=\"comment\"># Tell the modem you want to use AT-mode</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGF=1`r`n\"</span>)</span><br><span class=\"line\"> <span class=\"comment\"># Start feeding message data to the modem</span></span><br><span class=\"line\"> <span class=\"comment\"># Begin with the phone number, international</span></span><br><span class=\"line\"> <span class=\"comment\"># style and a &lt;CL&gt;... that's the `r`n part</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGS=`\"<span class=\"variable\">$phoneNumber</span>`\"`r`n\"</span>)</span><br><span class=\"line\"> <span class=\"comment\"># Give the modem some time to react...</span></span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">1</span></span><br><span class=\"line\"> <span class=\"comment\"># Now, write the message to the modem</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"<span class=\"variable\">$textMessage</span>`r`n\"</span>)</span><br><span class=\"line\"> <span class=\"comment\"># Send a Ctrl+Z to end the message.</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write($([char] <span class=\"number\">26</span>))</span><br><span class=\"line\"> <span class=\"comment\"># Wait for modem to send it</span></span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># Close the Serial Port connection</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Close()</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$serialPort</span>.IsOpen <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$false</span>) &#123;</span><br><span class=\"line\"> echo <span class=\"string\">\"Port Closed!\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># That's all folks</span></span><br><span class=\"line\"><span class=\"comment\"># Now, add call-backs, event-handlers, and return-</span></span><br><span class=\"line\"><span class=\"comment\"># message handling.</span></span><br></pre></td></tr></table></figure>\n<p>Enjoy!</p>\n","excerpt":"","more":"<p>Decided to do a quick-hack/fast-publish on this one as I have had a bit less time to create a nice clean production-ready version as of yet… and people has been asking about how far off the article is.</p>\n<p>What this script does is to send a text message using a GSM/GPRS modem connected to a local (or LAN-connected with local drivers) serial port using Powershell.</p>\n<h1 id=\"Disclaimer\"><a href=\"#Disclaimer\" class=\"headerlink\" title=\"Disclaimer!\"></a>Disclaimer!</h1><p>This script “works” but is not fit for production. See it as an example of the general concept to evolve and adapt into something worthy of production use.</p>\n<p>What’s missing in the latest iteration is:</p>\n<ul>\n<li>A working Event-Handler to deal with asynchronous call-backs.</li>\n<li>Support for AT+MSGW (write to modem memory)</li>\n<li>Reusing messages in modem memory for multiple recipients.</li>\n<li>Various error- and exeption-handlers.</li>\n<li>Actually verifying that the modem is AT-capable.</li>\n<li>Querying the system for available modems and their ports.</li>\n</ul>\n<h1 id=\"The-Script\"><a href=\"#The-Script\" class=\"headerlink\" title=\"The Script\"></a>The Script</h1><p>So, a short note before digging into the script. Prerequisites for this script is that you have identified which COM-port to use and it’s supported baud-rates and whether it supports DTR or not. If you do not know what the hell I am talking about, you could probably have it work with my preconfigured settings anyway. If you are unsure about if your modem supports AT commands you could open a serial connection to the modem using Hyperterminal or PuTTY and run AT+CMGF=1. If supported, the return should be OK. If it is not supported (you get ERROR instead) you would have to use PDU-mode which require a bit of hex-encoding of your messages. This is nothing I have had to do yet and will not be including in this script. Maybe in the future. Maybe.</p>\n<p>So, looking a some powershelling then. First thing would be to connect to the modem.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Create your instance of the SerialPort Class</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span> = <span class=\"built_in\">new-Object</span> System.IO.Ports.SerialPort</span><br><span class=\"line\"><span class=\"comment\"># Set various COM-port settings</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.PortName = <span class=\"string\">\"COM1\"</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.BaudRate = <span class=\"number\">19200</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.WriteTimeout = <span class=\"number\">500</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.ReadTimeout = <span class=\"number\">3000</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.DtrEnable = <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"comment\"># Open the connection</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Open()</span><br></pre></td></tr></table></figure>\n<p>With the connection established, you the set to modem in AT-mode and start sending the message to the modem.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Tell the modem you want to use AT-mode</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGF=1`r`n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Start feeding message data to the modem</span></span><br><span class=\"line\"><span class=\"comment\"># Begin with the phone number, international</span></span><br><span class=\"line\"><span class=\"comment\"># style and a &lt;CL&gt;... that's the `r`n part</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGS=`\"+46888888888`\"`r`n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Now, write the message to the modem</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"This is a test!`r`n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Send a Ctrl+Z to end the message.</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Write($([char] <span class=\"number\">26</span>))</span><br></pre></td></tr></table></figure>\n<p>As you may notice, the message is only stored in the modems memory until you send a Ctrl+z which will end the message and send it. It is possible to add more text to the message before sending it if you would like. Personally, I prefer to store the message into a regular powershell variable and pass that one to the script. The SerialPort library is sort of clever and a local phone number will probably work. For safety, I always use international number with country code as it will work every time.</p>\n<p>Only thing left now is to close the serial port connection and end the script. Like this.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$serialPort</span>.Close()</span><br></pre></td></tr></table></figure>\n<h2 id=\"The-Copy-Paste-part\"><a href=\"#The-Copy-Paste-part\" class=\"headerlink\" title=\"The Copy/Paste part\"></a>The Copy/Paste part</h2><p>Here’s the entire script with some added control-features and check to avoid trying to send text messages with no serial connection.</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### DISCLAIMER ###</span></span><br><span class=\"line\"><span class=\"comment\">## This script is a quick-hack to demonstrate</span></span><br><span class=\"line\"><span class=\"comment\">## the basics of sending an SMS using an AT-</span></span><br><span class=\"line\"><span class=\"comment\">## compatible GSM modem connected a local</span></span><br><span class=\"line\"><span class=\"comment\">## serial port through PowerShell.</span></span><br><span class=\"line\"><span class=\"comment\">## No error-handling is implemented and this</span></span><br><span class=\"line\"><span class=\"comment\">## is NOT a script fit for production.</span></span><br><span class=\"line\"><span class=\"comment\">##################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Create your instance of the SerialPort Class</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span> = <span class=\"built_in\">new-Object</span> System.IO.Ports.SerialPort</span><br><span class=\"line\"><span class=\"comment\"># Set various COM-port settings</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.PortName = <span class=\"string\">\"COM1\"</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.BaudRate = <span class=\"number\">19200</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.WriteTimeout = <span class=\"number\">500</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.ReadTimeout = <span class=\"number\">3000</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.DtrEnable = <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"comment\"># Open the connection</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Open()</span><br><span class=\"line\"><span class=\"comment\"># Add variables for phone number and the message.</span></span><br><span class=\"line\"><span class=\"variable\">$phoneNumber</span> = <span class=\"string\">\"+46888888888\"</span></span><br><span class=\"line\"><span class=\"variable\">$textMessage</span> = <span class=\"string\">\"This is a test message!\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Open()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">catch</span> &#123;</span><br><span class=\"line\"> <span class=\"comment\"># Wait for 5s and try again</span></span><br><span class=\"line\"> <span class=\"comment\"># Told you this is a quick-hack, right?</span></span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">5</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Open()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">If</span> (<span class=\"variable\">$serialPort</span>.IsOpen <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$true</span>) &#123;</span><br><span class=\"line\"> <span class=\"comment\"># Tell the modem you want to use AT-mode</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGF=1`r`n\"</span>)</span><br><span class=\"line\"> <span class=\"comment\"># Start feeding message data to the modem</span></span><br><span class=\"line\"> <span class=\"comment\"># Begin with the phone number, international</span></span><br><span class=\"line\"> <span class=\"comment\"># style and a &lt;CL&gt;... that's the `r`n part</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"AT+CMGS=`\"<span class=\"variable\">$phoneNumber</span>`\"`r`n\"</span>)</span><br><span class=\"line\"> <span class=\"comment\"># Give the modem some time to react...</span></span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">1</span></span><br><span class=\"line\"> <span class=\"comment\"># Now, write the message to the modem</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write(<span class=\"string\">\"<span class=\"variable\">$textMessage</span>`r`n\"</span>)</span><br><span class=\"line\"> <span class=\"comment\"># Send a Ctrl+Z to end the message.</span></span><br><span class=\"line\"> <span class=\"variable\">$serialPort</span>.Write($([char] <span class=\"number\">26</span>))</span><br><span class=\"line\"> <span class=\"comment\"># Wait for modem to send it</span></span><br><span class=\"line\"> <span class=\"built_in\">Start-Sleep</span> -Seconds <span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># Close the Serial Port connection</span></span><br><span class=\"line\"><span class=\"variable\">$serialPort</span>.Close()</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$serialPort</span>.IsOpen <span class=\"nomarkup\">-eq</span> <span class=\"literal\">$false</span>) &#123;</span><br><span class=\"line\"> echo <span class=\"string\">\"Port Closed!\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># That's all folks</span></span><br><span class=\"line\"><span class=\"comment\"># Now, add call-backs, event-handlers, and return-</span></span><br><span class=\"line\"><span class=\"comment\"># message handling.</span></span><br></pre></td></tr></table></figure>\n<p>Enjoy!</p>\n"},{"title":"Rant - The Concept of Booth-Babes","id":"603","date":"2012-05-08T16:18:05.000Z","_content":"\n# Background\n\nHaving visited a few conferences in the last years I have spotted a trend I didn't think I would see in the IT-Pro sphere. You could probably call me naïve for that but logically we should not encourage this trend. This is my appeal to all exhibitors of future conferences to re-evaluate the concept of booth-babes.\n\nI will not go into the genus-political part of this discussion as of now--others are more eloquent and fit to handle that--but rather some of the more pragmatic sides to ditch the BB (short for Booth-Babe) and how that would gain us visitors as well as the exhibitors. I will also keep a pretty frank, and perhaps impolite, tone in this rant of mine.\n\nSo, here's my top reasons, in no particular order, to give up the BBs.\n\n<!--more-->\n\n## Reason #1 - BBs is disrupting the purpose of the exhibition\n\nWhen I go to a conference, I am there for the tech, to network and shake paws with the people I collaborate with on-line. It is also a good place to meet the actual corporations that I do business with and discuss their products between four eyes.\nI do not want to plow through a crowd of great white whales [Oops! I meant \"males\"] ogling the BBs to get to someone with actual knowledge about the products and solutions at hand.\n\n## Reason #2 - BBs are alienating the visitors\n\nIf you are a heterosexual male or a homosexual female, the BBs can actually make you embarrassed, shy and unwilling to approach the exhibitor for that sole reason.\nIf you are not, you might find an exhibitor with BBs appalling and take another route for that sole reason.\n\n## Reason #3 - BBs are intimidating the female visitors\n\nThere is, of course, exceptions to this, but I actually discussed this matter with a couple of gentlewomen in the alumni lounge and they did say that they are both appalled and intimidated to the slightly clad BBs at one particular booth at this years MMS. They even used terms like \"ridiculous\" and \"waste of space\" to describe the phenomena.\nNow, I believe I can hear some of you readers thinking \"what? Nice addition to the boring screens and ...\". But imaging the opposite for a while. Imagine a whole bunch of Booth-Hunks instead. You know, Brad Pitt in Fight Club and the likes. I know I would be intimidated by that kind of display.\n\n## Reason #4 - BBs makes it hard to know who to talk to\n\nBecause of the BBs, it can at time be hard to know if the lady at the booth just happen to be a nice-looking knowledgeable tech-specialist or simply someone there for eye-candy. Too many times have I had a conversation like this:\n\n```text\n- \"Hi! So, tell me about [SystemX]. It looks kinda interesting on paper.\"\n- \"Hi! Uh, oh! Yeah! You should probably be talking to that guy over there. I don't really know anything about their stuff.\"\n```\n\nI hate it. I want to be able to pick anyone in the booth and get a cohesive answer. You cannot be expert on everything and some people are more marketing focused, but at least they can give you the big picture before calling some techy fellow. Last year I had a really nice discussion with a nice lady from EMC that later led to get access to to some beta code. Unfortunately, I had by then grown tired of the BBs and merely approached her since there were lines to the male exhibitors. Which brings me to...\n\n## Reason #5 - Having BBs is disrespecting your female colleagues.\n\nThere you are. You most certainly have some very talented women in your development teams--my experience is that's where you'll find most of them, as architects and lead developers--but for some reason your decide to hire a bunch of BBs to \"spice it up a little\", \"draw a little crowd\", \"get the attention\" and so forth. Do you really think your female colleagues appreciate that? Isn't that diminishing their talent a bit? I am sure that those who attend conferences for technical reasons and to do a bit of networking would take a nice technical discussion with anyone, however geeky she/he might be, rather than side-stepping a crowd or some figure-head on my way there.\n\nI don't know. Maybe I am alone in this matter, but I'd really like to see this change. I would really like to see vendors and exhibitors trying to dazzle the visitors with great displays, clever uses of software and mind-blowing products and not scantily clad women.\n\nAh, well. Thanks for your time.","source":"_posts/rant-the-concept-of-booth-babes.md","raw":"---\ntitle: Rant - The Concept of Booth-Babes\ntags:\n  - Conference\n  - Rant\nid: 603\ncategories:\n  - Technobabble\ndate: 2012-05-08 18:18:05\n---\n\n# Background\n\nHaving visited a few conferences in the last years I have spotted a trend I didn't think I would see in the IT-Pro sphere. You could probably call me naïve for that but logically we should not encourage this trend. This is my appeal to all exhibitors of future conferences to re-evaluate the concept of booth-babes.\n\nI will not go into the genus-political part of this discussion as of now--others are more eloquent and fit to handle that--but rather some of the more pragmatic sides to ditch the BB (short for Booth-Babe) and how that would gain us visitors as well as the exhibitors. I will also keep a pretty frank, and perhaps impolite, tone in this rant of mine.\n\nSo, here's my top reasons, in no particular order, to give up the BBs.\n\n<!--more-->\n\n## Reason #1 - BBs is disrupting the purpose of the exhibition\n\nWhen I go to a conference, I am there for the tech, to network and shake paws with the people I collaborate with on-line. It is also a good place to meet the actual corporations that I do business with and discuss their products between four eyes.\nI do not want to plow through a crowd of great white whales [Oops! I meant \"males\"] ogling the BBs to get to someone with actual knowledge about the products and solutions at hand.\n\n## Reason #2 - BBs are alienating the visitors\n\nIf you are a heterosexual male or a homosexual female, the BBs can actually make you embarrassed, shy and unwilling to approach the exhibitor for that sole reason.\nIf you are not, you might find an exhibitor with BBs appalling and take another route for that sole reason.\n\n## Reason #3 - BBs are intimidating the female visitors\n\nThere is, of course, exceptions to this, but I actually discussed this matter with a couple of gentlewomen in the alumni lounge and they did say that they are both appalled and intimidated to the slightly clad BBs at one particular booth at this years MMS. They even used terms like \"ridiculous\" and \"waste of space\" to describe the phenomena.\nNow, I believe I can hear some of you readers thinking \"what? Nice addition to the boring screens and ...\". But imaging the opposite for a while. Imagine a whole bunch of Booth-Hunks instead. You know, Brad Pitt in Fight Club and the likes. I know I would be intimidated by that kind of display.\n\n## Reason #4 - BBs makes it hard to know who to talk to\n\nBecause of the BBs, it can at time be hard to know if the lady at the booth just happen to be a nice-looking knowledgeable tech-specialist or simply someone there for eye-candy. Too many times have I had a conversation like this:\n\n```text\n- \"Hi! So, tell me about [SystemX]. It looks kinda interesting on paper.\"\n- \"Hi! Uh, oh! Yeah! You should probably be talking to that guy over there. I don't really know anything about their stuff.\"\n```\n\nI hate it. I want to be able to pick anyone in the booth and get a cohesive answer. You cannot be expert on everything and some people are more marketing focused, but at least they can give you the big picture before calling some techy fellow. Last year I had a really nice discussion with a nice lady from EMC that later led to get access to to some beta code. Unfortunately, I had by then grown tired of the BBs and merely approached her since there were lines to the male exhibitors. Which brings me to...\n\n## Reason #5 - Having BBs is disrespecting your female colleagues.\n\nThere you are. You most certainly have some very talented women in your development teams--my experience is that's where you'll find most of them, as architects and lead developers--but for some reason your decide to hire a bunch of BBs to \"spice it up a little\", \"draw a little crowd\", \"get the attention\" and so forth. Do you really think your female colleagues appreciate that? Isn't that diminishing their talent a bit? I am sure that those who attend conferences for technical reasons and to do a bit of networking would take a nice technical discussion with anyone, however geeky she/he might be, rather than side-stepping a crowd or some figure-head on my way there.\n\nI don't know. Maybe I am alone in this matter, but I'd really like to see this change. I would really like to see vendors and exhibitors trying to dazzle the visitors with great displays, clever uses of software and mind-blowing products and not scantily clad women.\n\nAh, well. Thanks for your time.","slug":"rant-the-concept-of-booth-babes","published":1,"updated":"2016-05-24T21:16:15.167Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jt0032q4o2tuhlm8dc","content":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>Having visited a few conferences in the last years I have spotted a trend I didn’t think I would see in the IT-Pro sphere. You could probably call me naïve for that but logically we should not encourage this trend. This is my appeal to all exhibitors of future conferences to re-evaluate the concept of booth-babes.</p>\n<p>I will not go into the genus-political part of this discussion as of now–others are more eloquent and fit to handle that–but rather some of the more pragmatic sides to ditch the BB (short for Booth-Babe) and how that would gain us visitors as well as the exhibitors. I will also keep a pretty frank, and perhaps impolite, tone in this rant of mine.</p>\n<p>So, here’s my top reasons, in no particular order, to give up the BBs.</p>\n<a id=\"more\"></a>\n<h2 id=\"Reason-1-BBs-is-disrupting-the-purpose-of-the-exhibition\"><a href=\"#Reason-1-BBs-is-disrupting-the-purpose-of-the-exhibition\" class=\"headerlink\" title=\"Reason #1 - BBs is disrupting the purpose of the exhibition\"></a>Reason #1 - BBs is disrupting the purpose of the exhibition</h2><p>When I go to a conference, I am there for the tech, to network and shake paws with the people I collaborate with on-line. It is also a good place to meet the actual corporations that I do business with and discuss their products between four eyes.<br>I do not want to plow through a crowd of great white whales [Oops! I meant “males”] ogling the BBs to get to someone with actual knowledge about the products and solutions at hand.</p>\n<h2 id=\"Reason-2-BBs-are-alienating-the-visitors\"><a href=\"#Reason-2-BBs-are-alienating-the-visitors\" class=\"headerlink\" title=\"Reason #2 - BBs are alienating the visitors\"></a>Reason #2 - BBs are alienating the visitors</h2><p>If you are a heterosexual male or a homosexual female, the BBs can actually make you embarrassed, shy and unwilling to approach the exhibitor for that sole reason.<br>If you are not, you might find an exhibitor with BBs appalling and take another route for that sole reason.</p>\n<h2 id=\"Reason-3-BBs-are-intimidating-the-female-visitors\"><a href=\"#Reason-3-BBs-are-intimidating-the-female-visitors\" class=\"headerlink\" title=\"Reason #3 - BBs are intimidating the female visitors\"></a>Reason #3 - BBs are intimidating the female visitors</h2><p>There is, of course, exceptions to this, but I actually discussed this matter with a couple of gentlewomen in the alumni lounge and they did say that they are both appalled and intimidated to the slightly clad BBs at one particular booth at this years MMS. They even used terms like “ridiculous” and “waste of space” to describe the phenomena.<br>Now, I believe I can hear some of you readers thinking “what? Nice addition to the boring screens and …”. But imaging the opposite for a while. Imagine a whole bunch of Booth-Hunks instead. You know, Brad Pitt in Fight Club and the likes. I know I would be intimidated by that kind of display.</p>\n<h2 id=\"Reason-4-BBs-makes-it-hard-to-know-who-to-talk-to\"><a href=\"#Reason-4-BBs-makes-it-hard-to-know-who-to-talk-to\" class=\"headerlink\" title=\"Reason #4 - BBs makes it hard to know who to talk to\"></a>Reason #4 - BBs makes it hard to know who to talk to</h2><p>Because of the BBs, it can at time be hard to know if the lady at the booth just happen to be a nice-looking knowledgeable tech-specialist or simply someone there for eye-candy. Too many times have I had a conversation like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">- &quot;Hi! So, tell me about [SystemX]. It looks kinda interesting on paper.&quot;</span><br><span class=\"line\">- &quot;Hi! Uh, oh! Yeah! You should probably be talking to that guy over there. I don&apos;t really know anything about their stuff.&quot;</span><br></pre></td></tr></table></figure>\n<p>I hate it. I want to be able to pick anyone in the booth and get a cohesive answer. You cannot be expert on everything and some people are more marketing focused, but at least they can give you the big picture before calling some techy fellow. Last year I had a really nice discussion with a nice lady from EMC that later led to get access to to some beta code. Unfortunately, I had by then grown tired of the BBs and merely approached her since there were lines to the male exhibitors. Which brings me to…</p>\n<h2 id=\"Reason-5-Having-BBs-is-disrespecting-your-female-colleagues\"><a href=\"#Reason-5-Having-BBs-is-disrespecting-your-female-colleagues\" class=\"headerlink\" title=\"Reason #5 - Having BBs is disrespecting your female colleagues.\"></a>Reason #5 - Having BBs is disrespecting your female colleagues.</h2><p>There you are. You most certainly have some very talented women in your development teams–my experience is that’s where you’ll find most of them, as architects and lead developers–but for some reason your decide to hire a bunch of BBs to “spice it up a little”, “draw a little crowd”, “get the attention” and so forth. Do you really think your female colleagues appreciate that? Isn’t that diminishing their talent a bit? I am sure that those who attend conferences for technical reasons and to do a bit of networking would take a nice technical discussion with anyone, however geeky she/he might be, rather than side-stepping a crowd or some figure-head on my way there.</p>\n<p>I don’t know. Maybe I am alone in this matter, but I’d really like to see this change. I would really like to see vendors and exhibitors trying to dazzle the visitors with great displays, clever uses of software and mind-blowing products and not scantily clad women.</p>\n<p>Ah, well. Thanks for your time.</p>\n","excerpt":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>Having visited a few conferences in the last years I have spotted a trend I didn’t think I would see in the IT-Pro sphere. You could probably call me naïve for that but logically we should not encourage this trend. This is my appeal to all exhibitors of future conferences to re-evaluate the concept of booth-babes.</p>\n<p>I will not go into the genus-political part of this discussion as of now–others are more eloquent and fit to handle that–but rather some of the more pragmatic sides to ditch the BB (short for Booth-Babe) and how that would gain us visitors as well as the exhibitors. I will also keep a pretty frank, and perhaps impolite, tone in this rant of mine.</p>\n<p>So, here’s my top reasons, in no particular order, to give up the BBs.</p>","more":"<h2 id=\"Reason-1-BBs-is-disrupting-the-purpose-of-the-exhibition\"><a href=\"#Reason-1-BBs-is-disrupting-the-purpose-of-the-exhibition\" class=\"headerlink\" title=\"Reason #1 - BBs is disrupting the purpose of the exhibition\"></a>Reason #1 - BBs is disrupting the purpose of the exhibition</h2><p>When I go to a conference, I am there for the tech, to network and shake paws with the people I collaborate with on-line. It is also a good place to meet the actual corporations that I do business with and discuss their products between four eyes.<br>I do not want to plow through a crowd of great white whales [Oops! I meant “males”] ogling the BBs to get to someone with actual knowledge about the products and solutions at hand.</p>\n<h2 id=\"Reason-2-BBs-are-alienating-the-visitors\"><a href=\"#Reason-2-BBs-are-alienating-the-visitors\" class=\"headerlink\" title=\"Reason #2 - BBs are alienating the visitors\"></a>Reason #2 - BBs are alienating the visitors</h2><p>If you are a heterosexual male or a homosexual female, the BBs can actually make you embarrassed, shy and unwilling to approach the exhibitor for that sole reason.<br>If you are not, you might find an exhibitor with BBs appalling and take another route for that sole reason.</p>\n<h2 id=\"Reason-3-BBs-are-intimidating-the-female-visitors\"><a href=\"#Reason-3-BBs-are-intimidating-the-female-visitors\" class=\"headerlink\" title=\"Reason #3 - BBs are intimidating the female visitors\"></a>Reason #3 - BBs are intimidating the female visitors</h2><p>There is, of course, exceptions to this, but I actually discussed this matter with a couple of gentlewomen in the alumni lounge and they did say that they are both appalled and intimidated to the slightly clad BBs at one particular booth at this years MMS. They even used terms like “ridiculous” and “waste of space” to describe the phenomena.<br>Now, I believe I can hear some of you readers thinking “what? Nice addition to the boring screens and …”. But imaging the opposite for a while. Imagine a whole bunch of Booth-Hunks instead. You know, Brad Pitt in Fight Club and the likes. I know I would be intimidated by that kind of display.</p>\n<h2 id=\"Reason-4-BBs-makes-it-hard-to-know-who-to-talk-to\"><a href=\"#Reason-4-BBs-makes-it-hard-to-know-who-to-talk-to\" class=\"headerlink\" title=\"Reason #4 - BBs makes it hard to know who to talk to\"></a>Reason #4 - BBs makes it hard to know who to talk to</h2><p>Because of the BBs, it can at time be hard to know if the lady at the booth just happen to be a nice-looking knowledgeable tech-specialist or simply someone there for eye-candy. Too many times have I had a conversation like this:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">- &quot;Hi! So, tell me about [SystemX]. It looks kinda interesting on paper.&quot;</span><br><span class=\"line\">- &quot;Hi! Uh, oh! Yeah! You should probably be talking to that guy over there. I don&apos;t really know anything about their stuff.&quot;</span><br></pre></td></tr></table></figure>\n<p>I hate it. I want to be able to pick anyone in the booth and get a cohesive answer. You cannot be expert on everything and some people are more marketing focused, but at least they can give you the big picture before calling some techy fellow. Last year I had a really nice discussion with a nice lady from EMC that later led to get access to to some beta code. Unfortunately, I had by then grown tired of the BBs and merely approached her since there were lines to the male exhibitors. Which brings me to…</p>\n<h2 id=\"Reason-5-Having-BBs-is-disrespecting-your-female-colleagues\"><a href=\"#Reason-5-Having-BBs-is-disrespecting-your-female-colleagues\" class=\"headerlink\" title=\"Reason #5 - Having BBs is disrespecting your female colleagues.\"></a>Reason #5 - Having BBs is disrespecting your female colleagues.</h2><p>There you are. You most certainly have some very talented women in your development teams–my experience is that’s where you’ll find most of them, as architects and lead developers–but for some reason your decide to hire a bunch of BBs to “spice it up a little”, “draw a little crowd”, “get the attention” and so forth. Do you really think your female colleagues appreciate that? Isn’t that diminishing their talent a bit? I am sure that those who attend conferences for technical reasons and to do a bit of networking would take a nice technical discussion with anyone, however geeky she/he might be, rather than side-stepping a crowd or some figure-head on my way there.</p>\n<p>I don’t know. Maybe I am alone in this matter, but I’d really like to see this change. I would really like to see vendors and exhibitors trying to dazzle the visitors with great displays, clever uses of software and mind-blowing products and not scantily clad women.</p>\n<p>Ah, well. Thanks for your time.</p>"},{"title":"(re)Gain sysadmin access to SQL2005 or SQL2008","id":"239","date":"2009-11-19T13:08:10.000Z","_content":"\nIn SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysadmin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin.\n\nIn some extreme cases I’ve seen situations where no one except some dude on vacation is sysadmin and I need to install or upgrade a bunch of applications and services. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn’t sysadmin either I still cannot login to the SQL server.\nWhat to do!?\n\nThanks to [Raul Carcia’s blog post](http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx) it’s not that a big deal. The instructions are written for SQL Server 2005 but works equally fine on SQL Server 2008 and the only pre-requirement is that you are a local server administrator.\nHere’s what to do:\n\n1. Open the _SQL Server Configuration Manager._\n3. In _SQL Server Services_, open the properties for the SQL Server instance you need access to.\n4. In the _Advanced_ tab, find _Startup Parameters_.\n5. Add “;-m” to the end of that line.\n6. Press OK and restart the SQL Server into “Maintenance Mode” or “Single User Mode” if you like. (check that a restart is OK first ;))\n7. Open a command prompt (right-click, “Run as Administrator” in Windows 2008) and go to C:\\Program Files\\Microsoft SQL Server\\100\\Tools\\Binn\n(C:\\Program Files\\Microsoft SQL Server\\_90_\\Tools\\Binn for SQL2005)\n7. Execute `sqlcmd /A /E /S <INSTANCE>`  \n  (use . for local default instance and .INSTANCE for local named instance)\n8. In the CLI, execute:\n\n  ```sql\n  EXEC sp_addsrvrolemember 'DOMAIN\\yourusername', 'sysadmin';\n  GO\n  ```\n9. Return to the _SQL Server Configuration Manager_ and restore the _Startup Parameters_ to it’s previous settings.\n10. Restart the SQL Server instance to allow users to get access to it again.\n\nNow, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good time to actually set up a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, are on vacation. ;)\n\nAs Raul Carcia point out in his original post, this is really a disaster recovery procedure and there’s definitely nothing sneaky about it since it leaves a lot of trails in the event logs.\n\nAll in all, a Great article by [Raul](http://blogs.msdn.com/raulga/) and all credit should go his way.","source":"_posts/regain-sysadmin-access-to-sql2005-or-sql2008.md","raw":"---\ntitle: (re)Gain sysadmin access to SQL2005 or SQL2008\ntags:\n  - How-To\n  - SQL Server\n  - SQL Server 2005\n  - SQL Server 2008\nid: 239\ncategories:\n  - Microsoft\n  - SQL Server\ndate: 2009-11-19 14:08:10\n---\n\nIn SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysadmin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin.\n\nIn some extreme cases I’ve seen situations where no one except some dude on vacation is sysadmin and I need to install or upgrade a bunch of applications and services. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn’t sysadmin either I still cannot login to the SQL server.\nWhat to do!?\n\nThanks to [Raul Carcia’s blog post](http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx) it’s not that a big deal. The instructions are written for SQL Server 2005 but works equally fine on SQL Server 2008 and the only pre-requirement is that you are a local server administrator.\nHere’s what to do:\n\n1. Open the _SQL Server Configuration Manager._\n3. In _SQL Server Services_, open the properties for the SQL Server instance you need access to.\n4. In the _Advanced_ tab, find _Startup Parameters_.\n5. Add “;-m” to the end of that line.\n6. Press OK and restart the SQL Server into “Maintenance Mode” or “Single User Mode” if you like. (check that a restart is OK first ;))\n7. Open a command prompt (right-click, “Run as Administrator” in Windows 2008) and go to C:\\Program Files\\Microsoft SQL Server\\100\\Tools\\Binn\n(C:\\Program Files\\Microsoft SQL Server\\_90_\\Tools\\Binn for SQL2005)\n7. Execute `sqlcmd /A /E /S <INSTANCE>`  \n  (use . for local default instance and .INSTANCE for local named instance)\n8. In the CLI, execute:\n\n  ```sql\n  EXEC sp_addsrvrolemember 'DOMAIN\\yourusername', 'sysadmin';\n  GO\n  ```\n9. Return to the _SQL Server Configuration Manager_ and restore the _Startup Parameters_ to it’s previous settings.\n10. Restart the SQL Server instance to allow users to get access to it again.\n\nNow, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good time to actually set up a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, are on vacation. ;)\n\nAs Raul Carcia point out in his original post, this is really a disaster recovery procedure and there’s definitely nothing sneaky about it since it leaves a lot of trails in the event logs.\n\nAll in all, a Great article by [Raul](http://blogs.msdn.com/raulga/) and all credit should go his way.","slug":"regain-sysadmin-access-to-sql2005-or-sql2008","published":1,"updated":"2016-07-05T14:42:49.336Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jv0035q4o2aohvr3fe","content":"<p>In SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysadmin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin.</p>\n<p>In some extreme cases I’ve seen situations where no one except some dude on vacation is sysadmin and I need to install or upgrade a bunch of applications and services. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn’t sysadmin either I still cannot login to the SQL server.<br>What to do!?</p>\n<p>Thanks to <a href=\"http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx\" target=\"_blank\" rel=\"external\">Raul Carcia’s blog post</a> it’s not that a big deal. The instructions are written for SQL Server 2005 but works equally fine on SQL Server 2008 and the only pre-requirement is that you are a local server administrator.<br>Here’s what to do:</p>\n<ol>\n<li>Open the <em>SQL Server Configuration Manager.</em></li>\n<li>In <em>SQL Server Services</em>, open the properties for the SQL Server instance you need access to.</li>\n<li>In the <em>Advanced</em> tab, find <em>Startup Parameters</em>.</li>\n<li>Add “;-m” to the end of that line.</li>\n<li>Press OK and restart the SQL Server into “Maintenance Mode” or “Single User Mode” if you like. (check that a restart is OK first ;))</li>\n<li>Open a command prompt (right-click, “Run as Administrator” in Windows 2008) and go to C:\\Program Files\\Microsoft SQL Server\\100\\Tools\\Binn<br>(C:\\Program Files\\Microsoft SQL Server_90_\\Tools\\Binn for SQL2005)</li>\n<li>Execute <code>sqlcmd /A /E /S &lt;INSTANCE&gt;</code><br>(use . for local default instance and .INSTANCE for local named instance)</li>\n<li><p>In the CLI, execute:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">EXEC sp_addsrvrolemember 'DOMAIN\\yourusername', 'sysadmin';</span><br><span class=\"line\">GO</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Return to the <em>SQL Server Configuration Manager</em> and restore the <em>Startup Parameters</em> to it’s previous settings.</p>\n</li>\n<li>Restart the SQL Server instance to allow users to get access to it again.</li>\n</ol>\n<p>Now, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good time to actually set up a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, are on vacation. ;)</p>\n<p>As Raul Carcia point out in his original post, this is really a disaster recovery procedure and there’s definitely nothing sneaky about it since it leaves a lot of trails in the event logs.</p>\n<p>All in all, a Great article by <a href=\"http://blogs.msdn.com/raulga/\" target=\"_blank\" rel=\"external\">Raul</a> and all credit should go his way.</p>\n","excerpt":"","more":"<p>In SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysadmin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin.</p>\n<p>In some extreme cases I’ve seen situations where no one except some dude on vacation is sysadmin and I need to install or upgrade a bunch of applications and services. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn’t sysadmin either I still cannot login to the SQL server.<br>What to do!?</p>\n<p>Thanks to <a href=\"http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx\">Raul Carcia’s blog post</a> it’s not that a big deal. The instructions are written for SQL Server 2005 but works equally fine on SQL Server 2008 and the only pre-requirement is that you are a local server administrator.<br>Here’s what to do:</p>\n<ol>\n<li>Open the <em>SQL Server Configuration Manager.</em></li>\n<li>In <em>SQL Server Services</em>, open the properties for the SQL Server instance you need access to.</li>\n<li>In the <em>Advanced</em> tab, find <em>Startup Parameters</em>.</li>\n<li>Add “;-m” to the end of that line.</li>\n<li>Press OK and restart the SQL Server into “Maintenance Mode” or “Single User Mode” if you like. (check that a restart is OK first ;))</li>\n<li>Open a command prompt (right-click, “Run as Administrator” in Windows 2008) and go to C:\\Program Files\\Microsoft SQL Server\\100\\Tools\\Binn<br>(C:\\Program Files\\Microsoft SQL Server_90_\\Tools\\Binn for SQL2005)</li>\n<li>Execute <code>sqlcmd /A /E /S &lt;INSTANCE&gt;</code><br>(use . for local default instance and .INSTANCE for local named instance)</li>\n<li><p>In the CLI, execute:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">EXEC sp_addsrvrolemember 'DOMAIN\\yourusername', 'sysadmin';</span><br><span class=\"line\">GO</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Return to the <em>SQL Server Configuration Manager</em> and restore the <em>Startup Parameters</em> to it’s previous settings.</p>\n</li>\n<li>Restart the SQL Server instance to allow users to get access to it again.</li>\n</ol>\n<p>Now, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good time to actually set up a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, are on vacation. ;)</p>\n<p>As Raul Carcia point out in his original post, this is really a disaster recovery procedure and there’s definitely nothing sneaky about it since it leaves a lot of trails in the event logs.</p>\n<p>All in all, a Great article by <a href=\"http://blogs.msdn.com/raulga/\">Raul</a> and all credit should go his way.</p>\n"},{"title":"Replace/Change a Gateway Server","id":"207","date":"2009-09-24T10:32:35.000Z","_content":"\n# Description of problem\n\nIf you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there's a little more to consider than just right-clicking the clients and selecting \"Change Primary Management Server\" in the Operations Console.\nYou could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things.\n\nHere's basically what happens:\n\n1. You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2.\n1. The SDK Service (i guess) tells GW1 that \"You're no longer the Primary Management Server for AGENTX\"\n1. GW1 acknowledges this and stops talking to AGENTX.  And I mean _Completely_ stops talking to AGENTX.\n1. OpsMgr then tells GW2 to start accepting communication from AGENTX.\n1. OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won't listen.\n\nSpotted the problem?\nThis modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic.  The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent _before_ the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000.\n\nHow do I get around this little _feature_ then?\n\nNo matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are [out there](http://www.systemcentercentral.com/Forums/tabid/60/IndexID/19305/Default.aspx#vwcComments19305 \"System Center Central\") allready, but in different contexts, hence this post.\n\n## First step:  Install the new Gateway\n\n[Documentation on this](http://technet.microsoft.com/en-us/library/bb432149.aspx \"Deploying Gateway Server in the Multiple Server, Single Management Group Scenario\") from Microsoft is good enough, but here's the short version.\n\n1. Verify name resolution to and from Gateway server and Management Server\n1. [Create certificate](http://technet.microsoft.com/en-us/library/bb735408.aspx \"Authentication and Data Encryption for Windows Computers in Operations Manager 2007\") for the Gateway server\n1. Approve the Gateway server\n1. Install Gateway server\n1. Import certificates on Windows system\n1. Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration\n1. Wait\n\nThe wait is for the gateway server to get all needed configuration from RMS and to download all neccesary management packs, run all the discovery scripts and so on. When the Operations Manager event log has calmed down a bit, move to step two.\n\n## Second step: Configure Agent Failover\n\nConnect to an Operations Manager Command Shell. Any will do, as long as it's connected to the correct Management Group.\nThen run the following script:\n\n```powershell\n$primaryGW= Get-ManagementServer | where {$_.Name -eq 'GW2.domain.local'}\n$failoverGw = Get-ManagementServer | where {$_.Name -eq 'GW1.domain.local'}\n$agents = Get-Agent | where {$_.primarymanagementservername -eq 'GW1.domain.local'}\nSet-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $primaryGW -FailoverServer: $failoverGw\n```\n\nRemember to change \"GW1.domain.local\" to you OLD Gateway servername and \"GW2.domain.local\" to your NEW Gateway servername.\n\nIf you don't know powershell, this script basically configures all agents using the old Gateway to use the new one as primare, but keep the old one as a fail-over server. The Gateways will still get to know the changes before the agents, but since the old on is still listening to the agents (though, as the fail-over host) it will be able to tell them to go to the new one, GW2.","source":"_posts/replacechange-a-gateway-server.md","raw":"---\ntitle: Replace/Change a Gateway Server\ntags:\n  - How-To\n  - OpsMgr\n  - PoSH\n  - Script\nid: 207\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-09-24 12:32:35\n---\n\n# Description of problem\n\nIf you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there's a little more to consider than just right-clicking the clients and selecting \"Change Primary Management Server\" in the Operations Console.\nYou could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things.\n\nHere's basically what happens:\n\n1. You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2.\n1. The SDK Service (i guess) tells GW1 that \"You're no longer the Primary Management Server for AGENTX\"\n1. GW1 acknowledges this and stops talking to AGENTX.  And I mean _Completely_ stops talking to AGENTX.\n1. OpsMgr then tells GW2 to start accepting communication from AGENTX.\n1. OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won't listen.\n\nSpotted the problem?\nThis modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic.  The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent _before_ the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000.\n\nHow do I get around this little _feature_ then?\n\nNo matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are [out there](http://www.systemcentercentral.com/Forums/tabid/60/IndexID/19305/Default.aspx#vwcComments19305 \"System Center Central\") allready, but in different contexts, hence this post.\n\n## First step:  Install the new Gateway\n\n[Documentation on this](http://technet.microsoft.com/en-us/library/bb432149.aspx \"Deploying Gateway Server in the Multiple Server, Single Management Group Scenario\") from Microsoft is good enough, but here's the short version.\n\n1. Verify name resolution to and from Gateway server and Management Server\n1. [Create certificate](http://technet.microsoft.com/en-us/library/bb735408.aspx \"Authentication and Data Encryption for Windows Computers in Operations Manager 2007\") for the Gateway server\n1. Approve the Gateway server\n1. Install Gateway server\n1. Import certificates on Windows system\n1. Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration\n1. Wait\n\nThe wait is for the gateway server to get all needed configuration from RMS and to download all neccesary management packs, run all the discovery scripts and so on. When the Operations Manager event log has calmed down a bit, move to step two.\n\n## Second step: Configure Agent Failover\n\nConnect to an Operations Manager Command Shell. Any will do, as long as it's connected to the correct Management Group.\nThen run the following script:\n\n```powershell\n$primaryGW= Get-ManagementServer | where {$_.Name -eq 'GW2.domain.local'}\n$failoverGw = Get-ManagementServer | where {$_.Name -eq 'GW1.domain.local'}\n$agents = Get-Agent | where {$_.primarymanagementservername -eq 'GW1.domain.local'}\nSet-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $primaryGW -FailoverServer: $failoverGw\n```\n\nRemember to change \"GW1.domain.local\" to you OLD Gateway servername and \"GW2.domain.local\" to your NEW Gateway servername.\n\nIf you don't know powershell, this script basically configures all agents using the old Gateway to use the new one as primare, but keep the old one as a fail-over server. The Gateways will still get to know the changes before the agents, but since the old on is still listening to the agents (though, as the fail-over host) it will be able to tell them to go to the new one, GW2.","slug":"replacechange-a-gateway-server","published":1,"updated":"2016-05-24T21:07:20.061Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7jz0039q4o2p4v2rmdt","content":"<h1 id=\"Description-of-problem\"><a href=\"#Description-of-problem\" class=\"headerlink\" title=\"Description of problem\"></a>Description of problem</h1><p>If you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there’s a little more to consider than just right-clicking the clients and selecting “Change Primary Management Server” in the Operations Console.<br>You could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things.</p>\n<p>Here’s basically what happens:</p>\n<ol>\n<li>You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2.</li>\n<li>The SDK Service (i guess) tells GW1 that “You’re no longer the Primary Management Server for AGENTX”</li>\n<li>GW1 acknowledges this and stops talking to AGENTX.  And I mean <em>Completely</em> stops talking to AGENTX.</li>\n<li>OpsMgr then tells GW2 to start accepting communication from AGENTX.</li>\n<li>OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won’t listen.</li>\n</ol>\n<p>Spotted the problem?<br>This modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic.  The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent <em>before</em> the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000.</p>\n<p>How do I get around this little <em>feature</em> then?</p>\n<p>No matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are <a href=\"http://www.systemcentercentral.com/Forums/tabid/60/IndexID/19305/Default.aspx#vwcComments19305\" title=\"System Center Central\" target=\"_blank\" rel=\"external\">out there</a> allready, but in different contexts, hence this post.</p>\n<h2 id=\"First-step-Install-the-new-Gateway\"><a href=\"#First-step-Install-the-new-Gateway\" class=\"headerlink\" title=\"First step:  Install the new Gateway\"></a>First step:  Install the new Gateway</h2><p><a href=\"http://technet.microsoft.com/en-us/library/bb432149.aspx\" title=\"Deploying Gateway Server in the Multiple Server, Single Management Group Scenario\" target=\"_blank\" rel=\"external\">Documentation on this</a> from Microsoft is good enough, but here’s the short version.</p>\n<ol>\n<li>Verify name resolution to and from Gateway server and Management Server</li>\n<li><a href=\"http://technet.microsoft.com/en-us/library/bb735408.aspx\" title=\"Authentication and Data Encryption for Windows Computers in Operations Manager 2007\" target=\"_blank\" rel=\"external\">Create certificate</a> for the Gateway server</li>\n<li>Approve the Gateway server</li>\n<li>Install Gateway server</li>\n<li>Import certificates on Windows system</li>\n<li>Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration</li>\n<li>Wait</li>\n</ol>\n<p>The wait is for the gateway server to get all needed configuration from RMS and to download all neccesary management packs, run all the discovery scripts and so on. When the Operations Manager event log has calmed down a bit, move to step two.</p>\n<h2 id=\"Second-step-Configure-Agent-Failover\"><a href=\"#Second-step-Configure-Agent-Failover\" class=\"headerlink\" title=\"Second step: Configure Agent Failover\"></a>Second step: Configure Agent Failover</h2><p>Connect to an Operations Manager Command Shell. Any will do, as long as it’s connected to the correct Management Group.<br>Then run the following script:</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$primaryGW</span>= Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">'GW2.domain.local'</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$failoverGw</span> = Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">'GW1.domain.local'</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$agents</span> = Get-Agent | where &#123;<span class=\"variable\">$_</span>.primarymanagementservername <span class=\"nomarkup\">-eq</span> <span class=\"string\">'GW1.domain.local'</span>&#125;</span><br><span class=\"line\">Set-ManagementServer -AgentManagedComputer: <span class=\"variable\">$agents</span> -PrimaryManagementServer: <span class=\"variable\">$primaryGW</span> -FailoverServer: <span class=\"variable\">$failoverGw</span></span><br></pre></td></tr></table></figure>\n<p>Remember to change “GW1.domain.local” to you OLD Gateway servername and “GW2.domain.local” to your NEW Gateway servername.</p>\n<p>If you don’t know powershell, this script basically configures all agents using the old Gateway to use the new one as primare, but keep the old one as a fail-over server. The Gateways will still get to know the changes before the agents, but since the old on is still listening to the agents (though, as the fail-over host) it will be able to tell them to go to the new one, GW2.</p>\n","excerpt":"","more":"<h1 id=\"Description-of-problem\"><a href=\"#Description-of-problem\" class=\"headerlink\" title=\"Description of problem\"></a>Description of problem</h1><p>If you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there’s a little more to consider than just right-clicking the clients and selecting “Change Primary Management Server” in the Operations Console.<br>You could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things.</p>\n<p>Here’s basically what happens:</p>\n<ol>\n<li>You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2.</li>\n<li>The SDK Service (i guess) tells GW1 that “You’re no longer the Primary Management Server for AGENTX”</li>\n<li>GW1 acknowledges this and stops talking to AGENTX.  And I mean <em>Completely</em> stops talking to AGENTX.</li>\n<li>OpsMgr then tells GW2 to start accepting communication from AGENTX.</li>\n<li>OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won’t listen.</li>\n</ol>\n<p>Spotted the problem?<br>This modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic.  The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent <em>before</em> the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000.</p>\n<p>How do I get around this little <em>feature</em> then?</p>\n<p>No matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are <a href=\"http://www.systemcentercentral.com/Forums/tabid/60/IndexID/19305/Default.aspx#vwcComments19305\" title=\"System Center Central\">out there</a> allready, but in different contexts, hence this post.</p>\n<h2 id=\"First-step-Install-the-new-Gateway\"><a href=\"#First-step-Install-the-new-Gateway\" class=\"headerlink\" title=\"First step:  Install the new Gateway\"></a>First step:  Install the new Gateway</h2><p><a href=\"http://technet.microsoft.com/en-us/library/bb432149.aspx\" title=\"Deploying Gateway Server in the Multiple Server, Single Management Group Scenario\">Documentation on this</a> from Microsoft is good enough, but here’s the short version.</p>\n<ol>\n<li>Verify name resolution to and from Gateway server and Management Server</li>\n<li><a href=\"http://technet.microsoft.com/en-us/library/bb735408.aspx\" title=\"Authentication and Data Encryption for Windows Computers in Operations Manager 2007\">Create certificate</a> for the Gateway server</li>\n<li>Approve the Gateway server</li>\n<li>Install Gateway server</li>\n<li>Import certificates on Windows system</li>\n<li>Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration</li>\n<li>Wait</li>\n</ol>\n<p>The wait is for the gateway server to get all needed configuration from RMS and to download all neccesary management packs, run all the discovery scripts and so on. When the Operations Manager event log has calmed down a bit, move to step two.</p>\n<h2 id=\"Second-step-Configure-Agent-Failover\"><a href=\"#Second-step-Configure-Agent-Failover\" class=\"headerlink\" title=\"Second step: Configure Agent Failover\"></a>Second step: Configure Agent Failover</h2><p>Connect to an Operations Manager Command Shell. Any will do, as long as it’s connected to the correct Management Group.<br>Then run the following script:</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$primaryGW</span>= Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">'GW2.domain.local'</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$failoverGw</span> = Get-ManagementServer | where &#123;<span class=\"variable\">$_</span>.Name <span class=\"nomarkup\">-eq</span> <span class=\"string\">'GW1.domain.local'</span>&#125;</span><br><span class=\"line\"><span class=\"variable\">$agents</span> = Get-Agent | where &#123;<span class=\"variable\">$_</span>.primarymanagementservername <span class=\"nomarkup\">-eq</span> <span class=\"string\">'GW1.domain.local'</span>&#125;</span><br><span class=\"line\">Set-ManagementServer -AgentManagedComputer: <span class=\"variable\">$agents</span> -PrimaryManagementServer: <span class=\"variable\">$primaryGW</span> -FailoverServer: <span class=\"variable\">$failoverGw</span></span><br></pre></td></tr></table></figure>\n<p>Remember to change “GW1.domain.local” to you OLD Gateway servername and “GW2.domain.local” to your NEW Gateway servername.</p>\n<p>If you don’t know powershell, this script basically configures all agents using the old Gateway to use the new one as primare, but keep the old one as a fail-over server. The Gateways will still get to know the changes before the agents, but since the old on is still listening to the agents (though, as the fail-over host) it will be able to tell them to go to the new one, GW2.</p>\n"},{"title":"Server problems fixed! (hopefully)","id":"478","date":"2011-04-27T19:50:12.000Z","_content":"\nI think I got the server running ok now.\n\nI've been fiddling about quite alot and unfortunately don't know which one action that fixed the problem. If I do figure it out, I will post it here.\n\nSite performance should be a bit better now.","source":"_posts/server-problems-fixed-hopefully.md","raw":"---\ntitle: Server problems fixed! (hopefully)\nid: 478\ncategories:\n  - Technobabble\ndate: 2011-04-27 21:50:12\ntags:\n---\n\nI think I got the server running ok now.\n\nI've been fiddling about quite alot and unfortunately don't know which one action that fixed the problem. If I do figure it out, I will post it here.\n\nSite performance should be a bit better now.","slug":"server-problems-fixed-hopefully","published":1,"updated":"2016-05-19T09:11:09.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7k2003dq4o27dohnvnq","content":"<p>I think I got the server running ok now.</p>\n<p>I’ve been fiddling about quite alot and unfortunately don’t know which one action that fixed the problem. If I do figure it out, I will post it here.</p>\n<p>Site performance should be a bit better now.</p>\n","excerpt":"","more":"<p>I think I got the server running ok now.</p>\n<p>I’ve been fiddling about quite alot and unfortunately don’t know which one action that fixed the problem. If I do figure it out, I will post it here.</p>\n<p>Site performance should be a bit better now.</p>\n"},{"title":"Silly Hibernation doo-doo on WinXP","id":"41","date":"2006-12-03T11:55:52.000Z","_content":"\nI recently added another 500MB of RAM to my computer... and there was much rejoice.\n\nHowever, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means \"Hibernate\"). It simply refused to hibernate with the very intuitive error message \"Insufficent System Resources Exist to Complete the API\".\n\nAnyway. [Microsoft](http://www.microsoft.com/ \"Microsoft.com\") has a fix for it, and you don't have to call them to get it anymore either. Just follow the link below.\n[http://support.microsoft.com/kb/Q909095](http://support.microsoft.com/kb/Q909095 \"http://support.microsoft.com/kb/Q909095\")","source":"_posts/silly-hibernation-doo-doo-on-winxp.md","raw":"---\ntitle: Silly Hibernation doo-doo on WinXP\ntags:\n  - Drivers\n  - KB\nid: 41\ncategories:\n  - Microsoft\n  - Windows\n  - Windows XP\ndate: 2006-12-03 12:55:52\n---\n\nI recently added another 500MB of RAM to my computer... and there was much rejoice.\n\nHowever, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means \"Hibernate\"). It simply refused to hibernate with the very intuitive error message \"Insufficent System Resources Exist to Complete the API\".\n\nAnyway. [Microsoft](http://www.microsoft.com/ \"Microsoft.com\") has a fix for it, and you don't have to call them to get it anymore either. Just follow the link below.\n[http://support.microsoft.com/kb/Q909095](http://support.microsoft.com/kb/Q909095 \"http://support.microsoft.com/kb/Q909095\")","slug":"silly-hibernation-doo-doo-on-winxp","published":1,"updated":"2016-05-19T10:42:06.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7k5003hq4o20clgrnf2","content":"<p>I recently added another 500MB of RAM to my computer… and there was much rejoice.</p>\n<p>However, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means “Hibernate”). It simply refused to hibernate with the very intuitive error message “Insufficent System Resources Exist to Complete the API”.</p>\n<p>Anyway. <a href=\"http://www.microsoft.com/\" title=\"Microsoft.com\" target=\"_blank\" rel=\"external\">Microsoft</a> has a fix for it, and you don’t have to call them to get it anymore either. Just follow the link below.<br><a href=\"http://support.microsoft.com/kb/Q909095\" title=\"http://support.microsoft.com/kb/Q909095\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/Q909095</a></p>\n","excerpt":"","more":"<p>I recently added another 500MB of RAM to my computer… and there was much rejoice.</p>\n<p>However, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means “Hibernate”). It simply refused to hibernate with the very intuitive error message “Insufficent System Resources Exist to Complete the API”.</p>\n<p>Anyway. <a href=\"http://www.microsoft.com/\" title=\"Microsoft.com\">Microsoft</a> has a fix for it, and you don’t have to call them to get it anymore either. Just follow the link below.<br><a href=\"http://support.microsoft.com/kb/Q909095\" title=\"http://support.microsoft.com/kb/Q909095\">http://support.microsoft.com/kb/Q909095</a></p>\n"},{"title":"Sluggish performance on teknoglot","id":"451","date":"2011-04-19T20:14:02.000Z","_content":"\nI, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server.\n\nI haven't found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up.\n\nHopefully there will be a fix available soon.\n\nSorry for any inconvenience in the meantime.","source":"_posts/sluggish-performance-on-teknoglot.md","raw":"---\ntitle: Sluggish performance on teknoglot\ntags:\n  - Teknoglot\nid: 451\ncategories:\n  - Technobabble\ndate: 2011-04-19 22:14:02\n---\n\nI, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server.\n\nI haven't found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up.\n\nHopefully there will be a fix available soon.\n\nSorry for any inconvenience in the meantime.","slug":"sluggish-performance-on-teknoglot","published":1,"updated":"2016-05-24T21:02:55.038Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7k8003lq4o2yusfcvlm","content":"<p>I, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server.</p>\n<p>I haven’t found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up.</p>\n<p>Hopefully there will be a fix available soon.</p>\n<p>Sorry for any inconvenience in the meantime.</p>\n","excerpt":"","more":"<p>I, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server.</p>\n<p>I haven’t found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up.</p>\n<p>Hopefully there will be a fix available soon.</p>\n<p>Sorry for any inconvenience in the meantime.</p>\n"},{"title":"SNMP GET Errors in OpsMgr EventLog","id":"306","date":"2010-09-02T20:28:07.000Z","_content":"\nI've been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS's, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I've never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright.\n\nTo make it clear right away, this is not going to be a \"Building an SNMP Management Pack Tutorial\" since there's plentiful good ones out there already, and to be extra helpful I'm gonna include a few links right away:\n\n* [SNMP Setup and Simple Custom SNMP Discovery](http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/66140/Default.aspx \"SNMP Setup and Simple Custom SNMP Discovery\") - Pretty much the basics\n* [SNMP Management Pack Example: NetApp Management Pack](http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/58919/Default.aspx \"SNMP Management Pack Example: NetApp Management Pack for SCOM 2007 R2 part 4\") - Part 4 actually, but has the links to the other parts\n* [Creating SNMP Probe Based Monitors](http://www.systemcentercentral.com/Details/tabid/147/IndexID/58815/Default.aspx \"Creating SNMP Probe Based Monitors\") - No custom discovery, but a good and simple guide to SNMP Probes\n\nIt's the second, the NetApp one, I've used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those.\n\n# Let's get to it\n\nWhen building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about \"invalid queries\", something that turned out to be related to me reading two guides--seriously though, pick one guide that is closest to what you want to achieve and stick to it--and mixing up the XPathQuery variables. Silly me.\nI got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.\nThe only error I got this time was the following:\n\n```text\nLog Name:      Operations Manager\nSource:        Health Service Modules\nDate:          2010-09-02 11:19:12\nEvent ID:      11001\nTask Category: None\nLevel:         Error\nKeywords:      Classic\nUser:          N/A\nComputer:      CENSORED\nDescription:\nError sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.\n\nOne or more workflows were affected by this.\n\nWorkflow name: CENSORED.MP.CLASS.DISCOVERY\nInstance name: CENSORED_DEVICENAME\nInstance ID: {5C7EFB30-D885-8843-0DD7-EA86B4FD2311}\nManagement group: CENSORED\n```\n\nI went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn't until I loaded the [PowerMIB](http://www.networkupstools.org/protocols/eaton/ \"EATON Protocol Library\") into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of \"SNMP Get-Request\" but no \"SNMP Get-Response\" which means that Operations Manager did send an SNMP GET but there was no response.\n\nAfter a bit of intense staring i noticed what you see in the screenshot.\n\n\n![SNMP Error in Wireshark](http://teknoglotse.nfshost.com/wp-content/uploads/2010/09/snmp_error_wireshark.png \"SNMP Error in Wireshark\")\n\nFor some reason Operations Manager does not care about what SNMP version you configure when you do the initial discovery of a network device. Even if you do specify SNMP v1, you probes may very well be using SNMP v2c instead and in many cases that will result in these SNMP GET errors in the Operations Manager event log.\n\nTo avoid this, you haves to specify which SNMP version to use in your System.SnmpProbe according to the information provided here: [http://msdn.microsoft.com/en-us/library/ee809331.aspx](http://msdn.microsoft.com/en-us/library/ee809331.aspx)\n\nSince I am such a nice guy, here's an example of the working probe with the added line highlighted.\n\n```xml\n<IsWriteAction>false</IsWriteAction>\n<IP>$Config/IP$</IP>\n<CommunityString>$Config/CommunityString$</CommunityString>\n<Version>1</Version>\n<SnmpVarBinds>\n\t<SnmpVarBind>\n\t<OID>1.3.6.1.4.1.534.1.1.1.0</OID>\n\t\t<Syntax>0</Syntax>\n\t\t<Value VariantType=\"8\"></Value>\n\t</SnmpVarBind>\n\t<SnmpVarBind>\n\t\t<OID>1.3.6.1.4.1.534.1.1.2.0</OID>\n\t\t<Syntax>0</Syntax>\n\t\t<Value VariantType=\"8\"></Value>\n\t</SnmpVarBind>\n\t<SnmpVarBind>\n\t\t<OID>1.3.6.1.4.1.534.1.1.3.0</OID>\n\t\t<Syntax>0</Syntax>\n\t\t<Value VariantType=\"8\"></Value>\n\t</SnmpVarBind>\n</SnmpVarBinds>\n```\n\nThat's it. Working perfectly now.\n\nBest of luck!","source":"_posts/snmp-get-errors-in-eventlog.md","raw":"---\ntitle: SNMP GET Errors in OpsMgr EventLog\ntags:\n  - Errors\n  - Management Pack\n  - OpsMgr\n  - TroubleShooting\nid: 306\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2010-09-02 22:28:07\n---\n\nI've been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS's, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I've never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright.\n\nTo make it clear right away, this is not going to be a \"Building an SNMP Management Pack Tutorial\" since there's plentiful good ones out there already, and to be extra helpful I'm gonna include a few links right away:\n\n* [SNMP Setup and Simple Custom SNMP Discovery](http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/66140/Default.aspx \"SNMP Setup and Simple Custom SNMP Discovery\") - Pretty much the basics\n* [SNMP Management Pack Example: NetApp Management Pack](http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/58919/Default.aspx \"SNMP Management Pack Example: NetApp Management Pack for SCOM 2007 R2 part 4\") - Part 4 actually, but has the links to the other parts\n* [Creating SNMP Probe Based Monitors](http://www.systemcentercentral.com/Details/tabid/147/IndexID/58815/Default.aspx \"Creating SNMP Probe Based Monitors\") - No custom discovery, but a good and simple guide to SNMP Probes\n\nIt's the second, the NetApp one, I've used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those.\n\n# Let's get to it\n\nWhen building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about \"invalid queries\", something that turned out to be related to me reading two guides--seriously though, pick one guide that is closest to what you want to achieve and stick to it--and mixing up the XPathQuery variables. Silly me.\nI got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.\nThe only error I got this time was the following:\n\n```text\nLog Name:      Operations Manager\nSource:        Health Service Modules\nDate:          2010-09-02 11:19:12\nEvent ID:      11001\nTask Category: None\nLevel:         Error\nKeywords:      Classic\nUser:          N/A\nComputer:      CENSORED\nDescription:\nError sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.\n\nOne or more workflows were affected by this.\n\nWorkflow name: CENSORED.MP.CLASS.DISCOVERY\nInstance name: CENSORED_DEVICENAME\nInstance ID: {5C7EFB30-D885-8843-0DD7-EA86B4FD2311}\nManagement group: CENSORED\n```\n\nI went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn't until I loaded the [PowerMIB](http://www.networkupstools.org/protocols/eaton/ \"EATON Protocol Library\") into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of \"SNMP Get-Request\" but no \"SNMP Get-Response\" which means that Operations Manager did send an SNMP GET but there was no response.\n\nAfter a bit of intense staring i noticed what you see in the screenshot.\n\n\n![SNMP Error in Wireshark](http://teknoglotse.nfshost.com/wp-content/uploads/2010/09/snmp_error_wireshark.png \"SNMP Error in Wireshark\")\n\nFor some reason Operations Manager does not care about what SNMP version you configure when you do the initial discovery of a network device. Even if you do specify SNMP v1, you probes may very well be using SNMP v2c instead and in many cases that will result in these SNMP GET errors in the Operations Manager event log.\n\nTo avoid this, you haves to specify which SNMP version to use in your System.SnmpProbe according to the information provided here: [http://msdn.microsoft.com/en-us/library/ee809331.aspx](http://msdn.microsoft.com/en-us/library/ee809331.aspx)\n\nSince I am such a nice guy, here's an example of the working probe with the added line highlighted.\n\n```xml\n<IsWriteAction>false</IsWriteAction>\n<IP>$Config/IP$</IP>\n<CommunityString>$Config/CommunityString$</CommunityString>\n<Version>1</Version>\n<SnmpVarBinds>\n\t<SnmpVarBind>\n\t<OID>1.3.6.1.4.1.534.1.1.1.0</OID>\n\t\t<Syntax>0</Syntax>\n\t\t<Value VariantType=\"8\"></Value>\n\t</SnmpVarBind>\n\t<SnmpVarBind>\n\t\t<OID>1.3.6.1.4.1.534.1.1.2.0</OID>\n\t\t<Syntax>0</Syntax>\n\t\t<Value VariantType=\"8\"></Value>\n\t</SnmpVarBind>\n\t<SnmpVarBind>\n\t\t<OID>1.3.6.1.4.1.534.1.1.3.0</OID>\n\t\t<Syntax>0</Syntax>\n\t\t<Value VariantType=\"8\"></Value>\n\t</SnmpVarBind>\n</SnmpVarBinds>\n```\n\nThat's it. Working perfectly now.\n\nBest of luck!","slug":"snmp-get-errors-in-eventlog","published":1,"updated":"2016-05-24T21:02:14.400Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kb003pq4o2z6cj08lm","content":"<p>I’ve been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS’s, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I’ve never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright.</p>\n<p>To make it clear right away, this is not going to be a “Building an SNMP Management Pack Tutorial” since there’s plentiful good ones out there already, and to be extra helpful I’m gonna include a few links right away:</p>\n<ul>\n<li><a href=\"http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/66140/Default.aspx\" title=\"SNMP Setup and Simple Custom SNMP Discovery\" target=\"_blank\" rel=\"external\">SNMP Setup and Simple Custom SNMP Discovery</a> - Pretty much the basics</li>\n<li><a href=\"http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/58919/Default.aspx\" title=\"SNMP Management Pack Example: NetApp Management Pack for SCOM 2007 R2 part 4\" target=\"_blank\" rel=\"external\">SNMP Management Pack Example: NetApp Management Pack</a> - Part 4 actually, but has the links to the other parts</li>\n<li><a href=\"http://www.systemcentercentral.com/Details/tabid/147/IndexID/58815/Default.aspx\" title=\"Creating SNMP Probe Based Monitors\" target=\"_blank\" rel=\"external\">Creating SNMP Probe Based Monitors</a> - No custom discovery, but a good and simple guide to SNMP Probes</li>\n</ul>\n<p>It’s the second, the NetApp one, I’ve used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those.</p>\n<h1 id=\"Let’s-get-to-it\"><a href=\"#Let’s-get-to-it\" class=\"headerlink\" title=\"Let’s get to it\"></a>Let’s get to it</h1><p>When building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about “invalid queries”, something that turned out to be related to me reading two guides–seriously though, pick one guide that is closest to what you want to achieve and stick to it–and mixing up the XPathQuery variables. Silly me.<br>I got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.<br>The only error I got this time was the following:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Log Name:      Operations Manager</span><br><span class=\"line\">Source:        Health Service Modules</span><br><span class=\"line\">Date:          2010-09-02 11:19:12</span><br><span class=\"line\">Event ID:      11001</span><br><span class=\"line\">Task Category: None</span><br><span class=\"line\">Level:         Error</span><br><span class=\"line\">Keywords:      Classic</span><br><span class=\"line\">User:          N/A</span><br><span class=\"line\">Computer:      CENSORED</span><br><span class=\"line\">Description:</span><br><span class=\"line\">Error sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.</span><br><span class=\"line\"></span><br><span class=\"line\">One or more workflows were affected by this.</span><br><span class=\"line\"></span><br><span class=\"line\">Workflow name: CENSORED.MP.CLASS.DISCOVERY</span><br><span class=\"line\">Instance name: CENSORED_DEVICENAME</span><br><span class=\"line\">Instance ID: &#123;5C7EFB30-D885-8843-0DD7-EA86B4FD2311&#125;</span><br><span class=\"line\">Management group: CENSORED</span><br></pre></td></tr></table></figure>\n<p>I went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn’t until I loaded the <a href=\"http://www.networkupstools.org/protocols/eaton/\" title=\"EATON Protocol Library\" target=\"_blank\" rel=\"external\">PowerMIB</a> into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of “SNMP Get-Request” but no “SNMP Get-Response” which means that Operations Manager did send an SNMP GET but there was no response.</p>\n<p>After a bit of intense staring i noticed what you see in the screenshot.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2010/09/snmp_error_wireshark.png\" alt=\"SNMP Error in Wireshark\" title=\"SNMP Error in Wireshark\"></p>\n<p>For some reason Operations Manager does not care about what SNMP version you configure when you do the initial discovery of a network device. Even if you do specify SNMP v1, you probes may very well be using SNMP v2c instead and in many cases that will result in these SNMP GET errors in the Operations Manager event log.</p>\n<p>To avoid this, you haves to specify which SNMP version to use in your System.SnmpProbe according to the information provided here: <a href=\"http://msdn.microsoft.com/en-us/library/ee809331.aspx\" target=\"_blank\" rel=\"external\">http://msdn.microsoft.com/en-us/library/ee809331.aspx</a></p>\n<p>Since I am such a nice guy, here’s an example of the working probe with the added line highlighted.</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">IsWriteAction</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">IsWriteAction</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">IP</span>&gt;</span>$Config/IP$<span class=\"tag\">&lt;/<span class=\"name\">IP</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">CommunityString</span>&gt;</span>$Config/CommunityString$<span class=\"tag\">&lt;/<span class=\"name\">CommunityString</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Version</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">Version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">SnmpVarBinds</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">OID</span>&gt;</span>1.3.6.1.4.1.534.1.1.1.0<span class=\"tag\">&lt;/<span class=\"name\">OID</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Syntax</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Syntax</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Value</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">Value</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">OID</span>&gt;</span>1.3.6.1.4.1.534.1.1.2.0<span class=\"tag\">&lt;/<span class=\"name\">OID</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Syntax</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Syntax</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Value</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">Value</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">OID</span>&gt;</span>1.3.6.1.4.1.534.1.1.3.0<span class=\"tag\">&lt;/<span class=\"name\">OID</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Syntax</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Syntax</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Value</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">Value</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBinds</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>That’s it. Working perfectly now.</p>\n<p>Best of luck!</p>\n","excerpt":"","more":"<p>I’ve been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS’s, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I’ve never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright.</p>\n<p>To make it clear right away, this is not going to be a “Building an SNMP Management Pack Tutorial” since there’s plentiful good ones out there already, and to be extra helpful I’m gonna include a few links right away:</p>\n<ul>\n<li><a href=\"http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/66140/Default.aspx\" title=\"SNMP Setup and Simple Custom SNMP Discovery\">SNMP Setup and Simple Custom SNMP Discovery</a> - Pretty much the basics</li>\n<li><a href=\"http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/58919/Default.aspx\" title=\"SNMP Management Pack Example: NetApp Management Pack for SCOM 2007 R2 part 4\">SNMP Management Pack Example: NetApp Management Pack</a> - Part 4 actually, but has the links to the other parts</li>\n<li><a href=\"http://www.systemcentercentral.com/Details/tabid/147/IndexID/58815/Default.aspx\" title=\"Creating SNMP Probe Based Monitors\">Creating SNMP Probe Based Monitors</a> - No custom discovery, but a good and simple guide to SNMP Probes</li>\n</ul>\n<p>It’s the second, the NetApp one, I’ve used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those.</p>\n<h1 id=\"Let’s-get-to-it\"><a href=\"#Let’s-get-to-it\" class=\"headerlink\" title=\"Let’s get to it\"></a>Let’s get to it</h1><p>When building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about “invalid queries”, something that turned out to be related to me reading two guides–seriously though, pick one guide that is closest to what you want to achieve and stick to it–and mixing up the XPathQuery variables. Silly me.<br>I got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.<br>The only error I got this time was the following:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Log Name:      Operations Manager</span><br><span class=\"line\">Source:        Health Service Modules</span><br><span class=\"line\">Date:          2010-09-02 11:19:12</span><br><span class=\"line\">Event ID:      11001</span><br><span class=\"line\">Task Category: None</span><br><span class=\"line\">Level:         Error</span><br><span class=\"line\">Keywords:      Classic</span><br><span class=\"line\">User:          N/A</span><br><span class=\"line\">Computer:      CENSORED</span><br><span class=\"line\">Description:</span><br><span class=\"line\">Error sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.</span><br><span class=\"line\"></span><br><span class=\"line\">One or more workflows were affected by this.</span><br><span class=\"line\"></span><br><span class=\"line\">Workflow name: CENSORED.MP.CLASS.DISCOVERY</span><br><span class=\"line\">Instance name: CENSORED_DEVICENAME</span><br><span class=\"line\">Instance ID: &#123;5C7EFB30-D885-8843-0DD7-EA86B4FD2311&#125;</span><br><span class=\"line\">Management group: CENSORED</span><br></pre></td></tr></table></figure>\n<p>I went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn’t until I loaded the <a href=\"http://www.networkupstools.org/protocols/eaton/\" title=\"EATON Protocol Library\">PowerMIB</a> into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of “SNMP Get-Request” but no “SNMP Get-Response” which means that Operations Manager did send an SNMP GET but there was no response.</p>\n<p>After a bit of intense staring i noticed what you see in the screenshot.</p>\n<p><img src=\"http://teknoglotse.nfshost.com/wp-content/uploads/2010/09/snmp_error_wireshark.png\" alt=\"SNMP Error in Wireshark\" title=\"SNMP Error in Wireshark\"></p>\n<p>For some reason Operations Manager does not care about what SNMP version you configure when you do the initial discovery of a network device. Even if you do specify SNMP v1, you probes may very well be using SNMP v2c instead and in many cases that will result in these SNMP GET errors in the Operations Manager event log.</p>\n<p>To avoid this, you haves to specify which SNMP version to use in your System.SnmpProbe according to the information provided here: <a href=\"http://msdn.microsoft.com/en-us/library/ee809331.aspx\">http://msdn.microsoft.com/en-us/library/ee809331.aspx</a></p>\n<p>Since I am such a nice guy, here’s an example of the working probe with the added line highlighted.</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">IsWriteAction</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">IsWriteAction</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">IP</span>&gt;</span>$Config/IP$<span class=\"tag\">&lt;/<span class=\"name\">IP</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">CommunityString</span>&gt;</span>$Config/CommunityString$<span class=\"tag\">&lt;/<span class=\"name\">CommunityString</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Version</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">Version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">SnmpVarBinds</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">OID</span>&gt;</span>1.3.6.1.4.1.534.1.1.1.0<span class=\"tag\">&lt;/<span class=\"name\">OID</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Syntax</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Syntax</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Value</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">Value</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">OID</span>&gt;</span>1.3.6.1.4.1.534.1.1.2.0<span class=\"tag\">&lt;/<span class=\"name\">OID</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Syntax</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Syntax</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Value</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">Value</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">OID</span>&gt;</span>1.3.6.1.4.1.534.1.1.3.0<span class=\"tag\">&lt;/<span class=\"name\">OID</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Syntax</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">Syntax</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">Value</span> <span class=\"attr\">VariantType</span>=<span class=\"string\">\"8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">Value</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBind</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">SnmpVarBinds</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>That’s it. Working perfectly now.</p>\n<p>Best of luck!</p>\n"},{"title":"SQL ManagementPack Survey – Make your voice heard","id":"224","date":"2009-10-07T12:24:37.000Z","_content":"\nAccording to the [OpsMgr Team blog](http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx), Microsoft wants to know what you think about their SQL Server MP. It’s really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don’t miss this one out.\n\n[http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx](http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx \"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\")","source":"_posts/sql-managementpack-survey-make-your-voice-heard.md","raw":"---\ntitle: SQL ManagementPack Survey – Make your voice heard\ntags:\n  - Management Pack\n  - SQL Server\nid: 224\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-10-07 14:24:37\n---\n\nAccording to the [OpsMgr Team blog](http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx), Microsoft wants to know what you think about their SQL Server MP. It’s really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don’t miss this one out.\n\n[http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx](http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx \"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\")","slug":"sql-managementpack-survey-make-your-voice-heard","published":1,"updated":"2016-05-19T10:42:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kh003tq4o2xr975zjb","content":"<p>According to the <a href=\"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\" target=\"_blank\" rel=\"external\">OpsMgr Team blog</a>, Microsoft wants to know what you think about their SQL Server MP. It’s really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don’t miss this one out.</p>\n<p><a href=\"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\" title=\"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx</a></p>\n","excerpt":"","more":"<p>According to the <a href=\"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\">OpsMgr Team blog</a>, Microsoft wants to know what you think about their SQL Server MP. It’s really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don’t miss this one out.</p>\n<p><a href=\"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\" title=\"http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx\">http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx</a></p>\n"},{"title":"SquaredUp Installation - Manual? Pfffft! [#opsmgr #squaredup]","id":"835","date":"2014-09-09T14:38:36.000Z","_content":"\n# Story-time\n\nI saw [SquaredUp](http://www.squaredup.com/ \"SquaredUp\") some year or two ago while googling about on behalf of a customer looking for a dashboard kind of thingy. It looked good and fairly simple, but for some reason it never clicked with the customer and we ended up going for some custom-made dashboards with a little scripting and some <abbr title=\"Database\">DB</abbr>-queries. I kind of liked the look of their product though and have kept an eye on them now and then. \nFast-forward to may 21st this year and the [release of version 1.8](http://www.squaredup.com/blog/proudly-announcing-squared-v18 \"Proudly Announcing v1.8\") and a whole slew of [nifty little features](http://www.squaredup.com/blog/squared-v18-new-features \"New Features in v1.8\"). What specifically piqued my interest was the linked dashboards, SharePoint integration and the included SLA and Map plugins. This basically ticked a lot of boxes many of my customers have looked for and something we've normally been looking into... err... _other products_ for. That, coupled with some new videos on their [Youtube-channel](https://www.youtube.com/user/SquaredUpLtd \"SquaredUp YouTube Channel\"), a few well-placed tweets and a little mail-correspondence had me setting it up in my portable little lab.\n\nOne of the interesting points is how, supposedly easy, it is to set the portal up. So I reset my lab -- <abbr title=\"Powershell Deployment Toolkit\">PDT</abbr> is just wonderful -- and decided to go for the hail-dummy approach. No manual, no preparations, no check-lists... Next-next-next then hopefully a working portal.\n<!--more-->\n\n# The Installation\n\nFirst, download the installation file (yes, singular) through the link you've got in your email and save it somewhere proper.\n![SquaredUp - Installation Package](http://www.teknoglot.se/wp-content/uploads/2014/09/152402_0001.png \"SquaredUp - Installation Package\")\n\nDoubleclicked the installation packaged and it now tells me it will install a few pre-requisites and configure the website for me. Next!\n\n![Installation Information](http://www.teknoglot.se/wp-content/uploads/2014/09/152428_0002.png \"SquaredUp - Something something components\")\n\nThe <abbr title=\"End User License Agreement\">EULA</abbr> I am sure each one of you are reading. Next!\n![EULA](http://www.teknoglot.se/wp-content/uploads/2014/09/152447_0003.png \"SquaredUp - Yeah, mhm... Read it.\")\n\nInstalling, or rather configuring, <abbr title=\"Internet Information Services\">IIS</abbr> and pre-requisites for me. Very nice. Next!\n\n![Installing/Configuring IIS](http://www.teknoglot.se/wp-content/uploads/2014/09/152506_0004.png \"SquaredUp - installing IIS for me... nice.\")\n\nQuick summary before actual installation. Next!\n\n![Installation Summary](http://www.teknoglot.se/wp-content/uploads/2014/09/152525_0005.png \"SquaredUp - Webroot... ok, sure.\")\n\nThis step actually requires a little action on your part. In this installation, the default setting \"localhost\" would actually work but I prefer to actually configure these things properly. I only have a single Management Server in this lab, so testing a load-balanced highly available scenario was not possible. Enter Management Server name, then Next!\n\n![Configuring the Management Server](http://www.teknoglot.se/wp-content/uploads/2014/09/152612_0006.png \"SquaredUp - Configure Management Server\")\n\nAfter a slight case of progress-bar the installation is now complete. Click link and exit the installer. Time spent so far is less than ten minutes, probably closer to five.\nNow it's time to login using your normal <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> credentials.\n\n![Login Screen](http://www.teknoglot.se/wp-content/uploads/2014/09/152750_0008.png \"SquaredUp - Login Screen\")\n\nFirst login will bring you to the Activation Screen. Simply paste the activation key from the email and Activate. This requires a working internet connection.\n\n![Activation Screen](http://www.teknoglot.se/wp-content/uploads/2014/09/153833_0010.png \"SquaredUp - Activation Screen\")\n\nThat's it! Well... not really. Navigating the portal I noticed that the spark-lines aren't showing, and hitting the \"View Performance\" link on an object view gives me a \"Login failed for user...\" error. I know I saw something about configuring the Data Warehouse in the email, so I check the blissfully simple Settings panel.\n![Settings Panel - DW Configuration](http://www.teknoglot.se/wp-content/uploads/2014/09/154502_0012.png \"SquaredUp - Configure DW Help\")\n\nFollowed the [instructions](http://support.squaredup.com/support/solutions/articles/27999 \"Squared Up - Configuring Data Warehouse Permissions\") to configure the security of the OperationsManagerDW database for the SquaredUp web application, and that's really it. Portal is up and running, spark-lines working. Ready to go.\n\n# Conclusion\n\nI wish more products and \"add-ons\" to <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> were this easy to install. No extra databases, no extra permissions, no extra infrastructure. I would like to try it out in a larger environment and see what the load on the website, the databases and the data access service will be. It would also be necessary to verify that it works properly when the management servers are behind a load balancer and maybe even putting the SquaredUp portal behind one itself. Since there is not a lot of configuration to be done and no database, it _should_ work. We'll see.\n\nNext up will be fiddling about with custom dashboards, maps, and generally figuring out what else we can do.","source":"_posts/squaredup-installation.md","raw":"---\ntitle: 'SquaredUp Installation - Manual? Pfffft! [#opsmgr #squaredup]'\ntags:\n  - Field Notes\n  - OpsMgr\n  - SquaredUp\nid: 835\ncategories:\n  - Microsoft\n  - OpsMgr 2012\ndate: 2014-09-09 16:38:36\n---\n\n# Story-time\n\nI saw [SquaredUp](http://www.squaredup.com/ \"SquaredUp\") some year or two ago while googling about on behalf of a customer looking for a dashboard kind of thingy. It looked good and fairly simple, but for some reason it never clicked with the customer and we ended up going for some custom-made dashboards with a little scripting and some <abbr title=\"Database\">DB</abbr>-queries. I kind of liked the look of their product though and have kept an eye on them now and then. \nFast-forward to may 21st this year and the [release of version 1.8](http://www.squaredup.com/blog/proudly-announcing-squared-v18 \"Proudly Announcing v1.8\") and a whole slew of [nifty little features](http://www.squaredup.com/blog/squared-v18-new-features \"New Features in v1.8\"). What specifically piqued my interest was the linked dashboards, SharePoint integration and the included SLA and Map plugins. This basically ticked a lot of boxes many of my customers have looked for and something we've normally been looking into... err... _other products_ for. That, coupled with some new videos on their [Youtube-channel](https://www.youtube.com/user/SquaredUpLtd \"SquaredUp YouTube Channel\"), a few well-placed tweets and a little mail-correspondence had me setting it up in my portable little lab.\n\nOne of the interesting points is how, supposedly easy, it is to set the portal up. So I reset my lab -- <abbr title=\"Powershell Deployment Toolkit\">PDT</abbr> is just wonderful -- and decided to go for the hail-dummy approach. No manual, no preparations, no check-lists... Next-next-next then hopefully a working portal.\n<!--more-->\n\n# The Installation\n\nFirst, download the installation file (yes, singular) through the link you've got in your email and save it somewhere proper.\n![SquaredUp - Installation Package](http://www.teknoglot.se/wp-content/uploads/2014/09/152402_0001.png \"SquaredUp - Installation Package\")\n\nDoubleclicked the installation packaged and it now tells me it will install a few pre-requisites and configure the website for me. Next!\n\n![Installation Information](http://www.teknoglot.se/wp-content/uploads/2014/09/152428_0002.png \"SquaredUp - Something something components\")\n\nThe <abbr title=\"End User License Agreement\">EULA</abbr> I am sure each one of you are reading. Next!\n![EULA](http://www.teknoglot.se/wp-content/uploads/2014/09/152447_0003.png \"SquaredUp - Yeah, mhm... Read it.\")\n\nInstalling, or rather configuring, <abbr title=\"Internet Information Services\">IIS</abbr> and pre-requisites for me. Very nice. Next!\n\n![Installing/Configuring IIS](http://www.teknoglot.se/wp-content/uploads/2014/09/152506_0004.png \"SquaredUp - installing IIS for me... nice.\")\n\nQuick summary before actual installation. Next!\n\n![Installation Summary](http://www.teknoglot.se/wp-content/uploads/2014/09/152525_0005.png \"SquaredUp - Webroot... ok, sure.\")\n\nThis step actually requires a little action on your part. In this installation, the default setting \"localhost\" would actually work but I prefer to actually configure these things properly. I only have a single Management Server in this lab, so testing a load-balanced highly available scenario was not possible. Enter Management Server name, then Next!\n\n![Configuring the Management Server](http://www.teknoglot.se/wp-content/uploads/2014/09/152612_0006.png \"SquaredUp - Configure Management Server\")\n\nAfter a slight case of progress-bar the installation is now complete. Click link and exit the installer. Time spent so far is less than ten minutes, probably closer to five.\nNow it's time to login using your normal <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> credentials.\n\n![Login Screen](http://www.teknoglot.se/wp-content/uploads/2014/09/152750_0008.png \"SquaredUp - Login Screen\")\n\nFirst login will bring you to the Activation Screen. Simply paste the activation key from the email and Activate. This requires a working internet connection.\n\n![Activation Screen](http://www.teknoglot.se/wp-content/uploads/2014/09/153833_0010.png \"SquaredUp - Activation Screen\")\n\nThat's it! Well... not really. Navigating the portal I noticed that the spark-lines aren't showing, and hitting the \"View Performance\" link on an object view gives me a \"Login failed for user...\" error. I know I saw something about configuring the Data Warehouse in the email, so I check the blissfully simple Settings panel.\n![Settings Panel - DW Configuration](http://www.teknoglot.se/wp-content/uploads/2014/09/154502_0012.png \"SquaredUp - Configure DW Help\")\n\nFollowed the [instructions](http://support.squaredup.com/support/solutions/articles/27999 \"Squared Up - Configuring Data Warehouse Permissions\") to configure the security of the OperationsManagerDW database for the SquaredUp web application, and that's really it. Portal is up and running, spark-lines working. Ready to go.\n\n# Conclusion\n\nI wish more products and \"add-ons\" to <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> were this easy to install. No extra databases, no extra permissions, no extra infrastructure. I would like to try it out in a larger environment and see what the load on the website, the databases and the data access service will be. It would also be necessary to verify that it works properly when the management servers are behind a load balancer and maybe even putting the SquaredUp portal behind one itself. Since there is not a lot of configuration to be done and no database, it _should_ work. We'll see.\n\nNext up will be fiddling about with custom dashboards, maps, and generally figuring out what else we can do.","slug":"squaredup-installation","published":1,"updated":"2016-05-24T20:56:13.235Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kk003xq4o2pxolnpol","content":"<h1 id=\"Story-time\"><a href=\"#Story-time\" class=\"headerlink\" title=\"Story-time\"></a>Story-time</h1><p>I saw <a href=\"http://www.squaredup.com/\" title=\"SquaredUp\" target=\"_blank\" rel=\"external\">SquaredUp</a> some year or two ago while googling about on behalf of a customer looking for a dashboard kind of thingy. It looked good and fairly simple, but for some reason it never clicked with the customer and we ended up going for some custom-made dashboards with a little scripting and some <abbr title=\"Database\">DB</abbr>-queries. I kind of liked the look of their product though and have kept an eye on them now and then.<br>Fast-forward to may 21st this year and the <a href=\"http://www.squaredup.com/blog/proudly-announcing-squared-v18\" title=\"Proudly Announcing v1.8\" target=\"_blank\" rel=\"external\">release of version 1.8</a> and a whole slew of <a href=\"http://www.squaredup.com/blog/squared-v18-new-features\" title=\"New Features in v1.8\" target=\"_blank\" rel=\"external\">nifty little features</a>. What specifically piqued my interest was the linked dashboards, SharePoint integration and the included SLA and Map plugins. This basically ticked a lot of boxes many of my customers have looked for and something we’ve normally been looking into… err… <em>other products</em> for. That, coupled with some new videos on their <a href=\"https://www.youtube.com/user/SquaredUpLtd\" title=\"SquaredUp YouTube Channel\" target=\"_blank\" rel=\"external\">Youtube-channel</a>, a few well-placed tweets and a little mail-correspondence had me setting it up in my portable little lab.</p>\n<p>One of the interesting points is how, supposedly easy, it is to set the portal up. So I reset my lab – <abbr title=\"Powershell Deployment Toolkit\">PDT</abbr> is just wonderful – and decided to go for the hail-dummy approach. No manual, no preparations, no check-lists… Next-next-next then hopefully a working portal.<br><a id=\"more\"></a></p>\n<h1 id=\"The-Installation\"><a href=\"#The-Installation\" class=\"headerlink\" title=\"The Installation\"></a>The Installation</h1><p>First, download the installation file (yes, singular) through the link you’ve got in your email and save it somewhere proper.<br><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152402_0001.png\" alt=\"SquaredUp - Installation Package\" title=\"SquaredUp - Installation Package\"></p>\n<p>Doubleclicked the installation packaged and it now tells me it will install a few pre-requisites and configure the website for me. Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152428_0002.png\" alt=\"Installation Information\" title=\"SquaredUp - Something something components\"></p>\n<p>The <abbr title=\"End User License Agreement\">EULA</abbr> I am sure each one of you are reading. Next!<br><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152447_0003.png\" alt=\"EULA\" title=\"SquaredUp - Yeah, mhm... Read it.\"></p>\n<p>Installing, or rather configuring, <abbr title=\"Internet Information Services\">IIS</abbr> and pre-requisites for me. Very nice. Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152506_0004.png\" alt=\"Installing/Configuring IIS\" title=\"SquaredUp - installing IIS for me... nice.\"></p>\n<p>Quick summary before actual installation. Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152525_0005.png\" alt=\"Installation Summary\" title=\"SquaredUp - Webroot... ok, sure.\"></p>\n<p>This step actually requires a little action on your part. In this installation, the default setting “localhost” would actually work but I prefer to actually configure these things properly. I only have a single Management Server in this lab, so testing a load-balanced highly available scenario was not possible. Enter Management Server name, then Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152612_0006.png\" alt=\"Configuring the Management Server\" title=\"SquaredUp - Configure Management Server\"></p>\n<p>After a slight case of progress-bar the installation is now complete. Click link and exit the installer. Time spent so far is less than ten minutes, probably closer to five.<br>Now it’s time to login using your normal <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> credentials.</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152750_0008.png\" alt=\"Login Screen\" title=\"SquaredUp - Login Screen\"></p>\n<p>First login will bring you to the Activation Screen. Simply paste the activation key from the email and Activate. This requires a working internet connection.</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/153833_0010.png\" alt=\"Activation Screen\" title=\"SquaredUp - Activation Screen\"></p>\n<p>That’s it! Well… not really. Navigating the portal I noticed that the spark-lines aren’t showing, and hitting the “View Performance” link on an object view gives me a “Login failed for user…” error. I know I saw something about configuring the Data Warehouse in the email, so I check the blissfully simple Settings panel.<br><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/154502_0012.png\" alt=\"Settings Panel - DW Configuration\" title=\"SquaredUp - Configure DW Help\"></p>\n<p>Followed the <a href=\"http://support.squaredup.com/support/solutions/articles/27999\" title=\"Squared Up - Configuring Data Warehouse Permissions\" target=\"_blank\" rel=\"external\">instructions</a> to configure the security of the OperationsManagerDW database for the SquaredUp web application, and that’s really it. Portal is up and running, spark-lines working. Ready to go.</p>\n<h1 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h1><p>I wish more products and “add-ons” to <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> were this easy to install. No extra databases, no extra permissions, no extra infrastructure. I would like to try it out in a larger environment and see what the load on the website, the databases and the data access service will be. It would also be necessary to verify that it works properly when the management servers are behind a load balancer and maybe even putting the SquaredUp portal behind one itself. Since there is not a lot of configuration to be done and no database, it <em>should</em> work. We’ll see.</p>\n<p>Next up will be fiddling about with custom dashboards, maps, and generally figuring out what else we can do.</p>\n","excerpt":"<h1 id=\"Story-time\"><a href=\"#Story-time\" class=\"headerlink\" title=\"Story-time\"></a>Story-time</h1><p>I saw <a href=\"http://www.squaredup.com/\" title=\"SquaredUp\">SquaredUp</a> some year or two ago while googling about on behalf of a customer looking for a dashboard kind of thingy. It looked good and fairly simple, but for some reason it never clicked with the customer and we ended up going for some custom-made dashboards with a little scripting and some <abbr title=\"Database\">DB</abbr>-queries. I kind of liked the look of their product though and have kept an eye on them now and then.<br>Fast-forward to may 21st this year and the <a href=\"http://www.squaredup.com/blog/proudly-announcing-squared-v18\" title=\"Proudly Announcing v1.8\">release of version 1.8</a> and a whole slew of <a href=\"http://www.squaredup.com/blog/squared-v18-new-features\" title=\"New Features in v1.8\">nifty little features</a>. What specifically piqued my interest was the linked dashboards, SharePoint integration and the included SLA and Map plugins. This basically ticked a lot of boxes many of my customers have looked for and something we’ve normally been looking into… err… <em>other products</em> for. That, coupled with some new videos on their <a href=\"https://www.youtube.com/user/SquaredUpLtd\" title=\"SquaredUp YouTube Channel\">Youtube-channel</a>, a few well-placed tweets and a little mail-correspondence had me setting it up in my portable little lab.</p>\n<p>One of the interesting points is how, supposedly easy, it is to set the portal up. So I reset my lab – <abbr title=\"Powershell Deployment Toolkit\">PDT</abbr> is just wonderful – and decided to go for the hail-dummy approach. No manual, no preparations, no check-lists… Next-next-next then hopefully a working portal.<br>","more":"</p>\n<h1 id=\"The-Installation\"><a href=\"#The-Installation\" class=\"headerlink\" title=\"The Installation\"></a>The Installation</h1><p>First, download the installation file (yes, singular) through the link you’ve got in your email and save it somewhere proper.<br><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152402_0001.png\" alt=\"SquaredUp - Installation Package\" title=\"SquaredUp - Installation Package\"></p>\n<p>Doubleclicked the installation packaged and it now tells me it will install a few pre-requisites and configure the website for me. Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152428_0002.png\" alt=\"Installation Information\" title=\"SquaredUp - Something something components\"></p>\n<p>The <abbr title=\"End User License Agreement\">EULA</abbr> I am sure each one of you are reading. Next!<br><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152447_0003.png\" alt=\"EULA\" title=\"SquaredUp - Yeah, mhm... Read it.\"></p>\n<p>Installing, or rather configuring, <abbr title=\"Internet Information Services\">IIS</abbr> and pre-requisites for me. Very nice. Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152506_0004.png\" alt=\"Installing/Configuring IIS\" title=\"SquaredUp - installing IIS for me... nice.\"></p>\n<p>Quick summary before actual installation. Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152525_0005.png\" alt=\"Installation Summary\" title=\"SquaredUp - Webroot... ok, sure.\"></p>\n<p>This step actually requires a little action on your part. In this installation, the default setting “localhost” would actually work but I prefer to actually configure these things properly. I only have a single Management Server in this lab, so testing a load-balanced highly available scenario was not possible. Enter Management Server name, then Next!</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152612_0006.png\" alt=\"Configuring the Management Server\" title=\"SquaredUp - Configure Management Server\"></p>\n<p>After a slight case of progress-bar the installation is now complete. Click link and exit the installer. Time spent so far is less than ten minutes, probably closer to five.<br>Now it’s time to login using your normal <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> credentials.</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/152750_0008.png\" alt=\"Login Screen\" title=\"SquaredUp - Login Screen\"></p>\n<p>First login will bring you to the Activation Screen. Simply paste the activation key from the email and Activate. This requires a working internet connection.</p>\n<p><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/153833_0010.png\" alt=\"Activation Screen\" title=\"SquaredUp - Activation Screen\"></p>\n<p>That’s it! Well… not really. Navigating the portal I noticed that the spark-lines aren’t showing, and hitting the “View Performance” link on an object view gives me a “Login failed for user…” error. I know I saw something about configuring the Data Warehouse in the email, so I check the blissfully simple Settings panel.<br><img src=\"http://www.teknoglot.se/wp-content/uploads/2014/09/154502_0012.png\" alt=\"Settings Panel - DW Configuration\" title=\"SquaredUp - Configure DW Help\"></p>\n<p>Followed the <a href=\"http://support.squaredup.com/support/solutions/articles/27999\" title=\"Squared Up - Configuring Data Warehouse Permissions\">instructions</a> to configure the security of the OperationsManagerDW database for the SquaredUp web application, and that’s really it. Portal is up and running, spark-lines working. Ready to go.</p>\n<h1 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h1><p>I wish more products and “add-ons” to <abbr title=\"System Center 2012 - Operations Manager\">SCOM</abbr> were this easy to install. No extra databases, no extra permissions, no extra infrastructure. I would like to try it out in a larger environment and see what the load on the website, the databases and the data access service will be. It would also be necessary to verify that it works properly when the management servers are behind a load balancer and maybe even putting the SquaredUp portal behind one itself. Since there is not a lot of configuration to be done and no database, it <em>should</em> work. We’ll see.</p>\n<p>Next up will be fiddling about with custom dashboards, maps, and generally figuring out what else we can do.</p>"},{"title":"The TCP Port Check: Use with caution!","id":"202","date":"2009-08-27T12:39:43.000Z","_content":"\nJust wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007.\n\nSome customers have notices the the system-logs on some Unix machines are completely swamped with \"connection error\", \"TCP Connect failed\", \"TCP Session Lost\" and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check.\n\nIt would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there causing your friendly neighbour to hang around waiting for something to happen.\n\nMaybe there's a setting somewhere to modify how \"deep\" a Port Check should go before closing. Perhaps fully initializing and then sending a proper \"Close\" instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there's no closure and finally having no sessions to spare for the real users. But on most servers it's just an annoyance since the \"real\" errors is very hard to be found in all the connection related logs.\n\nAnyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007\\. Keep an eye on the logs when implementing the port checks.","source":"_posts/tcp-port-check-use-with-caution.md","raw":"---\ntitle: 'The TCP Port Check: Use with caution!'\ntags:\n  - Errors\n  - OpsMgr\n  - Unix\nid: 202\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-08-27 14:39:43\n---\n\nJust wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007.\n\nSome customers have notices the the system-logs on some Unix machines are completely swamped with \"connection error\", \"TCP Connect failed\", \"TCP Session Lost\" and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check.\n\nIt would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there causing your friendly neighbour to hang around waiting for something to happen.\n\nMaybe there's a setting somewhere to modify how \"deep\" a Port Check should go before closing. Perhaps fully initializing and then sending a proper \"Close\" instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there's no closure and finally having no sessions to spare for the real users. But on most servers it's just an annoyance since the \"real\" errors is very hard to be found in all the connection related logs.\n\nAnyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007\\. Keep an eye on the logs when implementing the port checks.","slug":"tcp-port-check-use-with-caution","published":1,"updated":"2016-05-24T20:52:12.982Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7km0040q4o2r2p01fwj","content":"<p>Just wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007.</p>\n<p>Some customers have notices the the system-logs on some Unix machines are completely swamped with “connection error”, “TCP Connect failed”, “TCP Session Lost” and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check.</p>\n<p>It would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there causing your friendly neighbour to hang around waiting for something to happen.</p>\n<p>Maybe there’s a setting somewhere to modify how “deep” a Port Check should go before closing. Perhaps fully initializing and then sending a proper “Close” instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there’s no closure and finally having no sessions to spare for the real users. But on most servers it’s just an annoyance since the “real” errors is very hard to be found in all the connection related logs.</p>\n<p>Anyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007. Keep an eye on the logs when implementing the port checks.</p>\n","excerpt":"","more":"<p>Just wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007.</p>\n<p>Some customers have notices the the system-logs on some Unix machines are completely swamped with “connection error”, “TCP Connect failed”, “TCP Session Lost” and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check.</p>\n<p>It would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there causing your friendly neighbour to hang around waiting for something to happen.</p>\n<p>Maybe there’s a setting somewhere to modify how “deep” a Port Check should go before closing. Perhaps fully initializing and then sending a proper “Close” instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there’s no closure and finally having no sessions to spare for the real users. But on most servers it’s just an annoyance since the “real” errors is very hard to be found in all the connection related logs.</p>\n<p>Anyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007. Keep an eye on the logs when implementing the port checks.</p>\n"},{"title":"Updated: MP for System Center Configurations Manager 2007 SP2 on x64","id":"233","date":"2009-11-03T11:13:00.000Z","_content":"\nMicrosoft has released an updated <acronym title=\"Management Pack\">MP</acronym> for <acronym title=\"System Center Configurations Manager\">SCCM </acronym>SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2.\n\nThe update basically contains support for x64 that was missing in the previous release.\n> The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. **Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact**.\n\nEmphasis is mine.\n\nRead more and download here:\n[http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b](http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b \"http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b\")","source":"_posts/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64.md","raw":"---\ntitle: 'Updated: MP for System Center Configurations Manager 2007 SP2 on x64'\ntags:\n  - Management Pack\n  - OpsMgr\n  - x64\nid: 233\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-11-03 12:13:00\n---\n\nMicrosoft has released an updated <acronym title=\"Management Pack\">MP</acronym> for <acronym title=\"System Center Configurations Manager\">SCCM </acronym>SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2.\n\nThe update basically contains support for x64 that was missing in the previous release.\n> The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. **Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact**.\n\nEmphasis is mine.\n\nRead more and download here:\n[http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b](http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b \"http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b\")","slug":"updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64","published":1,"updated":"2016-05-24T20:50:51.201Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kp0045q4o25sq7t454","content":"<p>Microsoft has released an updated <acronym title=\"Management Pack\">MP</acronym> for <acronym title=\"System Center Configurations Manager\">SCCM </acronym>SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2.</p>\n<p>The update basically contains support for x64 that was missing in the previous release.</p>\n<blockquote>\n<p>The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. <strong>Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact</strong>.</p>\n</blockquote>\n<p>Emphasis is mine.</p>\n<p>Read more and download here:<br><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b\" title=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b</a></p>\n","excerpt":"","more":"<p>Microsoft has released an updated <acronym title=\"Management Pack\">MP</acronym> for <acronym title=\"System Center Configurations Manager\">SCCM </acronym>SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2.</p>\n<p>The update basically contains support for x64 that was missing in the previous release.</p>\n<blockquote>\n<p>The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. <strong>Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact</strong>.</p>\n</blockquote>\n<p>Emphasis is mine.</p>\n<p>Read more and download here:<br><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b\" title=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b\">http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b</a></p>\n"},{"title":"Updated MSMQ Management Pack v6.0.6615.0!","id":"251","date":"2009-12-23T08:57:38.000Z","_content":"\nMicrosoft has released an update to the MSMQ (version 3) management pack.\n\n```text\nSystem Center Pack for: Message Queuing 3.0\nVersion:      6.0.6615.0\nReleased on:  12/14/2009\n\nMessage Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging.\n```\n\nNow, what’s really interesting is what you will find in the MP Guide under “Supported Configurations”.\n> The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only.\n\n> The Message Queuing Management Pack supports the following platforms:\n> - Windows Server 2003\n> - Windows XP\n\n> ***The Message Queuing Management Pack also supports monitoring clustered MSMQ components***\n\nEmphasis by me.\n\nFinally, MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under “Changes in This Update”.\n\n> The December 2009 update to this management pack includes the following change:\n\n> - Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster.\n> - Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances.\n\nThe confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C’mon Microsoft! You _write_ the best practices, try to stick to them.) and generally improving display and documentation.\n\nGonna import this to our staging environment today and let it roll during the holidays.\n\nDownload and documentation:\n[http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&displaylang=en&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&displaylang=en&displaylang=en \"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&displaylang=en&displaylang=en\")\n\nCheers! Oh, and happy holidays!\n","source":"_posts/updated-msmq-management-pack.md","raw":"---\ntitle: Updated MSMQ Management Pack v6.0.6615.0!\ntags:\n  - Management Pack\n  - MSMQ\n  - OpsMgr\nid: 251\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-12-23 09:57:38\n---\n\nMicrosoft has released an update to the MSMQ (version 3) management pack.\n\n```text\nSystem Center Pack for: Message Queuing 3.0\nVersion:      6.0.6615.0\nReleased on:  12/14/2009\n\nMessage Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging.\n```\n\nNow, what’s really interesting is what you will find in the MP Guide under “Supported Configurations”.\n> The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only.\n\n> The Message Queuing Management Pack supports the following platforms:\n> - Windows Server 2003\n> - Windows XP\n\n> ***The Message Queuing Management Pack also supports monitoring clustered MSMQ components***\n\nEmphasis by me.\n\nFinally, MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under “Changes in This Update”.\n\n> The December 2009 update to this management pack includes the following change:\n\n> - Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster.\n> - Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances.\n\nThe confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C’mon Microsoft! You _write_ the best practices, try to stick to them.) and generally improving display and documentation.\n\nGonna import this to our staging environment today and let it roll during the holidays.\n\nDownload and documentation:\n[http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&displaylang=en&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&displaylang=en&displaylang=en \"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&displaylang=en&displaylang=en\")\n\nCheers! Oh, and happy holidays!\n","slug":"updated-msmq-management-pack","published":1,"updated":"2016-05-24T20:48:40.153Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kr0047q4o2an3nbbq0","content":"<p>Microsoft has released an update to the MSMQ (version 3) management pack.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">System Center Pack for: Message Queuing 3.0</span><br><span class=\"line\">Version:      6.0.6615.0</span><br><span class=\"line\">Released on:  12/14/2009</span><br><span class=\"line\"></span><br><span class=\"line\">Message Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging.</span><br></pre></td></tr></table></figure>\n<p>Now, what’s really interesting is what you will find in the MP Guide under “Supported Configurations”.</p>\n<blockquote>\n<p>The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only.</p>\n<p>The Message Queuing Management Pack supports the following platforms:</p>\n<ul>\n<li>Windows Server 2003</li>\n<li>Windows XP</li>\n</ul>\n<p><strong><em>The Message Queuing Management Pack also supports monitoring clustered MSMQ components</em></strong></p>\n</blockquote>\n<p>Emphasis by me.</p>\n<p>Finally, MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under “Changes in This Update”.</p>\n<blockquote>\n<p>The December 2009 update to this management pack includes the following change:</p>\n<ul>\n<li>Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster.</li>\n<li>Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances.</li>\n</ul>\n</blockquote>\n<p>The confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C’mon Microsoft! You <em>write</em> the best practices, try to stick to them.) and generally improving display and documentation.</p>\n<p>Gonna import this to our staging environment today and let it roll during the holidays.</p>\n<p>Download and documentation:<br><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en\" title=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en</a></p>\n<p>Cheers! Oh, and happy holidays!</p>\n","excerpt":"","more":"<p>Microsoft has released an update to the MSMQ (version 3) management pack.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">System Center Pack for: Message Queuing 3.0</span><br><span class=\"line\">Version:      6.0.6615.0</span><br><span class=\"line\">Released on:  12/14/2009</span><br><span class=\"line\"></span><br><span class=\"line\">Message Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging.</span><br></pre></td></tr></table></figure>\n<p>Now, what’s really interesting is what you will find in the MP Guide under “Supported Configurations”.</p>\n<blockquote>\n<p>The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only.</p>\n<p>The Message Queuing Management Pack supports the following platforms:</p>\n<ul>\n<li>Windows Server 2003</li>\n<li>Windows XP</li>\n</ul>\n<p><strong><em>The Message Queuing Management Pack also supports monitoring clustered MSMQ components</em></strong></p>\n</blockquote>\n<p>Emphasis by me.</p>\n<p>Finally, MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under “Changes in This Update”.</p>\n<blockquote>\n<p>The December 2009 update to this management pack includes the following change:</p>\n<ul>\n<li>Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster.</li>\n<li>Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances.</li>\n</ul>\n</blockquote>\n<p>The confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C’mon Microsoft! You <em>write</em> the best practices, try to stick to them.) and generally improving display and documentation.</p>\n<p>Gonna import this to our staging environment today and let it roll during the holidays.</p>\n<p>Download and documentation:<br><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en\" title=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en\">http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en</a></p>\n<p>Cheers! Oh, and happy holidays!</p>\n"},{"title":"Updated: Operations Manager 2007 R2 Management Pack","id":"225","date":"2009-10-14T09:29:00.000Z","_content":"\nMicrosoft released an updated <acronym title=\"Management Pack\">MP</acronym> (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components.\n\nMost significant updates, according to me, would seem to be:\n  > Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.\n  > Added the rule “Collects Opsmgr <acronym title=\"Software Development Kit\">SDK</acronym> ServiceClient Connections” to collect the number of connected clients for a given management group. This data is shown in the view “Console and SDK Connection Count” under the folder “Operations ManagerManagement Server Performance”.\n  > Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.\n  > Fixed the configuration of the rule “IIS Discovery Probe Module Execution Failure” to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert’s description.\n\nThe rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update.\n\nDownload at: [http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148](http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148 \"http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148\")","source":"_posts/updated-operations-manager-2007-r2-management-pack.md","raw":"---\ntitle: 'Updated: Operations Manager 2007 R2 Management Pack'\ntags:\n  - Management Pack\n  - OpsMgr\nid: 225\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-10-14 11:29:00\n---\n\nMicrosoft released an updated <acronym title=\"Management Pack\">MP</acronym> (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components.\n\nMost significant updates, according to me, would seem to be:\n  > Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.\n  > Added the rule “Collects Opsmgr <acronym title=\"Software Development Kit\">SDK</acronym> ServiceClient Connections” to collect the number of connected clients for a given management group. This data is shown in the view “Console and SDK Connection Count” under the folder “Operations ManagerManagement Server Performance”.\n  > Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.\n  > Fixed the configuration of the rule “IIS Discovery Probe Module Execution Failure” to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert’s description.\n\nThe rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update.\n\nDownload at: [http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148](http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148 \"http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148\")","slug":"updated-operations-manager-2007-r2-management-pack","published":1,"updated":"2016-05-24T20:42:03.573Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kt004bq4o2q2zberod","content":"<p>Microsoft released an updated <acronym title=\"Management Pack\">MP</acronym> (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components.</p>\n<p>Most significant updates, according to me, would seem to be:</p>\n<blockquote>\n<p>Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.<br>Added the rule “Collects Opsmgr <acronym title=\"Software Development Kit\">SDK</acronym> ServiceClient Connections” to collect the number of connected clients for a given management group. This data is shown in the view “Console and SDK Connection Count” under the folder “Operations ManagerManagement Server Performance”.<br>Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.<br>Fixed the configuration of the rule “IIS Discovery Probe Module Execution Failure” to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert’s description.</p>\n</blockquote>\n<p>The rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update.</p>\n<p>Download at: <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148\" title=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148</a></p>\n","excerpt":"","more":"<p>Microsoft released an updated <acronym title=\"Management Pack\">MP</acronym> (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components.</p>\n<p>Most significant updates, according to me, would seem to be:</p>\n<blockquote>\n<p>Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.<br>Added the rule “Collects Opsmgr <acronym title=\"Software Development Kit\">SDK</acronym> ServiceClient Connections” to collect the number of connected clients for a given management group. This data is shown in the view “Console and SDK Connection Count” under the folder “Operations ManagerManagement Server Performance”.<br>Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.<br>Fixed the configuration of the rule “IIS Discovery Probe Module Execution Failure” to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert’s description.</p>\n</blockquote>\n<p>The rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update.</p>\n<p>Download at: <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148\" title=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148\">http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148</a></p>\n"},{"title":"Virtual OpenVPN Server at Home","id":"584","date":"2011-09-28T06:37:39.000Z","_content":"\nI was going to write a post on how to install and configure your own virtual SSL-VPN server as I had in mind to make one myself as a means to surf safely while on hotspots and to access my System Center lab at home.\n\nI'm not gonna do that. Instead I just want to point to this free, already pre-configured, [OpenVPN Virtual Appliance](http://www.vmware.com/appliances/directory/va/320963 \"Free OpenVPN Appliance\"). Just follow its instructions and it will work quite nicely.\n\nHave fun.","source":"_posts/virtual-openvpn-server-at-home.md","raw":"---\ntitle: Virtual OpenVPN Server at Home\ntags:\n  - Linux\n  - OpenVPN\n  - Virtual Appliance\nid: 584\ncategories:\n  - Linux\ndate: 2011-09-28 08:37:39\n---\n\nI was going to write a post on how to install and configure your own virtual SSL-VPN server as I had in mind to make one myself as a means to surf safely while on hotspots and to access my System Center lab at home.\n\nI'm not gonna do that. Instead I just want to point to this free, already pre-configured, [OpenVPN Virtual Appliance](http://www.vmware.com/appliances/directory/va/320963 \"Free OpenVPN Appliance\"). Just follow its instructions and it will work quite nicely.\n\nHave fun.","slug":"virtual-openvpn-server-at-home","published":1,"updated":"2016-05-19T09:11:09.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7kv004dq4o2f79c4s7s","content":"<p>I was going to write a post on how to install and configure your own virtual SSL-VPN server as I had in mind to make one myself as a means to surf safely while on hotspots and to access my System Center lab at home.</p>\n<p>I’m not gonna do that. Instead I just want to point to this free, already pre-configured, <a href=\"http://www.vmware.com/appliances/directory/va/320963\" title=\"Free OpenVPN Appliance\" target=\"_blank\" rel=\"external\">OpenVPN Virtual Appliance</a>. Just follow its instructions and it will work quite nicely.</p>\n<p>Have fun.</p>\n","excerpt":"","more":"<p>I was going to write a post on how to install and configure your own virtual SSL-VPN server as I had in mind to make one myself as a means to surf safely while on hotspots and to access my System Center lab at home.</p>\n<p>I’m not gonna do that. Instead I just want to point to this free, already pre-configured, <a href=\"http://www.vmware.com/appliances/directory/va/320963\" title=\"Free OpenVPN Appliance\">OpenVPN Virtual Appliance</a>. Just follow its instructions and it will work quite nicely.</p>\n<p>Have fun.</p>\n"},{"title":"w3Socket in VBScript","id":"59","date":"2007-04-21T14:10:05.000Z","_content":"\nI've been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for... stuff.\nSince we're not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in <acronym title=\"VisualBasic Script\">VBS</acronym>/<acronym title=\"Windows Scripting Host\">WSH.</acronym>\n\nThankfully for me, [Dimac](http://www.dimac.com/ \"Dimac\") has release a [nifty little component](http://www.dimac.com/default3.asp?M=FreeDownloads/Menu.asp&amp;P=FreeDownloads/FreeDownloadsstart.asp \"Dimac - Free Downloads\") for free that makes talking telnet in VBS very simple.\n\nI thought that, hey! I must share this!\nSo here's an example in Classic VBS:\n\n```vbs\nDim oTelnet\noTelnet = CreateObject(Socket.Tcp)\n\nWith oTelnet\n.DoTelnetEmulation = True\n.TelnetEmulation = TTY\n.Host = 192.168.242.1:23\n.Open\n.WaitFor SLUSSEN login:\n.SendLine ANiftyUsename\n.WaitFor Password:\n.SendLine TEHP@ssw0rd\n.WaitFor ~ #\n.SendLine ifconfig\nMsgBox .Buffer\n.Close\nEnd With\n\nSet oTelnet = Nothing\n```\n\nNot very hard at all. This one is connecting to my router (with fake user/pwd... DUH!) and there's no support for setting the prompt type there, thus the \"~ #\".\nThe result of running this script with correct login info gives me a popup with the routers <acronym title=\"Network Interface Card\">NIC</acronym>-configuration.","source":"_posts/w3socket-in-vbscript.md","raw":"---\ntitle: w3Socket in VBScript\ntags:\n  - Script\nid: 59\ncategories:\n  - Code\n  - VBS\ndate: 2007-04-21 16:10:05\n---\n\nI've been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for... stuff.\nSince we're not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in <acronym title=\"VisualBasic Script\">VBS</acronym>/<acronym title=\"Windows Scripting Host\">WSH.</acronym>\n\nThankfully for me, [Dimac](http://www.dimac.com/ \"Dimac\") has release a [nifty little component](http://www.dimac.com/default3.asp?M=FreeDownloads/Menu.asp&amp;P=FreeDownloads/FreeDownloadsstart.asp \"Dimac - Free Downloads\") for free that makes talking telnet in VBS very simple.\n\nI thought that, hey! I must share this!\nSo here's an example in Classic VBS:\n\n```vbs\nDim oTelnet\noTelnet = CreateObject(Socket.Tcp)\n\nWith oTelnet\n.DoTelnetEmulation = True\n.TelnetEmulation = TTY\n.Host = 192.168.242.1:23\n.Open\n.WaitFor SLUSSEN login:\n.SendLine ANiftyUsename\n.WaitFor Password:\n.SendLine TEHP@ssw0rd\n.WaitFor ~ #\n.SendLine ifconfig\nMsgBox .Buffer\n.Close\nEnd With\n\nSet oTelnet = Nothing\n```\n\nNot very hard at all. This one is connecting to my router (with fake user/pwd... DUH!) and there's no support for setting the prompt type there, thus the \"~ #\".\nThe result of running this script with correct login info gives me a popup with the routers <acronym title=\"Network Interface Card\">NIC</acronym>-configuration.","slug":"w3socket-in-vbscript","published":1,"updated":"2016-05-24T20:02:59.883Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7l1004iq4o26sig0qtb","content":"<p>I’ve been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for… stuff.<br>Since we’re not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in <acronym title=\"VisualBasic Script\">VBS</acronym>/<acronym title=\"Windows Scripting Host\">WSH.</acronym></p>\n<p>Thankfully for me, <a href=\"http://www.dimac.com/\" title=\"Dimac\" target=\"_blank\" rel=\"external\">Dimac</a> has release a <a href=\"http://www.dimac.com/default3.asp?M=FreeDownloads/Menu.asp&amp;P=FreeDownloads/FreeDownloadsstart.asp\" title=\"Dimac - Free Downloads\" target=\"_blank\" rel=\"external\">nifty little component</a> for free that makes talking telnet in VBS very simple.</p>\n<p>I thought that, hey! I must share this!<br>So here’s an example in Classic VBS:</p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Dim</span> oTelnet</span><br><span class=\"line\">oTelnet = <span class=\"built_in\">CreateObject</span>(Socket.Tcp)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">With</span> oTelnet</span><br><span class=\"line\">.DoTelnetEmulation = <span class=\"literal\">True</span></span><br><span class=\"line\">.TelnetEmulation = TTY</span><br><span class=\"line\">.Host = <span class=\"number\">192.168</span><span class=\"number\">.242</span><span class=\"number\">.1</span>:<span class=\"number\">23</span></span><br><span class=\"line\">.Open</span><br><span class=\"line\">.WaitFor SLUSSEN login:</span><br><span class=\"line\">.SendLine ANiftyUsename</span><br><span class=\"line\">.WaitFor Password:</span><br><span class=\"line\">.SendLine TEHP@ssw0rd</span><br><span class=\"line\">.WaitFor ~ #</span><br><span class=\"line\">.SendLine ifconfig</span><br><span class=\"line\"><span class=\"built_in\">MsgBox</span> .Buffer</span><br><span class=\"line\">.Close</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> oTelnet = <span class=\"literal\">Nothing</span></span><br></pre></td></tr></table></figure>\n<p>Not very hard at all. This one is connecting to my router (with fake user/pwd… DUH!) and there’s no support for setting the prompt type there, thus the “~ #”.<br>The result of running this script with correct login info gives me a popup with the routers <acronym title=\"Network Interface Card\">NIC</acronym>-configuration.</p>\n","excerpt":"","more":"<p>I’ve been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for… stuff.<br>Since we’re not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in <acronym title=\"VisualBasic Script\">VBS</acronym>/<acronym title=\"Windows Scripting Host\">WSH.</acronym></p>\n<p>Thankfully for me, <a href=\"http://www.dimac.com/\" title=\"Dimac\">Dimac</a> has release a <a href=\"http://www.dimac.com/default3.asp?M=FreeDownloads/Menu.asp&amp;P=FreeDownloads/FreeDownloadsstart.asp\" title=\"Dimac - Free Downloads\">nifty little component</a> for free that makes talking telnet in VBS very simple.</p>\n<p>I thought that, hey! I must share this!<br>So here’s an example in Classic VBS:</p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Dim</span> oTelnet</span><br><span class=\"line\">oTelnet = <span class=\"built_in\">CreateObject</span>(Socket.Tcp)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">With</span> oTelnet</span><br><span class=\"line\">.DoTelnetEmulation = <span class=\"literal\">True</span></span><br><span class=\"line\">.TelnetEmulation = TTY</span><br><span class=\"line\">.Host = <span class=\"number\">192.168</span><span class=\"number\">.242</span><span class=\"number\">.1</span>:<span class=\"number\">23</span></span><br><span class=\"line\">.Open</span><br><span class=\"line\">.WaitFor SLUSSEN login:</span><br><span class=\"line\">.SendLine ANiftyUsename</span><br><span class=\"line\">.WaitFor Password:</span><br><span class=\"line\">.SendLine TEHP@ssw0rd</span><br><span class=\"line\">.WaitFor ~ #</span><br><span class=\"line\">.SendLine ifconfig</span><br><span class=\"line\"><span class=\"built_in\">MsgBox</span> .Buffer</span><br><span class=\"line\">.Close</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">With</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> oTelnet = <span class=\"literal\">Nothing</span></span><br></pre></td></tr></table></figure>\n<p>Not very hard at all. This one is connecting to my router (with fake user/pwd… DUH!) and there’s no support for setting the prompt type there, thus the “~ #”.<br>The result of running this script with correct login info gives me a popup with the routers <acronym title=\"Network Interface Card\">NIC</acronym>-configuration.</p>\n"},{"title":"Why not use SQL Express? It’s for free!","id":"195","date":"2009-08-21T08:38:55.000Z","_content":"\n# Background\n\nI get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here’s a little guidance.\n\nDon’t get me wrong now.\nSQL Express has it’s applications and for a free database server, it’s not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express.\n\n## My Checklist\n\nHere’s my list of questions you have to ask to find if SQL Express is the correct choice.\n\n### 1. Do your applications support SQL Express?\n\nIf your application developers cannot say “Yes” to this, you’re out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch.\n\n### 2. Do your applications fit the hardware limitations?\n\nSQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, [according to Microsoft](http://msdn.microsoft.com/en-us/library/ms345154%28SQL.90%29.aspx#sseover_topic4), you cannot run parallel queries.\n\n> ”SQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.”\n\nIf this is still true on SQL Express 2008, I don’t know and I haven’t found any information about it (yet).\n\nWhen answering this question, remember to calculate expected growth and possibly new databases/applications too.\n\n### 2. Do your applications use database replication?\n\n  If, so. Do the new server need to act as a publisher? If, yes, then you’re out of luck. SQL Express do handle database replication, but only as a subscriber. If you need to publish data, then you need a “bigger” SQL Edition.\n\n### 4. Do you need Database Mail?\n\nSQL Express does not have Database Mail. You have to find other ways to code your notifications. This question has raised counter-questions from customers as to “What would I need Database Mail for?”. It is, evidently a feature not used by many. Personally, I find it useful. [Clay McDonald has a nice blog-post](http://claysql.blogspot.com/2009/02/send-database-mail-from-trigger.html) on how to make SQL-triggers send mail on, for instance, inserts into a table using Database Mail. You could of course have it send mail on deletions as well. In my mind, this might come in handy in user-databases in CRM- or HR-systems. Every time an employee gets deleted from the database, the HR-admin could receive a notification.\n\n### 5. Do you need the SQL Agent?\n\nPerhaps not. Maybe you feel comfortable with scheduling your database backups using the windows scheduler and homebrew scripts. Just make sure your monitoring software (or IT-personnel) discover when the script fails. An increasing amount of applications require the SQL Agent to schedule and monitor recurring tasks, like Microsoft's App-V. Without the SQL Agent, the databases would grow ad infinitum. How about index maintenance? This is also possible to go by using your own scripts and the windows scheduler. SQL Express can do most maintenance tasks you would need using scripts and T-SQL. The SQL Agent just makes it simpler and more manageable. Once again, double-check this with the application developer.\n\n### 6. Do you application use SSIS/DTS-jobs?\n\nThis is not included in SQL Express. Maybe there’s a work-around, but I haven’t found it and I doubt it is supported by anyone.\n\n### 7. Do you need to be able to troubleshoot performance problems?\n\nYou can do this on SQL Express with a great deal of knowledge and timers. The SQL-profiler, the Performance Data Collection and the Database Tuning Advisor makes it easier. Specifically, the SQL-profiler comes in really handy when you suspect the application (not the system) to be the bad guy since you can trace the queries and pin-point where the performance-hit resides. Using the SQL-profiler I have been able to optimise indexes to and thus making database servers go from a 98% CPU Load to 3% CPU Load. I have also been able to pin-point specific queries and use them as “evidence” that the problem is bad/sloppy code rather than problems with the database server. Also, using the SQL-profiler.\n\nThere’s more, of course, but these point are the most common pit-falls in my experience. As you can see, there’s three “do you need”-questions  and there are highly optional. Far from everyone use them and often because of lacking SQL Server knowledge. You don’t know what you can do. Still, the most important question is #1\\. Is SQL Express a supported database server for your applications. Hopefully, the developer knows the answer to this directly. No maybe’s. Yes or No.\n\nPersonally, I find that If you need a database server for production data, don’t go for SQL Express. Many customers have gone that way because “it’s free!” just to find themselves in the midst of a SQL Server upgrade and database migration a year later.","source":"_posts/whynotusesqlexpress-itsforfree.md","raw":"---\ntitle: Why not use SQL Express? It’s for free!\ntags:\n  - Checklist\n  - SQL Express 2005\n  - SQL Express 2008\nid: 195\ncategories:\n  - Microsoft\n  - SQL Server\ndate: 2009-08-21 10:38:55\n---\n\n# Background\n\nI get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here’s a little guidance.\n\nDon’t get me wrong now.\nSQL Express has it’s applications and for a free database server, it’s not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express.\n\n## My Checklist\n\nHere’s my list of questions you have to ask to find if SQL Express is the correct choice.\n\n### 1. Do your applications support SQL Express?\n\nIf your application developers cannot say “Yes” to this, you’re out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch.\n\n### 2. Do your applications fit the hardware limitations?\n\nSQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, [according to Microsoft](http://msdn.microsoft.com/en-us/library/ms345154%28SQL.90%29.aspx#sseover_topic4), you cannot run parallel queries.\n\n> ”SQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.”\n\nIf this is still true on SQL Express 2008, I don’t know and I haven’t found any information about it (yet).\n\nWhen answering this question, remember to calculate expected growth and possibly new databases/applications too.\n\n### 2. Do your applications use database replication?\n\n  If, so. Do the new server need to act as a publisher? If, yes, then you’re out of luck. SQL Express do handle database replication, but only as a subscriber. If you need to publish data, then you need a “bigger” SQL Edition.\n\n### 4. Do you need Database Mail?\n\nSQL Express does not have Database Mail. You have to find other ways to code your notifications. This question has raised counter-questions from customers as to “What would I need Database Mail for?”. It is, evidently a feature not used by many. Personally, I find it useful. [Clay McDonald has a nice blog-post](http://claysql.blogspot.com/2009/02/send-database-mail-from-trigger.html) on how to make SQL-triggers send mail on, for instance, inserts into a table using Database Mail. You could of course have it send mail on deletions as well. In my mind, this might come in handy in user-databases in CRM- or HR-systems. Every time an employee gets deleted from the database, the HR-admin could receive a notification.\n\n### 5. Do you need the SQL Agent?\n\nPerhaps not. Maybe you feel comfortable with scheduling your database backups using the windows scheduler and homebrew scripts. Just make sure your monitoring software (or IT-personnel) discover when the script fails. An increasing amount of applications require the SQL Agent to schedule and monitor recurring tasks, like Microsoft's App-V. Without the SQL Agent, the databases would grow ad infinitum. How about index maintenance? This is also possible to go by using your own scripts and the windows scheduler. SQL Express can do most maintenance tasks you would need using scripts and T-SQL. The SQL Agent just makes it simpler and more manageable. Once again, double-check this with the application developer.\n\n### 6. Do you application use SSIS/DTS-jobs?\n\nThis is not included in SQL Express. Maybe there’s a work-around, but I haven’t found it and I doubt it is supported by anyone.\n\n### 7. Do you need to be able to troubleshoot performance problems?\n\nYou can do this on SQL Express with a great deal of knowledge and timers. The SQL-profiler, the Performance Data Collection and the Database Tuning Advisor makes it easier. Specifically, the SQL-profiler comes in really handy when you suspect the application (not the system) to be the bad guy since you can trace the queries and pin-point where the performance-hit resides. Using the SQL-profiler I have been able to optimise indexes to and thus making database servers go from a 98% CPU Load to 3% CPU Load. I have also been able to pin-point specific queries and use them as “evidence” that the problem is bad/sloppy code rather than problems with the database server. Also, using the SQL-profiler.\n\nThere’s more, of course, but these point are the most common pit-falls in my experience. As you can see, there’s three “do you need”-questions  and there are highly optional. Far from everyone use them and often because of lacking SQL Server knowledge. You don’t know what you can do. Still, the most important question is #1\\. Is SQL Express a supported database server for your applications. Hopefully, the developer knows the answer to this directly. No maybe’s. Yes or No.\n\nPersonally, I find that If you need a database server for production data, don’t go for SQL Express. Many customers have gone that way because “it’s free!” just to find themselves in the midst of a SQL Server upgrade and database migration a year later.","slug":"whynotusesqlexpress-itsforfree","published":1,"updated":"2016-05-24T20:40:08.948Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7l3004lq4o2e0lthizo","content":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>I get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here’s a little guidance.</p>\n<p>Don’t get me wrong now.<br>SQL Express has it’s applications and for a free database server, it’s not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express.</p>\n<h2 id=\"My-Checklist\"><a href=\"#My-Checklist\" class=\"headerlink\" title=\"My Checklist\"></a>My Checklist</h2><p>Here’s my list of questions you have to ask to find if SQL Express is the correct choice.</p>\n<h3 id=\"1-Do-your-applications-support-SQL-Express\"><a href=\"#1-Do-your-applications-support-SQL-Express\" class=\"headerlink\" title=\"1. Do your applications support SQL Express?\"></a>1. Do your applications support SQL Express?</h3><p>If your application developers cannot say “Yes” to this, you’re out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch.</p>\n<h3 id=\"2-Do-your-applications-fit-the-hardware-limitations\"><a href=\"#2-Do-your-applications-fit-the-hardware-limitations\" class=\"headerlink\" title=\"2. Do your applications fit the hardware limitations?\"></a>2. Do your applications fit the hardware limitations?</h3><p>SQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, <a href=\"http://msdn.microsoft.com/en-us/library/ms345154%28SQL.90%29.aspx#sseover_topic4\" target=\"_blank\" rel=\"external\">according to Microsoft</a>, you cannot run parallel queries.</p>\n<blockquote>\n<p>”SQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.”</p>\n</blockquote>\n<p>If this is still true on SQL Express 2008, I don’t know and I haven’t found any information about it (yet).</p>\n<p>When answering this question, remember to calculate expected growth and possibly new databases/applications too.</p>\n<h3 id=\"2-Do-your-applications-use-database-replication\"><a href=\"#2-Do-your-applications-use-database-replication\" class=\"headerlink\" title=\"2. Do your applications use database replication?\"></a>2. Do your applications use database replication?</h3><p>  If, so. Do the new server need to act as a publisher? If, yes, then you’re out of luck. SQL Express do handle database replication, but only as a subscriber. If you need to publish data, then you need a “bigger” SQL Edition.</p>\n<h3 id=\"4-Do-you-need-Database-Mail\"><a href=\"#4-Do-you-need-Database-Mail\" class=\"headerlink\" title=\"4. Do you need Database Mail?\"></a>4. Do you need Database Mail?</h3><p>SQL Express does not have Database Mail. You have to find other ways to code your notifications. This question has raised counter-questions from customers as to “What would I need Database Mail for?”. It is, evidently a feature not used by many. Personally, I find it useful. <a href=\"http://claysql.blogspot.com/2009/02/send-database-mail-from-trigger.html\" target=\"_blank\" rel=\"external\">Clay McDonald has a nice blog-post</a> on how to make SQL-triggers send mail on, for instance, inserts into a table using Database Mail. You could of course have it send mail on deletions as well. In my mind, this might come in handy in user-databases in CRM- or HR-systems. Every time an employee gets deleted from the database, the HR-admin could receive a notification.</p>\n<h3 id=\"5-Do-you-need-the-SQL-Agent\"><a href=\"#5-Do-you-need-the-SQL-Agent\" class=\"headerlink\" title=\"5. Do you need the SQL Agent?\"></a>5. Do you need the SQL Agent?</h3><p>Perhaps not. Maybe you feel comfortable with scheduling your database backups using the windows scheduler and homebrew scripts. Just make sure your monitoring software (or IT-personnel) discover when the script fails. An increasing amount of applications require the SQL Agent to schedule and monitor recurring tasks, like Microsoft’s App-V. Without the SQL Agent, the databases would grow ad infinitum. How about index maintenance? This is also possible to go by using your own scripts and the windows scheduler. SQL Express can do most maintenance tasks you would need using scripts and T-SQL. The SQL Agent just makes it simpler and more manageable. Once again, double-check this with the application developer.</p>\n<h3 id=\"6-Do-you-application-use-SSIS-DTS-jobs\"><a href=\"#6-Do-you-application-use-SSIS-DTS-jobs\" class=\"headerlink\" title=\"6. Do you application use SSIS/DTS-jobs?\"></a>6. Do you application use SSIS/DTS-jobs?</h3><p>This is not included in SQL Express. Maybe there’s a work-around, but I haven’t found it and I doubt it is supported by anyone.</p>\n<h3 id=\"7-Do-you-need-to-be-able-to-troubleshoot-performance-problems\"><a href=\"#7-Do-you-need-to-be-able-to-troubleshoot-performance-problems\" class=\"headerlink\" title=\"7. Do you need to be able to troubleshoot performance problems?\"></a>7. Do you need to be able to troubleshoot performance problems?</h3><p>You can do this on SQL Express with a great deal of knowledge and timers. The SQL-profiler, the Performance Data Collection and the Database Tuning Advisor makes it easier. Specifically, the SQL-profiler comes in really handy when you suspect the application (not the system) to be the bad guy since you can trace the queries and pin-point where the performance-hit resides. Using the SQL-profiler I have been able to optimise indexes to and thus making database servers go from a 98% CPU Load to 3% CPU Load. I have also been able to pin-point specific queries and use them as “evidence” that the problem is bad/sloppy code rather than problems with the database server. Also, using the SQL-profiler.</p>\n<p>There’s more, of course, but these point are the most common pit-falls in my experience. As you can see, there’s three “do you need”-questions  and there are highly optional. Far from everyone use them and often because of lacking SQL Server knowledge. You don’t know what you can do. Still, the most important question is #1. Is SQL Express a supported database server for your applications. Hopefully, the developer knows the answer to this directly. No maybe’s. Yes or No.</p>\n<p>Personally, I find that If you need a database server for production data, don’t go for SQL Express. Many customers have gone that way because “it’s free!” just to find themselves in the midst of a SQL Server upgrade and database migration a year later.</p>\n","excerpt":"","more":"<h1 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h1><p>I get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here’s a little guidance.</p>\n<p>Don’t get me wrong now.<br>SQL Express has it’s applications and for a free database server, it’s not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express.</p>\n<h2 id=\"My-Checklist\"><a href=\"#My-Checklist\" class=\"headerlink\" title=\"My Checklist\"></a>My Checklist</h2><p>Here’s my list of questions you have to ask to find if SQL Express is the correct choice.</p>\n<h3 id=\"1-Do-your-applications-support-SQL-Express\"><a href=\"#1-Do-your-applications-support-SQL-Express\" class=\"headerlink\" title=\"1. Do your applications support SQL Express?\"></a>1. Do your applications support SQL Express?</h3><p>If your application developers cannot say “Yes” to this, you’re out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch.</p>\n<h3 id=\"2-Do-your-applications-fit-the-hardware-limitations\"><a href=\"#2-Do-your-applications-fit-the-hardware-limitations\" class=\"headerlink\" title=\"2. Do your applications fit the hardware limitations?\"></a>2. Do your applications fit the hardware limitations?</h3><p>SQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, <a href=\"http://msdn.microsoft.com/en-us/library/ms345154%28SQL.90%29.aspx#sseover_topic4\">according to Microsoft</a>, you cannot run parallel queries.</p>\n<blockquote>\n<p>”SQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.”</p>\n</blockquote>\n<p>If this is still true on SQL Express 2008, I don’t know and I haven’t found any information about it (yet).</p>\n<p>When answering this question, remember to calculate expected growth and possibly new databases/applications too.</p>\n<h3 id=\"2-Do-your-applications-use-database-replication\"><a href=\"#2-Do-your-applications-use-database-replication\" class=\"headerlink\" title=\"2. Do your applications use database replication?\"></a>2. Do your applications use database replication?</h3><p>  If, so. Do the new server need to act as a publisher? If, yes, then you’re out of luck. SQL Express do handle database replication, but only as a subscriber. If you need to publish data, then you need a “bigger” SQL Edition.</p>\n<h3 id=\"4-Do-you-need-Database-Mail\"><a href=\"#4-Do-you-need-Database-Mail\" class=\"headerlink\" title=\"4. Do you need Database Mail?\"></a>4. Do you need Database Mail?</h3><p>SQL Express does not have Database Mail. You have to find other ways to code your notifications. This question has raised counter-questions from customers as to “What would I need Database Mail for?”. It is, evidently a feature not used by many. Personally, I find it useful. <a href=\"http://claysql.blogspot.com/2009/02/send-database-mail-from-trigger.html\">Clay McDonald has a nice blog-post</a> on how to make SQL-triggers send mail on, for instance, inserts into a table using Database Mail. You could of course have it send mail on deletions as well. In my mind, this might come in handy in user-databases in CRM- or HR-systems. Every time an employee gets deleted from the database, the HR-admin could receive a notification.</p>\n<h3 id=\"5-Do-you-need-the-SQL-Agent\"><a href=\"#5-Do-you-need-the-SQL-Agent\" class=\"headerlink\" title=\"5. Do you need the SQL Agent?\"></a>5. Do you need the SQL Agent?</h3><p>Perhaps not. Maybe you feel comfortable with scheduling your database backups using the windows scheduler and homebrew scripts. Just make sure your monitoring software (or IT-personnel) discover when the script fails. An increasing amount of applications require the SQL Agent to schedule and monitor recurring tasks, like Microsoft’s App-V. Without the SQL Agent, the databases would grow ad infinitum. How about index maintenance? This is also possible to go by using your own scripts and the windows scheduler. SQL Express can do most maintenance tasks you would need using scripts and T-SQL. The SQL Agent just makes it simpler and more manageable. Once again, double-check this with the application developer.</p>\n<h3 id=\"6-Do-you-application-use-SSIS-DTS-jobs\"><a href=\"#6-Do-you-application-use-SSIS-DTS-jobs\" class=\"headerlink\" title=\"6. Do you application use SSIS/DTS-jobs?\"></a>6. Do you application use SSIS/DTS-jobs?</h3><p>This is not included in SQL Express. Maybe there’s a work-around, but I haven’t found it and I doubt it is supported by anyone.</p>\n<h3 id=\"7-Do-you-need-to-be-able-to-troubleshoot-performance-problems\"><a href=\"#7-Do-you-need-to-be-able-to-troubleshoot-performance-problems\" class=\"headerlink\" title=\"7. Do you need to be able to troubleshoot performance problems?\"></a>7. Do you need to be able to troubleshoot performance problems?</h3><p>You can do this on SQL Express with a great deal of knowledge and timers. The SQL-profiler, the Performance Data Collection and the Database Tuning Advisor makes it easier. Specifically, the SQL-profiler comes in really handy when you suspect the application (not the system) to be the bad guy since you can trace the queries and pin-point where the performance-hit resides. Using the SQL-profiler I have been able to optimise indexes to and thus making database servers go from a 98% CPU Load to 3% CPU Load. I have also been able to pin-point specific queries and use them as “evidence” that the problem is bad/sloppy code rather than problems with the database server. Also, using the SQL-profiler.</p>\n<p>There’s more, of course, but these point are the most common pit-falls in my experience. As you can see, there’s three “do you need”-questions  and there are highly optional. Far from everyone use them and often because of lacking SQL Server knowledge. You don’t know what you can do. Still, the most important question is #1. Is SQL Express a supported database server for your applications. Hopefully, the developer knows the answer to this directly. No maybe’s. Yes or No.</p>\n<p>Personally, I find that If you need a database server for production data, don’t go for SQL Express. Many customers have gone that way because “it’s free!” just to find themselves in the midst of a SQL Server upgrade and database migration a year later.</p>\n"},{"title":"Windows Server 2008 NLB MP for OpsMgr released","id":"153","date":"2009-04-29T10:59:54.000Z","_content":"\nDon't know how I missed this when writing the last post, but Microsoft released the [MP for Windows Server 2008 NLB](http://www.microsoft.com/downloads/details.aspx?FamilyID=dc17e093-bdd7-4cb3-9981-853776ed90be&displaylang=en \"Windows Server 2008 Network Load Balancing for System Center Operations Manager 2007\") yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then.\n\n# Quick Details\n\n```text\nFile Name:      Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msi\nVersion:        6.0.6573.0\nDate Published: 4/28/2009\nLanguage:       English\nDownload Size:  519 KB\n```\n\n# Feature Summary\n\n* Monitor the NLB Node status.\n* Based on the status of individual cluster nodes, determine the overall state of the cluster.\n* Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS.\n* Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster.\n* Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again.\n\nRequires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the [QFEs for Windows Server 2008](http://support.microsoft.com/kb/953141 \"Support for running System Center Operations Manager 2007 Service Pack 1 and System Center Essentials 2007 Service Pack 1 on a Windows Server 2008-based computer\") and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the [QFE for wmiprvse.exe problems on Windows Server 2008](http://support.microsoft.com/kb/959493 \"The WMI Provider Host program (Wmiprvse.exe) may crash on a Windows Server 2008-based computer that has the NLB feature installed2008\").\n\nNo support for Mixed-mode (2008 and 2003) clusters though.","source":"_posts/windows-server-2008-nlb-m-for-opsmgr-released.md","raw":"---\ntitle: Windows Server 2008 NLB MP for OpsMgr released\ntags:\n  - Management Pack\n  - OpsMgr\nid: 153\ncategories:\n  - Microsoft\n  - OpsMgr 2007\ndate: 2009-04-29 12:59:54\n---\n\nDon't know how I missed this when writing the last post, but Microsoft released the [MP for Windows Server 2008 NLB](http://www.microsoft.com/downloads/details.aspx?FamilyID=dc17e093-bdd7-4cb3-9981-853776ed90be&displaylang=en \"Windows Server 2008 Network Load Balancing for System Center Operations Manager 2007\") yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then.\n\n# Quick Details\n\n```text\nFile Name:      Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msi\nVersion:        6.0.6573.0\nDate Published: 4/28/2009\nLanguage:       English\nDownload Size:  519 KB\n```\n\n# Feature Summary\n\n* Monitor the NLB Node status.\n* Based on the status of individual cluster nodes, determine the overall state of the cluster.\n* Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS.\n* Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster.\n* Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again.\n\nRequires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the [QFEs for Windows Server 2008](http://support.microsoft.com/kb/953141 \"Support for running System Center Operations Manager 2007 Service Pack 1 and System Center Essentials 2007 Service Pack 1 on a Windows Server 2008-based computer\") and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the [QFE for wmiprvse.exe problems on Windows Server 2008](http://support.microsoft.com/kb/959493 \"The WMI Provider Host program (Wmiprvse.exe) may crash on a Windows Server 2008-based computer that has the NLB feature installed2008\").\n\nNo support for Mixed-mode (2008 and 2003) clusters though.","slug":"windows-server-2008-nlb-m-for-opsmgr-released","published":1,"updated":"2016-05-24T20:26:37.040Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciq9xx7p500deq4o2187zzqa4","content":"<p>Don’t know how I missed this when writing the last post, but Microsoft released the <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=dc17e093-bdd7-4cb3-9981-853776ed90be&amp;displaylang=en\" title=\"Windows Server 2008 Network Load Balancing for System Center Operations Manager 2007\" target=\"_blank\" rel=\"external\">MP for Windows Server 2008 NLB</a> yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then.</p>\n<h1 id=\"Quick-Details\"><a href=\"#Quick-Details\" class=\"headerlink\" title=\"Quick Details\"></a>Quick Details</h1><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">File Name:      Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msi</span><br><span class=\"line\">Version:        6.0.6573.0</span><br><span class=\"line\">Date Published: 4/28/2009</span><br><span class=\"line\">Language:       English</span><br><span class=\"line\">Download Size:  519 KB</span><br></pre></td></tr></table></figure>\n<h1 id=\"Feature-Summary\"><a href=\"#Feature-Summary\" class=\"headerlink\" title=\"Feature Summary\"></a>Feature Summary</h1><ul>\n<li>Monitor the NLB Node status.</li>\n<li>Based on the status of individual cluster nodes, determine the overall state of the cluster.</li>\n<li>Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS.</li>\n<li>Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster.</li>\n<li>Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again.</li>\n</ul>\n<p>Requires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the <a href=\"http://support.microsoft.com/kb/953141\" title=\"Support for running System Center Operations Manager 2007 Service Pack 1 and System Center Essentials 2007 Service Pack 1 on a Windows Server 2008-based computer\" target=\"_blank\" rel=\"external\">QFEs for Windows Server 2008</a> and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the <a href=\"http://support.microsoft.com/kb/959493\" title=\"The WMI Provider Host program (Wmiprvse.exe) may crash on a Windows Server 2008-based computer that has the NLB feature installed2008\" target=\"_blank\" rel=\"external\">QFE for wmiprvse.exe problems on Windows Server 2008</a>.</p>\n<p>No support for Mixed-mode (2008 and 2003) clusters though.</p>\n","excerpt":"","more":"<p>Don’t know how I missed this when writing the last post, but Microsoft released the <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=dc17e093-bdd7-4cb3-9981-853776ed90be&amp;displaylang=en\" title=\"Windows Server 2008 Network Load Balancing for System Center Operations Manager 2007\">MP for Windows Server 2008 NLB</a> yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then.</p>\n<h1 id=\"Quick-Details\"><a href=\"#Quick-Details\" class=\"headerlink\" title=\"Quick Details\"></a>Quick Details</h1><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">File Name:      Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msi</span><br><span class=\"line\">Version:        6.0.6573.0</span><br><span class=\"line\">Date Published: 4/28/2009</span><br><span class=\"line\">Language:       English</span><br><span class=\"line\">Download Size:  519 KB</span><br></pre></td></tr></table></figure>\n<h1 id=\"Feature-Summary\"><a href=\"#Feature-Summary\" class=\"headerlink\" title=\"Feature Summary\"></a>Feature Summary</h1><ul>\n<li>Monitor the NLB Node status.</li>\n<li>Based on the status of individual cluster nodes, determine the overall state of the cluster.</li>\n<li>Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS.</li>\n<li>Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster.</li>\n<li>Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again.</li>\n</ul>\n<p>Requires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the <a href=\"http://support.microsoft.com/kb/953141\" title=\"Support for running System Center Operations Manager 2007 Service Pack 1 and System Center Essentials 2007 Service Pack 1 on a Windows Server 2008-based computer\">QFEs for Windows Server 2008</a> and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the <a href=\"http://support.microsoft.com/kb/959493\" title=\"The WMI Provider Host program (Wmiprvse.exe) may crash on a Windows Server 2008-based computer that has the NLB feature installed2008\">QFE for wmiprvse.exe problems on Windows Server 2008</a>.</p>\n<p>No support for Mixed-mode (2008 and 2003) clusters though.</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ciq9xx7fy0001q4o26drvw510","category_id":"ciq9xx7gc0004q4o23x8odlfy","_id":"ciq9xx7he000vq4o2ns4o50mj"},{"post_id":"ciq9xx7fy0001q4o26drvw510","category_id":"ciq9xx7h2000kq4o2d9o5zcfj","_id":"ciq9xx7hh0010q4o25vupi6ev"},{"post_id":"ciq9xx7gk000aq4o29p4tnie6","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ho0017q4o23uo3v23j"},{"post_id":"ciq9xx7gk000aq4o29p4tnie6","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7hq001bq4o24spjufvl"},{"post_id":"ciq9xx7g50002q4o220i0g6c2","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ht001fq4o2p2vlknkb"},{"post_id":"ciq9xx7g50002q4o220i0g6c2","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7hw001iq4o24mztwd8n"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7hz001lq4o2mrfzqyz4"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7i4001oq4o2uwef8qpi"},{"post_id":"ciq9xx7gm000bq4o2a9pa3dvd","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7i6001rq4o2qje4wnxk"},{"post_id":"ciq9xx7gm000bq4o2a9pa3dvd","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7ic001uq4o25i17rkvb"},{"post_id":"ciq9xx7hr001dq4o2emv345dk","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ih001xq4o2erfyc873"},{"post_id":"ciq9xx7hr001dq4o2emv345dk","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7iw0021q4o2ct7en2gn"},{"post_id":"ciq9xx7hw001kq4o2k6enoedb","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7iy0025q4o2e1qub99h"},{"post_id":"ciq9xx7hw001kq4o2k6enoedb","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7j10029q4o21pdxr131"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","category_id":"ciq9xx7hv001hq4o2zlvf83fi","_id":"ciq9xx7j7002cq4o2vcrmncl3"},{"post_id":"ciq9xx7hz001mq4o2owmv64n1","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jb002gq4o2hq54nmyl"},{"post_id":"ciq9xx7hz001mq4o2owmv64n1","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7jd002iq4o2eeyszb7a"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jf002mq4o2w6sq11jq"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7ji002oq4o2s8myc9w5"},{"post_id":"ciq9xx7gd0005q4o2i8k6ryww","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jk002sq4o2sqxqo7pe"},{"post_id":"ciq9xx7gd0005q4o2i8k6ryww","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7jm002uq4o2z5qi3pd6"},{"post_id":"ciq9xx7ie001vq4o2aqyej17g","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jo002zq4o2uh3dr8js"},{"post_id":"ciq9xx7ie001vq4o2aqyej17g","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7jt0031q4o2u7ints7h"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7jv0033q4o21cy8qmma"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7jz0038q4o28ezsz328"},{"post_id":"ciq9xx7iw0022q4o2x54fs6ja","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7k1003bq4o2ftc5n85g"},{"post_id":"ciq9xx7iw0022q4o2x54fs6ja","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7k5003gq4o23fr37ukb"},{"post_id":"ciq9xx7gz000iq4o2ct04qohd","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7k7003jq4o2euxvznsx"},{"post_id":"ciq9xx7gz000iq4o2ct04qohd","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7kb003oq4o2ydd4z3fe"},{"post_id":"ciq9xx7iz0026q4o2yftymaxa","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7kg003rq4o2gnis0wou"},{"post_id":"ciq9xx7iz0026q4o2yftymaxa","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7kk003wq4o25444str0"},{"post_id":"ciq9xx7j1002aq4o2v1elhqqn","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7km003zq4o2ls31280l"},{"post_id":"ciq9xx7j1002aq4o2v1elhqqn","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7kp0044q4o2x7mfd574"},{"post_id":"ciq9xx7gg0006q4o2z3t52qk6","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7kr0046q4o2zgabd24w"},{"post_id":"ciq9xx7gg0006q4o2z3t52qk6","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7kt004aq4o2zc00u8dx"},{"post_id":"ciq9xx7j7002eq4o2237ghxqh","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7kv004cq4o2zezpx0j7"},{"post_id":"ciq9xx7j7002eq4o2237ghxqh","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7l1004gq4o2jfip20sr"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7l3004jq4o2531v6gll"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7l5004oq4o2eafsqipg"},{"post_id":"ciq9xx7h1000jq4o2s6vnewu8","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7l6004qq4o2md7f75ns"},{"post_id":"ciq9xx7jd002jq4o220fzgifc","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7l7004uq4o2fzd3ckbl"},{"post_id":"ciq9xx7jd002jq4o220fzgifc","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7l9004vq4o2a9vwhyju"},{"post_id":"ciq9xx7jg002nq4o288tp3r2v","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7la004xq4o2tfz17rpo"},{"post_id":"ciq9xx7jg002nq4o288tp3r2v","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7lb004zq4o2rj680gnf"},{"post_id":"ciq9xx7h5000mq4o2579s7pbi","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7lb0051q4o21yw5532s"},{"post_id":"ciq9xx7ji002pq4o28zte13lp","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lc0053q4o2xsna4tlg"},{"post_id":"ciq9xx7ji002pq4o28zte13lp","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7lc0054q4o2i7w9gmp5"},{"post_id":"ciq9xx7jk002tq4o2bcrmrtwa","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7ld0057q4o2xx0m0zuq"},{"post_id":"ciq9xx7jm002vq4o2mewjflqv","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7le0058q4o2hvn71bf0"},{"post_id":"ciq9xx7jm002vq4o2mewjflqv","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7lf005bq4o22v7nca5v"},{"post_id":"ciq9xx7jt0032q4o2tuhlm8dc","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7lg005dq4o2yjzs9apk"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lh005hq4o2ji10wwhw"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","category_id":"ciq9xx7jo002yq4o27a9bmlj2","_id":"ciq9xx7li005jq4o2lpigr3n2"},{"post_id":"ciq9xx7jv0035q4o2aohvr3fe","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7li005mq4o21z7fj78t"},{"post_id":"ciq9xx7jv0035q4o2aohvr3fe","category_id":"ciq9xx7jo002yq4o27a9bmlj2","_id":"ciq9xx7lj005oq4o2jfq0ezff"},{"post_id":"ciq9xx7jz0039q4o2p4v2rmdt","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lk005rq4o20b6597o9"},{"post_id":"ciq9xx7jz0039q4o2p4v2rmdt","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7lk005sq4o2x5xzbhwq"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lk005uq4o2tbzev0jd"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","category_id":"ciq9xx7jx0036q4o20uctcy44","_id":"ciq9xx7lk005vq4o2d1ey20zq"},{"post_id":"ciq9xx7k2003dq4o27dohnvnq","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7ll005xq4o2mj9zib2y"},{"post_id":"ciq9xx7hb000uq4o2gfs2sx1s","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ll005yq4o2ofhbqnhp"},{"post_id":"ciq9xx7hb000uq4o2gfs2sx1s","category_id":"ciq9xx7k4003eq4o2102x4tx2","_id":"ciq9xx7ll0060q4o2ym7yv5fe"},{"post_id":"ciq9xx7k8003lq4o2yusfcvlm","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7lm0062q4o2d751nrb5"},{"post_id":"ciq9xx7kb003pq4o2z6cj08lm","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ln0065q4o2um4vc89w"},{"post_id":"ciq9xx7kb003pq4o2z6cj08lm","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7ln0067q4o21rw5971t"},{"post_id":"ciq9xx7hg000yq4o2wx4yplad","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ln0069q4o2g1cxkpm4"},{"post_id":"ciq9xx7hg000yq4o2wx4yplad","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7lo006cq4o21a55w5d0"},{"post_id":"ciq9xx7kh003tq4o2xr975zjb","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lo006eq4o2lp7wvrza"},{"post_id":"ciq9xx7kh003tq4o2xr975zjb","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7lp006gq4o2acguo5td"},{"post_id":"ciq9xx7kk003xq4o2pxolnpol","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lp006hq4o2jritt4fi"},{"post_id":"ciq9xx7kk003xq4o2pxolnpol","category_id":"ciq9xx7hk0012q4o2jbnjdy7y","_id":"ciq9xx7lq006jq4o25mymjrt5"},{"post_id":"ciq9xx7hi0011q4o2x2sppbkz","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7lq006lq4o2j1ntad9p"},{"post_id":"ciq9xx7km0040q4o2r2p01fwj","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lq006oq4o2ysg92plv"},{"post_id":"ciq9xx7km0040q4o2r2p01fwj","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7lr006qq4o29p372dkl"},{"post_id":"ciq9xx7kp0045q4o25sq7t454","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lr006sq4o2a2yynpd1"},{"post_id":"ciq9xx7kp0045q4o25sq7t454","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7ls006uq4o2wwpnqk59"},{"post_id":"ciq9xx7kr0047q4o2an3nbbq0","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7ls006vq4o29iwhhawa"},{"post_id":"ciq9xx7kr0047q4o2an3nbbq0","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7ls006xq4o2ox8sxgmp"},{"post_id":"ciq9xx7kt004bq4o2q2zberod","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lt006zq4o2baeci0wc"},{"post_id":"ciq9xx7kt004bq4o2q2zberod","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7lt0072q4o2g4pft3ah"},{"post_id":"ciq9xx7ho0018q4o2frtw4wuu","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7lu0074q4o2qg0qjz30"},{"post_id":"ciq9xx7kv004dq4o2f79c4s7s","category_id":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7lw0076q4o2pfcszrk7"},{"post_id":"ciq9xx7l1004iq4o26sig0qtb","category_id":"ciq9xx7gc0004q4o23x8odlfy","_id":"ciq9xx7lx0077q4o26v670xx7"},{"post_id":"ciq9xx7l1004iq4o26sig0qtb","category_id":"ciq9xx7h2000kq4o2d9o5zcfj","_id":"ciq9xx7lx0079q4o2vdbm1n2m"},{"post_id":"ciq9xx7hu001gq4o2a1daunmu","category_id":"ciq9xx7ja002fq4o2su9a74pw","_id":"ciq9xx7lx007aq4o2rdhyr7fz"},{"post_id":"ciq9xx7l3004lq4o2e0lthizo","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7lx007bq4o216hui9ad"},{"post_id":"ciq9xx7l3004lq4o2e0lthizo","category_id":"ciq9xx7jo002yq4o27a9bmlj2","_id":"ciq9xx7ly007dq4o2s22cefp2"},{"post_id":"ciq9xx7i7001sq4o2vcikza8d","category_id":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7ly007eq4o2khi5vm2h"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","category_id":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7lz007gq4o2dj2ldm6r"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","category_id":"ciq9xx7l9004wq4o2ey9jc4nk","_id":"ciq9xx7m0007iq4o202qmx8dj"},{"post_id":"ciq9xx7jp0030q4o26vds18qu","category_id":"ciq9xx7gc0004q4o23x8odlfy","_id":"ciq9xx7m0007lq4o29yydelrs"},{"post_id":"ciq9xx7jp0030q4o26vds18qu","category_id":"ciq9xx7lb0050q4o2gx27a2tn","_id":"ciq9xx7m0007nq4o2uzimonkh"},{"post_id":"ciq9xx7k5003hq4o20clgrnf2","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7m1007qq4o2cptpbtyp"},{"post_id":"ciq9xx7k5003hq4o20clgrnf2","category_id":"ciq9xx7jx0036q4o20uctcy44","_id":"ciq9xx7m1007sq4o2zfidqv12"},{"post_id":"ciq9xx7k5003hq4o20clgrnf2","category_id":"ciq9xx7lc0055q4o288eb66l0","_id":"ciq9xx7m2007uq4o28osg2nzn"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","category_id":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7m2007vq4o210fdm9b6"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","category_id":"ciq9xx7lf005aq4o2mo86svjf","_id":"ciq9xx7m2007wq4o2f19j4rrw"},{"post_id":"ciq9xx7ii001yq4o2g5ll06yk","category_id":"ciq9xx7jk002rq4o2bwcfgujb","_id":"ciq9xx7m3007yq4o2rsnzrr3v"},{"post_id":"ciq9xx7ii001yq4o2g5ll06yk","category_id":"ciq9xx7lh005gq4o2fj7kfxqz","_id":"ciq9xx7m3007zq4o2bvgdbtkm"},{"post_id":"ciq9xx7p500deq4o2187zzqa4","category_id":"ciq9xx7gk0009q4o2916yy1s2","_id":"ciq9xx7pa00dhq4o2zw12v1oz"},{"post_id":"ciq9xx7p500deq4o2187zzqa4","category_id":"ciq9xx7hf000xq4o2lani0wu0","_id":"ciq9xx7pa00diq4o25ttv4ovf"}],"PostTag":[{"post_id":"ciq9xx7fy0001q4o26drvw510","tag_id":"ciq9xx7g90003q4o2tu2xqgoo","_id":"ciq9xx7h6000nq4o23vzivg39"},{"post_id":"ciq9xx7fy0001q4o26drvw510","tag_id":"ciq9xx7gi0007q4o27fam74qz","_id":"ciq9xx7h8000pq4o2ko1opk9m"},{"post_id":"ciq9xx7fy0001q4o26drvw510","tag_id":"ciq9xx7gp000cq4o20nqr9rfu","_id":"ciq9xx7ha000tq4o2l22wqv7h"},{"post_id":"ciq9xx7fy0001q4o26drvw510","tag_id":"ciq9xx7gz000hq4o2tkvjnpmo","_id":"ciq9xx7he000wq4o2p6yfqshf"},{"post_id":"ciq9xx7gd0005q4o2i8k6ryww","tag_id":"ciq9xx7h4000lq4o2ffet8ino","_id":"ciq9xx7ho0016q4o2ckxt6b9i"},{"post_id":"ciq9xx7gd0005q4o2i8k6ryww","tag_id":"ciq9xx7h9000rq4o2hctxyl93","_id":"ciq9xx7hq001aq4o2r78bs0c2"},{"post_id":"ciq9xx7gd0005q4o2i8k6ryww","tag_id":"ciq9xx7hh000zq4o2429m6v0b","_id":"ciq9xx7hs001eq4o2atjxhxki"},{"post_id":"ciq9xx7gg0006q4o2z3t52qk6","tag_id":"ciq9xx7hm0014q4o2m91aouvv","_id":"ciq9xx7iv001zq4o24vg93hw7"},{"post_id":"ciq9xx7gg0006q4o2z3t52qk6","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7iy0023q4o2oljqtawy"},{"post_id":"ciq9xx7gg0006q4o2z3t52qk6","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7j00027q4o2d27a8fvo"},{"post_id":"ciq9xx7gg0006q4o2z3t52qk6","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7j6002bq4o2y4jnsz83"},{"post_id":"ciq9xx7jk002tq4o2bcrmrtwa","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7jn002wq4o2cza90a3n"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7jy0037q4o269gbh95x"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","tag_id":"ciq9xx7iy0024q4o2oft0ptly","_id":"ciq9xx7k1003aq4o2xbdnv688"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","tag_id":"ciq9xx7j7002dq4o267asblcz","_id":"ciq9xx7k4003fq4o2v9q8a79t"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","tag_id":"ciq9xx7je002kq4o2ev16t3r8","_id":"ciq9xx7k7003iq4o2oakl1kzc"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","tag_id":"ciq9xx7jj002qq4o22mk9zkr6","_id":"ciq9xx7kb003nq4o2zihj6rjm"},{"post_id":"ciq9xx7gi0008q4o2o5uvyk7u","tag_id":"ciq9xx7jo002xq4o22pych6nm","_id":"ciq9xx7kf003qq4o2cb8errf6"},{"post_id":"ciq9xx7gk000aq4o29p4tnie6","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7kj003vq4o21blg9tbg"},{"post_id":"ciq9xx7gk000aq4o29p4tnie6","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7kl003yq4o2jpi1wk7n"},{"post_id":"ciq9xx7gk000aq4o29p4tnie6","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7kp0043q4o260s3yz7r"},{"post_id":"ciq9xx7gm000bq4o2a9pa3dvd","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7l1004hq4o2uumlt5ig"},{"post_id":"ciq9xx7gm000bq4o2a9pa3dvd","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7l3004kq4o2a7qyx5ub"},{"post_id":"ciq9xx7gm000bq4o2a9pa3dvd","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7l6004pq4o2yhasar5y"},{"post_id":"ciq9xx7l1004iq4o26sig0qtb","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7l6004rq4o2188eqaek"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","tag_id":"ciq9xx7ky004eq4o2kxy0yivq","_id":"ciq9xx7lg005cq4o2fd0r4lim"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","tag_id":"ciq9xx7l5004mq4o20093fc7k","_id":"ciq9xx7lg005eq4o22s23oqol"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","tag_id":"ciq9xx7l7004tq4o2gbzm5y1u","_id":"ciq9xx7lh005iq4o25j9dr27z"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7li005kq4o2wz1jous7"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","tag_id":"ciq9xx7lb0052q4o2cx4dbmaa","_id":"ciq9xx7lj005nq4o2ixwpv67w"},{"post_id":"ciq9xx7gt000eq4o2dfdhzozn","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7lj005pq4o2mfl7oeef"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7lm0061q4o294h0iiyl"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7lm0063q4o2yzm62uop"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7ln0066q4o2929e2nqq"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","tag_id":"ciq9xx7j7002dq4o267asblcz","_id":"ciq9xx7ln0068q4o2w1orqntg"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","tag_id":"ciq9xx7lk005tq4o2mj2prwoy","_id":"ciq9xx7lo006bq4o2xvt98w1l"},{"post_id":"ciq9xx7gw000fq4o2ehw79pvt","tag_id":"ciq9xx7ll005wq4o2hy9becac","_id":"ciq9xx7lo006dq4o2ulexwncj"},{"post_id":"ciq9xx7gz000iq4o2ct04qohd","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7lq006kq4o2werayxsu"},{"post_id":"ciq9xx7gz000iq4o2ct04qohd","tag_id":"ciq9xx7lm0064q4o27kpecwe4","_id":"ciq9xx7lq006mq4o2dn1af6mh"},{"post_id":"ciq9xx7gz000iq4o2ct04qohd","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7lr006pq4o2wgr85w4i"},{"post_id":"ciq9xx7gz000iq4o2ct04qohd","tag_id":"ciq9xx7lo006fq4o24rd3fpi9","_id":"ciq9xx7lr006rq4o2ai0gdpt9"},{"post_id":"ciq9xx7h5000mq4o2579s7pbi","tag_id":"ciq9xx7lp006iq4o2ufry6eob","_id":"ciq9xx7lt006yq4o24z1j7pc8"},{"post_id":"ciq9xx7h5000mq4o2579s7pbi","tag_id":"ciq9xx7lq006nq4o2x868vt83","_id":"ciq9xx7lt0070q4o2jfotvplx"},{"post_id":"ciq9xx7h5000mq4o2579s7pbi","tag_id":"ciq9xx7lr006tq4o2nivfl1d8","_id":"ciq9xx7lu0073q4o2sza9rwwd"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7lz007hq4o2m59twhum"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","tag_id":"ciq9xx7lt0071q4o2guaci351","_id":"ciq9xx7m0007jq4o20uieh3f0"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","tag_id":"ciq9xx7lw0075q4o23b77o2kx","_id":"ciq9xx7m0007mq4o2ov64ns89"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","tag_id":"ciq9xx7lx0078q4o2k485whex","_id":"ciq9xx7m1007oq4o20qz30580"},{"post_id":"ciq9xx7h6000oq4o2h08hy80w","tag_id":"ciq9xx7ly007cq4o2yufjuxew","_id":"ciq9xx7m1007rq4o2341hl5wi"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7m40081q4o21nobo2u0"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","tag_id":"ciq9xx7m0007kq4o2t6jxmerq","_id":"ciq9xx7m40082q4o25ee04tsm"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","tag_id":"ciq9xx7m1007pq4o2oz9dr5f5","_id":"ciq9xx7m40084q4o2n3tltuag"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","tag_id":"ciq9xx7m2007tq4o2qa9urx84","_id":"ciq9xx7m50085q4o2ejqqiq4s"},{"post_id":"ciq9xx7h9000sq4o2l43h0ekp","tag_id":"ciq9xx7m2007xq4o2qgpei2y4","_id":"ciq9xx7m50087q4o2mqzrqbbx"},{"post_id":"ciq9xx7hb000uq4o2gfs2sx1s","tag_id":"ciq9xx7m30080q4o2c77arx7l","_id":"ciq9xx7m50088q4o27w0i8zuo"},{"post_id":"ciq9xx7hg000yq4o2wx4yplad","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7m9008bq4o2mhrchfdi"},{"post_id":"ciq9xx7hg000yq4o2wx4yplad","tag_id":"ciq9xx7m50086q4o2ry7ctoys","_id":"ciq9xx7m9008cq4o26rt0qoib"},{"post_id":"ciq9xx7hg000yq4o2wx4yplad","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7ma008eq4o2mumhpc7r"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7mc008jq4o2oaf8lmha"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","tag_id":"ciq9xx7lw0075q4o23b77o2kx","_id":"ciq9xx7mc008kq4o2hk3d882p"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7md008mq4o2j8jo4ezj"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","tag_id":"ciq9xx7ma008gq4o2w9lzwo8s","_id":"ciq9xx7md008nq4o2akixesfc"},{"post_id":"ciq9xx7hl0013q4o2nxdd9xvk","tag_id":"ciq9xx7mb008hq4o26txdwzr8","_id":"ciq9xx7md008pq4o2sfv224wj"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","tag_id":"ciq9xx7mb008iq4o2vff48b0a","_id":"ciq9xx7mg008tq4o2uymbtnc7"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7mg008uq4o2f75ppsjf"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","tag_id":"ciq9xx7md008oq4o2mxtkzhuy","_id":"ciq9xx7mh008wq4o2zj3bk8yb"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7mh008xq4o28x4r1lnq"},{"post_id":"ciq9xx7hn0015q4o24l4si41l","tag_id":"ciq9xx7me008rq4o2wys8h55h","_id":"ciq9xx7mi008zq4o2liex8k4u"},{"post_id":"ciq9xx7ho0018q4o2frtw4wuu","tag_id":"ciq9xx7lp006iq4o2ufry6eob","_id":"ciq9xx7mi0090q4o2m46sugtk"},{"post_id":"ciq9xx7hr001dq4o2emv345dk","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7mj0094q4o2cxd5kg7u"},{"post_id":"ciq9xx7hr001dq4o2emv345dk","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7mk0095q4o2rel2puny"},{"post_id":"ciq9xx7hr001dq4o2emv345dk","tag_id":"ciq9xx7mi0091q4o2kqwhuf82","_id":"ciq9xx7mk0097q4o2r3ew1r9a"},{"post_id":"ciq9xx7hr001dq4o2emv345dk","tag_id":"ciq9xx7mb008hq4o26txdwzr8","_id":"ciq9xx7mk0098q4o2wtttjocd"},{"post_id":"ciq9xx7hw001kq4o2k6enoedb","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7ml009aq4o2uw9m57ln"},{"post_id":"ciq9xx7hw001kq4o2k6enoedb","tag_id":"ciq9xx7mk0096q4o2i9cs893j","_id":"ciq9xx7ml009bq4o2vzjb6obi"},{"post_id":"ciq9xx7hw001kq4o2k6enoedb","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7mm009dq4o29m68gl9q"},{"post_id":"ciq9xx7hz001mq4o2owmv64n1","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7mn009fq4o2re7la8fc"},{"post_id":"ciq9xx7hz001mq4o2owmv64n1","tag_id":"ciq9xx7mk0096q4o2i9cs893j","_id":"ciq9xx7mn009gq4o2952e5ts9"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7mq009lq4o2xa0fmnyg"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","tag_id":"ciq9xx7mn009hq4o25siw25lb","_id":"ciq9xx7mq009mq4o2nj39myy7"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","tag_id":"ciq9xx7mk0096q4o2i9cs893j","_id":"ciq9xx7mq009oq4o2w65ago7h"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7mq009pq4o2wid46oen"},{"post_id":"ciq9xx7i4001pq4o2kj9lc5am","tag_id":"ciq9xx7mo009jq4o2k9u1be1c","_id":"ciq9xx7mr009rq4o2dzud5amj"},{"post_id":"ciq9xx7i7001sq4o2vcikza8d","tag_id":"ciq9xx7lw0075q4o23b77o2kx","_id":"ciq9xx7mr009sq4o2d1tr8kuz"},{"post_id":"ciq9xx7i7001sq4o2vcikza8d","tag_id":"ciq9xx7mq009nq4o2zzry7uqc","_id":"ciq9xx7ms009uq4o2zufpyi6f"},{"post_id":"ciq9xx7ie001vq4o2aqyej17g","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7mt009wq4o2e1i7ys54"},{"post_id":"ciq9xx7ie001vq4o2aqyej17g","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7mt009xq4o2so5l5u8h"},{"post_id":"ciq9xx7ie001vq4o2aqyej17g","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7mu009zq4o2vlslfg5b"},{"post_id":"ciq9xx7ie001vq4o2aqyej17g","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7mu00a0q4o2tlj8lacd"},{"post_id":"ciq9xx7ii001yq4o2g5ll06yk","tag_id":"ciq9xx7m30080q4o2c77arx7l","_id":"ciq9xx7mv00a2q4o2hl1q21uj"},{"post_id":"ciq9xx7ii001yq4o2g5ll06yk","tag_id":"ciq9xx7mt009yq4o2ygtbze0w","_id":"ciq9xx7mv00a3q4o2gqas30dt"},{"post_id":"ciq9xx7iw0022q4o2x54fs6ja","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7mw00a5q4o2kj7teqt8"},{"post_id":"ciq9xx7iw0022q4o2x54fs6ja","tag_id":"ciq9xx7mu00a1q4o2cevf6wtw","_id":"ciq9xx7mw00a6q4o2tocbxoip"},{"post_id":"ciq9xx7iz0026q4o2yftymaxa","tag_id":"ciq9xx7mq009nq4o2zzry7uqc","_id":"ciq9xx7my00aaq4o264i1keng"},{"post_id":"ciq9xx7iz0026q4o2yftymaxa","tag_id":"ciq9xx7mw00a7q4o2jlprqnzy","_id":"ciq9xx7my00abq4o291gze720"},{"post_id":"ciq9xx7iz0026q4o2yftymaxa","tag_id":"ciq9xx7mw00a8q4o2jcil6xwc","_id":"ciq9xx7mz00adq4o2bq9kzv1n"},{"post_id":"ciq9xx7j1002aq4o2v1elhqqn","tag_id":"ciq9xx7mx00a9q4o2kxhqt3zk","_id":"ciq9xx7mz00aeq4o2gyh2vg45"},{"post_id":"ciq9xx7j1002aq4o2v1elhqqn","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7n000agq4o2we7k5ig1"},{"post_id":"ciq9xx7j1002aq4o2v1elhqqn","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7n000ahq4o2ygnr8g61"},{"post_id":"ciq9xx7j1002aq4o2v1elhqqn","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7n100ajq4o2eh6lez1c"},{"post_id":"ciq9xx7j7002eq4o2237ghxqh","tag_id":"ciq9xx7mx00a9q4o2kxhqt3zk","_id":"ciq9xx7n100akq4o2ma7m5kgv"},{"post_id":"ciq9xx7j7002eq4o2237ghxqh","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7n100amq4o216ryrcxz"},{"post_id":"ciq9xx7j7002eq4o2237ghxqh","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7n200anq4o2w3fsvts4"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","tag_id":"ciq9xx7mx00a9q4o2kxhqt3zk","_id":"ciq9xx7n300apq4o2hvl25vp2"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7n300aqq4o217ya7aio"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7n400asq4o2c4yqzy4o"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7n400atq4o2s9vrqbq3"},{"post_id":"ciq9xx7jb002hq4o2kji8hcst","tag_id":"ciq9xx7n100alq4o2x5lvwx4h","_id":"ciq9xx7n500avq4o24vptfpz6"},{"post_id":"ciq9xx7jd002jq4o220fzgifc","tag_id":"ciq9xx7n200aoq4o2chv67bh9","_id":"ciq9xx7n500awq4o2v9dydw03"},{"post_id":"ciq9xx7jd002jq4o220fzgifc","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7n600ayq4o2sznznjre"},{"post_id":"ciq9xx7jd002jq4o220fzgifc","tag_id":"ciq9xx7n300arq4o2oosa9k0t","_id":"ciq9xx7n700azq4o2vdw3ykby"},{"post_id":"ciq9xx7jg002nq4o288tp3r2v","tag_id":"ciq9xx7n200aoq4o2chv67bh9","_id":"ciq9xx7n800b1q4o2225b5fq6"},{"post_id":"ciq9xx7jg002nq4o288tp3r2v","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7n800b2q4o2a2g3hcdc"},{"post_id":"ciq9xx7jg002nq4o288tp3r2v","tag_id":"ciq9xx7n300arq4o2oosa9k0t","_id":"ciq9xx7n900b4q4o2odcfobnv"},{"post_id":"ciq9xx7ji002pq4o28zte13lp","tag_id":"ciq9xx7m50086q4o2ry7ctoys","_id":"ciq9xx7n900b5q4o2uhq5932z"},{"post_id":"ciq9xx7ji002pq4o28zte13lp","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7na00b7q4o22p724zqs"},{"post_id":"ciq9xx7jm002vq4o2mewjflqv","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7nc00baq4o2jv8s9bq5"},{"post_id":"ciq9xx7jm002vq4o2mewjflqv","tag_id":"ciq9xx7m50086q4o2ry7ctoys","_id":"ciq9xx7nc00bbq4o2n0t1p16z"},{"post_id":"ciq9xx7jm002vq4o2mewjflqv","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7nd00bdq4o2msqsjwbl"},{"post_id":"ciq9xx7jm002vq4o2mewjflqv","tag_id":"ciq9xx7na00b8q4o2xy48mjyb","_id":"ciq9xx7nd00beq4o28g6ythsq"},{"post_id":"ciq9xx7jp0030q4o26vds18qu","tag_id":"ciq9xx7nb00b9q4o2afag9at0","_id":"ciq9xx7ne00bhq4o2rne7b292"},{"post_id":"ciq9xx7jp0030q4o26vds18qu","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7ne00biq4o2lzoxt5e7"},{"post_id":"ciq9xx7jp0030q4o26vds18qu","tag_id":"ciq9xx7nc00bcq4o2e3lxu2ed","_id":"ciq9xx7ng00bkq4o2u2drfsip"},{"post_id":"ciq9xx7jp0030q4o26vds18qu","tag_id":"ciq9xx7nd00bfq4o2u18jnxr6","_id":"ciq9xx7ng00blq4o2jwifa9xi"},{"post_id":"ciq9xx7jt0032q4o2tuhlm8dc","tag_id":"ciq9xx7nd00bgq4o2rne1e4tf","_id":"ciq9xx7ni00bnq4o2wt96wyau"},{"post_id":"ciq9xx7jt0032q4o2tuhlm8dc","tag_id":"ciq9xx7mq009nq4o2zzry7uqc","_id":"ciq9xx7ni00boq4o25k0w6ecj"},{"post_id":"ciq9xx7jv0035q4o2aohvr3fe","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7nl00btq4o2tbhdfbtz"},{"post_id":"ciq9xx7jv0035q4o2aohvr3fe","tag_id":"ciq9xx7ni00bpq4o2ekd6xblp","_id":"ciq9xx7nl00buq4o2lg5b7sm3"},{"post_id":"ciq9xx7jv0035q4o2aohvr3fe","tag_id":"ciq9xx7nj00bqq4o2ju1phikm","_id":"ciq9xx7nn00bwq4o2h9pu37oh"},{"post_id":"ciq9xx7jv0035q4o2aohvr3fe","tag_id":"ciq9xx7nj00brq4o2ww4cxvnc","_id":"ciq9xx7nn00bxq4o20frbxoks"},{"post_id":"ciq9xx7jz0039q4o2p4v2rmdt","tag_id":"ciq9xx7kg003sq4o2319hwh09","_id":"ciq9xx7no00bzq4o26suj7j2v"},{"post_id":"ciq9xx7jz0039q4o2p4v2rmdt","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7no00c0q4o2htigsv2v"},{"post_id":"ciq9xx7jz0039q4o2p4v2rmdt","tag_id":"ciq9xx7hw001jq4o2vyllybiz","_id":"ciq9xx7np00c2q4o24kr7ts3q"},{"post_id":"ciq9xx7jz0039q4o2p4v2rmdt","tag_id":"ciq9xx7i6001qq4o2lzcw07nj","_id":"ciq9xx7np00c3q4o2qp7uvvcg"},{"post_id":"ciq9xx7k5003hq4o20clgrnf2","tag_id":"ciq9xx7m30080q4o2c77arx7l","_id":"ciq9xx7nq00c5q4o2zxn68qfw"},{"post_id":"ciq9xx7k5003hq4o20clgrnf2","tag_id":"ciq9xx7iy0024q4o2oft0ptly","_id":"ciq9xx7nq00c6q4o218qm8xbq"},{"post_id":"ciq9xx7k8003lq4o2yusfcvlm","tag_id":"ciq9xx7lp006iq4o2ufry6eob","_id":"ciq9xx7ns00c8q4o2u5l0ybxw"},{"post_id":"ciq9xx7kb003pq4o2z6cj08lm","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7ns00c9q4o2vryuhbeu"},{"post_id":"ciq9xx7kb003pq4o2z6cj08lm","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7ns00cbq4o25yn11eza"},{"post_id":"ciq9xx7kb003pq4o2z6cj08lm","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7nt00ccq4o2gr0d0a9q"},{"post_id":"ciq9xx7kb003pq4o2z6cj08lm","tag_id":"ciq9xx7ma008gq4o2w9lzwo8s","_id":"ciq9xx7nu00ceq4o22u17p036"},{"post_id":"ciq9xx7kh003tq4o2xr975zjb","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7nu00cfq4o2wh0bo99v"},{"post_id":"ciq9xx7kh003tq4o2xr975zjb","tag_id":"ciq9xx7ni00bpq4o2ekd6xblp","_id":"ciq9xx7nu00chq4o20ovzfzgd"},{"post_id":"ciq9xx7kk003xq4o2pxolnpol","tag_id":"ciq9xx7n200aoq4o2chv67bh9","_id":"ciq9xx7nw00cjq4o2lh83wd93"},{"post_id":"ciq9xx7kk003xq4o2pxolnpol","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7nw00ckq4o2rxaunybq"},{"post_id":"ciq9xx7kk003xq4o2pxolnpol","tag_id":"ciq9xx7nu00cgq4o2mdnakf4l","_id":"ciq9xx7nx00cmq4o2zhxmw6cn"},{"post_id":"ciq9xx7km0040q4o2r2p01fwj","tag_id":"ciq9xx7ig001wq4o2qn5hq4hr","_id":"ciq9xx7nx00cnq4o27ca84yf1"},{"post_id":"ciq9xx7km0040q4o2r2p01fwj","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7ny00cpq4o2tml8fhpn"},{"post_id":"ciq9xx7km0040q4o2r2p01fwj","tag_id":"ciq9xx7nv00ciq4o2mo8ehmgk","_id":"ciq9xx7ny00cqq4o2gzii5q88"},{"post_id":"ciq9xx7kp0045q4o25sq7t454","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7nz00csq4o28hf4si82"},{"post_id":"ciq9xx7kp0045q4o25sq7t454","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7nz00ctq4o2nqqtu79l"},{"post_id":"ciq9xx7kp0045q4o25sq7t454","tag_id":"ciq9xx7m2007tq4o2qa9urx84","_id":"ciq9xx7o000cvq4o2uz5d6vbe"},{"post_id":"ciq9xx7kr0047q4o2an3nbbq0","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7o100cxq4o2c4cv9h7n"},{"post_id":"ciq9xx7kr0047q4o2an3nbbq0","tag_id":"ciq9xx7mk0096q4o2i9cs893j","_id":"ciq9xx7o100cyq4o25y906ef6"},{"post_id":"ciq9xx7kr0047q4o2an3nbbq0","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7o200d0q4o28f7ydl62"},{"post_id":"ciq9xx7kt004bq4o2q2zberod","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7o200d1q4o2fnvwlpt3"},{"post_id":"ciq9xx7kt004bq4o2q2zberod","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7o300d3q4o2ftgoguex"},{"post_id":"ciq9xx7kv004dq4o2f79c4s7s","tag_id":"ciq9xx7lw0075q4o23b77o2kx","_id":"ciq9xx7o500d6q4o2jtndwt7l"},{"post_id":"ciq9xx7kv004dq4o2f79c4s7s","tag_id":"ciq9xx7o300d2q4o2q27b2ehj","_id":"ciq9xx7o500d7q4o2ut5d5txn"},{"post_id":"ciq9xx7kv004dq4o2f79c4s7s","tag_id":"ciq9xx7o300d4q4o2rhaf9vg6","_id":"ciq9xx7o500d9q4o2dpgjtnaq"},{"post_id":"ciq9xx7l3004lq4o2e0lthizo","tag_id":"ciq9xx7o400d5q4o2ueuc8grp","_id":"ciq9xx7o800dbq4o2eyn7k25d"},{"post_id":"ciq9xx7l3004lq4o2e0lthizo","tag_id":"ciq9xx7o500d8q4o29fkq2ktp","_id":"ciq9xx7o800dcq4o2ypifvchy"},{"post_id":"ciq9xx7l3004lq4o2e0lthizo","tag_id":"ciq9xx7o600daq4o29jwlb77v","_id":"ciq9xx7o800ddq4o24y2qe516"},{"post_id":"ciq9xx7p500deq4o2187zzqa4","tag_id":"ciq9xx7lo006aq4o2uv4cf7ky","_id":"ciq9xx7p900dfq4o2zwqyvv1r"},{"post_id":"ciq9xx7p500deq4o2187zzqa4","tag_id":"ciq9xx7hq001cq4o2s68a1hm2","_id":"ciq9xx7pa00dgq4o2ck37ld4b"}],"Tag":[{"name":"VBScript","_id":"ciq9xx7g90003q4o2tu2xqgoo"},{"name":"Macro","_id":"ciq9xx7gi0007q4o27fam74qz"},{"name":"Word","_id":"ciq9xx7gp000cq4o20nqr9rfu"},{"name":"Office","_id":"ciq9xx7gz000hq4o2tkvjnpmo"},{"name":"Powershell","_id":"ciq9xx7h4000lq4o2ffet8ino"},{"name":"OpsMgr 2012 R2","_id":"ciq9xx7h9000rq4o2hctxyl93"},{"name":"HowTo","_id":"ciq9xx7hh000zq4o2429m6v0b"},{"name":"ACS","_id":"ciq9xx7hm0014q4o2m91aouvv"},{"name":"OpsMgr","_id":"ciq9xx7hq001cq4o2s68a1hm2"},{"name":"PoSH","_id":"ciq9xx7hw001jq4o2vyllybiz"},{"name":"Script","_id":"ciq9xx7i6001qq4o2lzcw07nj"},{"name":"Errors","_id":"ciq9xx7ig001wq4o2qn5hq4hr"},{"name":"KB","_id":"ciq9xx7iy0024q4o2oft0ptly"},{"name":"Windows","_id":"ciq9xx7j7002dq4o267asblcz"},{"name":"Windows 2008","_id":"ciq9xx7je002kq4o2ev16t3r8"},{"name":"Windows Vista","_id":"ciq9xx7jj002qq4o22mk9zkr6"},{"name":"Windows XP","_id":"ciq9xx7jo002xq4o22pych6nm"},{"name":"How-To","_id":"ciq9xx7kg003sq4o2319hwh09"},{"name":"DNS","_id":"ciq9xx7ky004eq4o2kxy0yivq"},{"name":"Invoke-RestMethod","_id":"ciq9xx7l5004mq4o20093fc7k"},{"name":"Mikrotik","_id":"ciq9xx7l7004tq4o2gbzm5y1u"},{"name":"RouterOS","_id":"ciq9xx7lb0052q4o2cx4dbmaa"},{"name":"Windows Installer","_id":"ciq9xx7lk005tq4o2mj2prwoy"},{"name":"WMI","_id":"ciq9xx7ll005wq4o2hy9becac"},{"name":"Exchange","_id":"ciq9xx7lm0064q4o27kpecwe4"},{"name":"Management Pack","_id":"ciq9xx7lo006aq4o2uv4cf7ky"},{"name":"TechNet","_id":"ciq9xx7lo006fq4o24rd3fpi9"},{"name":"Teknoglot","_id":"ciq9xx7lp006iq4o2ufry6eob"},{"name":"Hexo","_id":"ciq9xx7lq006nq4o2x868vt83"},{"name":"Wordpress","_id":"ciq9xx7lr006tq4o2nivfl1d8"},{"name":"Hyper-V","_id":"ciq9xx7lt0071q4o2guaci351"},{"name":"Linux","_id":"ciq9xx7lw0075q4o23b77o2kx"},{"name":"RedHat","_id":"ciq9xx7lx0078q4o2k485whex"},{"name":"RHES5","_id":"ciq9xx7ly007cq4o2yufjuxew"},{"name":"IIS7","_id":"ciq9xx7m0007kq4o2t6jxmerq"},{"name":"Reporting Services","_id":"ciq9xx7m1007pq4o2oz9dr5f5"},{"name":"x64","_id":"ciq9xx7m2007tq4o2qa9urx84"},{"name":"OpsMgr 2007","_id":"ciq9xx7m2007xq4o2qgpei2y4"},{"name":"Drivers","_id":"ciq9xx7m30080q4o2c77arx7l"},{"name":"MP Development","_id":"ciq9xx7m50086q4o2ry7ctoys"},{"name":"TroubleShooting","_id":"ciq9xx7ma008gq4o2w9lzwo8s"},{"name":"X-Plat","_id":"ciq9xx7mb008hq4o26txdwzr8"},{"name":"Highly-Available","_id":"ciq9xx7mb008iq4o2vff48b0a"},{"name":"NLB","_id":"ciq9xx7md008oq4o2mxtkzhuy"},{"name":"Tutorial","_id":"ciq9xx7me008rq4o2wys8h55h"},{"name":"SUSE 11","_id":"ciq9xx7mi0091q4o2kqwhuf82"},{"name":"MSMQ","_id":"ciq9xx7mk0096q4o2i9cs893j"},{"name":"Fixed","_id":"ciq9xx7mn009hq4o25siw25lb"},{"name":"Quick-fix","_id":"ciq9xx7mo009jq4o2k9u1be1c"},{"name":"Rant","_id":"ciq9xx7mq009nq4o2zzry7uqc"},{"name":"NVidia","_id":"ciq9xx7mt009yq4o2ygtbze0w"},{"name":"Quick Reference","_id":"ciq9xx7mu00a1q4o2cevf6wtw"},{"name":"Sillyness","_id":"ciq9xx7mw00a7q4o2jlprqnzy"},{"name":"Teach a Man to Fish","_id":"ciq9xx7mw00a8q4o2jcil6xwc"},{"name":"Fail-over","_id":"ciq9xx7mx00a9q4o2kxhqt3zk"},{"name":"Scripts","_id":"ciq9xx7n100alq4o2x5lvwx4h"},{"name":"Field Notes","_id":"ciq9xx7n200aoq4o2chv67bh9"},{"name":"Update Rollup","_id":"ciq9xx7n300arq4o2oosa9k0t"},{"name":"Video","_id":"ciq9xx7na00b8q4o2xy48mjyb"},{"name":"GSM","_id":"ciq9xx7nb00b9q4o2afag9at0"},{"name":"Quick-hack","_id":"ciq9xx7nc00bcq4o2e3lxu2ed"},{"name":"SMS","_id":"ciq9xx7nd00bfq4o2u18jnxr6"},{"name":"Conference","_id":"ciq9xx7nd00bgq4o2rne1e4tf"},{"name":"SQL Server","_id":"ciq9xx7ni00bpq4o2ekd6xblp"},{"name":"SQL Server 2005","_id":"ciq9xx7nj00bqq4o2ju1phikm"},{"name":"SQL Server 2008","_id":"ciq9xx7nj00brq4o2ww4cxvnc"},{"name":"SquaredUp","_id":"ciq9xx7nu00cgq4o2mdnakf4l"},{"name":"Unix","_id":"ciq9xx7nv00ciq4o2mo8ehmgk"},{"name":"OpenVPN","_id":"ciq9xx7o300d2q4o2q27b2ehj"},{"name":"Virtual Appliance","_id":"ciq9xx7o300d4q4o2rhaf9vg6"},{"name":"Checklist","_id":"ciq9xx7o400d5q4o2ueuc8grp"},{"name":"SQL Express 2005","_id":"ciq9xx7o500d8q4o29fkq2ktp"},{"name":"SQL Express 2008","_id":"ciq9xx7o600daq4o29jwlb77v"}]}}